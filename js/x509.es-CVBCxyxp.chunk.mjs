var Bh=Object.defineProperty,kh=Object.defineProperties;var xh=Object.getOwnPropertyDescriptors;var oi=Object.getOwnPropertySymbols;var Oa=Object.prototype.hasOwnProperty,Ca=Object.prototype.propertyIsEnumerable;var xa=(r,t,e)=>t in r?Bh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,P=(r,t)=>{for(var e in t||(t={}))Oa.call(t,e)&&xa(r,e,t[e]);if(oi)for(var e of oi(t))Ca.call(t,e)&&xa(r,e,t[e]);return r},K=(r,t)=>kh(r,xh(t));var q=(r,t)=>{var e={};for(var i in r)Oa.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&oi)for(var i of oi(r))t.indexOf(i)<0&&Ca.call(r,i)&&(e[i]=r[i]);return e};import{ar as Ea,B as Na,g as ai}from"./_plugin-vue2_normalizer-sB7H5_Rv.chunk.mjs";var Ia={},Ta;function Oh(){if(Ta)return Ia;Ta=1;var r;return function(t){(function(e){var i=typeof globalThis=="object"?globalThis:typeof Ea=="object"?Ea:typeof self=="object"?self:typeof this=="object"?this:u(),n=s(t);typeof i.Reflect<"u"&&(n=s(i.Reflect,n)),e(n,i),typeof i.Reflect>"u"&&(i.Reflect=t);function s(p,v){return function(m,H){Object.defineProperty(p,m,{configurable:!0,writable:!0,value:H}),v&&v(m,H)}}function a(){try{return Function("return this;")()}catch(p){}}function c(){try{return(0,eval)("(function() { return this; })()")}catch(p){}}function u(){return a()||c()}})(function(e,i){var n=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",a=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",c=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",u=typeof Object.create=="function",p={__proto__:[]}instanceof Array,v=!u&&!p,m={create:u?function(){return zn(Object.create(null))}:p?function(){return zn({__proto__:null})}:function(){return zn({})},has:v?function(f,y){return n.call(f,y)}:function(f,y){return y in f},get:v?function(f,y){return n.call(f,y)?f[y]:void 0}:function(f,y){return f[y]}},H=Object.getPrototypeOf(Function),J=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:mh(),et=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:wh(),Ht=typeof WeakMap=="function"?WeakMap:bh(),xe=s?Symbol.for("@reflect-metadata:registry"):void 0,ni=dh(),ca=gh(ni);function Yu(f,y,d,b){if(T(d)){if(!va(f))throw new TypeError;if(!ma(y))throw new TypeError;return ah(f,y)}else{if(!va(f))throw new TypeError;if(!Z(y))throw new TypeError;if(!Z(b)&&!T(b)&&!Oe(b))throw new TypeError;return Oe(b)&&(b=void 0),d=Tt(d),ch(f,y,d,b)}}e("decorate",Yu);function Xu(f,y){function d(b,I){if(!Z(b))throw new TypeError;if(!T(I)&&!fh(I))throw new TypeError;pa(f,y,b,I)}return d}e("metadata",Xu);function Qu(f,y,d,b){if(!Z(d))throw new TypeError;return T(b)||(b=Tt(b)),pa(f,y,d,b)}e("defineMetadata",Qu);function th(f,y,d){if(!Z(y))throw new TypeError;return T(d)||(d=Tt(d)),la(f,y,d)}e("hasMetadata",th);function eh(f,y,d){if(!Z(y))throw new TypeError;return T(d)||(d=Tt(d)),Wn(f,y,d)}e("hasOwnMetadata",eh);function rh(f,y,d){if(!Z(y))throw new TypeError;return T(d)||(d=Tt(d)),ua(f,y,d)}e("getMetadata",rh);function ih(f,y,d){if(!Z(y))throw new TypeError;return T(d)||(d=Tt(d)),ha(f,y,d)}e("getOwnMetadata",ih);function nh(f,y){if(!Z(f))throw new TypeError;return T(y)||(y=Tt(y)),fa(f,y)}e("getMetadataKeys",nh);function sh(f,y){if(!Z(f))throw new TypeError;return T(y)||(y=Tt(y)),ya(f,y)}e("getOwnMetadataKeys",sh);function oh(f,y,d){if(!Z(y))throw new TypeError;if(T(d)||(d=Tt(d)),!Z(y))throw new TypeError;T(d)||(d=Tt(d));var b=sr(y,d,!1);return T(b)?!1:b.OrdinaryDeleteMetadata(f,y,d)}e("deleteMetadata",oh);function ah(f,y){for(var d=f.length-1;d>=0;--d){var b=f[d],I=b(y);if(!T(I)&&!Oe(I)){if(!ma(I))throw new TypeError;y=I}}return y}function ch(f,y,d,b){for(var I=f.length-1;I>=0;--I){var z=f[I],Y=z(y,d,b);if(!T(Y)&&!Oe(Y)){if(!Z(Y))throw new TypeError;b=Y}}return b}function la(f,y,d){var b=Wn(f,y,d);if(b)return!0;var I=qn(y);return Oe(I)?!1:la(f,I,d)}function Wn(f,y,d){var b=sr(y,d,!1);return T(b)?!1:ga(b.OrdinaryHasOwnMetadata(f,y,d))}function ua(f,y,d){var b=Wn(f,y,d);if(b)return ha(f,y,d);var I=qn(y);if(!Oe(I))return ua(f,I,d)}function ha(f,y,d){var b=sr(y,d,!1);if(!T(b))return b.OrdinaryGetOwnMetadata(f,y,d)}function pa(f,y,d,b){var I=sr(d,b,!0);I.OrdinaryDefineOwnMetadata(f,y,d,b)}function fa(f,y){var d=ya(f,y),b=qn(f);if(b===null)return d;var I=fa(b,y);if(I.length<=0)return d;if(d.length<=0)return I;for(var z=new et,Y=[],R=0,B=d;R<B.length;R++){var O=B[R],C=z.has(O);C||(z.add(O),Y.push(O))}for(var N=0,V=I;N<V.length;N++){var O=V[N],C=z.has(O);C||(z.add(O),Y.push(O))}return Y}function ya(f,y){var d=sr(f,y,!1);return d?d.OrdinaryOwnMetadataKeys(f,y):[]}function da(f){if(f===null)return 1;switch(typeof f){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return f===null?1:6;default:return 6}}function T(f){return f===void 0}function Oe(f){return f===null}function lh(f){return typeof f=="symbol"}function Z(f){return typeof f=="object"?f!==null:typeof f=="function"}function uh(f,y){switch(da(f)){case 0:return f;case 1:return f;case 2:return f;case 3:return f;case 4:return f;case 5:return f}var d="string",b=wa(f,a);if(b!==void 0){var I=b.call(f,d);if(Z(I))throw new TypeError;return I}return hh(f)}function hh(f,y){var d,b,I;{var z=f.toString;if(si(z)){var b=z.call(f);if(!Z(b))return b}var d=f.valueOf;if(si(d)){var b=d.call(f);if(!Z(b))return b}}throw new TypeError}function ga(f){return!!f}function ph(f){return""+f}function Tt(f){var y=uh(f);return lh(y)?y:ph(y)}function va(f){return Array.isArray?Array.isArray(f):f instanceof Object?f instanceof Array:Object.prototype.toString.call(f)==="[object Array]"}function si(f){return typeof f=="function"}function ma(f){return typeof f=="function"}function fh(f){switch(da(f)){case 3:return!0;case 4:return!0;default:return!1}}function _n(f,y){return f===y||f!==f&&y!==y}function wa(f,y){var d=f[y];if(d!=null){if(!si(d))throw new TypeError;return d}}function ba(f){var y=wa(f,c);if(!si(y))throw new TypeError;var d=y.call(f);if(!Z(d))throw new TypeError;return d}function Aa(f){return f.value}function Sa(f){var y=f.next();return y.done?!1:y}function Ba(f){var y=f.return;y&&y.call(f)}function qn(f){var y=Object.getPrototypeOf(f);if(typeof f!="function"||f===H||y!==H)return y;var d=f.prototype,b=d&&Object.getPrototypeOf(d);if(b==null||b===Object.prototype)return y;var I=b.constructor;return typeof I!="function"||I===f?y:I}function yh(){var f;!T(xe)&&typeof i.Reflect<"u"&&!(xe in i.Reflect)&&typeof i.Reflect.defineMetadata=="function"&&(f=vh(i.Reflect));var y,d,b,I=new Ht,z={registerProvider:Y,getProvider:B,setProvider:C};return z;function Y(N){if(!Object.isExtensible(z))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case f===N:break;case T(y):y=N;break;case y===N:break;case T(d):d=N;break;case d===N:break;default:b===void 0&&(b=new et),b.add(N);break}}function R(N,V){if(!T(y)){if(y.isProviderFor(N,V))return y;if(!T(d)){if(d.isProviderFor(N,V))return y;if(!T(b))for(var $=ba(b);;){var G=Sa($);if(!G)return;var kt=Aa(G);if(kt.isProviderFor(N,V))return Ba($),kt}}}if(!T(f)&&f.isProviderFor(N,V))return f}function B(N,V){var $=I.get(N),G;return T($)||(G=$.get(V)),T(G)&&(G=R(N,V),T(G)||(T($)&&($=new J,I.set(N,$)),$.set(V,G))),G}function O(N){if(T(N))throw new TypeError;return y===N||d===N||!T(b)&&b.has(N)}function C(N,V,$){if(!O($))throw new Error("Metadata provider not registered.");var G=B(N,V);if(G!==$){if(!T(G))return!1;var kt=I.get(N);T(kt)&&(kt=new J,I.set(N,kt)),kt.set(V,$)}return!0}}function dh(){var f;return!T(xe)&&Z(i.Reflect)&&Object.isExtensible(i.Reflect)&&(f=i.Reflect[xe]),T(f)&&(f=yh()),!T(xe)&&Z(i.Reflect)&&Object.isExtensible(i.Reflect)&&Object.defineProperty(i.Reflect,xe,{enumerable:!1,configurable:!1,writable:!1,value:f}),f}function gh(f){var y=new Ht,d={isProviderFor:function(O,C){var N=y.get(O);return T(N)?!1:N.has(C)},OrdinaryDefineOwnMetadata:Y,OrdinaryHasOwnMetadata:I,OrdinaryGetOwnMetadata:z,OrdinaryOwnMetadataKeys:R,OrdinaryDeleteMetadata:B};return ni.registerProvider(d),d;function b(O,C,N){var V=y.get(O),$=!1;if(T(V)){if(!N)return;V=new J,y.set(O,V),$=!0}var G=V.get(C);if(T(G)){if(!N)return;if(G=new J,V.set(C,G),!f.setProvider(O,C,d))throw V.delete(C),$&&y.delete(O),new Error("Wrong provider for target.")}return G}function I(O,C,N){var V=b(C,N,!1);return T(V)?!1:ga(V.has(O))}function z(O,C,N){var V=b(C,N,!1);if(!T(V))return V.get(O)}function Y(O,C,N,V){var $=b(N,V,!0);$.set(O,C)}function R(O,C){var N=[],V=b(O,C,!1);if(T(V))return N;for(var $=V.keys(),G=ba($),kt=0;;){var ka=Sa(G);if(!ka)return N.length=kt,N;var Ah=Aa(ka);try{N[kt]=Ah}catch(Sh){try{Ba(G)}finally{throw Sh}}kt++}}function B(O,C,N){var V=b(C,N,!1);if(T(V)||!V.delete(O))return!1;if(V.size===0){var $=y.get(C);T($)||($.delete(N),$.size===0&&y.delete($))}return!0}}function vh(f){var y=f.defineMetadata,d=f.hasOwnMetadata,b=f.getOwnMetadata,I=f.getOwnMetadataKeys,z=f.deleteMetadata,Y=new Ht,R={isProviderFor:function(B,O){var C=Y.get(B);return!T(C)&&C.has(O)?!0:I(B,O).length?(T(C)&&(C=new et,Y.set(B,C)),C.add(O),!0):!1},OrdinaryDefineOwnMetadata:y,OrdinaryHasOwnMetadata:d,OrdinaryGetOwnMetadata:b,OrdinaryOwnMetadataKeys:I,OrdinaryDeleteMetadata:z};return R}function sr(f,y,d){var b=ni.getProvider(f,y);if(!T(b))return b;if(d){if(ni.setProvider(f,y,ca))return ca;throw new Error("Illegal state.")}}function mh(){var f={},y=[],d=function(){function R(B,O,C){this._index=0,this._keys=B,this._values=O,this._selector=C}return R.prototype["@@iterator"]=function(){return this},R.prototype[c]=function(){return this},R.prototype.next=function(){var B=this._index;if(B>=0&&B<this._keys.length){var O=this._selector(this._keys[B],this._values[B]);return B+1>=this._keys.length?(this._index=-1,this._keys=y,this._values=y):this._index++,{value:O,done:!1}}return{value:void 0,done:!0}},R.prototype.throw=function(B){throw this._index>=0&&(this._index=-1,this._keys=y,this._values=y),B},R.prototype.return=function(B){return this._index>=0&&(this._index=-1,this._keys=y,this._values=y),{value:B,done:!0}},R}(),b=function(){function R(){this._keys=[],this._values=[],this._cacheKey=f,this._cacheIndex=-2}return Object.defineProperty(R.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),R.prototype.has=function(B){return this._find(B,!1)>=0},R.prototype.get=function(B){var O=this._find(B,!1);return O>=0?this._values[O]:void 0},R.prototype.set=function(B,O){var C=this._find(B,!0);return this._values[C]=O,this},R.prototype.delete=function(B){var O=this._find(B,!1);if(O>=0){for(var C=this._keys.length,N=O+1;N<C;N++)this._keys[N-1]=this._keys[N],this._values[N-1]=this._values[N];return this._keys.length--,this._values.length--,_n(B,this._cacheKey)&&(this._cacheKey=f,this._cacheIndex=-2),!0}return!1},R.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=f,this._cacheIndex=-2},R.prototype.keys=function(){return new d(this._keys,this._values,I)},R.prototype.values=function(){return new d(this._keys,this._values,z)},R.prototype.entries=function(){return new d(this._keys,this._values,Y)},R.prototype["@@iterator"]=function(){return this.entries()},R.prototype[c]=function(){return this.entries()},R.prototype._find=function(B,O){if(!_n(this._cacheKey,B)){this._cacheIndex=-1;for(var C=0;C<this._keys.length;C++)if(_n(this._keys[C],B)){this._cacheIndex=C;break}}return this._cacheIndex<0&&O&&(this._cacheIndex=this._keys.length,this._keys.push(B),this._values.push(void 0)),this._cacheIndex},R}();return b;function I(R,B){return R}function z(R,B){return B}function Y(R,B){return[R,B]}}function wh(){var f=function(){function y(){this._map=new J}return Object.defineProperty(y.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),y.prototype.has=function(d){return this._map.has(d)},y.prototype.add=function(d){return this._map.set(d,d),this},y.prototype.delete=function(d){return this._map.delete(d)},y.prototype.clear=function(){this._map.clear()},y.prototype.keys=function(){return this._map.keys()},y.prototype.values=function(){return this._map.keys()},y.prototype.entries=function(){return this._map.entries()},y.prototype["@@iterator"]=function(){return this.keys()},y.prototype[c]=function(){return this.keys()},y}();return f}function bh(){var f=16,y=m.create(),d=b();return function(){function B(){this._key=b()}return B.prototype.has=function(O){var C=I(O,!1);return C!==void 0?m.has(C,this._key):!1},B.prototype.get=function(O){var C=I(O,!1);return C!==void 0?m.get(C,this._key):void 0},B.prototype.set=function(O,C){var N=I(O,!0);return N[this._key]=C,this},B.prototype.delete=function(O){var C=I(O,!1);return C!==void 0?delete C[this._key]:!1},B.prototype.clear=function(){this._key=b()},B}();function b(){var B;do B="@@WeakMap@@"+R();while(m.has(y,B));return y[B]=!0,B}function I(B,O){if(!n.call(B,d)){if(!O)return;Object.defineProperty(B,d,{value:m.create()})}return B[d]}function z(B,O){for(var C=0;C<O;++C)B[C]=Math.random()*255|0;return B}function Y(B){if(typeof Uint8Array=="function"){var O=new Uint8Array(B);return typeof crypto<"u"?crypto.getRandomValues(O):typeof msCrypto<"u"?msCrypto.getRandomValues(O):z(O,B),O}return z(new Array(B),B)}function R(){var B=Y(f);B[6]=B[6]&79|64,B[8]=B[8]&191|128;for(var O="",C=0;C<f;++C){var N=B[C];(C===4||C===6||C===8)&&(O+="-"),N<16&&(O+="0"),O+=N.toString(16).toLowerCase()}return O}}function zn(f){return f.__=void 0,delete f.__,f}})}(r||(r={})),Ia}Oh();const Ch="[object ArrayBuffer]";class A{static isArrayBuffer(t){return Object.prototype.toString.call(t)===Ch}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e)return t;if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const i=A.toUint8Array(t),n=A.toUint8Array(e);if(i.length!==n.byteLength)return!1;for(let s=0;s<i.length;s++)if(i[s]!==n[s])return!1;return!0}static concat(...t){let e;Array.isArray(t[0])&&!(t[1]instanceof Function)||Array.isArray(t[0])&&t[1]instanceof Function?e=t[0]:t[t.length-1]instanceof Function?e=t.slice(0,t.length-1):e=t;let i=0;for(const a of e)i+=a.byteLength;const n=new Uint8Array(i);let s=0;for(const a of e){const c=this.toUint8Array(a);n.set(c,s),s+=c.length}return t[t.length-1]instanceof Function?this.toView(n,t[t.length-1]):n.buffer}}const Kn="string",Eh=/^[0-9a-f\s]+$/i,Nh=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,Ih=/^[a-zA-Z0-9-_]+$/;class ja{static fromString(t){const e=unescape(encodeURIComponent(t)),i=new Uint8Array(e.length);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i.buffer}static toString(t){const e=A.toUint8Array(t);let i="";for(let n=0;n<e.length;n++)i+=String.fromCharCode(e[n]);return decodeURIComponent(escape(i))}}class jt{static toString(t,e=!1){const i=A.toArrayBuffer(t),n=new DataView(i);let s="";for(let a=0;a<i.byteLength;a+=2){const c=n.getUint16(a,e);s+=String.fromCharCode(c)}return s}static fromString(t,e=!1){const i=new ArrayBuffer(t.length*2),n=new DataView(i);for(let s=0;s<t.length;s++)n.setUint16(s*2,t.charCodeAt(s),e);return i}}class E{static isHex(t){return typeof t===Kn&&Eh.test(t)}static isBase64(t){return typeof t===Kn&&Nh.test(t)}static isBase64Url(t){return typeof t===Kn&&Ih.test(t)}static ToString(t,e="utf8"){const i=A.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(i);case"binary":return this.ToBinary(i);case"hex":return this.ToHex(i);case"base64":return this.ToBase64(i);case"base64url":return this.ToBase64Url(i);case"utf16le":return jt.toString(i,!0);case"utf16":case"utf16be":return jt.toString(i);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return jt.fromString(t,!0);case"utf16":case"utf16be":return jt.fromString(t);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToBase64(t){const e=A.toUint8Array(t);if(typeof btoa<"u"){const i=this.ToString(e,"binary");return btoa(i)}else return Na.from(e).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(e)):new Uint8Array(Na.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return ja.fromString(t);case"utf16":case"utf16be":return jt.fromString(t);case"utf16le":case"usc2":return jt.fromString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return ja.toString(t);case"utf16":case"utf16be":return jt.toString(t);case"utf16le":case"usc2":return jt.toString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromBinary(t){const e=t.length,i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.charCodeAt(n);return i.buffer}static ToBinary(t){const e=A.toUint8Array(t);let i="";for(let n=0;n<e.length;n++)i+=String.fromCharCode(e[n]);return i}static ToHex(t){const e=A.toUint8Array(t);let i="";const n=e.length;for(let s=0;s<n;s++){const a=e[s];a<16&&(i+="0"),i+=a.toString(16)}return i}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e="0".concat(e));const i=new Uint8Array(e.length/2);for(let n=0;n<e.length;n=n+2){const s=e.slice(n,n+2);i[n/2]=parseInt(s,16)}return i.buffer}static ToUtf16String(t,e=!1){return jt.toString(t,e)}static FromUtf16String(t,e=!1){return jt.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let i=0;i<e;i++)t+="=";return t}static formatString(t){return(t==null?void 0:t.replace(/[\n\r\t ]/g,""))||""}}E.DEFAULT_UTF8_ENCODING="utf8";function Th(...r){const t=r.map(n=>n.byteLength).reduce((n,s)=>n+s),e=new Uint8Array(t);let i=0;return r.map(n=>new Uint8Array(n)).forEach(n=>{for(const s of n)e[i++]=s}),e.buffer}function Kl(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),i=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)if(e[n]!==i[n])return!1;return!0}function xf(r,t,e){var i;return r instanceof Object&&(i=r[t])!==null&&i!==void 0?i:e}function Of(r,t=0,e=r.byteLength-t,i=!1){let n="";for(const s of new Uint8Array(r,t,e)){const a=s.toString(16).toUpperCase();a.length===1&&(n+="0"),n+=a,i&&(n+=" ")}return n.trim()}function Ke(r,t){let e=0;if(r.length===1)return r[0];for(let i=r.length-1;i>=0;i--)e+=r[r.length-1-i]*Math.pow(2,t*i);return e}function de(r,t,e=-1){const i=e;let n=r,s=0,a=Math.pow(2,t);for(let c=1;c<8;c++){if(r<a){let u;if(i<0)u=new ArrayBuffer(c),s=c;else{if(i<c)return new ArrayBuffer(0);u=new ArrayBuffer(i),s=i}const p=new Uint8Array(u);for(let v=c-1;v>=0;v--){const m=Math.pow(2,v*t);p[s-v-1]=Math.floor(n/m),n-=p[s-v-1]*m}return u}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function Cf(...r){let t=0,e=0;for(const s of r)t+=s.byteLength;const i=new ArrayBuffer(t),n=new Uint8Array(i);for(const s of r)n.set(new Uint8Array(s),e),e+=s.byteLength;return i}function As(...r){let t=0,e=0;for(const s of r)t+=s.length;const i=new ArrayBuffer(t),n=new Uint8Array(i);for(const s of r)n.set(s,e),e+=s.length;return n}function Gl(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const a=r[0]===255&&r[1]&128,c=r[0]===0&&(r[1]&128)===0;(a||c)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(t);for(let a=0;a<this.valueHex.byteLength;a++)e[a]=0;e[0]=r[0]&128;const i=Ke(e,8),n=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(n);for(let a=0;a<this.valueHex.byteLength;a++)s[a]=r[a];return s[0]&=127,Ke(s,8)-i}function jh(r){const t=r<0?r*-1:r;let e=128;for(let i=1;i<8;i++){if(t<=e){if(r<0){const a=e-t,c=de(a,8,i),u=new Uint8Array(c);return u[0]|=128,c}let n=de(t,8,i),s=new Uint8Array(n);if(s[0]&128){const a=n.slice(0),c=new Uint8Array(a);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let u=0;u<a.byteLength;u++)s[u+1]=c[u];s[0]=0}return n}e*=Math.pow(2,8)}return new ArrayBuffer(0)}function Uh(r,t){if(r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),i=new Uint8Array(t);for(let n=0;n<e.length;n++)if(e[n]!==i[n])return!1;return!0}function vt(r,t){const e=r.toString(10);if(t<e.length)return"";const i=t-e.length,n=new Array(i);for(let s=0;s<i;s++)n[s]="0";return n.join("").concat(e)}const Jl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Zl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function Ef(r,t=!1,e=!1,i=!1){let n=0,s=0,a=0,c="";const u=t?Zl:Jl;if(i){let p=0;for(let v=0;v<r.length;v++)if(r.charCodeAt(v)!==0){p=v;break}r=r.slice(p)}for(;n<r.length;){const p=r.charCodeAt(n++);n>=r.length&&(s=1);const v=r.charCodeAt(n++);n>=r.length&&(a=1);const m=r.charCodeAt(n++),H=p>>2,J=(p&3)<<4|v>>4;let et=(v&15)<<2|m>>6,Ht=m&63;s===1?et=Ht=64:a===1&&(Ht=64),e?et===64?c+="".concat(u.charAt(H)).concat(u.charAt(J)):Ht===64?c+="".concat(u.charAt(H)).concat(u.charAt(J)).concat(u.charAt(et)):c+="".concat(u.charAt(H)).concat(u.charAt(J)).concat(u.charAt(et)).concat(u.charAt(Ht)):c+="".concat(u.charAt(H)).concat(u.charAt(J)).concat(u.charAt(et)).concat(u.charAt(Ht))}return c}function Nf(r,t=!1,e=!1){const i=t?Zl:Jl;function n(u){for(let p=0;p<64;p++)if(i.charAt(p)===u)return p;return 64}function s(u){return u===64?0:u}let a=0,c="";for(;a<r.length;){const u=n(r.charAt(a++)),p=a>=r.length?0:n(r.charAt(a++)),v=a>=r.length?0:n(r.charAt(a++)),m=a>=r.length?0:n(r.charAt(a++)),H=s(u)<<2|s(p)>>4,J=(s(p)&15)<<4|s(v)>>2,et=(s(v)&3)<<6|s(m);c+=String.fromCharCode(H),v!==64&&(c+=String.fromCharCode(J)),m!==64&&(c+=String.fromCharCode(et))}if(e){const u=c.length;let p=-1;for(let v=u-1;v>=0;v--)if(c.charCodeAt(v)!==0){p=v;break}p!==-1?c=c.slice(0,p+1):c=""}return c}function If(r){let t="";const e=new Uint8Array(r);for(const i of e)t+=String.fromCharCode(i);return t}function Tf(r){const t=r.length,e=new ArrayBuffer(t),i=new Uint8Array(e);for(let n=0;n<t;n++)i[n]=r.charCodeAt(n);return e}const Ph=Math.log(2);function jf(r){const t=Math.log(r)/Ph,e=Math.floor(t),i=Math.round(t);return e===i?e:i}function Uf(r,t){for(const e of t)delete r[e]}function Ri(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Go(r){let t=0,e=0;for(let n=0;n<r.length;n++){const s=r[n];t+=s.byteLength}const i=new Uint8Array(t);for(let n=0;n<r.length;n++){const s=r[n];i.set(new Uint8Array(s),e),e+=s.byteLength}return i.buffer}function Jt(r,t,e,i){return t instanceof Uint8Array?t.byteLength?e<0?(r.error="Wrong parameter: inputOffset less than zero",!1):i<0?(r.error="Wrong parameter: inputLength less than zero",!1):t.byteLength-e-i<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Vn{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return Go(this.items)}}const or=[new Uint8Array([1])],Ua="0123456789",Gn="name",Pa="valueHexView",Rh="isHexOnly",Vh="idBlock",Lh="tagClass",Mh="tagNumber",Dh="isConstructed",Hh="fromBER",$h="toBER",Fh="local",ft="",It=new ArrayBuffer(0),Ln=new Uint8Array(0),zr="EndOfContent",Yl="OCTET STRING",Xl="BIT STRING";function Dt(r){var t;return t=class extends r{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var i;super(...e);const n=e[0]||{};this.isHexOnly=(i=n.isHexOnly)!==null&&i!==void 0?i:!1,this.valueHexView=n.valueHex?A.toUint8Array(n.valueHex):Ln}fromBER(e,i,n){const s=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!Jt(this,s,i,n))return-1;const a=i+n;return this.valueHexView=s.subarray(i,a),this.valueHexView.length?(this.blockLength=n,a):(this.warnings.push("Zero buffer length"),i)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",It)}toJSON(){return K(P({},super.toJSON()),{isHexOnly:this.isHexOnly,valueHex:E.ToHex(this.valueHexView)})}},t.NAME="hexBlock",t}class ke{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}constructor({blockLength:t=0,error:e=ft,warnings:i=[],valueBeforeDecode:n=Ln}={}){this.blockLength=t,this.error=e,this.warnings=i,this.valueBeforeDecodeView=A.toUint8Array(n)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:E.ToHex(this.valueBeforeDecodeView)}}}ke.NAME="baseBlock";class ut extends ke{fromBER(t,e,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}ut.NAME="valueBlock";class Ql extends Dt(ke){constructor({idBlock:t={}}={}){var e,i,n,s;super(),t?(this.isHexOnly=(e=t.isHexOnly)!==null&&e!==void 0?e:!1,this.valueHexView=t.valueHex?A.toUint8Array(t.valueHex):Ln,this.tagClass=(i=t.tagClass)!==null&&i!==void 0?i:-1,this.tagNumber=(n=t.tagNumber)!==null&&n!==void 0?n:-1,this.isConstructed=(s=t.isConstructed)!==null&&s!==void 0?s:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",It}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!t){let s=this.tagNumber;s&=31,e|=s,n[0]=e}return n.buffer}if(!this.isHexOnly){const n=de(this.tagNumber,7),s=new Uint8Array(n),a=n.byteLength,c=new Uint8Array(a+1);if(c[0]=e|31,!t){for(let u=0;u<a-1;u++)c[u+1]=s[u]|128;c[a]=s[a-1]}return c.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=e|31,!t){const n=this.valueHexView;for(let s=0;s<n.length-1;s++)i[s+1]=n[s]|128;i[this.valueHexView.byteLength]=n[n.length-1]}return i.buffer}fromBER(t,e,i){const n=A.toUint8Array(t);if(!Jt(this,n,e,i))return-1;const s=n.subarray(e,e+i);if(s.length===0)return this.error="Zero buffer length",-1;switch(s[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(s[0]&32)===32,this.isHexOnly=!1;const a=s[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let c=1,u=this.valueHexView=new Uint8Array(255),p=255;for(;s[c]&128;){if(u[c-1]=s[c]&127,c++,c>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(c===p){p+=255;const m=new Uint8Array(p);for(let H=0;H<u.length;H++)m[H]=u[H];u=this.valueHexView=new Uint8Array(p)}}this.blockLength=c+1,u[c-1]=s[c]&127;const v=new Uint8Array(c);for(let m=0;m<c;m++)v[m]=u[m];u=this.valueHexView=new Uint8Array(c),u.set(v),this.blockLength<=9?this.tagNumber=Ke(u,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return K(P({},super.toJSON()),{tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed})}}Ql.NAME="identificationBlock";class tu extends ke{constructor({lenBlock:t={}}={}){var e,i,n;super(),this.isIndefiniteForm=(e=t.isIndefiniteForm)!==null&&e!==void 0?e:!1,this.longFormUsed=(i=t.longFormUsed)!==null&&i!==void 0?i:!1,this.length=(n=t.length)!==null&&n!==void 0?n:0}fromBER(t,e,i){const n=A.toUint8Array(t);if(!Jt(this,n,e,i))return-1;const s=n.subarray(e,e+i);if(s.length===0)return this.error="Zero buffer length",-1;if(s[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=s[0]===128,this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(s[0]&128),this.longFormUsed===!1)return this.length=s[0],this.blockLength=1,e+this.blockLength;const a=s[0]&127;if(a>8)return this.error="Too big integer",-1;if(a+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const c=e+1,u=n.subarray(c,c+a);return u[a-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=Ke(u,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=a+1,e+this.blockLength}toBER(t=!1){let e,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),t===!1&&(i=new Uint8Array(e),i[0]=128),e;if(this.longFormUsed){const n=de(this.length,8);if(n.byteLength>127)return this.error="Too big length",It;if(e=new ArrayBuffer(n.byteLength+1),t)return e;const s=new Uint8Array(n);i=new Uint8Array(e),i[0]=n.byteLength|128;for(let a=0;a<n.byteLength;a++)i[a+1]=s[a];return e}return e=new ArrayBuffer(1),t===!1&&(i=new Uint8Array(e),i[0]=this.length),e}toJSON(){return K(P({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length})}}tu.NAME="lengthBlock";const x={};class nt extends ke{constructor(a={},s){var c=a,{name:t=ft,optional:e=!1,primitiveSchema:i}=c,n=q(c,["name","optional","primitiveSchema"]);super(n),this.name=t,this.optional=e,i&&(this.primitiveSchema=i),this.idBlock=new Ql(n),this.lenBlock=new tu(n),this.valueBlock=s?new s(n):new ut(n)}fromBER(t,e,i){const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(t,e){const i=e||new Vn;e||eu(this);const n=this.idBlock.toBER(t);if(i.write(n),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,i),i.write(new ArrayBuffer(2));else{const s=this.valueBlock.toBER(t);this.lenBlock.length=s.byteLength;const a=this.lenBlock.toBER(t);i.write(a),i.write(s)}return e?It:i.final()}toJSON(){const t=K(P({},super.toJSON()),{idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional});return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return t==="ascii"?this.onAsciiEncoding():E.ToHex(this.toBER())}onAsciiEncoding(){const t=this.constructor.NAME,e=E.ToHex(this.valueBlock.valueBeforeDecodeView);return"".concat(t," : ").concat(e)}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;const e=this.toBER(),i=t.toBER();return Uh(e,i)}}nt.NAME="BaseBlock";function eu(r){var t;if(r instanceof x.Constructed)for(const e of r.valueBlock.value)eu(e)&&(r.lenBlock.isIndefiniteForm=!0);return!!(!((t=r.lenBlock)===null||t===void 0)&&t.isIndefiniteForm)}class Jo extends nt{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor(n={},i){var s=n,{value:t=ft}=s,e=q(s,["value"]);super(e,i),t&&this.fromString(t)}fromBER(t,e,i){const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : '").concat(this.valueBlock.value,"'")}}Jo.NAME="BaseStringBlock";class ru extends Dt(ut){constructor(i={}){var n=i,{isHexOnly:t=!0}=n,e=q(n,["isHexOnly"]);super(e),this.isHexOnly=t}}ru.NAME="PrimitiveValueBlock";var Ra;class Kr extends nt{constructor(t={}){super(t,ru),this.idBlock.isConstructed=!1}}Ra=Kr,x.Primitive=Ra,Kr.NAME="PRIMITIVE";function Wh(r,t){if(r instanceof t)return r;const e=new t;return e.idBlock=r.idBlock,e.lenBlock=r.lenBlock,e.warnings=r.warnings,e.valueBeforeDecodeView=r.valueBeforeDecodeView,e}function rr(r,t=0,e=r.length){const i=t;let n=new nt({},ut);const s=new ke;if(!Jt(s,r,t,e))return n.error=s.error,{offset:-1,result:n};if(!r.subarray(t,t+e).length)return n.error="Zero buffer length",{offset:-1,result:n};let a=n.idBlock.fromBER(r,t,e);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),a===-1)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=a,e-=n.idBlock.blockLength,a=n.lenBlock.fromBER(r,t,e),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),a===-1)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=a,e-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let c=nt;switch(n.idBlock.tagClass){case 1:if(n.idBlock.tagNumber>=37&&n.idBlock.isHexOnly===!1)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};c=x.EndOfContent;break;case 1:c=x.Boolean;break;case 2:c=x.Integer;break;case 3:c=x.BitString;break;case 4:c=x.OctetString;break;case 5:c=x.Null;break;case 6:c=x.ObjectIdentifier;break;case 10:c=x.Enumerated;break;case 12:c=x.Utf8String;break;case 13:c=x.RelativeObjectIdentifier;break;case 14:c=x.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:c=x.Sequence;break;case 17:c=x.Set;break;case 18:c=x.NumericString;break;case 19:c=x.PrintableString;break;case 20:c=x.TeletexString;break;case 21:c=x.VideotexString;break;case 22:c=x.IA5String;break;case 23:c=x.UTCTime;break;case 24:c=x.GeneralizedTime;break;case 25:c=x.GraphicString;break;case 26:c=x.VisibleString;break;case 27:c=x.GeneralString;break;case 28:c=x.UniversalString;break;case 29:c=x.CharacterString;break;case 30:c=x.BmpString;break;case 31:c=x.DATE;break;case 32:c=x.TimeOfDay;break;case 33:c=x.DateTime;break;case 34:c=x.Duration;break;default:{const u=n.idBlock.isConstructed?new x.Constructed:new x.Primitive;u.idBlock=n.idBlock,u.lenBlock=n.lenBlock,u.warnings=n.warnings,n=u}}break;case 2:case 3:case 4:default:c=n.idBlock.isConstructed?x.Constructed:x.Primitive}return n=Wh(n,c),a=n.fromBER(r,t,n.lenBlock.isIndefiniteForm?e:n.lenBlock.length),n.valueBeforeDecodeView=r.subarray(i,i+n.blockLength),{offset:a,result:n}}function We(r){if(!r.byteLength){const t=new nt({},ut);return t.error="Input buffer has zero length",{offset:-1,result:t}}return rr(A.toUint8Array(r).slice(),0,r.byteLength)}function _h(r,t){return r?1:t}class re extends ut{constructor(n={}){var s=n,{value:t=[],isIndefiniteForm:e=!1}=s,i=q(s,["value","isIndefiniteForm"]);super(i),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,i){const n=A.toUint8Array(t);if(!Jt(this,n,e,i))return-1;if(this.valueBeforeDecodeView=n.subarray(e,e+i),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),e;let s=e;for(;_h(this.isIndefiniteForm,i)>0;){const a=rr(n,s,i);if(a.offset===-1)return this.error=a.result.error,this.warnings.concat(a.result.warnings),-1;if(s=a.offset,this.blockLength+=a.result.blockLength,i-=a.result.blockLength,this.value.push(a.result),this.isIndefiniteForm&&a.result.constructor.NAME===zr)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===zr?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(t,e){const i=e||new Vn;for(let n=0;n<this.value.length;n++)this.value[n].toBER(t,i);return e?It:i.final()}toJSON(){const t=K(P({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,value:[]});for(const e of this.value)t.value.push(e.toJSON());return t}}re.NAME="ConstructedValueBlock";var Va;class ct extends nt{constructor(t={}){super(t,re),this.idBlock.isConstructed=!0}fromBER(t,e,i){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const t=[];for(const i of this.valueBlock.value)t.push(i.toString("ascii").split("\n").map(n=>"  ".concat(n)).join("\n"));const e=this.idBlock.tagClass===3?"[".concat(this.idBlock.tagNumber,"]"):this.constructor.NAME;return t.length?"".concat(e," :\n").concat(t.join("\n")):"".concat(e," :")}}Va=ct,x.Constructed=Va,ct.NAME="CONSTRUCTED";class iu extends ut{fromBER(t,e,i){return e}toBER(t){return It}}iu.override="EndOfContentValueBlock";var La;class Ss extends nt{constructor(t={}){super(t,iu),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}La=Ss,x.EndOfContent=La,Ss.NAME=zr;var Ma;class ge extends nt{constructor(t={}){super(t,ut),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,i){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=i,e+i>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+i}toBER(t,e){const i=new ArrayBuffer(2);if(!t){const n=new Uint8Array(i);n[0]=5,n[1]=0}return e&&e.write(i),i}onAsciiEncoding(){return"".concat(this.constructor.NAME)}}Ma=ge,x.Null=Ma,ge.NAME="NULL";class nu extends Dt(ut){get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}constructor(i={}){var n=i,{value:t}=n,e=q(n,["value"]);super(e),e.valueHex?this.valueHexView=A.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}fromBER(t,e,i){const n=A.toUint8Array(t);return Jt(this,n,e,i)?(this.valueHexView=n.subarray(e,e+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Gl.call(this),this.blockLength=i,e+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return K(P({},super.toJSON()),{value:this.value})}}nu.NAME="BooleanValueBlock";var Da;class Vi extends nt{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor(t={}){super(t,nu),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.getValue)}}Da=Vi,x.Boolean=Da,Vi.NAME="BOOLEAN";class su extends Dt(re){constructor(i={}){var n=i,{isConstructed:t=!1}=n,e=q(n,["isConstructed"]);super(e),this.isConstructed=t}fromBER(t,e,i){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=re.prototype.fromBER.call(this,t,e,i),n===-1)return n;for(let s=0;s<this.value.length;s++){const a=this.value[s].constructor.NAME;if(a===zr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(a!==Yl)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(t,e,i),this.blockLength=i;return n}toBER(t,e){return this.isConstructed?re.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return K(P({},super.toJSON()),{isConstructed:this.isConstructed})}}su.NAME="OctetStringValueBlock";var Bs;let pe=class extends nt{constructor(i={}){var n=i,{idBlock:r={},lenBlock:t={}}=n,e=q(n,["idBlock","lenBlock"]);var s,a;(s=e.isConstructed)!==null&&s!==void 0||(e.isConstructed=!!(!((a=e.value)===null||a===void 0)&&a.length)),super(P({idBlock:P({isConstructed:e.isConstructed},r),lenBlock:K(P({},t),{isIndefiniteForm:!!e.isIndefiniteForm})},e),su),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,t,e){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,e===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const i=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(t,t+e);try{if(i.byteLength){const n=rr(i,0,i.byteLength);n.offset!==-1&&n.offset===e&&(this.valueBlock.value=[n.result])}}catch(n){}}return super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ct.prototype.onAsciiEncoding.call(this);const r=this.constructor.NAME,t=E.ToHex(this.valueBlock.valueHexView);return"".concat(r," : ").concat(t)}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const t of this.valueBlock.value)t instanceof Bs&&r.push(t.valueBlock.valueHexView);return A.concat(r)}};Bs=pe,x.OctetString=Bs,pe.NAME=Yl;class ou extends Dt(re){constructor(n={}){var s=n,{unusedBits:t=0,isConstructed:e=!1}=s,i=q(s,["unusedBits","isConstructed"]);super(i),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,i){if(!i)return e;let n=-1;if(this.isConstructed){if(n=re.prototype.fromBER.call(this,t,e,i),n===-1)return n;for(const c of this.value){const u=c.constructor.NAME;if(u===zr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(u!==Xl)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const p=c.valueBlock;if(this.unusedBits>0&&p.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=p.unusedBits}return n}const s=A.toUint8Array(t);if(!Jt(this,s,e,i))return-1;const a=s.subarray(e,e+i);if(this.unusedBits=a[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const c=a.subarray(1);try{if(c.byteLength){const u=rr(c,0,c.byteLength);u.offset!==-1&&u.offset===i-1&&(this.value=[u.result])}}catch(u){}}return this.valueHexView=a.subarray(1),this.blockLength=a.length,e+i}toBER(t,e){if(this.isConstructed)return re.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return It;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return K(P({},super.toJSON()),{unusedBits:this.unusedBits,isConstructed:this.isConstructed})}}ou.NAME="BitStringValueBlock";var Ha;let fe=class extends nt{constructor(i={}){var n=i,{idBlock:r={},lenBlock:t={}}=n,e=q(n,["idBlock","lenBlock"]);var s,a;(s=e.isConstructed)!==null&&s!==void 0||(e.isConstructed=!!(!((a=e.value)===null||a===void 0)&&a.length)),super(P({idBlock:P({isConstructed:e.isConstructed},r),lenBlock:K(P({},t),{isIndefiniteForm:!!e.isIndefiniteForm})},e),ou),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,t,e){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ct.prototype.onAsciiEncoding.call(this);{const r=[],t=this.valueBlock.valueHexView;for(const s of t)r.push(s.toString(2).padStart(8,"0"));const e=r.join(""),i=this.constructor.NAME,n=e.substring(0,e.length-this.valueBlock.unusedBits);return"".concat(i," : ").concat(n)}}};Ha=fe,x.BitString=Ha,fe.NAME=Xl;var $a;function qh(r,t){const e=new Uint8Array([0]),i=new Uint8Array(r),n=new Uint8Array(t);let s=i.slice(0);const a=s.length-1,c=n.slice(0),u=c.length-1;let p=0;const v=u<a?a:u;let m=0;for(let H=v;H>=0;H--,m++){switch(!0){case m<c.length:p=s[a-m]+c[u-m]+e[0];break;default:p=s[a-m]+e[0]}switch(e[0]=p/10,!0){case m>=s.length:s=As(new Uint8Array([p%10]),s);break;default:s[a-m]=p%10}}return e[0]>0&&(s=As(e,s)),s}function Fa(r){if(r>=or.length)for(let t=or.length;t<=r;t++){const e=new Uint8Array([0]);let i=or[t-1].slice(0);for(let n=i.length-1;n>=0;n--){const s=new Uint8Array([(i[n]<<1)+e[0]]);e[0]=s[0]/10,i[n]=s[0]%10}e[0]>0&&(i=As(e,i)),or.push(i)}return or[r]}function zh(r,t){let e=0;const i=new Uint8Array(r),n=new Uint8Array(t),s=i.slice(0),a=s.length-1,c=n.slice(0),u=c.length-1;let p,v=0;for(let m=u;m>=0;m--,v++)switch(p=s[a-v]-c[u-v]-e,!0){case p<0:e=1,s[a-v]=p+10;break;default:e=0,s[a-v]=p}if(e>0)for(let m=a-u+1;m>=0;m--,v++)if(p=s[a-v]-e,p<0)e=1,s[a-v]=p+10;else{e=0,s[a-v]=p;break}return s.slice()}class ks extends Dt(ut){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Gl.call(this)))}constructor(i={}){var n=i,{value:t}=n,e=q(n,["value"]);super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),t!==void 0&&(this.valueDec=t)}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(jh(t))}get valueDec(){return this._valueDec}fromDER(t,e,i,n=0){const s=this.fromBER(t,e,i);if(s===-1)return s;const a=this.valueHexView;return a[0]===0&&(a[1]&128)!==0?this.valueHexView=a.subarray(1):n!==0&&a.length<n&&(n-a.length>1&&(n=a.length+1),this.valueHexView=a.subarray(n-a.length)),s}toDER(t=!1){const e=this.valueHexView;switch(!0){case(e[0]&128)!==0:{const i=new Uint8Array(this.valueHexView.length+1);i[0]=0,i.set(e,1),this.valueHexView=i}break;case(e[0]===0&&(e[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(t)}fromBER(t,e,i){const n=super.fromBER(t,e,i);return n===-1||this.setValueHex(),n}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return K(P({},super.toJSON()),{valueDec:this.valueDec})}toString(){const t=this.valueHexView.length*8-1;let e=new Uint8Array(this.valueHexView.length*8/3),i=0,n;const s=this.valueHexView;let a="",c=!1;for(let u=s.byteLength-1;u>=0;u--){n=s[u];for(let p=0;p<8;p++){if((n&1)===1)switch(i){case t:e=zh(Fa(i),e),a="-";break;default:e=qh(e,Fa(i))}i++,n>>=1}}for(let u=0;u<e.length;u++)e[u]&&(c=!0),c&&(a+=Ua.charAt(e[u]));return c===!1&&(a+=Ua.charAt(0)),a}}$a=ks,ks.NAME="IntegerValueBlock",Object.defineProperty($a.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Rr;class Ge extends nt{constructor(t={}){super(t,ks),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return Ri(),BigInt(this.valueBlock.toString())}static fromBigInt(t){Ri();const e=BigInt(t),i=new Vn,n=e.toString(16).replace(/^-/,""),s=new Uint8Array(E.FromHex(n));if(e<0){const a=new Uint8Array(s.length+(s[0]&128?1:0));a[0]|=128;const c=BigInt("0x".concat(E.ToHex(a)))+e,u=A.toUint8Array(E.FromHex(c.toString(16)));u[0]|=128,i.write(u)}else s[0]&128&&i.write(new Uint8Array([0])),i.write(s);return new Rr({valueHex:i.final()})}convertToDER(){const t=new Rr({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new Rr({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString())}}Rr=Ge,x.Integer=Rr,Ge.NAME="INTEGER";var Wa;class Li extends Ge{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Wa=Li,x.Enumerated=Wa,Li.NAME="ENUMERATED";class xs extends Dt(ut){constructor(n={}){var s=n,{valueDec:t=-1,isFirstSid:e=!1}=s,i=q(s,["valueDec","isFirstSid"]);super(i),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,i){if(!i)return e;const n=A.toUint8Array(t);if(!Jt(this,n,e,i))return-1;const s=n.subarray(e,e+i);this.valueHexView=new Uint8Array(i);for(let c=0;c<i&&(this.valueHexView[c]=s[c]&127,this.blockLength++,(s[c]&128)!==0);c++);const a=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)a[c]=this.valueHexView[c];return this.valueHexView=a,(s[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Ke(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){Ri();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const i=new Uint8Array(e.length/7);for(let n=0;n<i.length;n++)i[n]=parseInt(e.slice(n*7,n*7+7),2)+(n+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)s[a]=n[a]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const e=de(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",It;const i=new Uint8Array(e.byteLength);if(!t){const n=new Uint8Array(e),s=e.byteLength-1;for(let a=0;a<s;a++)i[a]=n[a]|128;i[s]=n[s]}return i}toString(){let t="";if(this.isHexOnly)t=E.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return K(P({},super.toJSON()),{valueDec:this.valueDec,isFirstSid:this.isFirstSid})}}xs.NAME="sidBlock";class au extends ut{constructor(i={}){var n=i,{value:t=ft}=n,e=q(n,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,i){let n=e;for(;i>0;){const s=new xs;if(n=s.fromBER(t,n,i),n===-1)return this.blockLength=0,this.error=s.error,n;this.value.length===0&&(s.isFirstSid=!0),this.blockLength+=s.blockLength,i-=s.blockLength,this.value.push(s)}return n}toBER(t){const e=[];for(let i=0;i<this.value.length;i++){const n=this.value[i].toBER(t);if(n.byteLength===0)return this.error=this.value[i].error,It;e.push(n)}return Go(e)}fromString(t){this.value=[];let e=0,i=0,n="",s=!1;do if(i=t.indexOf(".",e),i===-1?n=t.substring(e):n=t.substring(e,i),e=i+1,s){const a=this.value[0];let c=0;switch(a.valueDec){case 0:break;case 1:c=40;break;case 2:c=80;break;default:this.value=[];return}const u=parseInt(n,10);if(isNaN(u))return;a.valueDec=u+c,s=!1}else{const a=new xs;if(n>Number.MAX_SAFE_INTEGER){Ri();const c=BigInt(n);a.valueBigInt=c}else if(a.valueDec=parseInt(n,10),isNaN(a.valueDec))return;this.value.length||(a.isFirstSid=!0,s=!0),this.value.push(a)}while(i!==-1)}toString(){let t="",e=!1;for(let i=0;i<this.value.length;i++){e=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(t="".concat(t,".")),e?(n="{".concat(n,"}"),this.value[i].isFirstSid?t="2.{".concat(n," - 80}"):t+=n):t+=n}return t}toJSON(){const t=K(P({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}au.NAME="ObjectIdentifierValueBlock";var _a;class Mi extends nt{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,au),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return K(P({},super.toJSON()),{value:this.getValue()})}}_a=Mi,x.ObjectIdentifier=_a,Mi.NAME="OBJECT IDENTIFIER";class Os extends Dt(ke){constructor(i={}){var n=i,{valueDec:t=0}=n,e=q(n,["valueDec"]);super(e),this.valueDec=t}fromBER(t,e,i){if(i===0)return e;const n=A.toUint8Array(t);if(!Jt(this,n,e,i))return-1;const s=n.subarray(e,e+i);this.valueHexView=new Uint8Array(i);for(let c=0;c<i&&(this.valueHexView[c]=s[c]&127,this.blockLength++,(s[c]&128)!==0);c++);const a=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)a[c]=this.valueHexView[c];return this.valueHexView=a,(s[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Ke(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,s=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)s[a]=n[a]|128;return s[this.blockLength-1]=n[this.blockLength-1],s.buffer}const e=de(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",It;const i=new Uint8Array(e.byteLength);if(!t){const n=new Uint8Array(e),s=e.byteLength-1;for(let a=0;a<s;a++)i[a]=n[a]|128;i[s]=n[s]}return i.buffer}toString(){let t="";return this.isHexOnly?t=E.ToHex(this.valueHexView):t=this.valueDec.toString(),t}toJSON(){return K(P({},super.toJSON()),{valueDec:this.valueDec})}}Os.NAME="relativeSidBlock";class cu extends ut{constructor(i={}){var n=i,{value:t=ft}=n,e=q(n,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,i){let n=e;for(;i>0;){const s=new Os;if(n=s.fromBER(t,n,i),n===-1)return this.blockLength=0,this.error=s.error,n;this.blockLength+=s.blockLength,i-=s.blockLength,this.value.push(s)}return n}toBER(t,e){const i=[];for(let n=0;n<this.value.length;n++){const s=this.value[n].toBER(t);if(s.byteLength===0)return this.error=this.value[n].error,It;i.push(s)}return Go(i)}fromString(t){this.value=[];let e=0,i=0,n="";do{i=t.indexOf(".",e),i===-1?n=t.substring(e):n=t.substring(e,i),e=i+1;const s=new Os;if(s.valueDec=parseInt(n,10),isNaN(s.valueDec))return!0;this.value.push(s)}while(i!==-1);return!0}toString(){let t="",e=!1;for(let i=0;i<this.value.length;i++){e=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(t="".concat(t,".")),e&&(n="{".concat(n,"}")),t+=n}return t}toJSON(){const t=K(P({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}cu.NAME="RelativeObjectIdentifierValueBlock";var qa;class Cs extends nt{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,cu),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return K(P({},super.toJSON()),{value:this.getValue()})}}qa=Cs,x.RelativeObjectIdentifier=qa,Cs.NAME="RelativeObjectIdentifier";var za;class Nt extends ct{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}za=Nt,x.Sequence=za,Nt.NAME="SEQUENCE";var Ka;let Vt=class extends ct{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};Ka=Vt,x.Set=Ka,Vt.NAME="SET";class lu extends Dt(ut){constructor(e={}){var t=q(e,[]);super(t),this.isHexOnly=!0,this.value=ft}toJSON(){return K(P({},super.toJSON()),{value:this.value})}}lu.NAME="StringValueBlock";class uu extends lu{}uu.NAME="SimpleStringValueBlock";class wt extends Jo{constructor(e={}){var t=q(e,[]);super(t,uu)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,A.toUint8Array(t))}fromString(t){const e=t.length,i=this.valueBlock.valueHexView=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.charCodeAt(n);this.valueBlock.value=t}}wt.NAME="SIMPLE STRING";class hu extends wt{fromBuffer(t){this.valueBlock.valueHexView=A.toUint8Array(t);try{this.valueBlock.value=E.ToUtf8String(t)}catch(e){this.warnings.push('Error during "decodeURIComponent": '.concat(e,", using raw string")),this.valueBlock.value=E.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(E.FromUtf8String(t)),this.valueBlock.value=t}}hu.NAME="Utf8StringValueBlock";var Ga;class qt extends hu{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Ga=qt,x.Utf8String=Ga,qt.NAME="UTF8String";class pu extends wt{fromBuffer(t){this.valueBlock.value=E.ToUtf16String(t),this.valueBlock.valueHexView=A.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(E.FromUtf16String(t))}}pu.NAME="BmpStringValueBlock";var Ja;class Di extends pu{constructor(e={}){var t=q(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Ja=Di,x.BmpString=Ja,Di.NAME="BMPString";class fu extends wt{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),i=new Uint8Array(e);for(let n=0;n<i.length;n+=4)i[n]=i[n+3],i[n+1]=i[n+2],i[n+2]=0,i[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,i=this.valueBlock.valueHexView=new Uint8Array(e*4);for(let n=0;n<e;n++){const s=de(t.charCodeAt(n),8),a=new Uint8Array(s);if(a.length>4)continue;const c=4-a.length;for(let u=a.length-1;u>=0;u--)i[n*4+u+c]=a[u]}this.valueBlock.value=t}}fu.NAME="UniversalStringValueBlock";var Za;class Hi extends fu{constructor(e={}){var t=q(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Za=Hi,x.UniversalString=Za,Hi.NAME="UniversalString";var Ya;class $i extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Ya=$i,x.NumericString=Ya,$i.NAME="NumericString";var Xa;class Fi extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Xa=Fi,x.PrintableString=Xa,Fi.NAME="PrintableString";var Qa;class Wi extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Qa=Wi,x.TeletexString=Qa,Wi.NAME="TeletexString";var tc;class _i extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}tc=_i,x.VideotexString=tc,_i.NAME="VideotexString";var ec;class qi extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}ec=qi,x.IA5String=ec,qi.NAME="IA5String";var rc;class zi extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}rc=zi,x.GraphicString=rc,zi.NAME="GraphicString";var ic;class Gr extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}ic=Gr,x.VisibleString=ic,Gr.NAME="VisibleString";var nc;class Ki extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}nc=Ki,x.GeneralString=nc,Ki.NAME="GeneralString";var sc;class Gi extends wt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}sc=Gi,x.CharacterString=sc,Gi.NAME="CharacterString";var oc;class Jr extends Gr{constructor(n={}){var s=n,{value:t,valueDate:e}=s,i=q(s,["value","valueDate"]);if(super(i),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let a=0;a<t.length;a++)this.valueBlock.valueHexView[a]=t.charCodeAt(a)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,A.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),i=new Uint8Array(e);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(t);if(e===null){this.error="Wrong input string for conversion";return}const i=parseInt(e[1],10);i>=50?this.year=1900+i:this.year=2e3+i,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(t="iso"){if(t==="iso"){const e=new Array(7);return e[0]=vt(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=vt(this.month,2),e[2]=vt(this.day,2),e[3]=vt(this.hour,2),e[4]=vt(this.minute,2),e[5]=vt(this.second,2),e[6]="Z",e.join("")}return super.toString(t)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.toDate().toISOString())}toJSON(){return K(P({},super.toJSON()),{year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second})}}oc=Jr,x.UTCTime=oc,Jr.NAME="UTCTime";var ac;class Ji extends Jr{constructor(t={}){var e;super(t),(e=this.millisecond)!==null&&e!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){const t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(t)}fromString(t){let e=!1,i="",n="",s=0,a,c=0,u=0;if(t[t.length-1]==="Z")i=t.substring(0,t.length-1),e=!0;else{const m=new Number(t[t.length-1]);if(isNaN(m.valueOf()))throw new Error("Wrong input string for conversion");i=t}if(e){if(i.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(i.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let m=1,H=i.indexOf("+"),J="";if(H===-1&&(H=i.indexOf("-"),m=-1),H!==-1){if(J=i.substring(H+1),i=i.substring(0,H),J.length!==2&&J.length!==4)throw new Error("Wrong input string for conversion");let et=parseInt(J.substring(0,2),10);if(isNaN(et.valueOf()))throw new Error("Wrong input string for conversion");if(c=m*et,J.length===4){if(et=parseInt(J.substring(2,4),10),isNaN(et.valueOf()))throw new Error("Wrong input string for conversion");u=m*et}}}let p=i.indexOf(".");if(p===-1&&(p=i.indexOf(",")),p!==-1){const m=new Number("0".concat(i.substring(p)));if(isNaN(m.valueOf()))throw new Error("Wrong input string for conversion");s=m.valueOf(),n=i.substring(0,p)}else n=i;switch(!0){case n.length===8:if(a=/(\d{4})(\d{2})(\d{2})/ig,p!==-1)throw new Error("Wrong input string for conversion");break;case n.length===10:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let m=60*s;this.minute=Math.floor(m),m=60*(m-this.minute),this.second=Math.floor(m),m=1e3*(m-this.second),this.millisecond=Math.floor(m)}break;case n.length===12:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let m=60*s;this.second=Math.floor(m),m=1e3*(m-this.second),this.millisecond=Math.floor(m)}break;case n.length===14:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){const m=1e3*s;this.millisecond=Math.floor(m)}break;default:throw new Error("Wrong input string for conversion")}const v=a.exec(n);if(v===null)throw new Error("Wrong input string for conversion");for(let m=1;m<v.length;m++)switch(m){case 1:this.year=parseInt(v[m],10);break;case 2:this.month=parseInt(v[m],10);break;case 3:this.day=parseInt(v[m],10);break;case 4:this.hour=parseInt(v[m],10)+c;break;case 5:this.minute=parseInt(v[m],10)+u;break;case 6:this.second=parseInt(v[m],10);break;default:throw new Error("Wrong input string for conversion")}if(e===!1){const m=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=m.getUTCFullYear(),this.month=m.getUTCMonth(),this.day=m.getUTCDay(),this.hour=m.getUTCHours(),this.minute=m.getUTCMinutes(),this.second=m.getUTCSeconds(),this.millisecond=m.getUTCMilliseconds()}}toString(t="iso"){if(t==="iso"){const e=[];return e.push(vt(this.year,4)),e.push(vt(this.month,2)),e.push(vt(this.day,2)),e.push(vt(this.hour,2)),e.push(vt(this.minute,2)),e.push(vt(this.second,2)),this.millisecond!==0&&(e.push("."),e.push(vt(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(t)}toJSON(){return K(P({},super.toJSON()),{millisecond:this.millisecond})}}ac=Ji,x.GeneralizedTime=ac,Ji.NAME="GeneralizedTime";var cc;class Es extends qt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}cc=Es,x.DATE=cc,Es.NAME="DATE";var lc;class Ns extends qt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}lc=Ns,x.TimeOfDay=lc,Ns.NAME="TimeOfDay";var uc;class Is extends qt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}uc=Is,x.DateTime=uc,Is.NAME="DateTime";var hc;class Ts extends qt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}hc=Ts,x.Duration=hc,Ts.NAME="Duration";var pc;class js extends qt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}pc=js,x.TIME=pc,js.NAME="TIME";class ve{constructor({name:t=ft,optional:e=!1}={}){this.name=t,this.optional=e}}class Zo extends ve{constructor(i={}){var n=i,{value:t=[]}=n,e=q(n,["value"]);super(e),this.value=t}}class Zi extends ve{constructor(n={}){var s=n,{value:t=new ve,local:e=!1}=s,i=q(s,["value","local"]);super(i),this.value=t,this.local=e}}class Kh{get data(){return this.dataView.slice().buffer}set data(t){this.dataView=A.toUint8Array(t)}constructor({data:t=Ln}={}){this.dataView=A.toUint8Array(t)}fromBER(t,e,i){const n=e+i;return this.dataView=A.toUint8Array(t).subarray(e,n),n}toBER(t){return this.dataView.slice().buffer}}function Qt(r,t,e){if(e instanceof Zo){for(const n of e.value)if(Qt(r,t,n).verified)return{verified:!0,result:r};{const n={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(Gn)&&(n.name=e.name),n}}if(e instanceof ve)return e.hasOwnProperty(Gn)&&(r[e.name]=t),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Vh in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Hh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!($h in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=e.idBlock.toBER(!1);if(i.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(e.idBlock.fromBER(i,0,i.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(e.idBlock.hasOwnProperty(Lh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(Mh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(Dh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:r};if(!(Rh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:r};if(e.idBlock.isHexOnly){if(!(Pa in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=e.idBlock.valueHexView,s=t.idBlock.valueHexView;if(n.length!==s.length)return{verified:!1,result:r};for(let a=0;a<n.length;a++)if(n[a]!==s[1])return{verified:!1,result:r}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&(r[e.name]=t)),e instanceof x.Constructed){let n=0,s={verified:!1,result:{error:"Unknown error"}},a=e.valueBlock.value.length;if(a>0&&e.valueBlock.value[0]instanceof Zi&&(a=t.valueBlock.value.length),a===0)return{verified:!0,result:r};if(t.valueBlock.value.length===0&&e.valueBlock.value.length!==0){let c=!0;for(let u=0;u<e.valueBlock.value.length;u++)c=c&&(e.valueBlock.value[u].optional||!1);return c?{verified:!0,result:r}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&delete r[e.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let c=0;c<a;c++)if(c-n>=t.valueBlock.value.length){if(e.valueBlock.value[c].optional===!1){const u={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&(delete r[e.name],u.name=e.name)),u}}else if(e.valueBlock.value[0]instanceof Zi){if(s=Qt(r,t.valueBlock.value[c],e.valueBlock.value[0].value),s.verified===!1)if(e.valueBlock.value[0].optional)n++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&delete r[e.name]),s;if(Gn in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let u={};Fh in e.valueBlock.value[0]&&e.valueBlock.value[0].local?u=t:u=r,typeof u[e.valueBlock.value[0].name]>"u"&&(u[e.valueBlock.value[0].name]=[]),u[e.valueBlock.value[0].name].push(t.valueBlock.value[c])}}else if(s=Qt(r,t.valueBlock.value[c-n],e.valueBlock.value[c]),s.verified===!1)if(e.valueBlock.value[c].optional)n++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&delete r[e.name]),s;if(s.verified===!1){const c={verified:!1,result:r};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&(delete r[e.name],c.name=e.name)),c}return{verified:!0,result:r}}if(e.primitiveSchema&&Pa in t.valueBlock){const n=rr(t.valueBlock.valueHexView);if(n.offset===-1){const s={verified:!1,result:n.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ft),e.name&&(delete r[e.name],s.name=e.name)),s}return Qt(r,n.result,e.primitiveSchema)}return{verified:!0,result:r}}function Gh(r,t){if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const e=rr(A.toUint8Array(r));return e.offset===-1?{verified:!1,result:e.result}:Qt(e.result,e.result,t)}const yu=Object.freeze(Object.defineProperty({__proto__:null,Any:ve,BaseBlock:nt,BaseStringBlock:Jo,BitString:fe,BmpString:Di,Boolean:Vi,CharacterString:Gi,Choice:Zo,Constructed:ct,DATE:Es,DateTime:Is,Duration:Ts,EndOfContent:Ss,Enumerated:Li,GeneralString:Ki,GeneralizedTime:Ji,GraphicString:zi,HexBlock:Dt,IA5String:qi,Integer:Ge,Null:ge,NumericString:$i,ObjectIdentifier:Mi,OctetString:pe,Primitive:Kr,PrintableString:Fi,RawData:Kh,RelativeObjectIdentifier:Cs,Repeated:Zi,Sequence:Nt,Set:Vt,TIME:js,TeletexString:Wi,TimeOfDay:Ns,UTCTime:Jr,UniversalString:Hi,Utf8String:qt,ValueBlock:ut,VideotexString:_i,ViewWriter:Vn,VisibleString:Gr,compareSchema:Qt,fromBER:We,verifySchema:Gh},Symbol.toStringTag,{value:"Module"}));var g;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(g||(g={}));var h;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(h||(h={}));class Mn{constructor(t,e=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),t)if(typeof t=="number")this.fromNumber(t);else if(A.isBufferSource(t))this.unusedBits=e,this.value=A.toArrayBuffer(t);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(t){if(!(t instanceof fe))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=t.valueBlock.unusedBits,this.value=t.valueBlock.valueHex,this}toASN(){return new fe({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new fe({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const i of e)t+=i.toString(2).padStart(8,"0");return t=t.split("").reverse().join(""),this.unusedBits&&(t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(t,2)}fromNumber(t){let e=t.toString(2);const i=e.length+7>>3;this.unusedBits=(i<<3)-e.length;const n=new Uint8Array(i);e=e.padStart(i<<3,"0").split("").reverse().join("");let s=0;for(;s<i;)n[s]=parseInt(e.slice(s<<3,(s<<3)+8),2),s++;this.value=n.buffer}}class L{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(t){typeof t=="number"?this.buffer=new ArrayBuffer(t):A.isBufferSource(t)?this.buffer=A.toArrayBuffer(t):Array.isArray(t)?this.buffer=new Uint8Array(t):this.buffer=new ArrayBuffer(0)}fromASN(t){if(!(t instanceof pe))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=t.valueBlock.valueHex,this}toASN(){return new pe({valueHex:this.buffer})}toSchema(t){return new pe({name:t})}}const Jh={fromASN:r=>r instanceof ge?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new ge;const t=We(r);if(t.result.error)throw new Error(t.result.error);return t.result}},Zh={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new Ge({value:+r})},Yh={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new Li({value:r})},F={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Ge({valueHex:r})},Xh={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new fe({valueHex:r})},Qh={fromASN:r=>r.valueBlock.toString(),toASN:r=>new Mi({value:r})},tp={fromASN:r=>r.valueBlock.value,toASN:r=>new Vi({value:r})},Yi={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new pe({valueHex:r})},ep={fromASN:r=>new L(r.getValue()),toASN:r=>r.toASN()};function Bt(r){return{fromASN:t=>t.valueBlock.value,toASN:t=>new r({value:t})}}const du=Bt(qt),rp=Bt(Di),ip=Bt(Hi),np=Bt($i),sp=Bt(Fi),op=Bt(Wi),ap=Bt(_i),cp=Bt(qi),lp=Bt(zi),up=Bt(Gr),hp=Bt(Ki),pp=Bt(Gi),fp={fromASN:r=>r.toDate(),toASN:r=>new Jr({valueDate:r})},yp={fromASN:r=>r.toDate(),toASN:r=>new Ji({valueDate:r})},dp={fromASN:()=>null,toASN:()=>new ge};function Vr(r){switch(r){case h.Any:return Jh;case h.BitString:return Xh;case h.BmpString:return rp;case h.Boolean:return tp;case h.CharacterString:return pp;case h.Enumerated:return Yh;case h.GeneralString:return hp;case h.GeneralizedTime:return yp;case h.GraphicString:return lp;case h.IA5String:return cp;case h.Integer:return Zh;case h.Null:return dp;case h.NumericString:return np;case h.ObjectIdentifier:return Qh;case h.OctetString:return Yi;case h.PrintableString:return sp;case h.TeletexString:return op;case h.UTCTime:return fp;case h.UniversalString:return ip;case h.Utf8String:return du;case h.VideotexString:return ap;case h.VisibleString:return up;default:return null}}function _t(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:_t(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function gu(r){var t;if(r){const e=Object.getPrototypeOf(r);return((t=e==null?void 0:e.prototype)===null||t===void 0?void 0:t.constructor)===Array?!0:gu(e)}return!1}function gp(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),i=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)if(e[n]!==i[n])return!1;return!0}class vp{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,e=!1){const i=this.items.get(t);if(!i)throw new Error("Cannot get schema for '".concat(t.prototype.constructor.name,"' target"));if(e&&!i.schema)throw new Error("Schema '".concat(t.prototype.constructor.name,"' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'."));return i}cache(t){const e=this.get(t);e.schema||(e.schema=this.create(t,!0))}createDefault(t){const e={type:g.Sequence,items:{}},i=this.findParentSchema(t);return i&&(Object.assign(e,i),e.items=Object.assign({},e.items,i.items)),e}create(t,e){const i=this.items.get(t)||this.createDefault(t),n=[];for(const s in i.items){const a=i.items[s],c=e?s:"";let u;if(typeof a.type=="number"){const v=h[a.type],m=yu[v];if(!m)throw new Error("Cannot get ASN1 class by name '".concat(v,"'"));u=new m({name:c})}else _t(a.type)?u=new a.type().toSchema(c):a.optional?this.get(a.type).type===g.Choice?u=new ve({name:c}):(u=this.create(a.type,!1),u.name=c):u=new ve({name:c});const p=!!a.optional||a.defaultValue!==void 0;if(a.repeated){u.name="";const v=a.repeated==="set"?Vt:Nt;u=new v({name:"",value:[new Zi({name:c,value:u})]})}if(a.context!==null&&a.context!==void 0)if(a.implicit)if(typeof a.type=="number"||_t(a.type)){const v=a.repeated?ct:Kr;n.push(new v({name:c,optional:p,idBlock:{tagClass:3,tagNumber:a.context}}))}else{this.cache(a.type);const v=!!a.repeated;let m=v?u:this.get(a.type,!0).schema;m="valueBlock"in m?m.valueBlock.value:m.value,n.push(new ct({name:v?"":c,optional:p,idBlock:{tagClass:3,tagNumber:a.context},value:m}))}else n.push(new ct({optional:p,idBlock:{tagClass:3,tagNumber:a.context},value:[u]}));else u.optional=p,n.push(u)}switch(i.type){case g.Sequence:return new Nt({value:n,name:""});case g.Set:return new Vt({value:n,name:""});case g.Choice:return new Zo({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(t,e){return this.items.set(t,e),this}findParentSchema(t){const e=Object.getPrototypeOf(t);return e?this.items.get(e)||this.findParentSchema(e):null}}const Q=new vp,w=r=>t=>{let e;Q.has(t)?e=Q.get(t):(e=Q.createDefault(t),Q.set(t,e)),Object.assign(e,r)},l=r=>(t,e)=>{let i;Q.has(t.constructor)?i=Q.get(t.constructor):(i=Q.createDefault(t.constructor),Q.set(t.constructor,i));const n=Object.assign({},r);if(typeof n.type=="number"&&!n.converter){const s=Vr(r.type);if(!s)throw new Error("Cannot get default converter for property '".concat(e,"' of ").concat(t.constructor.name));n.converter=s}n.raw=r.raw,i.items[e]=n};class ar extends Error{constructor(){super(...arguments),this.schemas=[]}}class mp{static parse(t,e){const i=We(t);if(i.result.error)throw new Error(i.result.error);return this.fromASN(i.result,e)}static fromASN(t,e){try{if(_t(e))return new e().fromASN(t);const i=Q.get(e);Q.cache(e);let n=i.schema;const s=this.handleChoiceTypes(t,i,e,n);if(s!=null&&s.result)return s.result;s!=null&&s.targetSchema&&(n=s.targetSchema);const a=this.handleSequenceTypes(t,i,e,n);if(a&&"isManualMapping"in a)return a.result;const c=a,u=new e;return gu(e)?this.handleArrayTypes(t,i,e):(this.processSchemaItems(i,c,u),u)}catch(i){throw i instanceof ar&&i.schemas.push(e.name),i}}static handleChoiceTypes(t,e,i,n){if(t.constructor===ct&&e.type===g.Choice&&t.idBlock.tagClass===3)for(const s in e.items){const a=e.items[s];if(a.context===t.idBlock.tagNumber&&a.implicit&&typeof a.type=="function"&&Q.has(a.type)){const c=Q.get(a.type);if(c&&c.type===g.Sequence){const u=new Nt;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in u.valueBlock){u.valueBlock.value=t.valueBlock.value;const p=this.fromASN(u,a.type),v=new i;return v[s]=p,{result:v}}}}}else if(t.constructor===ct&&e.type!==g.Choice){const s=new ct({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:e.schema.valueBlock.value});for(const a in e.items)delete t[a];return{targetSchema:s}}return null}static handleSequenceTypes(t,e,i,n){if(e.type===g.Sequence){if(Object.keys(e.items).filter(a=>{const c=e.items[a];return c.optional&&typeof c.type=="function"&&Q.has(c.type)&&Q.get(c.type).type===g.Choice}).length>0&&"value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&i.name==="CertReqMsg")return this.handleManualMapping(t,e,i);const s=Qt({},t,n);if(!s.verified)throw new ar("Data does not match to ".concat(i.name," ASN1 schema.").concat(s.result.error?" ".concat(s.result.error):""));return s}else{const s=Qt({},t,n);if(!s.verified)throw new ar("Data does not match to ".concat(i.name," ASN1 schema.").concat(s.result.error?" ".concat(s.result.error):""));return s}}static handleManualMapping(t,e,i){const n=new i,s=t.valueBlock.value,a=Object.keys(e.items);let c=0;for(let u=0;u<a.length;u++){const p=a[u],v=e.items[p];if(c>=s.length)break;if(v.repeated){n[p]=this.processRepeatedField(s,c,v);break}else if(typeof v.type=="number")n[p]=this.processPrimitiveField(s[c],v),c++;else if(this.isOptionalChoiceField(v)){const m=this.processOptionalChoiceField(s[c],v);m.processed&&(n[p]=m.value,c++)}else n[p]=this.fromASN(s[c],v.type),c++}return{result:n,verified:!0,isManualMapping:!0}}static processRepeatedField(t,e,i){let n=t.slice(e);if(n.length===1&&n[0].constructor.name==="Sequence"){const s=n[0];s.valueBlock&&s.valueBlock.value&&Array.isArray(s.valueBlock.value)&&(n=s.valueBlock.value)}if(typeof i.type=="number"){const s=Vr(i.type);if(!s)throw new Error("No converter for ASN.1 type ".concat(i.type));return n.filter(a=>a&&a.valueBlock).map(a=>{try{return s.fromASN(a)}catch(c){return}}).filter(a=>a!==void 0)}else return n.filter(s=>s&&s.valueBlock).map(s=>{try{return this.fromASN(s,i.type)}catch(a){return}}).filter(s=>s!==void 0)}static processPrimitiveField(t,e){const i=Vr(e.type);if(!i)throw new Error("No converter for ASN.1 type ".concat(e.type));return i.fromASN(t)}static isOptionalChoiceField(t){return t.optional&&typeof t.type=="function"&&Q.has(t.type)&&Q.get(t.type).type===g.Choice}static processOptionalChoiceField(t,e){try{return{processed:!0,value:this.fromASN(t,e.type)}}catch(i){if(i instanceof ar&&/Wrong values for Choice type/.test(i.message))return{processed:!1};throw i}}static handleArrayTypes(t,e,i){if(!("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const n=e.itemType;if(typeof n=="number"){const s=Vr(n);if(!s)throw new Error("Cannot get default converter for array item of ".concat(i.name," ASN1 schema"));return i.from(t.valueBlock.value,a=>s.fromASN(a))}else return i.from(t.valueBlock.value,s=>this.fromASN(s,n))}static processSchemaItems(t,e,i){for(const n in t.items){const s=e.result[n];if(!s)continue;const a=t.items[n],c=a.type;let u;typeof c=="number"||_t(c)?u=this.processPrimitiveSchemaItem(s,a,c):u=this.processComplexSchemaItem(s,a,c),u&&typeof u=="object"&&"value"in u&&"raw"in u?(i[n]=u.value,i["".concat(n,"Raw")]=u.raw):i[n]=u}}static processPrimitiveSchemaItem(t,e,i){var n;const s=(n=e.converter)!==null&&n!==void 0?n:_t(i)?new i:null;if(!s)throw new Error("Converter is empty");return e.repeated?this.processRepeatedPrimitiveItem(t,e,s):this.processSinglePrimitiveItem(t,e,i,s)}static processRepeatedPrimitiveItem(t,e,i){if(e.implicit){const n=e.repeated==="sequence"?Nt:Vt,s=new n;s.valueBlock=t.valueBlock;const a=We(s.toBER(!1));if(a.offset===-1)throw new Error("Cannot parse the child item. ".concat(a.result.error));if(!("value"in a.result.valueBlock&&Array.isArray(a.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const c=a.result.valueBlock.value;return Array.from(c,u=>i.fromASN(u))}else return Array.from(t,n=>i.fromASN(n))}static processSinglePrimitiveItem(t,e,i,n){let s=t;if(e.implicit){let a;if(_t(i))a=new i().toSchema("");else{const c=h[i],u=yu[c];if(!u)throw new Error("Cannot get '".concat(c,"' class from asn1js module"));a=new u}a.valueBlock=s.valueBlock,s=We(a.toBER(!1)).result}return n.fromASN(s)}static processComplexSchemaItem(t,e,i){if(e.repeated){if(!Array.isArray(t))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(t,n=>this.fromASN(n,i))}else{const n=this.handleImplicitTagging(t,e,i);if(this.isOptionalChoiceField(e))try{return this.fromASN(n,i)}catch(s){if(s instanceof ar&&/Wrong values for Choice type/.test(s.message))return;throw s}else{const s=this.fromASN(n,i);return e.raw?{value:s,raw:t.valueBeforeDecodeView}:s}}}static handleImplicitTagging(t,e,i){if(e.implicit&&typeof e.context=="number"){const n=Q.get(i);if(n.type===g.Sequence){const s=new Nt;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in s.valueBlock)return s.valueBlock.value=t.valueBlock.value,s}else if(n.type===g.Set){const s=new Vt;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in s.valueBlock)return s.valueBlock.value=t.valueBlock.value,s}}return t}}class Yo{static serialize(t){return t instanceof nt?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){if(t&&typeof t=="object"&&_t(t))return t.toASN();if(!(t&&typeof t=="object"))throw new TypeError("Parameter 1 should be type of Object.");const e=t.constructor,i=Q.get(e);Q.cache(e);let n=[];if(i.itemType){if(!Array.isArray(t))throw new TypeError("Parameter 1 should be type of Array.");if(typeof i.itemType=="number"){const a=Vr(i.itemType);if(!a)throw new Error("Cannot get default converter for array item of ".concat(e.name," ASN1 schema"));n=t.map(c=>a.toASN(c))}else n=t.map(a=>this.toAsnItem({type:i.itemType},"[]",e,a))}else for(const a in i.items){const c=i.items[a],u=t[a];if(u===void 0||c.defaultValue===u||typeof c.defaultValue=="object"&&typeof u=="object"&&gp(this.serialize(c.defaultValue),this.serialize(u)))continue;const p=Yo.toAsnItem(c,a,e,u);if(typeof c.context=="number")if(c.implicit)if(!c.repeated&&(typeof c.type=="number"||_t(c.type))){const v={};v.valueHex=p instanceof ge?p.valueBeforeDecodeView:p.valueBlock.toBER(),n.push(new Kr(P({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context}},v)))}else n.push(new ct({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:p.valueBlock.value}));else n.push(new ct({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:[p]}));else c.repeated?n=n.concat(p):n.push(p)}let s;switch(i.type){case g.Sequence:s=new Nt({value:n});break;case g.Set:s=new Vt({value:n});break;case g.Choice:if(!n[0])throw new Error("Schema '".concat(e.name,"' has wrong data. Choice cannot be empty."));s=n[0];break}return s}static toAsnItem(t,e,i,n){let s;if(typeof t.type=="number"){const a=t.converter;if(!a)throw new Error("Property '".concat(e,"' doesn't have converter for type ").concat(h[t.type]," in schema '").concat(i.name,"'"));if(t.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const c=Array.from(n,p=>a.toASN(p)),u=t.repeated==="sequence"?Nt:Vt;s=new u({value:c})}else s=a.toASN(n)}else if(t.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const a=Array.from(n,u=>this.toASN(u)),c=t.repeated==="sequence"?Nt:Vt;s=new c({value:a})}else s=this.toASN(n);return s}}class D extends Array{constructor(t=[]){if(typeof t=="number")super(t);else{super();for(const e of t)this.push(e)}}}class S{static serialize(t){return Yo.serialize(t)}static parse(t,e){return mp.parse(t,e)}static toString(t){const e=A.isBufferSource(t)?A.toArrayBuffer(t):S.serialize(t),i=We(e);if(i.offset===-1)throw new Error("Cannot decode ASN.1 data. ".concat(i.result.error));return i.result.toString()}}function o(r,t,e,i){var n=arguments.length,s=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,t,e,i);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(s=(n<3?a(s):n>3?a(t,e,s):a(t,e))||s);return n>3&&s&&Object.defineProperty(t,e,s),s}function U(r,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(r):i?i.value:t.get(r)}function W(r,t,e,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(r,e):n?n.value=e:t.set(r,e),e}class fc{static isIPv4(t){return/^(\d{1,3}\.){3}\d{1,3}$/.test(t)}static parseIPv4(t){const e=t.split(".");if(e.length!==4)throw new Error("Invalid IPv4 address");return e.map(i=>{const n=parseInt(i,10);if(isNaN(n)||n<0||n>255)throw new Error("Invalid IPv4 address part");return n})}static parseIPv6(t){const e=this.expandIPv6(t).split(":");if(e.length!==8)throw new Error("Invalid IPv6 address");return e.reduce((i,n)=>{const s=parseInt(n,16);if(isNaN(s)||s<0||s>65535)throw new Error("Invalid IPv6 address part");return i.push(s>>8&255),i.push(s&255),i},[])}static expandIPv6(t){if(!t.includes("::"))return t;const e=t.split("::");if(e.length>2)throw new Error("Invalid IPv6 address");const i=e[0]?e[0].split(":"):[],n=e[1]?e[1].split(":"):[],s=8-(i.length+n.length);if(s<0)throw new Error("Invalid IPv6 address");return[...i,...Array(s).fill("0"),...n].join(":")}static formatIPv6(t){const e=[];for(let i=0;i<16;i+=2)e.push((t[i]<<8|t[i+1]).toString(16));return this.compressIPv6(e.join(":"))}static compressIPv6(t){const e=t.split(":");let i=-1,n=0,s=-1,a=0;for(let c=0;c<e.length;c++)e[c]==="0"?(s===-1&&(s=c),a++):(a>n&&(i=s,n=a),s=-1,a=0);if(a>n&&(i=s,n=a),n>1){const c=e.slice(0,i).join(":"),u=e.slice(i+n).join(":");return"".concat(c,"::").concat(u)}return t}static parseCIDR(t){const[e,i]=t.split("/"),n=parseInt(i,10);if(this.isIPv4(e)){if(n<0||n>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(e),n]}else{if(n<0||n>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(e),n]}}static decodeIP(t){if(t.length===64&&parseInt(t,16)===0)return"::/0";if(t.length!==16)return t;const e=parseInt(t.slice(8),16).toString(2).split("").reduce((n,s)=>n+ +s,0);let i=t.slice(0,8).replace(/(.{2})/g,n=>"".concat(parseInt(n,16),"."));return i=i.slice(0,-1),"".concat(i,"/").concat(e)}static toString(t){const e=new Uint8Array(t);if(e.length===4)return Array.from(e).join(".");if(e.length===16)return this.formatIPv6(e);if(e.length===8||e.length===32){const i=e.length/2,n=e.slice(0,i),s=e.slice(i);if(e.every(c=>c===0))return e.length===8?"0.0.0.0/0":"::/0";const a=s.reduce((c,u)=>c+(u.toString(2).match(/1/g)||[]).length,0);return e.length===8?"".concat(Array.from(n).join("."),"/").concat(a):"".concat(this.formatIPv6(n),"/").concat(a)}return this.decodeIP(E.ToHex(t))}static fromString(t){if(t.includes("/")){const[i,n]=this.parseCIDR(t),s=new Uint8Array(i.length);let a=n;for(let u=0;u<s.length;u++)a>=8?(s[u]=255,a-=8):a>0&&(s[u]=255<<8-a,a=0);const c=new Uint8Array(i.length*2);return c.set(i,0),c.set(s,i.length),c.buffer}const e=this.isIPv4(t)?this.parseIPv4(t):this.parseIPv6(t);return new Uint8Array(e).buffer}}var Us,Ps,Rs;let rt=class{constructor(r={}){Object.assign(this,r)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};o([l({type:h.TeletexString})],rt.prototype,"teletexString",void 0),o([l({type:h.PrintableString})],rt.prototype,"printableString",void 0),o([l({type:h.UniversalString})],rt.prototype,"universalString",void 0),o([l({type:h.Utf8String})],rt.prototype,"utf8String",void 0),o([l({type:h.BmpString})],rt.prototype,"bmpString",void 0),rt=o([w({type:g.Choice})],rt);let Ve=class extends rt{constructor(r={}){super(r),Object.assign(this,r)}toString(){return this.ia5String||(this.anyValue?E.ToHex(this.anyValue):super.toString())}};o([l({type:h.IA5String})],Ve.prototype,"ia5String",void 0),o([l({type:h.Any})],Ve.prototype,"anyValue",void 0),Ve=o([w({type:g.Choice})],Ve);class Xi{constructor(t={}){this.type="",this.value=new Ve,Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Xi.prototype,"type",void 0),o([l({type:Ve})],Xi.prototype,"value",void 0);let Je=Us=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Us.prototype)}};Je=Us=o([w({type:g.Set,itemType:Xi})],Je);let Vs=Ps=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Ps.prototype)}};Vs=Ps=o([w({type:g.Sequence,itemType:Je})],Vs);let tt=Rs=class extends Vs{constructor(r){super(r),Object.setPrototypeOf(this,Rs.prototype)}};tt=Rs=o([w({type:g.Sequence})],tt);const wp={fromASN:r=>fc.toString(Yi.fromASN(r)),toASN:r=>Yi.toASN(fc.fromString(r))};class Zr{constructor(t={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Zr.prototype,"typeId",void 0),o([l({type:h.Any,context:0})],Zr.prototype,"value",void 0);class Ls{constructor(t={}){this.partyName=new rt,Object.assign(this,t)}}o([l({type:rt,optional:!0,context:0,implicit:!0})],Ls.prototype,"nameAssigner",void 0),o([l({type:rt,context:1,implicit:!0})],Ls.prototype,"partyName",void 0);let j=class{constructor(r={}){Object.assign(this,r)}};o([l({type:Zr,context:0,implicit:!0})],j.prototype,"otherName",void 0),o([l({type:h.IA5String,context:1,implicit:!0})],j.prototype,"rfc822Name",void 0),o([l({type:h.IA5String,context:2,implicit:!0})],j.prototype,"dNSName",void 0),o([l({type:h.Any,context:3,implicit:!0})],j.prototype,"x400Address",void 0),o([l({type:tt,context:4,implicit:!1})],j.prototype,"directoryName",void 0),o([l({type:Ls,context:5})],j.prototype,"ediPartyName",void 0),o([l({type:h.IA5String,context:6,implicit:!0})],j.prototype,"uniformResourceIdentifier",void 0),o([l({type:h.OctetString,context:7,implicit:!0,converter:wp})],j.prototype,"iPAddress",void 0),o([l({type:h.ObjectIdentifier,context:8,implicit:!0})],j.prototype,"registeredID",void 0),j=o([w({type:g.Choice})],j);const Xo="1.3.6.1.5.5.7",bp="".concat(Xo,".1"),ir="".concat(Xo,".3"),Dn="".concat(Xo,".48"),yc="".concat(Dn,".1"),dc="".concat(Dn,".2"),gc="".concat(Dn,".3"),vc="".concat(Dn,".5"),Zt="2.5.29";var Ms;const Ds="".concat(bp,".1");class Yr{constructor(t={}){this.accessMethod="",this.accessLocation=new j,Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Yr.prototype,"accessMethod",void 0),o([l({type:j})],Yr.prototype,"accessLocation",void 0);let Le=Ms=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Ms.prototype)}};Le=Ms=o([w({type:g.Sequence,itemType:Yr})],Le);const Hs="".concat(Zt,".35");class Qo extends L{}class le{constructor(t={}){t&&Object.assign(this,t)}}o([l({type:Qo,context:0,optional:!0,implicit:!0})],le.prototype,"keyIdentifier",void 0),o([l({type:j,context:1,optional:!0,implicit:!0,repeated:"sequence"})],le.prototype,"authorityCertIssuer",void 0),o([l({type:h.Integer,context:2,optional:!0,implicit:!0,converter:F})],le.prototype,"authorityCertSerialNumber",void 0);const vu="".concat(Zt,".19");class Qi{constructor(t={}){this.cA=!1,Object.assign(this,t)}}o([l({type:h.Boolean,defaultValue:!1})],Qi.prototype,"cA",void 0),o([l({type:h.Integer,optional:!0})],Qi.prototype,"pathLenConstraint",void 0);var $s;let ot=$s=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,$s.prototype)}};ot=$s=o([w({type:g.Sequence,itemType:j})],ot);var Fs;let mc=Fs=class extends ot{constructor(r){super(r),Object.setPrototypeOf(this,Fs.prototype)}};mc=Fs=o([w({type:g.Sequence})],mc);var Ws;const mu="".concat(Zt,".32");let Wt=class{constructor(r={}){Object.assign(this,r)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};o([l({type:h.IA5String})],Wt.prototype,"ia5String",void 0),o([l({type:h.VisibleString})],Wt.prototype,"visibleString",void 0),o([l({type:h.BmpString})],Wt.prototype,"bmpString",void 0),o([l({type:h.Utf8String})],Wt.prototype,"utf8String",void 0),Wt=o([w({type:g.Choice})],Wt);class _s{constructor(t={}){this.organization=new Wt,this.noticeNumbers=[],Object.assign(this,t)}}o([l({type:Wt})],_s.prototype,"organization",void 0),o([l({type:h.Integer,repeated:"sequence"})],_s.prototype,"noticeNumbers",void 0);class qs{constructor(t={}){Object.assign(this,t)}}o([l({type:_s,optional:!0})],qs.prototype,"noticeRef",void 0),o([l({type:Wt,optional:!0})],qs.prototype,"explicitText",void 0);let ci=class{constructor(r={}){Object.assign(this,r)}};o([l({type:h.IA5String})],ci.prototype,"cPSuri",void 0),o([l({type:qs})],ci.prototype,"userNotice",void 0),ci=o([w({type:g.Choice})],ci);class zs{constructor(t={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],zs.prototype,"policyQualifierId",void 0),o([l({type:h.Any})],zs.prototype,"qualifier",void 0);class tn{constructor(t={}){this.policyIdentifier="",Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],tn.prototype,"policyIdentifier",void 0),o([l({type:zs,repeated:"sequence",optional:!0})],tn.prototype,"policyQualifiers",void 0);let en=Ws=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Ws.prototype)}};en=Ws=o([w({type:g.Sequence,itemType:tn})],en);let vi=class{constructor(r=0){this.value=r}};o([l({type:h.Integer})],vi.prototype,"value",void 0),vi=o([w({type:g.Choice})],vi);let wc=class extends vi{};wc=o([w({type:g.Choice})],wc);var Ks;const Gs="".concat(Zt,".31");var xt;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(xt||(xt={}));class wu extends Mn{toJSON(){const t=[],e=this.toNumber();return e&xt.aACompromise&&t.push("aACompromise"),e&xt.affiliationChanged&&t.push("affiliationChanged"),e&xt.cACompromise&&t.push("cACompromise"),e&xt.certificateHold&&t.push("certificateHold"),e&xt.cessationOfOperation&&t.push("cessationOfOperation"),e&xt.keyCompromise&&t.push("keyCompromise"),e&xt.privilegeWithdrawn&&t.push("privilegeWithdrawn"),e&xt.superseded&&t.push("superseded"),e&xt.unused&&t.push("unused"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}let ue=class{constructor(r={}){Object.assign(this,r)}};o([l({type:j,context:0,repeated:"sequence",implicit:!0})],ue.prototype,"fullName",void 0),o([l({type:Je,context:1,implicit:!0})],ue.prototype,"nameRelativeToCRLIssuer",void 0),ue=o([w({type:g.Choice})],ue);class _e{constructor(t={}){Object.assign(this,t)}}o([l({type:ue,context:0,optional:!0})],_e.prototype,"distributionPoint",void 0),o([l({type:wu,context:1,optional:!0,implicit:!0})],_e.prototype,"reasons",void 0),o([l({type:j,context:2,optional:!0,repeated:"sequence",implicit:!0})],_e.prototype,"cRLIssuer",void 0);let qe=Ks=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Ks.prototype)}};qe=Ks=o([w({type:g.Sequence,itemType:_e})],qe);var Js;let bc=Js=class extends qe{constructor(r){super(r),Object.setPrototypeOf(this,Js.prototype)}};bc=Js=o([w({type:g.Sequence,itemType:_e})],bc);class st{constructor(t={}){this.onlyContainsUserCerts=st.ONLY,this.onlyContainsCACerts=st.ONLY,this.indirectCRL=st.ONLY,this.onlyContainsAttributeCerts=st.ONLY,Object.assign(this,t)}}st.ONLY=!1,o([l({type:ue,context:0,optional:!0})],st.prototype,"distributionPoint",void 0),o([l({type:h.Boolean,context:1,defaultValue:st.ONLY,implicit:!0})],st.prototype,"onlyContainsUserCerts",void 0),o([l({type:h.Boolean,context:2,defaultValue:st.ONLY,implicit:!0})],st.prototype,"onlyContainsCACerts",void 0),o([l({type:wu,context:3,optional:!0,implicit:!0})],st.prototype,"onlySomeReasons",void 0),o([l({type:h.Boolean,context:4,defaultValue:st.ONLY,implicit:!0})],st.prototype,"indirectCRL",void 0),o([l({type:h.Boolean,context:5,defaultValue:st.ONLY,implicit:!0})],st.prototype,"onlyContainsAttributeCerts",void 0);var Lr;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Lr||(Lr={}));let Jn=class{constructor(r=Lr.unspecified){this.reason=Lr.unspecified,this.reason=r}toJSON(){return Lr[this.reason]}toString(){return this.toJSON()}};o([l({type:h.Enumerated})],Jn.prototype,"reason",void 0),Jn=o([w({type:g.Choice})],Jn);var Zs;const bu="".concat(Zt,".37");let rn=Zs=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Zs.prototype)}};rn=Zs=o([w({type:g.Sequence,itemType:h.ObjectIdentifier})],rn);const Ap="".concat(ir,".1"),Sp="".concat(ir,".2"),Bp="".concat(ir,".3"),kp="".concat(ir,".4"),xp="".concat(ir,".8"),Op="".concat(ir,".9");let Zn=class{constructor(r=new ArrayBuffer(0)){this.value=r}};o([l({type:h.Integer,converter:F})],Zn.prototype,"value",void 0),Zn=o([w({type:g.Choice})],Zn);let Yn=class{constructor(r){this.value=new Date,r&&(this.value=r)}};o([l({type:h.GeneralizedTime})],Yn.prototype,"value",void 0),Yn=o([w({type:g.Choice})],Yn);var Ys;const Au="".concat(Zt,".18");let Ac=Ys=class extends ot{constructor(r){super(r),Object.setPrototypeOf(this,Ys.prototype)}};Ac=Ys=o([w({type:g.Sequence})],Ac);const Su="".concat(Zt,".15");var Ot;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Ot||(Ot={}));class Xn extends Mn{toJSON(){const t=this.toNumber(),e=[];return t&Ot.cRLSign&&e.push("crlSign"),t&Ot.dataEncipherment&&e.push("dataEncipherment"),t&Ot.decipherOnly&&e.push("decipherOnly"),t&Ot.digitalSignature&&e.push("digitalSignature"),t&Ot.encipherOnly&&e.push("encipherOnly"),t&Ot.keyAgreement&&e.push("keyAgreement"),t&Ot.keyCertSign&&e.push("keyCertSign"),t&Ot.keyEncipherment&&e.push("keyEncipherment"),t&Ot.nonRepudiation&&e.push("nonRepudiation"),e}toString(){return"[".concat(this.toJSON().join(", "),"]")}}var Xs;class mi{constructor(t={}){this.base=new j,this.minimum=0,Object.assign(this,t)}}o([l({type:j})],mi.prototype,"base",void 0),o([l({type:h.Integer,context:0,defaultValue:0,implicit:!0})],mi.prototype,"minimum",void 0),o([l({type:h.Integer,context:1,optional:!0,implicit:!0})],mi.prototype,"maximum",void 0);let nn=Xs=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Xs.prototype)}};nn=Xs=o([w({type:g.Sequence,itemType:mi})],nn);class Sc{constructor(t={}){Object.assign(this,t)}}o([l({type:nn,context:0,optional:!0,implicit:!0})],Sc.prototype,"permittedSubtrees",void 0),o([l({type:nn,context:1,optional:!0,implicit:!0})],Sc.prototype,"excludedSubtrees",void 0);class Bc{constructor(t={}){Object.assign(this,t)}}o([l({type:h.Integer,context:0,implicit:!0,optional:!0,converter:F})],Bc.prototype,"requireExplicitPolicy",void 0),o([l({type:h.Integer,context:1,implicit:!0,optional:!0,converter:F})],Bc.prototype,"inhibitPolicyMapping",void 0);var Qs;class to{constructor(t={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],to.prototype,"issuerDomainPolicy",void 0),o([l({type:h.ObjectIdentifier})],to.prototype,"subjectDomainPolicy",void 0);let kc=Qs=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Qs.prototype)}};kc=Qs=o([w({type:g.Sequence,itemType:to})],kc);var eo;const Bu="".concat(Zt,".17");let ro=eo=class extends ot{constructor(r){super(r),Object.setPrototypeOf(this,eo.prototype)}};ro=eo=o([w({type:g.Sequence})],ro);let zt=class{constructor(r={}){this.type="",this.values=[],Object.assign(this,r)}};o([l({type:h.ObjectIdentifier})],zt.prototype,"type",void 0),o([l({type:h.Any,repeated:"set"})],zt.prototype,"values",void 0);var io;let xc=io=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,io.prototype)}};xc=io=o([w({type:g.Sequence,itemType:zt})],xc);const ku="".concat(Zt,".14");class ie extends Qo{}class Oc{constructor(t={}){Object.assign(this,t)}}o([l({type:h.GeneralizedTime,context:0,implicit:!0,optional:!0})],Oc.prototype,"notBefore",void 0),o([l({type:h.GeneralizedTime,context:1,implicit:!0,optional:!0})],Oc.prototype,"notAfter",void 0);var Mr;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(Mr||(Mr={}));class xu extends Mn{toJSON(){const t=[],e=this.toNumber();return e&Mr.pKIXCertificate&&t.push("pKIXCertificate"),e&Mr.newExtensions&&t.push("newExtensions"),e&Mr.keyUpdateAllowed&&t.push("keyUpdateAllowed"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}class Cc{constructor(t={}){this.entrustVers="",this.entrustInfoFlags=new xu,Object.assign(this,t)}}o([l({type:h.GeneralString})],Cc.prototype,"entrustVers",void 0),o([l({type:xu})],Cc.prototype,"entrustInfoFlags",void 0);var no;let Ec=no=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,no.prototype)}};Ec=no=o([w({type:g.Sequence,itemType:Yr})],Ec);class k{constructor(t={}){this.algorithm="",Object.assign(this,t)}isEqual(t){return t instanceof k&&t.algorithm==this.algorithm&&(t.parameters&&this.parameters&&Kl(t.parameters,this.parameters)||t.parameters===this.parameters)}}o([l({type:h.ObjectIdentifier})],k.prototype,"algorithm",void 0),o([l({type:h.Any,optional:!0})],k.prototype,"parameters",void 0);class Rt{constructor(t={}){this.algorithm=new k,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:k})],Rt.prototype,"algorithm",void 0),o([l({type:h.BitString})],Rt.prototype,"subjectPublicKey",void 0);let it=class{constructor(r){if(r)if(typeof r=="string"||typeof r=="number"||r instanceof Date){const t=new Date(r);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,r)}getTime(){const r=this.utcTime||this.generalTime;if(!r)throw new Error("Cannot get time from CHOICE object");return r}};o([l({type:h.UTCTime})],it.prototype,"utcTime",void 0),o([l({type:h.GeneralizedTime})],it.prototype,"generalTime",void 0),it=o([w({type:g.Choice})],it);class sn{constructor(t){this.notBefore=new it(new Date),this.notAfter=new it(new Date),t&&(this.notBefore=new it(t.notBefore),this.notAfter=new it(t.notAfter))}}o([l({type:it})],sn.prototype,"notBefore",void 0),o([l({type:it})],sn.prototype,"notAfter",void 0);var so;let Et=class Ou{constructor(t={}){this.extnID="",this.critical=Ou.CRITICAL,this.extnValue=new L,Object.assign(this,t)}};Et.CRITICAL=!1,o([l({type:h.ObjectIdentifier})],Et.prototype,"extnID",void 0),o([l({type:h.Boolean,defaultValue:Et.CRITICAL})],Et.prototype,"critical",void 0),o([l({type:L})],Et.prototype,"extnValue",void 0);let me=so=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,so.prototype)}};me=so=o([w({type:g.Sequence,itemType:Et})],me);var Ze;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(Ze||(Ze={}));class At{constructor(t={}){this.version=Ze.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new k,this.issuer=new tt,this.validity=new sn,this.subject=new tt,this.subjectPublicKeyInfo=new Rt,Object.assign(this,t)}}o([l({type:h.Integer,context:0,defaultValue:Ze.v1})],At.prototype,"version",void 0),o([l({type:h.Integer,converter:F})],At.prototype,"serialNumber",void 0),o([l({type:k})],At.prototype,"signature",void 0),o([l({type:tt})],At.prototype,"issuer",void 0),o([l({type:sn})],At.prototype,"validity",void 0),o([l({type:tt})],At.prototype,"subject",void 0),o([l({type:Rt})],At.prototype,"subjectPublicKeyInfo",void 0),o([l({type:h.BitString,context:1,implicit:!0,optional:!0})],At.prototype,"issuerUniqueID",void 0),o([l({type:h.BitString,context:2,implicit:!0,optional:!0})],At.prototype,"subjectUniqueID",void 0),o([l({type:me,context:3,optional:!0})],At.prototype,"extensions",void 0);class ze{constructor(t={}){this.tbsCertificate=new At,this.signatureAlgorithm=new k,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:At,raw:!0})],ze.prototype,"tbsCertificate",void 0),o([l({type:k})],ze.prototype,"signatureAlgorithm",void 0),o([l({type:h.BitString})],ze.prototype,"signatureValue",void 0);class wi{constructor(t={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new it,Object.assign(this,t)}}o([l({type:h.Integer,converter:F})],wi.prototype,"userCertificate",void 0),o([l({type:it})],wi.prototype,"revocationDate",void 0),o([l({type:Et,optional:!0,repeated:"sequence"})],wi.prototype,"crlEntryExtensions",void 0);class Ft{constructor(t={}){this.signature=new k,this.issuer=new tt,this.thisUpdate=new it,Object.assign(this,t)}}o([l({type:h.Integer,optional:!0})],Ft.prototype,"version",void 0),o([l({type:k})],Ft.prototype,"signature",void 0),o([l({type:tt})],Ft.prototype,"issuer",void 0),o([l({type:it})],Ft.prototype,"thisUpdate",void 0),o([l({type:it,optional:!0})],Ft.prototype,"nextUpdate",void 0),o([l({type:wi,repeated:"sequence",optional:!0})],Ft.prototype,"revokedCertificates",void 0),o([l({type:Et,optional:!0,context:0,repeated:"sequence"})],Ft.prototype,"crlExtensions",void 0);class Qn{constructor(t={}){this.tbsCertList=new Ft,this.signatureAlgorithm=new k,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:Ft,raw:!0})],Qn.prototype,"tbsCertList",void 0),o([l({type:k})],Qn.prototype,"signatureAlgorithm",void 0),o([l({type:h.BitString})],Qn.prototype,"signature",void 0);class Ye{constructor(t={}){this.issuer=new tt,this.serialNumber=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:tt})],Ye.prototype,"issuer",void 0),o([l({type:h.Integer,converter:F})],Ye.prototype,"serialNumber",void 0);let Me=class{constructor(r={}){Object.assign(this,r)}};o([l({type:ie,context:0,implicit:!0})],Me.prototype,"subjectKeyIdentifier",void 0),o([l({type:Ye})],Me.prototype,"issuerAndSerialNumber",void 0),Me=o([w({type:g.Choice})],Me);var Kt;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(Kt||(Kt={}));let Xr=class extends k{};Xr=o([w({type:g.Sequence})],Xr);let on=class extends k{};on=o([w({type:g.Sequence})],on);let Mt=class extends k{};Mt=o([w({type:g.Sequence})],Mt);let an=class extends k{};an=o([w({type:g.Sequence})],an);let Nc=class extends k{};Nc=o([w({type:g.Sequence})],Nc);let oo=class extends k{};oo=o([w({type:g.Sequence})],oo);let Xe=class{constructor(r={}){this.attrType="",this.attrValues=[],Object.assign(this,r)}};o([l({type:h.ObjectIdentifier})],Xe.prototype,"attrType",void 0),o([l({type:h.Any,repeated:"set"})],Xe.prototype,"attrValues",void 0);var ao;class Pt{constructor(t={}){this.version=Kt.v0,this.sid=new Me,this.digestAlgorithm=new Xr,this.signatureAlgorithm=new on,this.signature=new L,Object.assign(this,t)}}o([l({type:h.Integer})],Pt.prototype,"version",void 0),o([l({type:Me})],Pt.prototype,"sid",void 0),o([l({type:Xr})],Pt.prototype,"digestAlgorithm",void 0),o([l({type:Xe,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],Pt.prototype,"signedAttrs",void 0),o([l({type:on})],Pt.prototype,"signatureAlgorithm",void 0),o([l({type:L})],Pt.prototype,"signature",void 0),o([l({type:Xe,repeated:"set",context:1,implicit:!0,optional:!0})],Pt.prototype,"unsignedAttrs",void 0);let cn=ao=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,ao.prototype)}};cn=ao=o([w({type:g.Set,itemType:Pt})],cn);let Ic=class extends it{};Ic=o([w({type:g.Choice})],Ic);let Tc=class extends Pt{};Tc=o([w({type:g.Sequence})],Tc);class ts{constructor(t={}){this.acIssuer=new j,this.acSerial=0,this.attrs=[],Object.assign(this,t)}}o([l({type:j})],ts.prototype,"acIssuer",void 0),o([l({type:h.Integer})],ts.prototype,"acSerial",void 0),o([l({type:zt,repeated:"sequence"})],ts.prototype,"attrs",void 0);var co;let ln=co=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,co.prototype)}};ln=co=o([w({type:g.Sequence,itemType:h.ObjectIdentifier})],ln);class li{constructor(t={}){this.permitUnSpecified=!0,Object.assign(this,t)}}o([l({type:h.Integer,optional:!0})],li.prototype,"pathLenConstraint",void 0),o([l({type:ln,implicit:!0,context:0,optional:!0})],li.prototype,"permittedAttrs",void 0),o([l({type:ln,implicit:!0,context:1,optional:!0})],li.prototype,"excludedAttrs",void 0),o([l({type:h.Boolean,defaultValue:!0})],li.prototype,"permitUnSpecified",void 0);class ye{constructor(t={}){this.issuer=new ot,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:ot})],ye.prototype,"issuer",void 0),o([l({type:h.Integer,converter:F})],ye.prototype,"serial",void 0),o([l({type:h.BitString,optional:!0})],ye.prototype,"issuerUID",void 0);var lo;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(lo||(lo={}));class he{constructor(t={}){this.digestedObjectType=lo.publicKey,this.digestAlgorithm=new k,this.objectDigest=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.Enumerated})],he.prototype,"digestedObjectType",void 0),o([l({type:h.ObjectIdentifier,optional:!0})],he.prototype,"otherObjectTypeID",void 0),o([l({type:k})],he.prototype,"digestAlgorithm",void 0),o([l({type:h.BitString})],he.prototype,"objectDigest",void 0);class bi{constructor(t={}){Object.assign(this,t)}}o([l({type:ot,optional:!0})],bi.prototype,"issuerName",void 0),o([l({type:ye,context:0,implicit:!0,optional:!0})],bi.prototype,"baseCertificateID",void 0),o([l({type:he,context:1,implicit:!0,optional:!0})],bi.prototype,"objectDigestInfo",void 0);let De=class{constructor(r={}){Object.assign(this,r)}};o([l({type:j,repeated:"sequence"})],De.prototype,"v1Form",void 0),o([l({type:bi,context:0,implicit:!0})],De.prototype,"v2Form",void 0),De=o([w({type:g.Choice})],De);class un{constructor(t={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,t)}}o([l({type:h.GeneralizedTime})],un.prototype,"notBeforeTime",void 0),o([l({type:h.GeneralizedTime})],un.prototype,"notAfterTime",void 0);class Dr{constructor(t={}){Object.assign(this,t)}}o([l({type:ye,implicit:!0,context:0,optional:!0})],Dr.prototype,"baseCertificateID",void 0),o([l({type:ot,implicit:!0,context:1,optional:!0})],Dr.prototype,"entityName",void 0),o([l({type:he,implicit:!0,context:2,optional:!0})],Dr.prototype,"objectDigestInfo",void 0);var uo;(function(r){r[r.v2=1]="v2"})(uo||(uo={}));class Ct{constructor(t={}){this.version=uo.v2,this.holder=new Dr,this.issuer=new De,this.signature=new k,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new un,this.attributes=[],Object.assign(this,t)}}o([l({type:h.Integer})],Ct.prototype,"version",void 0),o([l({type:Dr})],Ct.prototype,"holder",void 0),o([l({type:De})],Ct.prototype,"issuer",void 0),o([l({type:k})],Ct.prototype,"signature",void 0),o([l({type:h.Integer,converter:F})],Ct.prototype,"serialNumber",void 0),o([l({type:un})],Ct.prototype,"attrCertValidityPeriod",void 0),o([l({type:zt,repeated:"sequence"})],Ct.prototype,"attributes",void 0),o([l({type:h.BitString,optional:!0})],Ct.prototype,"issuerUniqueID",void 0),o([l({type:me,optional:!0})],Ct.prototype,"extensions",void 0);class Ai{constructor(t={}){this.acinfo=new Ct,this.signatureAlgorithm=new k,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:Ct})],Ai.prototype,"acinfo",void 0),o([l({type:k})],Ai.prototype,"signatureAlgorithm",void 0),o([l({type:h.BitString})],Ai.prototype,"signatureValue",void 0);var hn;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})(hn||(hn={}));class ho extends Mn{}class po{constructor(t={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier,implicit:!0,context:0})],po.prototype,"type",void 0),o([l({type:h.Any,implicit:!0,context:1})],po.prototype,"value",void 0);class es{constructor(t={}){this.policyId="",this.classList=new ho(hn.unclassified),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],es.prototype,"policyId",void 0),o([l({type:ho,defaultValue:new ho(hn.unclassified)})],es.prototype,"classList",void 0),o([l({type:po,repeated:"set"})],es.prototype,"securityCategories",void 0);class Si{constructor(t={}){Object.assign(this,t)}}o([l({type:L})],Si.prototype,"cotets",void 0),o([l({type:h.ObjectIdentifier})],Si.prototype,"oid",void 0),o([l({type:h.Utf8String})],Si.prototype,"string",void 0);class jc{constructor(t={}){this.values=[],Object.assign(this,t)}}o([l({type:ot,implicit:!0,context:0,optional:!0})],jc.prototype,"policyAuthority",void 0),o([l({type:Si,repeated:"sequence"})],jc.prototype,"values",void 0);var fo;class Bi{constructor(t={}){this.targetCertificate=new ye,Object.assign(this,t)}}o([l({type:ye})],Bi.prototype,"targetCertificate",void 0),o([l({type:j,optional:!0})],Bi.prototype,"targetName",void 0),o([l({type:he,optional:!0})],Bi.prototype,"certDigestInfo",void 0);let Ne=class{constructor(r={}){Object.assign(this,r)}};o([l({type:j,context:0,implicit:!0})],Ne.prototype,"targetName",void 0),o([l({type:j,context:1,implicit:!0})],Ne.prototype,"targetGroup",void 0),o([l({type:Bi,context:2,implicit:!0})],Ne.prototype,"targetCert",void 0),Ne=o([w({type:g.Choice})],Ne);let yo=fo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,fo.prototype)}};yo=fo=o([w({type:g.Sequence,itemType:Ne})],yo);var go;let Uc=go=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,go.prototype)}};Uc=go=o([w({type:g.Sequence,itemType:yo})],Uc);class Pc{constructor(t={}){Object.assign(this,t)}}o([l({type:ot,implicit:!0,context:0,optional:!0})],Pc.prototype,"roleAuthority",void 0),o([l({type:j,implicit:!0,context:1})],Pc.prototype,"roleName",void 0);class rs{constructor(t={}){this.service=new j,this.ident=new j,Object.assign(this,t)}}o([l({type:j})],rs.prototype,"service",void 0),o([l({type:j})],rs.prototype,"ident",void 0),o([l({type:L,optional:!0})],rs.prototype,"authInfo",void 0);var vo;class mo{constructor(t={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],mo.prototype,"otherCertFormat",void 0),o([l({type:h.Any})],mo.prototype,"otherCert",void 0);let Ie=class{constructor(r={}){Object.assign(this,r)}};o([l({type:ze})],Ie.prototype,"certificate",void 0),o([l({type:Ai,context:2,implicit:!0})],Ie.prototype,"v2AttrCert",void 0),o([l({type:mo,context:3,implicit:!0})],Ie.prototype,"other",void 0),Ie=o([w({type:g.Choice})],Ie);let pn=vo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,vo.prototype)}};pn=vo=o([w({type:g.Set,itemType:Ie})],pn);class Qe{constructor(t={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Qe.prototype,"contentType",void 0),o([l({type:h.Any,context:0})],Qe.prototype,"content",void 0);let lr=class{constructor(r={}){Object.assign(this,r)}};o([l({type:L})],lr.prototype,"single",void 0),o([l({type:h.Any})],lr.prototype,"any",void 0),lr=o([w({type:g.Choice})],lr);class fn{constructor(t={}){this.eContentType="",Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],fn.prototype,"eContentType",void 0),o([l({type:lr,context:0,optional:!0})],fn.prototype,"eContent",void 0);let ur=class{constructor(r={}){Object.assign(this,r)}};o([l({type:L,context:0,implicit:!0,optional:!0})],ur.prototype,"value",void 0),o([l({type:L,converter:ep,context:0,implicit:!0,optional:!0,repeated:"sequence"})],ur.prototype,"constructedValue",void 0),ur=o([w({type:g.Choice})],ur);class Hr{constructor(t={}){this.contentType="",this.contentEncryptionAlgorithm=new an,Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Hr.prototype,"contentType",void 0),o([l({type:an})],Hr.prototype,"contentEncryptionAlgorithm",void 0),o([l({type:ur,optional:!0})],Hr.prototype,"encryptedContent",void 0);class yn{constructor(t={}){this.keyAttrId="",Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],yn.prototype,"keyAttrId",void 0),o([l({type:h.Any,optional:!0})],yn.prototype,"keyAttr",void 0);var wo;class ki{constructor(t={}){this.subjectKeyIdentifier=new ie,Object.assign(this,t)}}o([l({type:ie})],ki.prototype,"subjectKeyIdentifier",void 0),o([l({type:h.GeneralizedTime,optional:!0})],ki.prototype,"date",void 0),o([l({type:yn,optional:!0})],ki.prototype,"other",void 0);let He=class{constructor(r={}){Object.assign(this,r)}};o([l({type:ki,context:0,implicit:!0,optional:!0})],He.prototype,"rKeyId",void 0),o([l({type:Ye,optional:!0})],He.prototype,"issuerAndSerialNumber",void 0),He=o([w({type:g.Choice})],He);class bo{constructor(t={}){this.rid=new He,this.encryptedKey=new L,Object.assign(this,t)}}o([l({type:He})],bo.prototype,"rid",void 0),o([l({type:L})],bo.prototype,"encryptedKey",void 0);let dn=wo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,wo.prototype)}};dn=wo=o([w({type:g.Sequence,itemType:bo})],dn);class Ao{constructor(t={}){this.algorithm=new k,this.publicKey=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:k})],Ao.prototype,"algorithm",void 0),o([l({type:h.BitString})],Ao.prototype,"publicKey",void 0);let oe=class{constructor(r={}){Object.assign(this,r)}};o([l({type:ie,context:0,implicit:!0,optional:!0})],oe.prototype,"subjectKeyIdentifier",void 0),o([l({type:Ao,context:1,implicit:!0,optional:!0})],oe.prototype,"originatorKey",void 0),o([l({type:Ye,optional:!0})],oe.prototype,"issuerAndSerialNumber",void 0),oe=o([w({type:g.Choice})],oe);class Te{constructor(t={}){this.version=Kt.v3,this.originator=new oe,this.keyEncryptionAlgorithm=new Mt,this.recipientEncryptedKeys=new dn,Object.assign(this,t)}}o([l({type:h.Integer})],Te.prototype,"version",void 0),o([l({type:oe,context:0})],Te.prototype,"originator",void 0),o([l({type:L,context:1,optional:!0})],Te.prototype,"ukm",void 0),o([l({type:Mt})],Te.prototype,"keyEncryptionAlgorithm",void 0),o([l({type:dn})],Te.prototype,"recipientEncryptedKeys",void 0);let $e=class{constructor(r={}){Object.assign(this,r)}};o([l({type:ie,context:0,implicit:!0})],$e.prototype,"subjectKeyIdentifier",void 0),o([l({type:Ye})],$e.prototype,"issuerAndSerialNumber",void 0),$e=o([w({type:g.Choice})],$e);class hr{constructor(t={}){this.version=Kt.v0,this.rid=new $e,this.keyEncryptionAlgorithm=new Mt,this.encryptedKey=new L,Object.assign(this,t)}}o([l({type:h.Integer})],hr.prototype,"version",void 0),o([l({type:$e})],hr.prototype,"rid",void 0),o([l({type:Mt})],hr.prototype,"keyEncryptionAlgorithm",void 0),o([l({type:L})],hr.prototype,"encryptedKey",void 0);class $r{constructor(t={}){this.keyIdentifier=new L,Object.assign(this,t)}}o([l({type:L})],$r.prototype,"keyIdentifier",void 0),o([l({type:h.GeneralizedTime,optional:!0})],$r.prototype,"date",void 0),o([l({type:yn,optional:!0})],$r.prototype,"other",void 0);class pr{constructor(t={}){this.version=Kt.v4,this.kekid=new $r,this.keyEncryptionAlgorithm=new Mt,this.encryptedKey=new L,Object.assign(this,t)}}o([l({type:h.Integer})],pr.prototype,"version",void 0),o([l({type:$r})],pr.prototype,"kekid",void 0),o([l({type:Mt})],pr.prototype,"keyEncryptionAlgorithm",void 0),o([l({type:L})],pr.prototype,"encryptedKey",void 0);class fr{constructor(t={}){this.version=Kt.v0,this.keyEncryptionAlgorithm=new Mt,this.encryptedKey=new L,Object.assign(this,t)}}o([l({type:h.Integer})],fr.prototype,"version",void 0),o([l({type:oo,context:0,optional:!0})],fr.prototype,"keyDerivationAlgorithm",void 0),o([l({type:Mt})],fr.prototype,"keyEncryptionAlgorithm",void 0),o([l({type:L})],fr.prototype,"encryptedKey",void 0);class So{constructor(t={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],So.prototype,"oriType",void 0),o([l({type:h.Any})],So.prototype,"oriValue",void 0);let Yt=class{constructor(r={}){Object.assign(this,r)}};o([l({type:hr,optional:!0})],Yt.prototype,"ktri",void 0),o([l({type:Te,context:1,implicit:!0,optional:!0})],Yt.prototype,"kari",void 0),o([l({type:pr,context:2,implicit:!0,optional:!0})],Yt.prototype,"kekri",void 0),o([l({type:fr,context:3,implicit:!0,optional:!0})],Yt.prototype,"pwri",void 0),o([l({type:So,context:4,implicit:!0,optional:!0})],Yt.prototype,"ori",void 0),Yt=o([w({type:g.Choice})],Yt);var Bo;let gn=Bo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Bo.prototype)}};gn=Bo=o([w({type:g.Set,itemType:Yt})],gn);var ko;class vn{constructor(t={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],vn.prototype,"otherRevInfoFormat",void 0),o([l({type:h.Any})],vn.prototype,"otherRevInfo",void 0);let xi=class{constructor(r={}){this.other=new vn,Object.assign(this,r)}};o([l({type:vn,context:1,implicit:!0})],xi.prototype,"other",void 0),xi=o([w({type:g.Choice})],xi);let mn=ko=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,ko.prototype)}};mn=ko=o([w({type:g.Set,itemType:xi})],mn);class xo{constructor(t={}){Object.assign(this,t)}}o([l({type:pn,context:0,implicit:!0,optional:!0})],xo.prototype,"certs",void 0),o([l({type:mn,context:1,implicit:!0,optional:!0})],xo.prototype,"crls",void 0);var Oo;let Co=Oo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Oo.prototype)}};Co=Oo=o([w({type:g.Set,itemType:Xe})],Co);class cr{constructor(t={}){this.version=Kt.v0,this.recipientInfos=new gn,this.encryptedContentInfo=new Hr,Object.assign(this,t)}}o([l({type:h.Integer})],cr.prototype,"version",void 0),o([l({type:xo,context:0,implicit:!0,optional:!0})],cr.prototype,"originatorInfo",void 0),o([l({type:gn})],cr.prototype,"recipientInfos",void 0),o([l({type:Hr})],cr.prototype,"encryptedContentInfo",void 0),o([l({type:Co,context:1,implicit:!0,optional:!0})],cr.prototype,"unprotectedAttrs",void 0);const Cp="1.2.840.113549.1.7.2";var Eo;let wn=Eo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Eo.prototype)}};wn=Eo=o([w({type:g.Set,itemType:Xr})],wn);class Ce{constructor(t={}){this.version=Kt.v0,this.digestAlgorithms=new wn,this.encapContentInfo=new fn,this.signerInfos=new cn,Object.assign(this,t)}}o([l({type:h.Integer})],Ce.prototype,"version",void 0),o([l({type:wn})],Ce.prototype,"digestAlgorithms",void 0),o([l({type:fn})],Ce.prototype,"encapContentInfo",void 0),o([l({type:pn,context:0,implicit:!0,optional:!0})],Ce.prototype,"certificates",void 0),o([l({type:mn,context:1,implicit:!0,optional:!0})],Ce.prototype,"crls",void 0),o([l({type:cn})],Ce.prototype,"signerInfos",void 0);const Qr="1.2.840.10045.2.1",ta="1.2.840.10045.4.1",Cu="1.2.840.10045.4.3.1",ea="1.2.840.10045.4.3.2",ra="1.2.840.10045.4.3.3",ia="1.2.840.10045.4.3.4",Rc="1.2.840.10045.3.1.7",Vc="1.3.132.0.34",Lc="1.3.132.0.35";function ri(r){return new k({algorithm:r})}const Ep=ri(ta);ri(Cu);const Np=ri(ea),Ip=ri(ra),Tp=ri(ia);let yr=class{constructor(r={}){Object.assign(this,r)}};o([l({type:h.ObjectIdentifier})],yr.prototype,"fieldType",void 0),o([l({type:h.Any})],yr.prototype,"parameters",void 0),yr=o([w({type:g.Sequence})],yr);class jp extends L{}let je=class{constructor(r={}){Object.assign(this,r)}};o([l({type:h.OctetString})],je.prototype,"a",void 0),o([l({type:h.OctetString})],je.prototype,"b",void 0),o([l({type:h.BitString,optional:!0})],je.prototype,"seed",void 0),je=o([w({type:g.Sequence})],je);var No;(function(r){r[r.ecpVer1=1]="ecpVer1"})(No||(No={}));let $t=class{constructor(r={}){this.version=No.ecpVer1,Object.assign(this,r)}};o([l({type:h.Integer})],$t.prototype,"version",void 0),o([l({type:yr})],$t.prototype,"fieldID",void 0),o([l({type:je})],$t.prototype,"curve",void 0),o([l({type:jp})],$t.prototype,"base",void 0),o([l({type:h.Integer,converter:F})],$t.prototype,"order",void 0),o([l({type:h.Integer,optional:!0})],$t.prototype,"cofactor",void 0),$t=o([w({type:g.Sequence})],$t);let Xt=class{constructor(r={}){Object.assign(this,r)}};o([l({type:h.ObjectIdentifier})],Xt.prototype,"namedCurve",void 0),o([l({type:h.Null})],Xt.prototype,"implicitCurve",void 0),o([l({type:$t})],Xt.prototype,"specifiedCurve",void 0),Xt=o([w({type:g.Choice})],Xt);class ui{constructor(t={}){this.version=1,this.privateKey=new L,Object.assign(this,t)}}o([l({type:h.Integer})],ui.prototype,"version",void 0),o([l({type:L})],ui.prototype,"privateKey",void 0),o([l({type:Xt,context:0,optional:!0})],ui.prototype,"parameters",void 0),o([l({type:h.BitString,context:1,optional:!0})],ui.prototype,"publicKey",void 0);class bn{constructor(t={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.Integer,converter:F})],bn.prototype,"r",void 0),o([l({type:h.Integer,converter:F})],bn.prototype,"s",void 0);const yt="1.2.840.113549.1.1",we="".concat(yt,".1"),Up="".concat(yt,".7"),Pp="".concat(yt,".9"),Fr="".concat(yt,".10"),Rp="".concat(yt,".2"),Vp="".concat(yt,".4"),An="".concat(yt,".5"),Lp="".concat(yt,".14"),Io="".concat(yt,".11"),Sn="".concat(yt,".12"),Bn="".concat(yt,".13"),Mc="".concat(yt,".15"),Dc="".concat(yt,".16"),kn="1.3.14.3.2.26",Eu="2.16.840.1.101.3.4.2.4",xn="2.16.840.1.101.3.4.2.1",On="2.16.840.1.101.3.4.2.2",Cn="2.16.840.1.101.3.4.2.3",Mp="2.16.840.1.101.3.4.2.5",Dp="2.16.840.1.101.3.4.2.6",Hp="1.2.840.113549.2.2",$p="1.2.840.113549.2.5",Hn="".concat(yt,".8");function X(r){return new k({algorithm:r,parameters:null})}X(Hp),X($p);const be=X(kn);X(Eu),X(xn),X(On),X(Cn),X(Mp),X(Dp);const Nu=new k({algorithm:Hn,parameters:S.serialize(be)}),Iu=new k({algorithm:Pp,parameters:S.serialize(Yi.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});X(we),X(Rp),X(Vp),X(An),X(Mc),X(Dc),X(Sn),X(Bn),X(Mc),X(Dc);class hi{constructor(t={}){this.hashAlgorithm=new k(be),this.maskGenAlgorithm=new k({algorithm:Hn,parameters:S.serialize(be)}),this.pSourceAlgorithm=new k(Iu),Object.assign(this,t)}}o([l({type:k,context:0,defaultValue:be})],hi.prototype,"hashAlgorithm",void 0),o([l({type:k,context:1,defaultValue:Nu})],hi.prototype,"maskGenAlgorithm",void 0),o([l({type:k,context:2,defaultValue:Iu})],hi.prototype,"pSourceAlgorithm",void 0),new k({algorithm:Up,parameters:S.serialize(new hi)});class ae{constructor(t={}){this.hashAlgorithm=new k(be),this.maskGenAlgorithm=new k({algorithm:Hn,parameters:S.serialize(be)}),this.saltLength=20,this.trailerField=1,Object.assign(this,t)}}o([l({type:k,context:0,defaultValue:be})],ae.prototype,"hashAlgorithm",void 0),o([l({type:k,context:1,defaultValue:Nu})],ae.prototype,"maskGenAlgorithm",void 0),o([l({type:h.Integer,context:2,defaultValue:20})],ae.prototype,"saltLength",void 0),o([l({type:h.Integer,context:3,defaultValue:1})],ae.prototype,"trailerField",void 0),new k({algorithm:Fr,parameters:S.serialize(new ae)});class En{constructor(t={}){this.digestAlgorithm=new k,this.digest=new L,Object.assign(this,t)}}o([l({type:k})],En.prototype,"digestAlgorithm",void 0),o([l({type:L})],En.prototype,"digest",void 0);var To;class Oi{constructor(t={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.Integer,converter:F})],Oi.prototype,"prime",void 0),o([l({type:h.Integer,converter:F})],Oi.prototype,"exponent",void 0),o([l({type:h.Integer,converter:F})],Oi.prototype,"coefficient",void 0);let jo=To=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,To.prototype)}};jo=To=o([w({type:g.Sequence,itemType:Oi})],jo);class Ut{constructor(t={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.Integer})],Ut.prototype,"version",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"modulus",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"publicExponent",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"privateExponent",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"prime1",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"prime2",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"exponent1",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"exponent2",void 0),o([l({type:h.Integer,converter:F})],Ut.prototype,"coefficient",void 0),o([l({type:jo,optional:!0})],Ut.prototype,"otherPrimeInfos",void 0);class Uo{constructor(t={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.Integer,converter:F})],Uo.prototype,"modulus",void 0),o([l({type:h.Integer,converter:F})],Uo.prototype,"publicExponent",void 0);var Po;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(Po||(Po={}));const ht=Po;var Ro=function(r,t){return Ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},Ro(r,t)};function na(r,t){Ro(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Fp(r,t,e,i){function n(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(v){try{p(i.next(v))}catch(m){a(m)}}function u(v){try{p(i.throw(v))}catch(m){a(m)}}function p(v){v.done?s(v.value):n(v.value).then(c,u)}p((i=i.apply(r,[])).next())})}function Wp(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(p){return function(v){return u([p,v])}}function u(p){if(i)throw new TypeError("Generator is already executing.");for(;e;)try{if(i=1,n&&(s=p[0]&2?n.return:p[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,p[1])).done)return s;switch(n=0,s&&(p=[p[0]&2,s.value]),p[0]){case 0:case 1:s=p;break;case 4:return e.label++,{value:p[1],done:!1};case 5:e.label++,n=p[1],p=[0];continue;case 7:p=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(p[0]===6||p[0]===2)){e=0;continue}if(p[0]===3&&(!s||p[1]>s[0]&&p[1]<s[3])){e.label=p[1];break}if(p[0]===6&&e.label<s[1]){e.label=s[1],s=p;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(p);break}s[2]&&e.ops.pop(),e.trys.pop();continue}p=t.call(r,e)}catch(v){p=[6,v],n=0}finally{i=s=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function pi(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],i=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nn(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var i=e.call(r),n,s=[],a;try{for(;(t===void 0||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(a)throw a.error}}return s}function ce(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Nn(arguments[t]));return r}var _p="injectionTokens";function qp(r){var t=Reflect.getMetadata("design:paramtypes",r)||[],e=Reflect.getOwnMetadata(_p,r)||{};return Object.keys(e).forEach(function(i){t[+i]=e[i]}),t}function Tu(r){return!!r.useClass}function Vo(r){return!!r.useFactory}var ju=function(){function r(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(t){var e=this,i={},n=!1,s,a=function(){return n||(s=t(e.wrap()),n=!0),s};return new Proxy(i,this.createHandler(a))},r.prototype.createHandler=function(t){var e={},i=function(n){e[n]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];s[0]=t();var c=Reflect[n];return c.apply(void 0,ce(s))}};return this.reflectMethods.forEach(i),e},r}();function Ee(r){return typeof r=="string"||typeof r=="symbol"}function zp(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function Hc(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Kp(r){return typeof r=="function"||r instanceof ju}function Ci(r){return!!r.useToken}function Ei(r){return r.useValue!=null}function Gp(r){return Tu(r)||Ei(r)||Ci(r)||Vo(r)}var sa=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},r.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},r.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},r.prototype.setAll=function(t,e){this._registryMap.set(t,e)},r.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},r}(),Jp=function(r){na(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(sa),fi=function(){function r(){this.scopedResolutions=new Map}return r}();function Zp(r,t){if(r===null)return"at position #"+t;var e=r.split(",")[t].trim();return'"'+e+'" at position #'+t}function Yp(r,t,e){return e===void 0&&(e="    "),ce([r],t.message.split("\n").map(function(i){return e+i})).join("\n")}function Xp(r,t,e){var i=Nn(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),n=i[1],s=n===void 0?null:n,a=Zp(s,t);return Yp("Cannot inject the dependency "+a+' of "'+r.name+'" constructor. Reason:',e)}function Qp(r){if(typeof r.dispose!="function")return!1;var t=r.dispose;return!(t.length>0)}var tf=function(r){na(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(sa),ef=function(r){na(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(sa),rf=function(){function r(){this.preResolution=new tf,this.postResolution=new ef}return r}(),Uu=new Map,nf=function(){function r(t){this.parent=t,this._registry=new Jp,this.interceptors=new rf,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(t,e,i){i===void 0&&(i={lifecycle:ht.Transient}),this.ensureNotDisposed();var n;if(Gp(e)?n=e:n={useClass:e},Ci(n))for(var s=[t],a=n;a!=null;){var c=a.useToken;if(s.includes(c))throw new Error("Token registration cycle detected! "+ce(s,[c]).join(" -> "));s.push(c);var u=this._registry.get(c);u&&Ci(u.provider)?a=u.provider:a=null}if((i.lifecycle===ht.Singleton||i.lifecycle==ht.ContainerScoped||i.lifecycle==ht.ResolutionScoped)&&(Ei(n)||Vo(n)))throw new Error('Cannot use lifecycle "'+ht[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:n,options:i}),this},r.prototype.registerType=function(t,e){return this.ensureNotDisposed(),Ee(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},r.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},r.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),Ee(t)){if(Ee(e))return this.register(t,{useToken:e},{lifecycle:ht.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:ht.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=t;return e&&!Ee(e)&&(i=e),this.register(t,{useClass:i},{lifecycle:ht.Singleton})},r.prototype.resolve=function(t,e,i){e===void 0&&(e=new fi),i===void 0&&(i=!1),this.ensureNotDisposed();var n=this.getRegistration(t);if(!n&&Ee(t)){if(i)return;throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"Single"),n){var s=this.resolveRegistration(n,e);return this.executePostResolutionInterceptor(t,s,"Single"),s}if(Kp(t)){var s=this.construct(t,e);return this.executePostResolutionInterceptor(t,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(t,e){var i,n;if(this.interceptors.preResolution.has(t)){var s=[];try{for(var a=pi(this.interceptors.preResolution.getAll(t)),c=a.next();!c.done;c=a.next()){var u=c.value;u.options.frequency!="Once"&&s.push(u),u.callback(t,e)}}catch(p){i={error:p}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(t,s)}},r.prototype.executePostResolutionInterceptor=function(t,e,i){var n,s;if(this.interceptors.postResolution.has(t)){var a=[];try{for(var c=pi(this.interceptors.postResolution.getAll(t)),u=c.next();!u.done;u=c.next()){var p=u.value;p.options.frequency!="Once"&&a.push(p),p.callback(t,e,i)}}catch(v){n={error:v}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(t,a)}},r.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===ht.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var i=t.options.lifecycle===ht.Singleton,n=t.options.lifecycle===ht.ContainerScoped,s=i||n,a;return Ei(t.provider)?a=t.provider.useValue:Ci(t.provider)?a=s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):Tu(t.provider)?a=s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):Vo(t.provider)?a=t.provider.useFactory(this):a=this.construct(t.provider,e),t.options.lifecycle===ht.ResolutionScoped&&e.scopedResolutions.set(t,a),a},r.prototype.resolveAll=function(t,e,i){var n=this;e===void 0&&(e=new fi),i===void 0&&(i=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(t);if(!s&&Ee(t)){if(i)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"All"),s){var a=s.map(function(u){return n.resolveRegistration(u,e)});return this.executePostResolutionInterceptor(t,a,"All"),a}var c=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,c,"All"),c},r.prototype.isRegistered=function(t,e){return e===void 0&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var i=pi(this._registry.entries()),n=i.next();!n.done;n=i.next()){var s=Nn(n.value,2),a=s[0],c=s[1];this._registry.setAll(a,c.filter(function(u){return!Ei(u.provider)}).map(function(u){return u.instance=void 0,u}))}}catch(u){t={error:u}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},r.prototype.createChildContainer=function(){var t,e;this.ensureNotDisposed();var i=new r(this);try{for(var n=pi(this._registry.entries()),s=n.next();!s.done;s=n.next()){var a=Nn(s.value,2),c=a[0],u=a[1];u.some(function(p){var v=p.options;return v.lifecycle===ht.ContainerScoped})&&i._registry.setAll(c,u.map(function(p){return p.options.lifecycle===ht.ContainerScoped?{provider:p.provider,options:p.options}:p}))}}catch(p){t={error:p}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return i},r.prototype.beforeResolution=function(t,e,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:i})},r.prototype.afterResolution=function(t,e,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:i})},r.prototype.dispose=function(){return Fp(this,void 0,void 0,function(){var t;return Wp(this,function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach(function(i){var n=i.dispose();n&&t.push(n)}),[4,Promise.all(t)];case 1:return e.sent(),[2]}})})},r.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},r.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},r.prototype.construct=function(t,e){var i=this;if(t instanceof ju)return t.createProxy(function(s){return i.resolve(s,e)});var n=function(){var s=Uu.get(t);if(!s||s.length===0){if(t.length===0)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var a=s.map(i.resolveParams(e,t));return new(t.bind.apply(t,ce([void 0],a)))}();return Qp(n)&&this.disposables.add(n),n},r.prototype.resolveParams=function(t,e){var i=this;return function(n,s){var a,c,u;try{return zp(n)?Hc(n)?n.multiple?(a=i.resolve(n.transform)).transform.apply(a,ce([i.resolveAll(n.token,new fi,n.isOptional)],n.transformArgs)):(c=i.resolve(n.transform)).transform.apply(c,ce([i.resolve(n.token,t,n.isOptional)],n.transformArgs)):n.multiple?i.resolveAll(n.token,new fi,n.isOptional):i.resolve(n.token,t,n.isOptional):Hc(n)?(u=i.resolve(n.transform,t)).transform.apply(u,ce([i.resolve(n.token,t)],n.transformArgs)):i.resolve(n,t)}catch(p){throw new Error(Xp(e,s,p))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),lt=new nf;function $n(r){return function(t){Uu.set(t,qp(t))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var Lo;class In{constructor(t={}){this.attrId="",this.attrValues=[],Object.assign(t)}}o([l({type:h.ObjectIdentifier})],In.prototype,"attrId",void 0),o([l({type:h.Any,repeated:"set"})],In.prototype,"attrValues",void 0);let $c=Lo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Lo.prototype)}};$c=Lo=o([w({type:g.Sequence,itemType:In})],$c);var Mo;let Fc=Mo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Mo.prototype)}};Fc=Mo=o([w({type:g.Sequence,itemType:Qe})],Fc);class Wc{constructor(t={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Wc.prototype,"certId",void 0),o([l({type:h.Any,context:0})],Wc.prototype,"certValue",void 0);class _c{constructor(t={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],_c.prototype,"crlId",void 0),o([l({type:h.Any,context:0})],_c.prototype,"crltValue",void 0);class Pu extends L{}let Tn=class{constructor(r={}){this.encryptionAlgorithm=new k,this.encryptedData=new Pu,Object.assign(this,r)}};o([l({type:k})],Tn.prototype,"encryptionAlgorithm",void 0),o([l({type:Pu})],Tn.prototype,"encryptedData",void 0);var Do,Ho;(function(r){r[r.v1=0]="v1"})(Ho||(Ho={}));class Ru extends L{}let $o=Do=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Do.prototype)}};$o=Do=o([w({type:g.Sequence,itemType:zt})],$o);class dr{constructor(t={}){this.version=Ho.v1,this.privateKeyAlgorithm=new k,this.privateKey=new Ru,Object.assign(this,t)}}o([l({type:h.Integer})],dr.prototype,"version",void 0),o([l({type:k})],dr.prototype,"privateKeyAlgorithm",void 0),o([l({type:Ru})],dr.prototype,"privateKey",void 0),o([l({type:$o,implicit:!0,context:0,optional:!0})],dr.prototype,"attributes",void 0);let qc=class extends dr{};qc=o([w({type:g.Sequence})],qc);let zc=class extends Tn{};zc=o([w({type:g.Sequence})],zc);class Kc{constructor(t={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Kc.prototype,"secretTypeId",void 0),o([l({type:h.Any,context:0})],Kc.prototype,"secretValue",void 0);class Wr{constructor(t={}){this.mac=new En,this.macSalt=new L,this.iterations=1,Object.assign(this,t)}}o([l({type:En})],Wr.prototype,"mac",void 0),o([l({type:L})],Wr.prototype,"macSalt",void 0),o([l({type:h.Integer,defaultValue:1})],Wr.prototype,"iterations",void 0);class Ni{constructor(t={}){this.version=3,this.authSafe=new Qe,this.macData=new Wr,Object.assign(this,t)}}o([l({type:h.Integer})],Ni.prototype,"version",void 0),o([l({type:Qe})],Ni.prototype,"authSafe",void 0),o([l({type:Wr,optional:!0})],Ni.prototype,"macData",void 0);var Fo;class Ii{constructor(t={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:h.ObjectIdentifier})],Ii.prototype,"bagId",void 0),o([l({type:h.Any,context:0})],Ii.prototype,"bagValue",void 0),o([l({type:In,repeated:"set",optional:!0})],Ii.prototype,"bagAttributes",void 0);let Gc=Fo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Fo.prototype)}};Gc=Fo=o([w({type:g.Sequence,itemType:Ii})],Gc);var Wo,_o,qo;const Vu="1.2.840.113549.1.9",Lu="".concat(Vu,".7"),oa="".concat(Vu,".14");let Ti=class extends rt{constructor(r={}){super(r)}toString(){return this.ia5String||super.toString()}};o([l({type:h.IA5String})],Ti.prototype,"ia5String",void 0),Ti=o([w({type:g.Choice})],Ti);let Jc=class extends Qe{};Jc=o([w({type:g.Sequence})],Jc);let Zc=class extends Ni{};Zc=o([w({type:g.Sequence})],Zc);let Yc=class extends Tn{};Yc=o([w({type:g.Sequence})],Yc);let is=class{constructor(r=""){this.value=r}toString(){return this.value}};o([l({type:h.IA5String})],is.prototype,"value",void 0),is=o([w({type:g.Choice})],is);let Xc=class extends Ti{};Xc=o([w({type:g.Choice})],Xc);let Qc=class extends rt{};Qc=o([w({type:g.Choice})],Qc);let ns=class{constructor(r=new Date){this.value=r}};o([l({type:h.GeneralizedTime})],ns.prototype,"value",void 0),ns=o([w({type:g.Choice})],ns);let tl=class extends rt{};tl=o([w({type:g.Choice})],tl);let ss=class{constructor(r="M"){this.value=r}toString(){return this.value}};o([l({type:h.PrintableString})],ss.prototype,"value",void 0),ss=o([w({type:g.Choice})],ss);let ji=class{constructor(r=""){this.value=r}toString(){return this.value}};o([l({type:h.PrintableString})],ji.prototype,"value",void 0),ji=o([w({type:g.Choice})],ji);let el=class extends ji{};el=o([w({type:g.Choice})],el);let rl=class extends rt{};rl=o([w({type:g.Choice})],rl);let os=class{constructor(r=""){this.value=r}toString(){return this.value}};o([l({type:h.ObjectIdentifier})],os.prototype,"value",void 0),os=o([w({type:g.Choice})],os);let il=class extends it{};il=o([w({type:g.Choice})],il);let as=class{constructor(r=0){this.value=r}toString(){return this.value.toString()}};o([l({type:h.Integer})],as.prototype,"value",void 0),as=o([w({type:g.Choice})],as);let nl=class extends Pt{};nl=o([w({type:g.Sequence})],nl);let jn=class extends rt{};jn=o([w({type:g.Choice})],jn);let sl=Wo=class extends me{constructor(r){super(r),Object.setPrototypeOf(this,Wo.prototype)}};sl=Wo=o([w({type:g.Sequence})],sl);let ol=_o=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,_o.prototype)}};ol=_o=o([w({type:g.Set,itemType:Xe})],ol);let cs=class{constructor(r=""){this.value=r}toString(){return this.value}};o([l({type:h.BmpString})],cs.prototype,"value",void 0),cs=o([w({type:g.Choice})],cs);let zo=class extends k{};zo=o([w({type:g.Sequence})],zo);let al=qo=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,qo.prototype)}};al=qo=o([w({type:g.Sequence,itemType:zo})],al);var Ko;let Un=Ko=class extends D{constructor(r){super(r),Object.setPrototypeOf(this,Ko.prototype)}};Un=Ko=o([w({type:g.Sequence,itemType:zt})],Un);class Fe{constructor(t={}){this.version=0,this.subject=new tt,this.subjectPKInfo=new Rt,this.attributes=new Un,Object.assign(this,t)}}o([l({type:h.Integer})],Fe.prototype,"version",void 0),o([l({type:tt})],Fe.prototype,"subject",void 0),o([l({type:Rt})],Fe.prototype,"subjectPKInfo",void 0),o([l({type:Un,implicit:!0,context:0})],Fe.prototype,"attributes",void 0);class _r{constructor(t={}){this.certificationRequestInfo=new Fe,this.signatureAlgorithm=new k,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}o([l({type:Fe,raw:!0})],_r.prototype,"certificationRequestInfo",void 0),o([l({type:k})],_r.prototype,"signatureAlgorithm",void 0),o([l({type:h.BitString})],_r.prototype,"signature",void 0);const ii="crypto.algorithm";class sf{getAlgorithms(){return lt.resolveAll(ii)}toAsnAlgorithm(t){P({},t);for(const e of this.getAlgorithms()){const i=e.toAsnAlgorithm(t);if(i)return i}if(/^[0-9.]+$/.test(t.name)){const e=new k({algorithm:t.name});if("parameters"in t){const i=t;e.parameters=i.parameters}return e}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(t){for(const e of this.getAlgorithms()){const i=e.toWebAlgorithm(t);if(i)return i}return{name:t.algorithm,parameters:t.parameters}}}const tr="crypto.algorithmProvider";lt.registerSingleton(tr,sf);var Ui;const dt="1.3.36.3.3.2.8.1.1",cl="".concat(dt,".1"),ll="".concat(dt,".2"),ul="".concat(dt,".3"),hl="".concat(dt,".4"),pl="".concat(dt,".5"),fl="".concat(dt,".6"),yl="".concat(dt,".7"),dl="".concat(dt,".8"),gl="".concat(dt,".9"),vl="".concat(dt,".10"),ml="".concat(dt,".11"),wl="".concat(dt,".12"),bl="".concat(dt,".13"),Al="".concat(dt,".14"),Sl="brainpoolP160r1",Bl="brainpoolP160t1",kl="brainpoolP192r1",xl="brainpoolP192t1",Ol="brainpoolP224r1",Cl="brainpoolP224t1",El="brainpoolP256r1",Nl="brainpoolP256t1",Il="brainpoolP320r1",Tl="brainpoolP320t1",jl="brainpoolP384r1",Ul="brainpoolP384t1",Pl="brainpoolP512r1",Rl="brainpoolP512t1",_="ECDSA";let gr=Ui=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case _.toLowerCase():if("hash"in r)switch((typeof r.hash=="string"?r.hash:r.hash.name).toLowerCase()){case"sha-1":return Ep;case"sha-256":return Np;case"sha-384":return Ip;case"sha-512":return Tp}else if("namedCurve"in r){let t="";switch(r.namedCurve){case"P-256":t=Rc;break;case"K-256":t=Ui.SECP256K1;break;case"P-384":t=Vc;break;case"P-521":t=Lc;break;case Sl:t=cl;break;case Bl:t=ll;break;case kl:t=ul;break;case xl:t=hl;break;case Ol:t=pl;break;case Cl:t=fl;break;case El:t=yl;break;case Nl:t=dl;break;case Il:t=gl;break;case Tl:t=vl;break;case jl:t=ml;break;case Ul:t=wl;break;case Pl:t=bl;break;case Rl:t=Al;break}if(t)return new k({algorithm:Qr,parameters:S.serialize(new Xt({namedCurve:t}))})}}return null}toWebAlgorithm(r){switch(r.algorithm){case ta:return{name:_,hash:{name:"SHA-1"}};case ea:return{name:_,hash:{name:"SHA-256"}};case ra:return{name:_,hash:{name:"SHA-384"}};case ia:return{name:_,hash:{name:"SHA-512"}};case Qr:{if(!r.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(S.parse(r.parameters,Xt).namedCurve){case Rc:return{name:_,namedCurve:"P-256"};case Ui.SECP256K1:return{name:_,namedCurve:"K-256"};case Vc:return{name:_,namedCurve:"P-384"};case Lc:return{name:_,namedCurve:"P-521"};case cl:return{name:_,namedCurve:Sl};case ll:return{name:_,namedCurve:Bl};case ul:return{name:_,namedCurve:kl};case hl:return{name:_,namedCurve:xl};case pl:return{name:_,namedCurve:Ol};case fl:return{name:_,namedCurve:Cl};case yl:return{name:_,namedCurve:El};case dl:return{name:_,namedCurve:Nl};case gl:return{name:_,namedCurve:Il};case vl:return{name:_,namedCurve:Tl};case ml:return{name:_,namedCurve:jl};case wl:return{name:_,namedCurve:Ul};case bl:return{name:_,namedCurve:Pl};case Al:return{name:_,namedCurve:Rl}}}}return null}};gr.SECP256K1="1.3.132.0.10",gr=Ui=o([$n()],gr),lt.registerSingleton(ii,gr);const Mu=Symbol("name"),Du=Symbol("value");class M{constructor(t,e={},i=""){this[Mu]=t,this[Du]=i;for(const n in e)this[n]=e[n]}}M.NAME=Mu,M.VALUE=Du;class of{static toTextObject(t){const e=new M("Algorithm Identifier",{},ne.toString(t.algorithm));if(t.parameters)switch(t.algorithm){case Qr:{const i=new gr().toWebAlgorithm(t);i&&"namedCurve"in i?e["Named Curve"]=i.namedCurve:e.Parameters=t.parameters;break}default:e.Parameters=t.parameters}return e}}class ne{static toString(t){return this.items[t]||t}}ne.items={[kn]:"sha1",[Eu]:"sha224",[xn]:"sha256",[On]:"sha384",[Cn]:"sha512",[we]:"rsaEncryption",[An]:"sha1WithRSAEncryption",[Lp]:"sha224WithRSAEncryption",[Io]:"sha256WithRSAEncryption",[Sn]:"sha384WithRSAEncryption",[Bn]:"sha512WithRSAEncryption",[Qr]:"ecPublicKey",[ta]:"ecdsaWithSHA1",[Cu]:"ecdsaWithSHA224",[ea]:"ecdsaWithSHA256",[ra]:"ecdsaWithSHA384",[ia]:"ecdsaWithSHA512",[Ap]:"TLS WWW server authentication",[Sp]:"TLS WWW client authentication",[Bp]:"Code Signing",[kp]:"E-mail Protection",[xp]:"Time Stamping",[Op]:"OCSP Signing",[Cp]:"Signed Data"};class Ae{static serialize(t){return this.serializeObj(t).join("\n")}static pad(t=0){return"".padStart(2*t," ")}static serializeObj(t,e=0){const i=[];let n=this.pad(e++),s="";const a=t[M.VALUE];a&&(s=" ".concat(a)),i.push("".concat(n).concat(t[M.NAME],":").concat(s)),n=this.pad(e);for(const c in t){if(typeof c=="symbol")continue;const u=t[c],p=c?"".concat(c,": "):"";if(typeof u=="string"||typeof u=="number"||typeof u=="boolean")i.push("".concat(n).concat(p).concat(u));else if(u instanceof Date)i.push("".concat(n).concat(p).concat(u.toUTCString()));else if(Array.isArray(u))for(const v of u)v[M.NAME]=c,i.push(...this.serializeObj(v,e));else if(u instanceof M)u[M.NAME]=c,i.push(...this.serializeObj(u,e));else if(A.isBufferSource(u))c?(i.push("".concat(n).concat(p)),i.push(...this.serializeBufferSource(u,e+1))):i.push(...this.serializeBufferSource(u,e));else if("toTextObject"in u){const v=u.toTextObject();v[M.NAME]=c,i.push(...this.serializeObj(v,e))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return i}static serializeBufferSource(t,e=0){const i=this.pad(e),n=A.toUint8Array(t),s=[];for(let a=0;a<n.length;){const c=[];for(let u=0;u<16&&a<n.length;u++){u===8&&c.push("");const p=n[a++].toString(16).padStart(2,"0");c.push(p)}s.push("".concat(i).concat(c.join(" ")))}return s}static serializeAlgorithm(t){return this.algorithmSerializer.toTextObject(t)}}Ae.oidSerializer=ne,Ae.algorithmSerializer=of;var Ue;class se{get rawData(){return U(this,Ue,"f")||W(this,Ue,S.serialize(this.asn),"f"),U(this,Ue,"f")}constructor(...t){Ue.set(this,void 0),A.isBufferSource(t[0])?(this.asn=S.parse(t[0],t[1]),W(this,Ue,A.toArrayBuffer(t[0]),"f"),this.onInit(this.asn)):(this.asn=t[0],this.onInit(this.asn))}equal(t){return t instanceof se?Kl(t.rawData,this.rawData):!1}toString(t="text"){switch(t){case"asn":return S.toString(this.rawData);case"text":return Ae.serialize(this.toTextObject());case"hex":return E.ToHex(this.rawData);case"base64":return E.ToBase64(this.rawData);case"base64url":return E.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const t=this.toTextObjectEmpty();return t[""]=this.rawData,t}toTextObjectEmpty(t){return new M(this.getTextName(),{},t)}}Ue=new WeakMap,se.NAME="ASN";class bt extends se{constructor(...t){let e;A.isBufferSource(t[0])?e=A.toArrayBuffer(t[0]):e=S.serialize(new Et({extnID:t[0],critical:t[1],extnValue:new L(A.toArrayBuffer(t[2]))})),super(e,Et)}onInit(t){this.type=t.extnID,this.critical=t.critical,this.value=t.extnValue.buffer}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.value,t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty(this.critical?"critical":void 0);return t[M.NAME]===bt.NAME&&(t[M.NAME]=ne.toString(this.type)),t}}var Hu;class te{static isCryptoKeyPair(t){return t&&t.privateKey&&t.publicKey}static isCryptoKey(t){return t&&t.usages&&t.type&&t.algorithm&&t.extractable!==void 0}constructor(){this.items=new Map,this[Hu]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(te.DEFAULT,crypto):typeof ai<"u"&&ai.crypto&&ai.crypto.subtle&&this.set(te.DEFAULT,ai.crypto)}clear(){this.items.clear()}delete(t){return this.items.delete(t)}forEach(t,e){return this.items.forEach(t,e)}has(t){return this.items.has(t)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(t=te.DEFAULT){const e=this.items.get(t.toLowerCase());if(!e)throw new Error("Cannot get Crypto by name '".concat(t,"'"));return e}set(t,e){if(typeof t=="string"){if(!e)throw new TypeError("Argument 'value' is required");this.items.set(t.toLowerCase(),e)}else this.items.set(te.DEFAULT,t);return this}}Hu=Symbol.toStringTag,te.DEFAULT="default";const at=new te,af=/^[0-2](?:\.[1-9][0-9]*)+$/;function cf(r){return new RegExp(af).test(r)}class $u{constructor(t={}){this.items={};for(const e in t)this.register(e,t[e])}get(t){return this.items[t]||null}findId(t){return cf(t)?t:this.get(t)}register(t,e){this.items[t]=e,this.items[e]=t}}const pt=new $u;pt.register("CN","2.5.4.3"),pt.register("L","2.5.4.7"),pt.register("ST","2.5.4.8"),pt.register("O","2.5.4.10"),pt.register("OU","2.5.4.11"),pt.register("C","2.5.4.6"),pt.register("DC","0.9.2342.19200300.100.1.25"),pt.register("E","1.2.840.113549.1.9.1"),pt.register("G","2.5.4.42"),pt.register("I","2.5.4.43"),pt.register("SN","2.5.4.4"),pt.register("T","2.5.4.12");function lf(r,t){return"\\".concat(E.ToHex(E.FromUtf8String(t)).toUpperCase())}function uf(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,lf)}class Se{static isASCII(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!1;return!0}static isPrintableString(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(t)}constructor(t,e={}){this.extraNames=new $u,this.asn=new tt;for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const n=e[i];this.extraNames.register(i,n)}typeof t=="string"?this.asn=this.fromString(t):t instanceof tt?this.asn=t:A.isBufferSource(t)?this.asn=S.parse(t,tt):this.asn=this.fromJSON(t)}getField(t){const e=this.extraNames.findId(t)||pt.findId(t),i=[];for(const n of this.asn)for(const s of n)s.type===e&&i.push(s.value.toString());return i}getName(t){return this.extraNames.get(t)||pt.get(t)}toString(){return this.asn.map(t=>t.map(e=>{const i=this.getName(e.type)||e.type,n=e.value.anyValue?"#".concat(E.ToHex(e.value.anyValue)):uf(e.value.toString());return"".concat(i,"=").concat(n)}).join("+")).join(", ")}toJSON(){var t;const e=[];for(const i of this.asn){const n={};for(const s of i){const a=this.getName(s.type)||s.type;(t=n[a])!==null&&t!==void 0||(n[a]=[]),n[a].push(s.value.anyValue?"#".concat(E.ToHex(s.value.anyValue)):s.value.toString())}e.push(n)}return e}fromString(t){const e=new tt,i=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,s=",";for(;n=i.exec("".concat(t,","));){let[,a,c]=n;const u=c[c.length-1];(u===","||u==="+")&&(c=c.slice(0,c.length-1),n[3]=u);const p=n[3];a=this.getTypeOid(a);const v=this.createAttribute(a,c);s==="+"?e[e.length-1].push(v):e.push(new Je([v])),s=p}return e}fromJSON(t){const e=new tt;for(const i of t){const n=new Je;for(const s in i){const a=this.getTypeOid(s),c=i[s];for(const u of c){const p=this.createAttribute(a,u);n.push(p)}}e.push(n)}return e}getTypeOid(t){if(/[\d.]+/.test(t)||(t=this.getName(t)||""),!t)throw new Error("Cannot get OID for name type '".concat(t,"'"));return t}createAttribute(t,e){const i=new Xi({type:t});if(typeof e=="object")for(const n in e)switch(n){case"ia5String":i.value.ia5String=e[n];break;case"utf8String":i.value.utf8String=e[n];break;case"universalString":i.value.universalString=e[n];break;case"bmpString":i.value.bmpString=e[n];break;case"printableString":i.value.printableString=e[n];break}else if(e[0]==="#")i.value.anyValue=E.FromHex(e.slice(1));else{const n=this.processStringValue(e);t===this.getName("E")||t===this.getName("DC")?i.value.ia5String=n:Se.isPrintableString(n)?i.value.printableString=n:i.value.utf8String=n}return i}processStringValue(t){const e=/"(.*?[^\\])?"/.exec(t);return e&&(t=e[1]),t.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return S.serialize(this.asn)}async getThumbprint(...t){var e;let i,n="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(n=t[0]||n,i=t[1]||at.get()):i=t[0]||at.get(),await i.subtle.digest(n,this.toArrayBuffer())}}const Fu="Cannot initialize GeneralName from ASN.1 data.",Vl="".concat(Fu," Unsupported string format in use."),hf="".concat(Fu," Value doesn't match to GUID regular expression."),Ll=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,Ml="1.3.6.1.4.1.311.25.1",Dl="1.3.6.1.4.1.311.20.2.3",ls="dns",us="dn",hs="email",ps="ip",fs="url",ys="guid",ds="upn",yi="id";class ee extends se{constructor(...t){let e;if(t.length===2)switch(t[0]){case us:{const i=new Se(t[1]).toArrayBuffer(),n=S.parse(i,tt);e=new j({directoryName:n});break}case ls:e=new j({dNSName:t[1]});break;case hs:e=new j({rfc822Name:t[1]});break;case ys:{const i=new RegExp(Ll,"i").exec(t[1]);if(!i)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=i.slice(1).map((s,a)=>a<3?E.ToHex(new Uint8Array(E.FromHex(s)).reverse()):s).join("");e=new j({otherName:new Zr({typeId:Ml,value:S.serialize(new L(E.FromHex(n)))})});break}case ps:e=new j({iPAddress:t[1]});break;case yi:e=new j({registeredID:t[1]});break;case ds:{e=new j({otherName:new Zr({typeId:Dl,value:S.serialize(du.toASN(t[1]))})});break}case fs:e=new j({uniformResourceIdentifier:t[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else A.isBufferSource(t[0])?e=S.parse(t[0],j):e=t[0];super(e)}onInit(t){if(t.dNSName!=null)this.type=ls,this.value=t.dNSName;else if(t.rfc822Name!=null)this.type=hs,this.value=t.rfc822Name;else if(t.iPAddress!=null)this.type=ps,this.value=t.iPAddress;else if(t.uniformResourceIdentifier!=null)this.type=fs,this.value=t.uniformResourceIdentifier;else if(t.registeredID!=null)this.type=yi,this.value=t.registeredID;else if(t.directoryName!=null)this.type=us,this.value=new Se(t.directoryName).toString();else if(t.otherName!=null)if(t.otherName.typeId===Ml){this.type=ys;const e=S.parse(t.otherName.value,L),i=new RegExp(Ll,"i").exec(E.ToHex(e));if(!i)throw new Error(hf);this.value=i.slice(1).map((n,s)=>s<3?E.ToHex(new Uint8Array(E.FromHex(n)).reverse()):n).join("-")}else if(t.otherName.typeId===Dl)this.type=ds,this.value=S.parse(t.otherName.value,rt).toString();else throw new Error(Vl);else throw new Error(Vl)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let t;switch(this.type){case us:case ls:case ys:case ps:case yi:case ds:case fs:t=this.type.toUpperCase();break;case hs:t="Email";break;default:throw new Error("Unsupported GeneralName type")}let e=this.value;return this.type===yi&&(e=ne.toString(e)),new M(t,void 0,e)}}class Be extends se{constructor(t){let e;if(t instanceof ot)e=t;else if(Array.isArray(t)){const i=[];for(const n of t)if(n instanceof j)i.push(n);else{const s=S.parse(new ee(n.type,n.value).rawData,j);i.push(s)}e=new ot(i)}else if(A.isBufferSource(t))e=S.parse(t,ot);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(e)}onInit(t){const e=[];for(const i of t){let n=null;try{n=new ee(i)}catch(s){continue}e.push(n)}this.items=e}toJSON(){return this.items.map(t=>t.toJSON())}toTextObject(){const t=super.toTextObjectEmpty();for(const e of this.items){const i=e.toTextObject();let n=t[i[M.NAME]];Array.isArray(n)||(n=[],t[i[M.NAME]]=n),n.push(i)}return t}}Be.NAME="GeneralNames";const qr="-{5}",ti="\\n",pf="[^".concat(ti,"]+"),ff="".concat(qr,"BEGIN (").concat(pf,"(?=").concat(qr,"))").concat(qr),yf="".concat(qr,"END \\1").concat(qr),er="\\n",df="[^:".concat(ti,"]+"),gf="(?:[^".concat(ti,"]+").concat(er,"(?: +[^").concat(ti,"]+").concat(er,")*)"),vf="[a-zA-Z0-9=+/]+",mf="(?:".concat(vf).concat(er,")+"),Hl="".concat(ff).concat(er,"(?:((?:").concat(df,": ").concat(gf,")+))?").concat(er,"?(").concat(mf,")").concat(yf);class mt{static isPem(t){return typeof t=="string"&&new RegExp(Hl,"g").test(t.replace(/\r/g,""))}static decodeWithHeaders(t){t=t.replace(/\r/g,"");const e=new RegExp(Hl,"g"),i=[];let n=null;for(;n=e.exec(t);){const s=n[3].replace(new RegExp("[".concat(ti,"]+"),"g"),""),a={type:n[1],headers:[],rawData:E.FromBase64(s)},c=n[2];if(c){const u=c.split(new RegExp(er,"g"));let p=null;for(const v of u){const[m,H]=v.split(/:(.*)/);if(H===void 0){if(!p)throw new Error("Cannot parse PEM string. Incorrect header value");p.value+=m.trim()}else p&&a.headers.push(p),p={key:m,value:H.trim()}}p&&a.headers.push(p)}i.push(a)}return i}static decode(t){return this.decodeWithHeaders(t).map(e=>e.rawData)}static decodeFirst(t){const e=this.decode(t);if(!e.length)throw new RangeError("PEM string doesn't contain any objects");return e[0]}static encode(t,e){if(Array.isArray(t)){const i=new Array;return e?t.forEach(n=>{if(!A.isBufferSource(n))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");i.push(this.encodeStruct({type:e,rawData:A.toArrayBuffer(n)}))}):t.forEach(n=>{if(!("type"in n))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");i.push(this.encodeStruct(n))}),i.join("\n")}else{if(!e)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:e,rawData:A.toArrayBuffer(t)})}}static encodeStruct(t){var e;const i=t.type.toLocaleUpperCase(),n=[];if(n.push("-----BEGIN ".concat(i,"-----")),!((e=t.headers)===null||e===void 0)&&e.length){for(const p of t.headers)n.push("".concat(p.key,": ").concat(p.value));n.push("")}const s=E.ToBase64(t.rawData);let a,c=0;const u=Array();for(;c<s.length&&(s.length-c<64?a=s.substring(c):(a=s.substring(c,c+64),c+=64),a.length!==0)&&(u.push(a),!(a.length<64)););return n.push(...u),n.push("-----END ".concat(i,"-----")),n.join("\n")}}mt.CertificateTag="CERTIFICATE",mt.CrlTag="CRL",mt.CertificateRequestTag="CERTIFICATE REQUEST",mt.PublicKeyTag="PUBLIC KEY",mt.PrivateKeyTag="PRIVATE KEY";class Gt extends se{static isAsnEncoded(t){return A.isBufferSource(t)||typeof t=="string"}static toArrayBuffer(t){if(typeof t=="string"){if(mt.isPem(t))return mt.decode(t)[0];if(E.isHex(t))return E.FromHex(t);if(E.isBase64(t))return E.FromBase64(t);if(E.isBase64Url(t))return E.FromBase64Url(t);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const e=A.toUint8Array(t);if(e.length>0&&e[0]===48)return A.toArrayBuffer(t);const i=E.ToBinary(t);if(mt.isPem(i))return mt.decode(i)[0];if(E.isHex(i))return E.FromHex(i);if(E.isBase64(i))return E.FromBase64(i);if(E.isBase64Url(i))return E.FromBase64Url(i);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...t){Gt.isAsnEncoded(t[0])?super(Gt.toArrayBuffer(t[0]),t[1]):super(t[0])}toString(t="pem"){switch(t){case"pem":return mt.encode(this.rawData,this.tag);default:return super.toString(t)}}}class Lt extends Gt{static async create(t,e=at.get()){if(t instanceof Lt)return t;if(te.isCryptoKey(t)){if(t.type!=="public")throw new TypeError("Public key is required");const i=await e.subtle.exportKey("spki",t);return new Lt(i)}else{if(t.publicKey)return t.publicKey;if(A.isBufferSource(t))return new Lt(t);throw new TypeError("Unsupported PublicKeyType")}}constructor(t){Gt.isAsnEncoded(t)?super(t,Rt):super(t),this.tag=mt.PublicKeyTag}async export(...t){let e,i=["verify"],n=P({hash:"SHA-256"},this.algorithm);t.length>1?(n=t[0]||n,i=t[1]||i,e=t[2]||at.get()):e=t[0]||at.get();let s=this.rawData;const a=S.parse(this.rawData,Rt);return a.algorithm.algorithm===Fr&&(s=wf(a,s)),e.subtle.importKey("spki",s,n,!0,i)}onInit(t){const e=lt.resolve(tr),i=this.algorithm=e.toWebAlgorithm(t.algorithm);switch(t.algorithm.algorithm){case we:{const n=S.parse(t.subjectPublicKey,Uo),s=A.toUint8Array(n.modulus);i.publicExponent=A.toUint8Array(n.publicExponent),i.modulusLength=(s[0]?s:s.slice(1)).byteLength<<3;break}}}async getThumbprint(...t){var e;let i,n="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(n=t[0]||n,i=t[1]||at.get()):i=t[0]||at.get(),await i.subtle.digest(n,this.rawData)}async getKeyIdentifier(...t){let e,i="SHA-1";t.length===1?typeof t[0]=="string"?(i=t[0],e=at.get()):e=t[0]:t.length===2?(i=t[0],e=t[1]):e=at.get();const n=S.parse(this.rawData,Rt);return await e.subtle.digest(i,n.subjectPublicKey)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,Rt);switch(t.Algorithm=Ae.serializeAlgorithm(e.algorithm),e.algorithm.algorithm){case Qr:t["EC Point"]=e.subjectPublicKey;break;case we:default:t["Raw Data"]=e.subjectPublicKey}return t}}function wf(r,t){return r.algorithm=new k({algorithm:we,parameters:null}),t=S.serialize(r),t}class ei extends bt{static async create(t,e=!1,i=at.get()){if("name"in t&&"serialNumber"in t)return new ei(t,e);const n=await(await Lt.create(t,i)).getKeyIdentifier(i);return new ei(E.ToHex(n),e)}constructor(...t){if(A.isBufferSource(t[0]))super(t[0]);else if(typeof t[0]=="string"){const e=new le({keyIdentifier:new Qo(E.FromHex(t[0]))});super(Hs,t[1],S.serialize(e))}else{const e=t[0],i=e.name instanceof Be?S.parse(e.name.rawData,ot):e.name,n=new le({authorityCertIssuer:i,authorityCertSerialNumber:E.FromHex(e.serialNumber)});super(Hs,t[1],S.serialize(n))}}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,le);e.keyIdentifier&&(this.keyId=E.ToHex(e.keyIdentifier)),(e.authorityCertIssuer||e.authorityCertSerialNumber)&&(this.certId={name:e.authorityCertIssuer||[],serialNumber:e.authorityCertSerialNumber?E.ToHex(e.authorityCertSerialNumber):""})}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,le);return e.authorityCertIssuer&&(t["Authority Issuer"]=new Be(e.authorityCertIssuer).toTextObject()),e.authorityCertSerialNumber&&(t["Authority Serial Number"]=e.authorityCertSerialNumber),e.keyIdentifier&&(t[""]=e.keyIdentifier),t}}ei.NAME="Authority Key Identifier";class Wu extends bt{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,Qi);this.ca=e.cA,this.pathLength=e.pathLenConstraint}else{const e=new Qi({cA:t[0],pathLenConstraint:t[1]});super(vu,t[2],S.serialize(e)),this.ca=t[0],this.pathLength=t[1]}}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ca&&(t.CA=this.ca),this.pathLength!==void 0&&(t["Path Length"]=this.pathLength),t}}Wu.NAME="Basic Constraints";var $l;(function(r){r.serverAuth="1.3.6.1.5.5.7.3.1",r.clientAuth="1.3.6.1.5.5.7.3.2",r.codeSigning="1.3.6.1.5.5.7.3.3",r.emailProtection="1.3.6.1.5.5.7.3.4",r.timeStamping="1.3.6.1.5.5.7.3.8",r.ocspSigning="1.3.6.1.5.5.7.3.9"})($l||($l={}));class _u extends bt{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,rn);this.usages=e.map(i=>i)}else{const e=new rn(t[0]);super(bu,t[1],S.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.usages.map(e=>ne.toString(e)).join(", "),t}}_u.NAME="Extended Key Usages";var Fl;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Fl||(Fl={}));class qu extends bt{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,Xn);this.usages=e.toNumber()}else{const e=new Xn(t[0]);super(Su,t[1],S.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,Xn);return t[""]=e.toJSON().join(", "),t}}qu.NAME="Key Usages";class Fn extends bt{static async create(t,e=!1,i=at.get()){const n=await(await Lt.create(t,i)).getKeyIdentifier(i);return new Fn(E.ToHex(n),e)}constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,ie);this.keyId=E.ToHex(e)}else{const e=typeof t[0]=="string"?E.FromHex(t[0]):t[0],i=new ie(e);super(ku,t[1],S.serialize(i)),this.keyId=E.ToHex(e)}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,ie);return t[""]=e,t}}Fn.NAME="Subject Key Identifier";class zu extends bt{constructor(...t){A.isBufferSource(t[0])?super(t[0]):super(Bu,t[1],new Be(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,ro);this.names=new Be(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const i in e)t[i]=e[i];return t}}zu.NAME="Subject Alternative Name";class gt{static register(t,e){this.items.set(t,e)}static create(t){const e=new bt(t),i=this.items.get(e.type);return i?new i(t):e}}gt.items=new Map;class Wl extends bt{constructor(...t){var e;if(A.isBufferSource(t[0])){super(t[0]);const i=S.parse(this.value,en);this.policies=i.map(n=>n.policyIdentifier)}else{const i=t[0],n=(e=t[1])!==null&&e!==void 0?e:!1,s=new en(i.map(a=>new tn({policyIdentifier:a})));super(mu,n,S.serialize(s)),this.policies=i}}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Policy=this.policies.map(e=>new M("",{},ne.toString(e))),t}}Wl.NAME="Certificate Policies",gt.register(mu,Wl);class Ku extends bt{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else if(Array.isArray(t[0])&&typeof t[0][0]=="string"){const i=t[0].map(s=>new _e({distributionPoint:new ue({fullName:[new j({uniformResourceIdentifier:s})]})})),n=new qe(i);super(Gs,t[1],S.serialize(n))}else{const i=new qe(t[0]);super(Gs,t[1],S.serialize(i))}(e=this.distributionPoints)!==null&&e!==void 0||(this.distributionPoints=[])}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,qe);this.distributionPoints=e}toTextObject(){const t=this.toTextObjectWithoutValue();return t["Distribution Point"]=this.distributionPoints.map(e=>{var i;const n={};return e.distributionPoint&&(n[""]=(i=e.distributionPoint.fullName)===null||i===void 0?void 0:i.map(s=>new ee(s).toString()).join(", ")),e.reasons&&(n.Reasons=e.reasons.toString()),e.cRLIssuer&&(n["CRL Issuer"]=e.cRLIssuer.map(s=>s.toString()).join(", ")),n}),t}}Ku.NAME="CRL Distribution Points";class Gu extends bt{constructor(...t){var e,i,n,s;if(A.isBufferSource(t[0]))super(t[0]);else if(t[0]instanceof Le){const a=new Le(t[0]);super(Ds,t[1],S.serialize(a))}else{const a=t[0],c=new Le;gi(c,a,yc,"ocsp"),gi(c,a,dc,"caIssuers"),gi(c,a,gc,"timeStamping"),gi(c,a,vc,"caRepository"),super(Ds,t[1],S.serialize(c))}(e=this.ocsp)!==null&&e!==void 0||(this.ocsp=[]),(i=this.caIssuers)!==null&&i!==void 0||(this.caIssuers=[]),(n=this.timeStamping)!==null&&n!==void 0||(this.timeStamping=[]),(s=this.caRepository)!==null&&s!==void 0||(this.caRepository=[])}onInit(t){super.onInit(t),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],S.parse(t.extnValue,Le).forEach(e=>{switch(e.accessMethod){case yc:this.ocsp.push(new ee(e.accessLocation));break;case dc:this.caIssuers.push(new ee(e.accessLocation));break;case gc:this.timeStamping.push(new ee(e.accessLocation));break;case vc:this.caRepository.push(new ee(e.accessLocation));break}})}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ocsp.length&&di(t,"OCSP",this.ocsp),this.caIssuers.length&&di(t,"CA Issuers",this.caIssuers),this.timeStamping.length&&di(t,"Time Stamping",this.timeStamping),this.caRepository.length&&di(t,"CA Repository",this.caRepository),t}}Gu.NAME="Authority Info Access";function di(r,t,e){if(e.length===1)r[t]=e[0].toTextObject();else{const i=new M("");e.forEach((n,s)=>{const a=n.toTextObject(),c="".concat(a[M.NAME]," ").concat(s+1);let u=i[c];Array.isArray(u)||(u=[],i[c]=u),u.push(a)}),r[t]=i}}function gi(r,t,e,i){const n=t[i];n&&(Array.isArray(n)?n:[n]).forEach(s=>{typeof s=="string"&&(s=new ee("url",s)),r.push(new Yr({accessMethod:e,accessLocation:S.parse(s.rawData,j)}))})}class Ju extends bt{constructor(...t){A.isBufferSource(t[0])?super(t[0]):super(Au,t[1],new Be(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,ot);this.names=new Be(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const i in e)t[i]=e[i];return t}}Ju.NAME="Issuer Alternative Name";class nr extends se{constructor(...t){let e;if(A.isBufferSource(t[0]))e=A.toArrayBuffer(t[0]);else{const i=t[0],n=Array.isArray(t[1])?t[1].map(s=>A.toArrayBuffer(s)):[];e=S.serialize(new zt({type:i,values:n}))}super(e,zt)}onInit(t){this.type=t.type,this.values=t.values}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Value=this.values.map(e=>new M("",{"":e})),t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty();return t[M.NAME]===nr.NAME&&(t[M.NAME]=ne.toString(this.type)),t}}nr.NAME="Attribute";class Zu extends nr{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else{const i=new jn({printableString:t[0]});super(Lu,[S.serialize(i)])}(e=this.password)!==null&&e!==void 0||(this.password="")}onInit(t){if(super.onInit(t),this.values[0]){const e=S.parse(this.values[0],jn);this.password=e.toString()}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[M.VALUE]=this.password,t}}Zu.NAME="Challenge Password";class aa extends nr{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else{const i=t[0],n=new me;for(const s of i)n.push(S.parse(s.rawData,Et));super(oa,[S.serialize(n)])}(e=this.items)!==null&&e!==void 0||(this.items=[])}onInit(t){if(super.onInit(t),this.values[0]){const e=S.parse(this.values[0],me);this.items=e.map(i=>gt.create(S.serialize(i)))}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.items.map(i=>i.toTextObject());for(const i of e)t[i[M.NAME]]=i;return t}}aa.NAME="Extensions";class Pn{static register(t,e){this.items.set(t,e)}static create(t){const e=new nr(t),i=this.items.get(e.type);return i?new i(t):e}}Pn.items=new Map;const Rn="crypto.signatureFormatter";class bf{toAsnSignature(t,e){return A.toArrayBuffer(e)}toWebSignature(t,e){return A.toArrayBuffer(e)}}var Pi;let gs=Pi=class{static createPssParams(r,t){const e=Pi.getHashAlgorithm(r);return e?new ae({hashAlgorithm:e,maskGenAlgorithm:new k({algorithm:Hn,parameters:S.serialize(e)}),saltLength:t}):null}static getHashAlgorithm(r){const t=lt.resolve(tr);return typeof r=="string"?t.toAsnAlgorithm({name:r}):typeof r=="object"&&r&&"name"in r?t.toAsnAlgorithm(r):null}toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in r){let t;if(typeof r.hash=="string")t=r.hash;else if(r.hash&&typeof r.hash=="object"&&"name"in r.hash&&typeof r.hash.name=="string")t=r.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new k({algorithm:An,parameters:null});case"sha-256":return new k({algorithm:Io,parameters:null});case"sha-384":return new k({algorithm:Sn,parameters:null});case"sha-512":return new k({algorithm:Bn,parameters:null})}}else return new k({algorithm:we,parameters:null});break;case"rsa-pss":if("hash"in r){if(!("saltLength"in r&&typeof r.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=Pi.createPssParams(r.hash,r.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new k({algorithm:Fr,parameters:S.serialize(t)})}else return new k({algorithm:Fr,parameters:null})}return null}toWebAlgorithm(r){switch(r.algorithm){case we:return{name:"RSASSA-PKCS1-v1_5"};case An:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case Io:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case Sn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case Bn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case Fr:if(r.parameters){const t=S.parse(r.parameters,ae);return{name:"RSA-PSS",hash:lt.resolve(tr).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}else return{name:"RSA-PSS"}}return null}};gs=Pi=o([$n()],gs),lt.registerSingleton(ii,gs);let vs=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"sha-1":return new k({algorithm:kn});case"sha-256":return new k({algorithm:xn});case"sha-384":return new k({algorithm:On});case"sha-512":return new k({algorithm:Cn})}return null}toWebAlgorithm(r){switch(r.algorithm){case kn:return{name:"SHA-1"};case xn:return{name:"SHA-256"};case On:return{name:"SHA-384"};case Cn:return{name:"SHA-512"}}return null}};vs=o([$n()],vs),lt.registerSingleton(ii,vs);class St{addPadding(t,e){const i=A.toUint8Array(e),n=new Uint8Array(t);return n.set(i,t-i.length),n.buffer}removePadding(t,e=!1){let i=A.toUint8Array(t);for(let n=0;n<i.length;n++)if(i[n]){i=i.slice(n);break}if(e&&i[0]>127){const n=new Uint8Array(i.length+1);return n.set(i,1),n.buffer}return i.buffer}toAsnSignature(t,e){if(t.name==="ECDSA"){const i=t.namedCurve,n=St.namedCurveSize.get(i)||St.defaultNamedCurveSize,s=new bn,a=A.toUint8Array(e);return s.r=this.removePadding(a.slice(0,n),!0),s.s=this.removePadding(a.slice(n,n+n),!0),S.serialize(s)}return null}toWebSignature(t,e){if(t.name==="ECDSA"){const i=S.parse(e,bn),n=t.namedCurve,s=St.namedCurveSize.get(n)||St.defaultNamedCurveSize,a=this.addPadding(s,this.removePadding(i.r)),c=this.addPadding(s,this.removePadding(i.s));return Th(a,c)}return null}}St.namedCurveSize=new Map,St.defaultNamedCurveSize=32;const ms="1.3.101.110",_l="1.3.101.111",ws="1.3.101.112",ql="1.3.101.113";let bs=class{toAsnAlgorithm(r){let t=null;switch(r.name.toLowerCase()){case"ed25519":t=ws;break;case"x25519":t=ms;break;case"eddsa":switch(r.namedCurve.toLowerCase()){case"ed25519":t=ws;break;case"ed448":t=ql;break}break;case"ecdh-es":switch(r.namedCurve.toLowerCase()){case"x25519":t=ms;break;case"x448":t=_l;break}}return t?new k({algorithm:t}):null}toWebAlgorithm(r){switch(r.algorithm){case ws:return{name:"Ed25519"};case ql:return{name:"EdDSA",namedCurve:"Ed448"};case ms:return{name:"X25519"};case _l:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};bs=o([$n()],bs),lt.registerSingleton(ii,bs);var vr,mr,wr,br,Ar,Sr,Br,Pe;class Af extends Gt{get subjectName(){return U(this,mr,"f")||W(this,mr,new Se(this.asn.certificationRequestInfo.subject),"f"),U(this,mr,"f")}get subject(){return U(this,wr,"f")||W(this,wr,this.subjectName.toString(),"f"),U(this,wr,"f")}get signatureAlgorithm(){if(!U(this,br,"f")){const t=lt.resolve(tr);W(this,br,t.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return U(this,br,"f")}get signature(){return U(this,Ar,"f")||W(this,Ar,this.asn.signature,"f"),U(this,Ar,"f")}get publicKey(){return U(this,Sr,"f")||W(this,Sr,new Lt(this.asn.certificationRequestInfo.subjectPKInfo),"f"),U(this,Sr,"f")}get attributes(){return U(this,Br,"f")||W(this,Br,this.asn.certificationRequestInfo.attributes.map(t=>Pn.create(S.serialize(t))),"f"),U(this,Br,"f")}get extensions(){if(!U(this,Pe,"f")){W(this,Pe,[],"f");const t=this.getAttribute(oa);t instanceof aa&&W(this,Pe,t.items,"f")}return U(this,Pe,"f")}get tbs(){return U(this,vr,"f")||W(this,vr,this.asn.certificationRequestInfoRaw||S.serialize(this.asn.certificationRequestInfo),"f"),U(this,vr,"f")}constructor(t){const e=Gt.isAsnEncoded(t)?[t,_r]:[t];super(e[0],e[1]),vr.set(this,void 0),mr.set(this,void 0),wr.set(this,void 0),br.set(this,void 0),Ar.set(this,void 0),Sr.set(this,void 0),Br.set(this,void 0),Pe.set(this,void 0),this.tag=mt.CertificateRequestTag}onInit(t){}getAttribute(t){for(const e of this.attributes)if(e.type===t)return e;return null}getAttributes(t){return this.attributes.filter(e=>e.type===t)}getExtension(t){for(const e of this.extensions)if(e.type===t)return e;return null}getExtensions(t){return this.extensions.filter(e=>e.type===t)}async verify(t=at.get()){const e=P(P({},this.publicKey.algorithm),this.signatureAlgorithm),i=await this.publicKey.export(e,["verify"],t),n=lt.resolveAll(Rn).reverse();let s=null;for(const a of n)if(s=a.toWebSignature(e,this.signature),s)break;if(!s)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await t.subtle.verify(this.signatureAlgorithm,i,s,this.tbs)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,_r),i=e.certificationRequestInfo,n=new M("",{Version:"".concat(Ze[i.version]," (").concat(i.version,")"),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const s=new M("");for(const a of this.attributes){const c=a.toTextObject();s[c[M.NAME]]=c}n.Attributes=s}return t.Data=n,t.Signature=new M("",{Algorithm:Ae.serializeAlgorithm(e.signatureAlgorithm),"":e.signature}),t}}vr=new WeakMap,mr=new WeakMap,wr=new WeakMap,br=new WeakMap,Ar=new WeakMap,Sr=new WeakMap,Br=new WeakMap,Pe=new WeakMap,Af.NAME="PKCS#10 Certificate Request";var kr,xr,Or,Cr,Er,Nr,Ir,Tr,jr,Ur,Re,Pr;class Sf extends Gt{get publicKey(){return U(this,Pr,"f")||W(this,Pr,new Lt(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),U(this,Pr,"f")}get serialNumber(){if(!U(this,xr,"f")){const t=this.asn.tbsCertificate;let e=new Uint8Array(t.serialNumber);e.length>1&&e[0]===0&&e[1]>127&&(e=e.slice(1)),W(this,xr,E.ToHex(e),"f")}return U(this,xr,"f")}get subjectName(){return U(this,Or,"f")||W(this,Or,new Se(this.asn.tbsCertificate.subject),"f"),U(this,Or,"f")}get subject(){return U(this,Cr,"f")||W(this,Cr,this.subjectName.toString(),"f"),U(this,Cr,"f")}get issuerName(){return U(this,Er,"f")||W(this,Er,new Se(this.asn.tbsCertificate.issuer),"f"),U(this,Er,"f")}get issuer(){return U(this,Nr,"f")||W(this,Nr,this.issuerName.toString(),"f"),U(this,Nr,"f")}get notBefore(){if(!U(this,Ir,"f")){const t=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!t)throw new Error("Cannot get 'notBefore' value");W(this,Ir,t,"f")}return U(this,Ir,"f")}get notAfter(){if(!U(this,Tr,"f")){const t=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!t)throw new Error("Cannot get 'notAfter' value");W(this,Tr,t,"f")}return U(this,Tr,"f")}get signatureAlgorithm(){if(!U(this,jr,"f")){const t=lt.resolve(tr);W(this,jr,t.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return U(this,jr,"f")}get signature(){return U(this,Ur,"f")||W(this,Ur,this.asn.signatureValue,"f"),U(this,Ur,"f")}get extensions(){return U(this,Re,"f")||(W(this,Re,[],"f"),this.asn.tbsCertificate.extensions&&W(this,Re,this.asn.tbsCertificate.extensions.map(t=>gt.create(S.serialize(t))),"f")),U(this,Re,"f")}get tbs(){return U(this,kr,"f")||W(this,kr,this.asn.tbsCertificateRaw||S.serialize(this.asn.tbsCertificate),"f"),U(this,kr,"f")}constructor(t){const e=Gt.isAsnEncoded(t)?[t,ze]:[t];super(e[0],e[1]),kr.set(this,void 0),xr.set(this,void 0),Or.set(this,void 0),Cr.set(this,void 0),Er.set(this,void 0),Nr.set(this,void 0),Ir.set(this,void 0),Tr.set(this,void 0),jr.set(this,void 0),Ur.set(this,void 0),Re.set(this,void 0),Pr.set(this,void 0),this.tag=mt.CertificateTag}onInit(t){}getExtension(t){for(const e of this.extensions)if(typeof t=="string"){if(e.type===t)return e}else if(e instanceof t)return e;return null}getExtensions(t){return this.extensions.filter(e=>typeof t=="string"?e.type===t:e instanceof t)}async verify(t={},e=at.get()){let i,n;const s=t.publicKey;try{if(!s)i=P(P({},this.publicKey.algorithm),this.signatureAlgorithm),n=await this.publicKey.export(i,["verify"],e);else if("publicKey"in s)i=P(P({},s.publicKey.algorithm),this.signatureAlgorithm),n=await s.publicKey.export(i,["verify"],e);else if(s instanceof Lt)i=P(P({},s.algorithm),this.signatureAlgorithm),n=await s.export(i,["verify"],e);else if(A.isBufferSource(s)){const p=new Lt(s);i=P(P({},p.algorithm),this.signatureAlgorithm),n=await p.export(i,["verify"],e)}else i=P(P({},s.algorithm),this.signatureAlgorithm),n=s}catch(p){return!1}const a=lt.resolveAll(Rn).reverse();let c=null;for(const p of a)if(c=p.toWebSignature(i,this.signature),c)break;if(!c)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const u=await e.subtle.verify(this.signatureAlgorithm,n,c,this.tbs);if(t.signatureOnly)return u;{const p=(t.date||new Date).getTime();return u&&this.notBefore.getTime()<p&&p<this.notAfter.getTime()}}async getThumbprint(...t){let e,i="SHA-1";return t[0]&&(t[0].subtle?e=t[0]:(i=t[0]||i,e=t[1])),e!=null||(e=at.get()),await e.subtle.digest(i,this.rawData)}async isSelfSigned(t=at.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},t)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,ze),i=e.tbsCertificate,n=new M("",{Version:"".concat(Ze[i.version]," (").concat(i.version,")"),"Serial Number":i.serialNumber,"Signature Algorithm":Ae.serializeAlgorithm(i.signature),Issuer:this.issuer,Validity:new M("",{"Not Before":i.validity.notBefore.getTime(),"Not After":i.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(i.issuerUniqueID&&(n["Issuer Unique ID"]=i.issuerUniqueID),i.subjectUniqueID&&(n["Subject Unique ID"]=i.subjectUniqueID),this.extensions.length){const s=new M("");for(const a of this.extensions){const c=a.toTextObject();s[c[M.NAME]]=c}n.Extensions=s}return t.Data=n,t.Signature=new M("",{Algorithm:Ae.serializeAlgorithm(e.signatureAlgorithm),"":e.signatureValue}),t}}kr=new WeakMap,xr=new WeakMap,Or=new WeakMap,Cr=new WeakMap,Er=new WeakMap,Nr=new WeakMap,Ir=new WeakMap,Tr=new WeakMap,jr=new WeakMap,Ur=new WeakMap,Re=new WeakMap,Pr=new WeakMap,Sf.NAME="Certificate";var zl;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(zl||(zl={})),gt.register(vu,Wu),gt.register(bu,_u),gt.register(Su,qu),gt.register(ku,Fn),gt.register(Hs,ei),gt.register(Bu,zu),gt.register(Gs,Ku),gt.register(Ds,Gu),gt.register(Au,Ju),Pn.register(Lu,Zu),Pn.register(oa,aa),lt.registerSingleton(Rn,bf),lt.registerSingleton(Rn,St),St.namedCurveSize.set("P-256",32),St.namedCurveSize.set("K-256",32),St.namedCurveSize.set("P-384",48),St.namedCurveSize.set("P-521",66);export{ve as A,A as B,ct as C,Ki as D,Gi as E,Li as F,Ji as G,Ke as H,Ge as I,de as J,Of as K,ge as N,pe as O,Kr as P,Zi as R,Nt as S,Wi as T,Jr as U,_i as V,Sf as X,If as a,Qt as b,Uf as c,Mi as d,fe as e,We as f,xf as g,Zo as h,E as i,Vt as j,Nf as k,Uh as l,Kh as m,jf as n,Vi as o,Fi as p,Hi as q,qt as r,Tf as s,Ef as t,Cf as u,Di as v,qi as w,$i as x,zi as y,Gr as z};
//# sourceMappingURL=x509.es-CVBCxyxp.chunk.mjs.map
