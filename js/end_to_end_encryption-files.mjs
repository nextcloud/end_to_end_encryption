(function(){"use strict";try{if(typeof document<"u"){var i=document.createElement("style");i.appendChild(document.createTextNode("/*!\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */.toastify.dialogs{min-width:200px;background:none;background-color:var(--color-main-background);color:var(--color-main-text);box-shadow:0 0 6px 0 var(--color-box-shadow);padding:0 12px;margin-top:45px;position:fixed;z-index:10100;border-radius:var(--border-radius);display:flex;align-items:center;min-height:50px}.toastify.dialogs .toast-loader-container,.toastify.dialogs .toast-undo-container{display:flex;align-items:center;width:100%}.toastify.dialogs .toast-undo-button,.toastify.dialogs .toast-close{position:static;overflow:hidden;box-sizing:border-box;min-width:44px;height:100%;padding:12px;white-space:nowrap;background-repeat:no-repeat;background-position:center;background-color:transparent;min-height:0}.toastify.dialogs .toast-undo-button.toast-close,.toastify.dialogs .toast-close.toast-close{text-indent:0;opacity:.4;border:none;min-height:44px;margin-left:10px;font-size:0}.toastify.dialogs .toast-undo-button.toast-close:before,.toastify.dialogs .toast-close.toast-close:before{background-image:url(\"data:image/svg+xml,%3csvg%20viewBox='0%200%2016%2016'%20height='16'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='M6.4%2019%205%2017.6l5.6-5.6L5%206.4%206.4%205l5.6%205.6L17.6%205%2019%206.4%2013.4%2012l5.6%205.6-1.4%201.4-5.6-5.6L6.4%2019Z'%20style='fill-rule:nonzero'%20transform='matrix(.85714%200%200%20.85714%20-2.286%20-2.286)'/%3e%3c/svg%3e\");content:\" \";filter:var(--background-invert-if-dark);display:inline-block;width:16px;height:16px}.toastify.dialogs .toast-undo-button.toast-undo-button,.toastify.dialogs .toast-close.toast-undo-button{height:calc(100% - 6px);margin:3px 3px 3px 12px}.toastify.dialogs .toast-undo-button:hover,.toastify.dialogs .toast-undo-button:focus,.toastify.dialogs .toast-undo-button:active,.toastify.dialogs .toast-close:hover,.toastify.dialogs .toast-close:focus,.toastify.dialogs .toast-close:active{cursor:pointer;opacity:1}.toastify.dialogs.toastify-top{right:10px}.toastify.dialogs.toast-with-click{cursor:pointer}.toastify.dialogs.toast-error{border-left:3px solid var(--color-element-error, var(--color-error))}.toastify.dialogs.toast-info{border-left:3px solid var(--color-element-info, var(--color-primary))}.toastify.dialogs.toast-warning{border-left:3px solid var(--color-element-warning, var(--color-warning))}.toastify.dialogs.toast-success,.toastify.dialogs.toast-undo{border-left:3px solid var(--color-element-success, var(--color-success))}.toastify.dialogs.toast-loading{border-left:3px solid var(--color-element-info, var(--color-primary))}.toastify.dialogs.toast-loading .toast-loader{display:inline-block;width:20px;height:20px;animation:rotate var(--animation-duration, .8s) linear infinite;margin-left:auto}.theme--dark .toastify.dialogs .toast-close.toast-close:before{background-image:url(\"data:image/svg+xml,%3csvg%20viewBox='0%200%2016%2016'%20height='16'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2'%3e%3cpath%20d='M6.4%2019%205%2017.6l5.6-5.6L5%206.4%206.4%205l5.6%205.6L17.6%205%2019%206.4%2013.4%2012l5.6%205.6-1.4%201.4-5.6-5.6L6.4%2019Z'%20style='fill:%23fff;fill-rule:nonzero'%20transform='matrix(.85714%200%200%20.85714%20-2.286%20-2.286)'/%3e%3c/svg%3e\")}.nc-generic-dialog .dialog__actions{justify-content:space-between;min-width:calc(100% - 12px)}/*!\n * SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */._file-picker__file-icon_3v9zx_9{position:relative;width:32px;height:32px;min-width:32px;min-height:32px;background-repeat:no-repeat;background-size:contain;display:flex;justify-content:center}._file-picker__file-icon--primary_3v9zx_21{color:var(--color-primary-element)}._file-picker__file-icon-overlay_3v9zx_25{color:var(--color-primary-element-text);position:absolute;inset-block-start:10px}tr.file-picker__row[data-v-15187afc]{height:var(--row-height, 50px)}tr.file-picker__row td[data-v-15187afc]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;border-bottom:none}tr.file-picker__row td.row-checkbox[data-v-15187afc]{padding:0 2px}tr.file-picker__row td[data-v-15187afc]:not(.row-checkbox){padding-inline:14px 0}tr.file-picker__row td.row-size[data-v-15187afc]{text-align:end;padding-inline:0 14px}tr.file-picker__row td.row-name[data-v-15187afc]{padding-inline:2px 0}@keyframes gradient-15187afc{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.loading-row .row-checkbox[data-v-15187afc]{text-align:center!important}.loading-row span[data-v-15187afc]{display:inline-block;height:24px;background:linear-gradient(to right,var(--color-background-darker),var(--color-text-maxcontrast),var(--color-background-darker));background-size:600px 100%;border-radius:var(--border-radius);animation:gradient-15187afc 12s ease infinite}.loading-row .row-wrapper[data-v-15187afc]{display:inline-flex;align-items:center}.loading-row .row-checkbox span[data-v-15187afc]{width:24px}.loading-row .row-name span[data-v-15187afc]:last-of-type{margin-inline-start:6px;width:130px}.loading-row .row-size span[data-v-15187afc]{width:80px}.loading-row .row-modified span[data-v-15187afc]{width:90px}/*!\n* SPDX-FileCopyrightText: 2023-2024 Nextcloud GmbH and Nextcloud contributors\n* SPDX-License-Identifier: AGPL-3.0-or-later\n*/tr.file-picker__row[data-v-82f380c9]{height:var(--row-height, 50px)}tr.file-picker__row td[data-v-82f380c9]{cursor:pointer;overflow:hidden;text-overflow:ellipsis;border-bottom:none}tr.file-picker__row td.row-checkbox[data-v-82f380c9]{padding:0 2px}tr.file-picker__row td[data-v-82f380c9]:not(.row-checkbox){padding-inline:14px 0}tr.file-picker__row td.row-size[data-v-82f380c9]{text-align:end;padding-inline:0 14px}tr.file-picker__row td.row-name[data-v-82f380c9]{padding-inline:2px 0}.file-picker__row *[data-v-82f380c9]{cursor:pointer}.file-picker__row--selected[data-v-82f380c9]{background-color:var(--color-background-dark)}.file-picker__row--not-navigatable[data-v-82f380c9]{filter:saturate(.7);opacity:.7}.file-picker__row--not-navigatable *[data-v-82f380c9],.file-picker__row--not-pickable *[data-v-82f380c9]{cursor:default!important}.file-picker__row[data-v-82f380c9]:hover{background-color:var(--color-background-hover)}.file-picker__name-container[data-v-82f380c9]{display:flex;justify-content:start;align-items:center;height:100%}.file-picker__file-name[data-v-82f380c9]{padding-inline-start:6px;min-width:0;overflow:hidden;text-overflow:ellipsis}.file-picker__file-extension[data-v-82f380c9]{color:var(--color-text-maxcontrast);min-width:fit-content}.file-picker__header-preview[data-v-6503afab]{width:22px;height:32px;flex:0 0 auto}.file-picker__files[data-v-6503afab]{margin:2px;margin-inline-start:12px;overflow:scroll auto}.file-picker__files table[data-v-6503afab]{width:100%;max-height:100%;table-layout:fixed}.file-picker__files th[data-v-6503afab]{position:-webkit-sticky;position:sticky;z-index:1;top:0;background-color:var(--color-main-background);padding:2px}.file-picker__files th .header-wrapper[data-v-6503afab]{display:flex}.file-picker__files th.row-checkbox[data-v-6503afab]{width:44px}.file-picker__files th.row-name[data-v-6503afab]{width:230px}.file-picker__files th.row-size[data-v-6503afab]{width:100px}.file-picker__files th.row-modified[data-v-6503afab]{width:120px}.file-picker__files th[data-v-6503afab]:not(.row-size) .button-vue__wrapper{justify-content:start;flex-direction:row-reverse}.file-picker__files th[data-v-6503afab]:not(.row-size) .button-vue{padding-inline:16px 4px}.file-picker__files th.row-size[data-v-6503afab] .button-vue__wrapper{justify-content:end}.file-picker__files th[data-v-6503afab] .button-vue__wrapper{color:var(--color-text-maxcontrast)}.file-picker__files th[data-v-6503afab] .button-vue__wrapper .button-vue__text{font-weight:400}.file-picker__breadcrumbs[data-v-1a8cb0b2]{flex-grow:0!important}.file-picker__side[data-v-f5975252]{display:flex;flex-direction:column;align-items:stretch;gap:.5rem;min-width:200px;padding:2px;margin-block-start:7px;overflow:auto}.file-picker__side[data-v-f5975252] .button-vue__wrapper{justify-content:start}.file-picker__filter-input[data-v-f5975252]{margin-block:7px;max-width:260px}@media (max-width: 736px){.file-picker__side[data-v-f5975252]{flex-direction:row;min-width:unset}}@media (max-width: 512px){.file-picker__side[data-v-f5975252]{flex-direction:row;min-width:unset}.file-picker__filter-input[data-v-f5975252]{max-width:unset}}.file-picker__navigation{padding-inline:8px 2px}.file-picker__navigation,.file-picker__navigation *{box-sizing:border-box}.file-picker__navigation .v-select.select{min-width:220px}@media (min-width: 513px) and (max-width: 736px){.file-picker__navigation{gap:11px}}@media (max-width: 512px){.file-picker__navigation{flex-direction:column-reverse!important}}.file-picker__view[data-v-dda9b42b]{height:50px;display:flex;justify-content:start;align-items:center}.file-picker__view h3[data-v-dda9b42b]{font-weight:700;height:fit-content;margin:0}.file-picker__main[data-v-dda9b42b]{box-sizing:border-box;width:100%;display:flex;flex-direction:column;min-height:0;flex:1;padding-inline:2px}.file-picker__main *[data-v-dda9b42b]{box-sizing:border-box}[data-v-dda9b42b] .file-picker{height:min(80vh,800px)!important}@media (max-width: 512px){[data-v-dda9b42b] .file-picker{height:calc(100% - 16px - var(--default-clickable-area))!important}}[data-v-dda9b42b] .file-picker__content{display:flex;flex-direction:column;overflow:hidden}.public-auth-prompt__text[data-v-a2f36bdb]{font-size:1.25em;margin-block:0 calc(3 * var(--default-grid-baseline))}.public-auth-prompt__header[data-v-a2f36bdb]{margin-block:0 calc(3 * var(--default-grid-baseline))}.public-auth-prompt__header[data-v-a2f36bdb]:first-child{margin-top:0}.public-auth-prompt__input[data-v-a2f36bdb]{margin-block:calc(4 * var(--default-grid-baseline)) calc(2 * var(--default-grid-baseline))}.material-design-icon[data-v-ab8d7671]{display:flex;align-self:center;justify-self:center;align-items:center;justify-content:center}/*!\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */.input-field[data-v-ab8d7671]{--input-border-color: var(--color-border-maxcontrast);--input-border-radius: var(--border-radius-element);--input-padding-start: var(--border-radius-large);--input-padding-end: var(--border-radius-large);position:relative;width:100%;margin-block-start:6px}.input-field--disabled[data-v-ab8d7671]{opacity:.4;filter:saturate(.4)}.input-field--label-outside[data-v-ab8d7671]{margin-block-start:0}.input-field--leading-icon[data-v-ab8d7671]{--input-padding-start: calc(var(--default-clickable-area) - var(--default-grid-baseline))}.input-field--trailing-icon[data-v-ab8d7671]{--input-padding-end: calc(var(--default-clickable-area) - var(--default-grid-baseline))}.input-field--pill[data-v-ab8d7671]{--input-border-radius: var(--border-radius-pill)}.input-field__main-wrapper[data-v-ab8d7671]{height:var(--default-clickable-area);padding:var(--border-width-input-focused, 2px);position:relative}.input-field__input[data-v-ab8d7671]{--input-border-box-shadow-light: 0 -1px var(--input-border-color), 0 0 0 1px color-mix(in srgb, var(--input-border-color), 65% transparent);--input-border-box-shadow-dark: 0 1px var(--input-border-color), 0 0 0 1px color-mix(in srgb, var(--input-border-color), 65% transparent);--input-border-box-shadow: var(--input-border-box-shadow-light);border:none;border-radius:var(--border-radius-element);box-shadow:var(--input-border-box-shadow)}.input-field__input[data-v-ab8d7671]:hover:not([disabled]){box-shadow:0 0 0 1px var(--input-border-color)}@media (prefers-color-scheme: dark){.input-field__input .input-field__input[data-v-ab8d7671]{--input-border-box-shadow: var(--input-border-box-shadow-dark)}}[data-theme-dark] .input-field__input[data-v-ab8d7671]{--input-border-box-shadow: var(--input-border-box-shadow-dark)}[data-theme-light] .input-field__input[data-v-ab8d7671]{--input-border-box-shadow: var(--input-border-box-shadow-light)}.input-field--legacy .input-field__input[data-v-ab8d7671]{box-shadow:0 0 0 1px var(--input-border-color)}.input-field--legacy .input-field__input[data-v-ab8d7671]:hover:not([disabled]){box-shadow:0 0 0 2px var(--input-border-color)}.input-field__input[data-v-ab8d7671]:focus-within:not([disabled]),.input-field__input[data-v-ab8d7671]:active:not([disabled]){box-shadow:0 0 0 2px var(--input-border-color),0 0 0 4px var(--color-main-background)!important}.input-field__input[data-v-ab8d7671]{background-color:var(--color-main-background);color:var(--color-main-text);border-radius:var(--input-border-radius);cursor:pointer;-webkit-appearance:textfield!important;-moz-appearance:textfield!important;appearance:textfield!important;font-size:var(--default-font-size);text-overflow:ellipsis;padding-block:0;padding-inline:var(--input-padding-start) var(--input-padding-end);height:100%!important;min-height:unset;width:100%}.input-field__input[data-v-ab8d7671]::placeholder{color:var(--color-text-maxcontrast)}.input-field__input[data-v-ab8d7671]::-webkit-search-cancel-button{display:none}.input-field__input[data-v-ab8d7671]::-webkit-search-decoration,.input-field__input[data-v-ab8d7671]::-webkit-search-results-button,.input-field__input[data-v-ab8d7671]::-webkit-search-results-decoration,.input-field__input[data-v-ab8d7671]::-ms-clear{display:none}.input-field__input[data-v-ab8d7671]:active:not([disabled]),.input-field__input[data-v-ab8d7671]:focus:not([disabled]){--input-border-color: var(--color-main-text)}.input-field__input:focus+.input-field__label[data-v-ab8d7671],.input-field__input:hover:not(:placeholder-shown)+.input-field__label[data-v-ab8d7671]{color:var(--color-main-text)}.input-field__input[data-v-ab8d7671]:focus{cursor:text}.input-field__input[data-v-ab8d7671]:disabled{cursor:default}.input-field__input[data-v-ab8d7671]:focus-visible{box-shadow:unset!important}.input-field__input--success[data-v-ab8d7671]{border-color:var(--color-border-success, var(--color-success))!important}.input-field__input--success[data-v-ab8d7671]:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}.input-field__input--error[data-v-ab8d7671],.input-field__input[data-v-ab8d7671]:user-invalid{border-color:var(--color-border-error, var(--color-error))!important}.input-field__input--error[data-v-ab8d7671]:focus-visible,.input-field__input[data-v-ab8d7671]:user-invalid:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}.input-field:not(.input-field--label-outside) .input-field__input[data-v-ab8d7671]:not(:focus)::placeholder{opacity:0}.input-field__label[data-v-ab8d7671]{--input-label-font-size: var(--default-font-size);position:absolute;margin-inline:var(--input-padding-start) var(--input-padding-end);max-width:fit-content;font-size:var(--input-label-font-size);inset-block-start:calc((var(--default-clickable-area) - 1lh) / 2);inset-inline:var(--border-width-input-focused, 2px);color:var(--color-text-maxcontrast);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;pointer-events:none;transition:height var(--animation-quick),inset-block-start var(--animation-quick),font-size var(--animation-quick),color var(--animation-quick),background-color var(--animation-quick) var(--animation-slow)}.input-field__input:focus+.input-field__label[data-v-ab8d7671],.input-field__input:not(:placeholder-shown)+.input-field__label[data-v-ab8d7671]{--input-label-font-size: 13px;line-height:1.5;inset-block-start:calc(-1.5 * var(--input-label-font-size) / 2);font-weight:500;border-radius:var(--default-grid-baseline) var(--default-grid-baseline) 0 0;background-color:var(--color-main-background);padding-inline:var(--default-grid-baseline);margin-inline:calc(var(--input-padding-start) - var(--default-grid-baseline)) calc(var(--input-padding-end) - var(--default-grid-baseline));transition:height var(--animation-quick),inset-block-start var(--animation-quick),font-size var(--animation-quick),color var(--animation-quick)}.input-field__icon[data-v-ab8d7671]{position:absolute;height:var(--default-clickable-area);width:var(--default-clickable-area);display:flex;align-items:center;justify-content:center;opacity:.7;inset-block-end:0}.input-field__icon--leading[data-v-ab8d7671]{inset-inline-start:0px}.input-field__icon--trailing[data-v-ab8d7671]{inset-inline-end:0px}.input-field__trailing-button[data-v-ab8d7671]{--button-size: calc(var(--default-clickable-area) - 2 * var(--border-width-input-focused, 2px)) !important;--button-radius: calc(var(--input-border-radius) - var(--border-width-input-focused, 2px))}.input-field__trailing-button.button-vue[data-v-ab8d7671]{position:absolute;top:var(--border-width-input-focused, 2px);inset-inline-end:var(--border-width-input-focused, 2px)}.input-field__trailing-button.button-vue[data-v-ab8d7671]:focus-visible{box-shadow:none!important}.input-field__helper-text-message[data-v-ab8d7671]{padding-block:4px;padding-inline:var(--border-radius-large);display:flex;align-items:center;color:var(--color-text-maxcontrast)}.input-field__helper-text-message__icon[data-v-ab8d7671]{margin-inline-end:8px}.input-field__helper-text-message--error[data-v-ab8d7671]{color:var(--color-text-error, var(--color-error))}.input-field--error .input-field__input[data-v-ab8d7671],.input-field__input[data-v-ab8d7671]:user-invalid{--input-border-color: var(--color-border-error, var(--color-error)) !important}.input-field--error .input-field__input[data-v-ab8d7671]:focus-visible,.input-field__input[data-v-ab8d7671]:user-invalid:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}.input-field--success .input-field__input[data-v-ab8d7671]{--input-border-color: var(--color-border-success, var(--color-success)) !important}.input-field--success .input-field__input[data-v-ab8d7671]:focus-visible{box-shadow:#f8fafc 0 0 0 2px,var(--color-primary-element) 0 0 0 4px,#0000000d 0 1px 2px}")),document.head.appendChild(i)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}})();
var Vw=Object.defineProperty,xw=Object.defineProperties;var Bw=Object.getOwnPropertyDescriptors;var Rd=Object.getOwnPropertySymbols;var Pw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable;var Ld=s=>{throw TypeError(s)};var im=(s,e,t)=>e in s?Vw(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,ct=(s,e)=>{for(var t in e||(e={}))Pw.call(e,t)&&im(s,t,e[t]);if(Rd)for(var t of Rd(e))Ow.call(e,t)&&im(s,t,e[t]);return s},fs=(s,e)=>xw(s,Bw(e));var Fe=(s,e,t)=>im(s,typeof e!="symbol"?e+"":e,t),om=(s,e,t)=>e.has(s)||Ld("Cannot "+t);var q=(s,e,t)=>(om(s,e,"read from private field"),t?t.call(s):e.get(s)),Ot=(s,e,t)=>e.has(s)?Ld("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),De=(s,e,t,r)=>(om(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),Qs=(s,e,t)=>(om(s,e,"access private method"),t);import{p as ze,g as Tt,a as hf,b as ed,c as Dw,o as Tw,d as Rw,e as Lw,f as Uw,B as lm,h as ug,i as cg,n as Zh,N as jw,j as Ud,G as $w,l as Kw,r as Hw,k as Mw,m as Fw,q as Jw,s as qw,t as wc,u as Ww,v as _w,w as Gw,x as um,y as jd,z as mf,A as Xw,C as zw}from"./_plugin-vue2_normalizer-B-KrDPBh.chunk.mjs";import{f as $e,B as Se,s as Vo,a as xh,O as J,N as We,I as L,S as C,g as f,A as te,b as z,c as K,d as H,e as ce,C as P,R as se,h as Ve,P as ee,i as pe,j as _e,G as xe,k as ha,u as So,l as rc,m as Bh,t as ff,n as ac,o as Yw,p as Zw,q as $d,r as Kd,E as nc,U as df,v as Ph,w as pf,x as gf,y as Gc,z as Hs,T as wf,V as Qw,D as hg,F as ey,H as ty,J as sy,K as ry,X as ay,L as xo}from"./x509.es-B6WIgDe8.chunk.mjs";import{N as ny,a as iy,b as oy,s as ly}from"./NcCheckboxRadioSwitch-BF1M0HBu-BWJLZ4l3.chunk.mjs";import{u as mg}from"./useModelMigration-EhAWvqDD-Bi8JK8Au.chunk.mjs";function fg(s,e,t){var n;const r="#initial-state-".concat(s,"-").concat(e);if((n=window._nc_initial_state)!=null&&n.has(r))return window._nc_initial_state.get(r);window._nc_initial_state||(window._nc_initial_state=new Map);const a=document.querySelector(r);if(a===null)return t;try{const o=JSON.parse(atob(a.value));return window._nc_initial_state.set(r,o),o}catch(o){return console.error("[@nextcloud/initial-state] Could not parse initial state",{key:e,app:s,error:o}),t}}function dg(){var s;return(s=fg("files_sharing","isPublic",null))!=null?s:document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function uy(){var s,e,t;return(t=(e=fg("files_sharing","sharingToken",null))!=null?e:(s=document.querySelector('input#sharingToken[type="hidden"]'))==null?void 0:s.value)!=null?t:null}function ir(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Hd(s,e,t){cy(s,e),e.set(s,t)}function cy(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(s,e){var t=pg(s,e,"get");return hy(s,t)}function hy(s,e){return e.get?e.get.call(s):e.value}function Md(s,e,t){var r=pg(s,e,"set");return my(s,r,t),t}function pg(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function my(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var fy=typeof Symbol<"u"?Symbol.toStringTag:"@@toStringTag",ht=new WeakMap,Lo=new WeakMap;class Qh{constructor(e){var{executor:t=()=>{},internals:r=sd(),promise:a=new Promise((n,o)=>t(n,o,i=>{r.onCancelList.push(i)}))}=e;Hd(this,ht,{writable:!0,value:void 0}),Hd(this,Lo,{writable:!0,value:void 0}),ir(this,fy,"CancelablePromise"),this.cancel=this.cancel.bind(this),Md(this,ht,r),Md(this,Lo,a||new Promise((n,o)=>t(n,o,i=>{r.onCancelList.push(i)})))}then(e,t){return Xc(lt(this,Lo).then(yc(e,lt(this,ht)),yc(t,lt(this,ht))),lt(this,ht))}catch(e){return Xc(lt(this,Lo).catch(yc(e,lt(this,ht))),lt(this,ht))}finally(e,t){return t&&lt(this,ht).onCancelList.push(e),Xc(lt(this,Lo).finally(yc(()=>{if(e)return t&&(lt(this,ht).onCancelList=lt(this,ht).onCancelList.filter(r=>r!==e)),e()},lt(this,ht))),lt(this,ht))}cancel(){lt(this,ht).isCanceled=!0;var e=lt(this,ht).onCancelList;lt(this,ht).onCancelList=[];for(var t of e)if(typeof t=="function")try{t()}catch(r){console.error(r)}}isCanceled(){return lt(this,ht).isCanceled===!0}}class or extends Qh{constructor(e){super({executor:e})}}ir(or,"all",function(s){return vc(s,Promise.all(s))}),ir(or,"allSettled",function(s){return vc(s,Promise.allSettled(s))}),ir(or,"any",function(s){return vc(s,Promise.any(s))}),ir(or,"race",function(s){return vc(s,Promise.race(s))}),ir(or,"resolve",function(s){return Fd(Promise.resolve(s))}),ir(or,"reject",function(s){return Fd(Promise.reject(s))}),ir(or,"isCancelable",td);function Fd(s){return Xc(s,sd())}function td(s){return s instanceof or||s instanceof Qh}function yc(s,e){if(s)return t=>{if(!e.isCanceled){var r=s(t);return td(r)&&e.onCancelList.push(r.cancel),r}return t}}function Xc(s,e){return new Qh({internals:e,promise:s})}function vc(s,e){var t=sd();return t.onCancelList.push(()=>{for(var r of s)td(r)&&r.cancel()}),new Qh({internals:t,promise:e})}function sd(){return{isCanceled:!1,onCancelList:[]}}var cm={},dy={2:s=>{function e(a,n,o){a instanceof RegExp&&(a=t(a,o)),n instanceof RegExp&&(n=t(n,o));var i=r(a,n,o);return i&&{start:i[0],end:i[1],pre:o.slice(0,i[0]),body:o.slice(i[0]+a.length,i[1]),post:o.slice(i[1]+n.length)}}function t(a,n){var o=n.match(a);return o?o[0]:null}function r(a,n,o){var i,u,c,l,m,h=o.indexOf(a),g=o.indexOf(n,h+1),w=h;if(h>=0&&g>0){for(i=[],c=o.length;w>=0&&!m;)w==h?(i.push(w),h=o.indexOf(a,w+1)):i.length==1?m=[i.pop(),g]:((u=i.pop())<c&&(c=u,l=g),g=o.indexOf(n,w+1)),w=h<g&&h>=0?h:g;i.length&&(m=[c,l])}return m}s.exports=e,e.range=r},101:function(s,e,t){var r;s=t.nmd(s),function(a){var n=(s&&s.exports,typeof Tt=="object"&&Tt);n.global!==n&&n.window;var o=function(m){this.message=m};(o.prototype=new Error).name="InvalidCharacterError";var i=function(m){throw new o(m)},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,l={encode:function(m){m=String(m),/[^\0-\xFF]/.test(m)&&i("The string to be encoded contains characters outside of the Latin1 range.");for(var h,g,w,d,p=m.length%3,E="",y=-1,S=m.length-p;++y<S;)h=m.charCodeAt(y)<<16,g=m.charCodeAt(++y)<<8,w=m.charCodeAt(++y),E+=u.charAt((d=h+g+w)>>18&63)+u.charAt(d>>12&63)+u.charAt(d>>6&63)+u.charAt(63&d);return p==2?(h=m.charCodeAt(y)<<8,g=m.charCodeAt(++y),E+=u.charAt((d=h+g)>>10)+u.charAt(d>>4&63)+u.charAt(d<<2&63)+"="):p==1&&(d=m.charCodeAt(y),E+=u.charAt(d>>2)+u.charAt(d<<4&63)+"=="),E},decode:function(m){var h=(m=String(m).replace(c,"")).length;h%4==0&&(h=(m=m.replace(/==?$/,"")).length),(h%4==1||/[^+a-zA-Z0-9/]/.test(m))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var g,w,d=0,p="",E=-1;++E<h;)w=u.indexOf(m.charAt(E)),g=d%4?64*g+w:w,d++%4&&(p+=String.fromCharCode(255&g>>(-2*d&6)));return p},version:"1.0.0"};(r=function(){return l}.call(e,t,e,s))===void 0||(s.exports=r)}()},172:(s,e)=>{e.d=function(t){if(!t)return 0;for(var r=(t=t.toString()).length,a=t.length;a--;){var n=t.charCodeAt(a);56320<=n&&n<=57343&&a--,127<n&&n<=2047?r++:2047<n&&n<=65535&&(r+=2)}return r}},526:s=>{var e={utf8:{stringToBytes:function(t){return e.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(e.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var r=[],a=0;a<t.length;a++)r.push(255&t.charCodeAt(a));return r},bytesToString:function(t){for(var r=[],a=0;a<t.length;a++)r.push(String.fromCharCode(t[a]));return r.join("")}}};s.exports=e},298:s=>{var e,t;e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(r,a){return r<<a|r>>>32-a},rotr:function(r,a){return r<<32-a|r>>>a},endian:function(r){if(r.constructor==Number)return 16711935&t.rotl(r,8)|4278255360&t.rotl(r,24);for(var a=0;a<r.length;a++)r[a]=t.endian(r[a]);return r},randomBytes:function(r){for(var a=[];r>0;r--)a.push(Math.floor(256*Math.random()));return a},bytesToWords:function(r){for(var a=[],n=0,o=0;n<r.length;n++,o+=8)a[o>>>5]|=r[n]<<24-o%32;return a},wordsToBytes:function(r){for(var a=[],n=0;n<32*r.length;n+=8)a.push(r[n>>>5]>>>24-n%32&255);return a},bytesToHex:function(r){for(var a=[],n=0;n<r.length;n++)a.push((r[n]>>>4).toString(16)),a.push((15&r[n]).toString(16));return a.join("")},hexToBytes:function(r){for(var a=[],n=0;n<r.length;n+=2)a.push(parseInt(r.substr(n,2),16));return a},bytesToBase64:function(r){for(var a=[],n=0;n<r.length;n+=3)for(var o=r[n]<<16|r[n+1]<<8|r[n+2],i=0;i<4;i++)8*n+6*i<=8*r.length?a.push(e.charAt(o>>>6*(3-i)&63)):a.push("=");return a.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/gi,"");for(var a=[],n=0,o=0;n<r.length;o=++n%4)o!=0&&a.push((e.indexOf(r.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|e.indexOf(r.charAt(n))>>>6-2*o);return a}},s.exports=t},635:(s,e,t)=>{const r=t(31),a=t(338),n=t(221);s.exports={XMLParser:a,XMLValidator:r,XMLBuilder:n}},118:s=>{s.exports=function(e){return typeof e=="function"?e:Array.isArray(e)?t=>{for(const r of e)if(typeof r=="string"&&t===r||r instanceof RegExp&&r.test(t))return!0}:()=>!1}},705:(s,e)=>{const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+t+"]["+t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",a=new RegExp("^"+r+"$");e.isExist=function(n){return n!==void 0},e.isEmptyObject=function(n){return Object.keys(n).length===0},e.merge=function(n,o,i){if(o){const u=Object.keys(o),c=u.length;for(let l=0;l<c;l++)n[u[l]]=i==="strict"?[o[u[l]]]:o[u[l]]}},e.getValue=function(n){return e.isExist(n)?n:""},e.isName=function(n){return a.exec(n)!=null},e.getAllMatches=function(n,o){const i=[];let u=o.exec(n);for(;u;){const c=[];c.startIndex=o.lastIndex-u[0].length;const l=u.length;for(let m=0;m<l;m++)c.push(u[m]);i.push(c),u=o.exec(n)}return i},e.nameRegexp=r},31:(s,e,t)=>{const r=t(705),a={allowBooleanAttributes:!1,unpairedTags:[]};function n(y){return y===" "||y==="	"||y==="\n"||y==="\r"}function o(y,S){const N=S;for(;S<y.length;S++)if(!(y[S]!="?"&&y[S]!=" ")){const x=y.substr(N,S-N);if(S>5&&x==="xml")return w("InvalidXml","XML declaration allowed only at the start of the document.",p(y,S));if(y[S]=="?"&&y[S+1]==">"){S++;break}}return S}function i(y,S){if(y.length>S+5&&y[S+1]==="-"&&y[S+2]==="-"){for(S+=3;S<y.length;S++)if(y[S]==="-"&&y[S+1]==="-"&&y[S+2]===">"){S+=2;break}}else if(y.length>S+8&&y[S+1]==="D"&&y[S+2]==="O"&&y[S+3]==="C"&&y[S+4]==="T"&&y[S+5]==="Y"&&y[S+6]==="P"&&y[S+7]==="E"){let N=1;for(S+=8;S<y.length;S++)if(y[S]==="<")N++;else if(y[S]===">"&&(N--,N===0))break}else if(y.length>S+9&&y[S+1]==="["&&y[S+2]==="C"&&y[S+3]==="D"&&y[S+4]==="A"&&y[S+5]==="T"&&y[S+6]==="A"&&y[S+7]==="["){for(S+=8;S<y.length;S++)if(y[S]==="]"&&y[S+1]==="]"&&y[S+2]===">"){S+=2;break}}return S}e.validate=function(y,S){S=Object.assign({},a,S);const N=[];let x=!1,I=!1;y[0]==="\uFEFF"&&(y=y.substr(1));for(let V=0;V<y.length;V++)if(y[V]==="<"&&y[V+1]==="?"){if(V+=2,V=o(y,V),V.err)return V}else{if(y[V]!=="<"){if(n(y[V]))continue;return w("InvalidChar","char '"+y[V]+"' is not expected.",p(y,V))}{let k=V;if(V++,y[V]==="!"){V=i(y,V);continue}{let M=!1;y[V]==="/"&&(M=!0,V++);let j="";for(;V<y.length&&y[V]!==">"&&y[V]!==" "&&y[V]!=="	"&&y[V]!=="\n"&&y[V]!=="\r";V++)j+=y[V];if(j=j.trim(),j[j.length-1]==="/"&&(j=j.substring(0,j.length-1),V--),D=j,!r.isName(D)){let Y;return Y=j.trim().length===0?"Invalid space after '<'.":"Tag '"+j+"' is an invalid name.",w("InvalidTag",Y,p(y,V))}const F=l(y,V);if(F===!1)return w("InvalidAttr","Attributes for '"+j+"' have open quote.",p(y,V));let T=F.value;if(V=F.index,T[T.length-1]==="/"){const Y=V-T.length;T=T.substring(0,T.length-1);const _=h(T,S);if(_!==!0)return w(_.err.code,_.err.msg,p(y,Y+_.err.line));x=!0}else if(M){if(!F.tagClosed)return w("InvalidTag","Closing tag '"+j+"' doesn't have proper closing.",p(y,V));if(T.trim().length>0)return w("InvalidTag","Closing tag '"+j+"' can't have attributes or invalid starting.",p(y,k));if(N.length===0)return w("InvalidTag","Closing tag '"+j+"' has not been opened.",p(y,k));{const Y=N.pop();if(j!==Y.tagName){let _=p(y,Y.tagStartPos);return w("InvalidTag","Expected closing tag '"+Y.tagName+"' (opened in line "+_.line+", col "+_.col+") instead of closing tag '"+j+"'.",p(y,k))}N.length==0&&(I=!0)}}else{const Y=h(T,S);if(Y!==!0)return w(Y.err.code,Y.err.msg,p(y,V-T.length+Y.err.line));if(I===!0)return w("InvalidXml","Multiple possible root nodes found.",p(y,V));S.unpairedTags.indexOf(j)!==-1||N.push({tagName:j,tagStartPos:k}),x=!0}for(V++;V<y.length;V++)if(y[V]==="<"){if(y[V+1]==="!"){V++,V=i(y,V);continue}if(y[V+1]!=="?")break;if(V=o(y,++V),V.err)return V}else if(y[V]==="&"){const Y=g(y,V);if(Y==-1)return w("InvalidChar","char '&' is not expected.",p(y,V));V=Y}else if(I===!0&&!n(y[V]))return w("InvalidXml","Extra text at the end",p(y,V));y[V]==="<"&&V--}}}var D;return x?N.length==1?w("InvalidTag","Unclosed tag '"+N[0].tagName+"'.",p(y,N[0].tagStartPos)):!(N.length>0)||w("InvalidXml","Invalid '"+JSON.stringify(N.map(V=>V.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):w("InvalidXml","Start tag expected.",1)};const u='"',c="'";function l(y,S){let N="",x="",I=!1;for(;S<y.length;S++){if(y[S]===u||y[S]===c)x===""?x=y[S]:x!==y[S]||(x="");else if(y[S]===">"&&x===""){I=!0;break}N+=y[S]}return x===""&&{value:N,index:S,tagClosed:I}}const m=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function h(y,S){const N=r.getAllMatches(y,m),x={};for(let I=0;I<N.length;I++){if(N[I][1].length===0)return w("InvalidAttr","Attribute '"+N[I][2]+"' has no space in starting.",E(N[I]));if(N[I][3]!==void 0&&N[I][4]===void 0)return w("InvalidAttr","Attribute '"+N[I][2]+"' is without value.",E(N[I]));if(N[I][3]===void 0&&!S.allowBooleanAttributes)return w("InvalidAttr","boolean attribute '"+N[I][2]+"' is not allowed.",E(N[I]));const D=N[I][2];if(!d(D))return w("InvalidAttr","Attribute '"+D+"' is an invalid name.",E(N[I]));if(x.hasOwnProperty(D))return w("InvalidAttr","Attribute '"+D+"' is repeated.",E(N[I]));x[D]=1}return!0}function g(y,S){if(y[++S]===";")return-1;if(y[S]==="#")return function(x,I){let D=/\d/;for(x[I]==="x"&&(I++,D=/[\da-fA-F]/);I<x.length;I++){if(x[I]===";")return I;if(!x[I].match(D))break}return-1}(y,++S);let N=0;for(;S<y.length;S++,N++)if(!(y[S].match(/\w/)&&N<20)){if(y[S]===";")break;return-1}return S}function w(y,S,N){return{err:{code:y,msg:S,line:N.line||N,col:N.col}}}function d(y){return r.isName(y)}function p(y,S){const N=y.substring(0,S).split(/\r?\n/);return{line:N.length,col:N[N.length-1].length+1}}function E(y){return y.startIndex+y[1].length}},221:(s,e,t)=>{const r=t(87),a=t(118),n={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(l,m){return m},attributeValueProcessor:function(l,m){return m},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function o(l){this.options=Object.assign({},n,l),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=a(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=c),this.processTextOrObjNode=i,this.options.format?(this.indentate=u,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function i(l,m,h,g){const w=this.j2x(l,h+1,g.concat(m));return l[this.options.textNodeName]!==void 0&&Object.keys(l).length===1?this.buildTextValNode(l[this.options.textNodeName],m,w.attrStr,h):this.buildObjectNode(w.val,m,w.attrStr,h)}function u(l){return this.options.indentBy.repeat(l)}function c(l){return!(!l.startsWith(this.options.attributeNamePrefix)||l===this.options.textNodeName)&&l.substr(this.attrPrefixLen)}o.prototype.build=function(l){return this.options.preserveOrder?r(l,this.options):(Array.isArray(l)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(l={[this.options.arrayNodeName]:l}),this.j2x(l,0,[]).val)},o.prototype.j2x=function(l,m,h){let g="",w="";const d=h.join(".");for(let p in l)if(Object.prototype.hasOwnProperty.call(l,p))if(l[p]===void 0)this.isAttribute(p)&&(w+="");else if(l[p]===null)this.isAttribute(p)?w+="":p[0]==="?"?w+=this.indentate(m)+"<"+p+"?"+this.tagEndChar:w+=this.indentate(m)+"<"+p+"/"+this.tagEndChar;else if(l[p]instanceof Date)w+=this.buildTextValNode(l[p],p,"",m);else if(typeof l[p]!="object"){const E=this.isAttribute(p);if(E&&!this.ignoreAttributesFn(E,d))g+=this.buildAttrPairStr(E,""+l[p]);else if(!E)if(p===this.options.textNodeName){let y=this.options.tagValueProcessor(p,""+l[p]);w+=this.replaceEntitiesValue(y)}else w+=this.buildTextValNode(l[p],p,"",m)}else if(Array.isArray(l[p])){const E=l[p].length;let y="",S="";for(let N=0;N<E;N++){const x=l[p][N];if(x!==void 0)if(x===null)p[0]==="?"?w+=this.indentate(m)+"<"+p+"?"+this.tagEndChar:w+=this.indentate(m)+"<"+p+"/"+this.tagEndChar;else if(typeof x=="object")if(this.options.oneListGroup){const I=this.j2x(x,m+1,h.concat(p));y+=I.val,this.options.attributesGroupName&&x.hasOwnProperty(this.options.attributesGroupName)&&(S+=I.attrStr)}else y+=this.processTextOrObjNode(x,p,m,h);else if(this.options.oneListGroup){let I=this.options.tagValueProcessor(p,x);I=this.replaceEntitiesValue(I),y+=I}else y+=this.buildTextValNode(x,p,"",m)}this.options.oneListGroup&&(y=this.buildObjectNode(y,p,S,m)),w+=y}else if(this.options.attributesGroupName&&p===this.options.attributesGroupName){const E=Object.keys(l[p]),y=E.length;for(let S=0;S<y;S++)g+=this.buildAttrPairStr(E[S],""+l[p][E[S]])}else w+=this.processTextOrObjNode(l[p],p,m,h);return{attrStr:g,val:w}},o.prototype.buildAttrPairStr=function(l,m){return m=this.options.attributeValueProcessor(l,""+m),m=this.replaceEntitiesValue(m),this.options.suppressBooleanAttributes&&m==="true"?" "+l:" "+l+'="'+m+'"'},o.prototype.buildObjectNode=function(l,m,h,g){if(l==="")return m[0]==="?"?this.indentate(g)+"<"+m+h+"?"+this.tagEndChar:this.indentate(g)+"<"+m+h+this.closeTag(m)+this.tagEndChar;{let w="</"+m+this.tagEndChar,d="";return m[0]==="?"&&(d="?",w=""),!h&&h!==""||l.indexOf("<")!==-1?this.options.commentPropName!==!1&&m===this.options.commentPropName&&d.length===0?this.indentate(g)+"<!--".concat(l,"-->")+this.newLine:this.indentate(g)+"<"+m+h+d+this.tagEndChar+l+this.indentate(g)+w:this.indentate(g)+"<"+m+h+d+">"+l+w}},o.prototype.closeTag=function(l){let m="";return this.options.unpairedTags.indexOf(l)!==-1?this.options.suppressUnpairedNode||(m="/"):m=this.options.suppressEmptyNode?"/":"></".concat(l),m},o.prototype.buildTextValNode=function(l,m,h,g){if(this.options.cdataPropName!==!1&&m===this.options.cdataPropName)return this.indentate(g)+"<![CDATA[".concat(l,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&m===this.options.commentPropName)return this.indentate(g)+"<!--".concat(l,"-->")+this.newLine;if(m[0]==="?")return this.indentate(g)+"<"+m+h+"?"+this.tagEndChar;{let w=this.options.tagValueProcessor(m,l);return w=this.replaceEntitiesValue(w),w===""?this.indentate(g)+"<"+m+h+this.closeTag(m)+this.tagEndChar:this.indentate(g)+"<"+m+h+">"+w+"</"+m+this.tagEndChar}},o.prototype.replaceEntitiesValue=function(l){if(l&&l.length>0&&this.options.processEntities)for(let m=0;m<this.options.entities.length;m++){const h=this.options.entities[m];l=l.replace(h.regex,h.val)}return l},s.exports=o},87:s=>{function e(o,i,u,c){let l="",m=!1;for(let h=0;h<o.length;h++){const g=o[h],w=t(g);if(w===void 0)continue;let d="";if(d=u.length===0?w:"".concat(u,".").concat(w),w===i.textNodeName){let S=g[w];a(d,i)||(S=i.tagValueProcessor(w,S),S=n(S,i)),m&&(l+=c),l+=S,m=!1;continue}if(w===i.cdataPropName){m&&(l+=c),l+="<![CDATA[".concat(g[w][0][i.textNodeName],"]]>"),m=!1;continue}if(w===i.commentPropName){l+=c+"<!--".concat(g[w][0][i.textNodeName],"-->"),m=!0;continue}if(w[0]==="?"){const S=r(g[":@"],i),N=w==="?xml"?"":c;let x=g[w][0][i.textNodeName];x=x.length!==0?" "+x:"",l+=N+"<".concat(w).concat(x).concat(S,"?>"),m=!0;continue}let p=c;p!==""&&(p+=i.indentBy);const E=c+"<".concat(w).concat(r(g[":@"],i)),y=e(g[w],i,d,p);i.unpairedTags.indexOf(w)!==-1?i.suppressUnpairedNode?l+=E+">":l+=E+"/>":y&&y.length!==0||!i.suppressEmptyNode?y&&y.endsWith(">")?l+=E+">".concat(y).concat(c,"</").concat(w,">"):(l+=E+">",y&&c!==""&&(y.includes("/>")||y.includes("</"))?l+=c+i.indentBy+y+c:l+=y,l+="</".concat(w,">")):l+=E+"/>",m=!0}return l}function t(o){const i=Object.keys(o);for(let u=0;u<i.length;u++){const c=i[u];if(o.hasOwnProperty(c)&&c!==":@")return c}}function r(o,i){let u="";if(o&&!i.ignoreAttributes)for(let c in o){if(!o.hasOwnProperty(c))continue;let l=i.attributeValueProcessor(c,o[c]);l=n(l,i),l===!0&&i.suppressBooleanAttributes?u+=" ".concat(c.substr(i.attributeNamePrefix.length)):u+=" ".concat(c.substr(i.attributeNamePrefix.length),'="').concat(l,'"')}return u}function a(o,i){let u=(o=o.substr(0,o.length-i.textNodeName.length-1)).substr(o.lastIndexOf(".")+1);for(let c in i.stopNodes)if(i.stopNodes[c]===o||i.stopNodes[c]==="*."+u)return!0;return!1}function n(o,i){if(o&&o.length>0&&i.processEntities)for(let u=0;u<i.entities.length;u++){const c=i.entities[u];o=o.replace(c.regex,c.val)}return o}s.exports=function(o,i){let u="";return i.format&&i.indentBy.length>0&&(u="\n"),e(o,i,"",u)}},193:(s,e,t)=>{const r=t(705);function a(m,h){let g="";for(;h<m.length&&m[h]!=="'"&&m[h]!=='"';h++)g+=m[h];if(g=g.trim(),g.indexOf(" ")!==-1)throw new Error("External entites are not supported");const w=m[h++];let d="";for(;h<m.length&&m[h]!==w;h++)d+=m[h];return[g,d,h]}function n(m,h){return m[h+1]==="!"&&m[h+2]==="-"&&m[h+3]==="-"}function o(m,h){return m[h+1]==="!"&&m[h+2]==="E"&&m[h+3]==="N"&&m[h+4]==="T"&&m[h+5]==="I"&&m[h+6]==="T"&&m[h+7]==="Y"}function i(m,h){return m[h+1]==="!"&&m[h+2]==="E"&&m[h+3]==="L"&&m[h+4]==="E"&&m[h+5]==="M"&&m[h+6]==="E"&&m[h+7]==="N"&&m[h+8]==="T"}function u(m,h){return m[h+1]==="!"&&m[h+2]==="A"&&m[h+3]==="T"&&m[h+4]==="T"&&m[h+5]==="L"&&m[h+6]==="I"&&m[h+7]==="S"&&m[h+8]==="T"}function c(m,h){return m[h+1]==="!"&&m[h+2]==="N"&&m[h+3]==="O"&&m[h+4]==="T"&&m[h+5]==="A"&&m[h+6]==="T"&&m[h+7]==="I"&&m[h+8]==="O"&&m[h+9]==="N"}function l(m){if(r.isName(m))return m;throw new Error("Invalid entity name ".concat(m))}s.exports=function(m,h){const g={};if(m[h+3]!=="O"||m[h+4]!=="C"||m[h+5]!=="T"||m[h+6]!=="Y"||m[h+7]!=="P"||m[h+8]!=="E")throw new Error("Invalid Tag instead of DOCTYPE");{h+=9;let w=1,d=!1,p=!1,E="";for(;h<m.length;h++)if(m[h]!=="<"||p)if(m[h]===">"){if(p?m[h-1]==="-"&&m[h-2]==="-"&&(p=!1,w--):w--,w===0)break}else m[h]==="["?d=!0:E+=m[h];else{if(d&&o(m,h)){let y,S;h+=7,[y,S,h]=a(m,h+1),S.indexOf("&")===-1&&(g[l(y)]={regx:RegExp("&".concat(y,";"),"g"),val:S})}else if(d&&i(m,h))h+=8;else if(d&&u(m,h))h+=8;else if(d&&c(m,h))h+=9;else{if(!n)throw new Error("Invalid DOCTYPE");p=!0}w++,E=""}if(w!==0)throw new Error("Unclosed DOCTYPE")}return{entities:g,i:h}}},63:(s,e)=>{const t={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,a){return a},attributeValueProcessor:function(r,a){return a},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,a,n){return r}};e.buildOptions=function(r){return Object.assign({},t,r)},e.defaultOptions=t},299:(s,e,t)=>{const r=t(705),a=t(365),n=t(193),o=t(494),i=t(118);function u(I){const D=Object.keys(I);for(let V=0;V<D.length;V++){const k=D[V];this.lastEntities[k]={regex:new RegExp("&"+k+";","g"),val:I[k]}}}function c(I,D,V,k,M,j,F){if(I!==void 0&&(this.options.trimValues&&!k&&(I=I.trim()),I.length>0)){F||(I=this.replaceEntitiesValue(I));const T=this.options.tagValueProcessor(D,I,V,M,j);return T==null?I:typeof T!=typeof I||T!==I?T:this.options.trimValues||I.trim()===I?x(I,this.options.parseTagValue,this.options.numberParseOptions):I}}function l(I){if(this.options.removeNSPrefix){const D=I.split(":"),V=I.charAt(0)==="/"?"/":"";if(D[0]==="xmlns")return"";D.length===2&&(I=V+D[1])}return I}const m=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function h(I,D,V){if(this.options.ignoreAttributes!==!0&&typeof I=="string"){const k=r.getAllMatches(I,m),M=k.length,j={};for(let F=0;F<M;F++){const T=this.resolveNameSpace(k[F][1]);if(this.ignoreAttributesFn(T,D))continue;let Y=k[F][4],_=this.options.attributeNamePrefix+T;if(T.length)if(this.options.transformAttributeName&&(_=this.options.transformAttributeName(_)),_==="__proto__"&&(_="#__proto__"),Y!==void 0){this.options.trimValues&&(Y=Y.trim()),Y=this.replaceEntitiesValue(Y);const ie=this.options.attributeValueProcessor(T,Y,D);j[_]=ie==null?Y:typeof ie!=typeof Y||ie!==Y?ie:x(Y,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(j[_]=!0)}if(!Object.keys(j).length)return;if(this.options.attributesGroupName){const F={};return F[this.options.attributesGroupName]=j,F}return j}}const g=function(I){I=I.replace(/\r\n?/g,"\n");const D=new a("!xml");let V=D,k="",M="";for(let j=0;j<I.length;j++)if(I[j]==="<")if(I[j+1]==="/"){const F=y(I,">",j,"Closing Tag is not closed.");let T=I.substring(j+2,F).trim();if(this.options.removeNSPrefix){const ie=T.indexOf(":");ie!==-1&&(T=T.substr(ie+1))}this.options.transformTagName&&(T=this.options.transformTagName(T)),V&&(k=this.saveTextToParentTag(k,V,M));const Y=M.substring(M.lastIndexOf(".")+1);if(T&&this.options.unpairedTags.indexOf(T)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(T,">"));let _=0;Y&&this.options.unpairedTags.indexOf(Y)!==-1?(_=M.lastIndexOf(".",M.lastIndexOf(".")-1),this.tagsNodeStack.pop()):_=M.lastIndexOf("."),M=M.substring(0,_),V=this.tagsNodeStack.pop(),k="",j=F}else if(I[j+1]==="?"){let F=S(I,j,!1,"?>");if(!F)throw new Error("Pi Tag is not closed.");if(k=this.saveTextToParentTag(k,V,M),!(this.options.ignoreDeclaration&&F.tagName==="?xml"||this.options.ignorePiTags)){const T=new a(F.tagName);T.add(this.options.textNodeName,""),F.tagName!==F.tagExp&&F.attrExpPresent&&(T[":@"]=this.buildAttributesMap(F.tagExp,M,F.tagName)),this.addChild(V,T,M)}j=F.closeIndex+1}else if(I.substr(j+1,3)==="!--"){const F=y(I,"-->",j+4,"Comment is not closed.");if(this.options.commentPropName){const T=I.substring(j+4,F-2);k=this.saveTextToParentTag(k,V,M),V.add(this.options.commentPropName,[{[this.options.textNodeName]:T}])}j=F}else if(I.substr(j+1,2)==="!D"){const F=n(I,j);this.docTypeEntities=F.entities,j=F.i}else if(I.substr(j+1,2)==="!["){const F=y(I,"]]>",j,"CDATA is not closed.")-2,T=I.substring(j+9,F);k=this.saveTextToParentTag(k,V,M);let Y=this.parseTextData(T,V.tagname,M,!0,!1,!0,!0);Y==null&&(Y=""),this.options.cdataPropName?V.add(this.options.cdataPropName,[{[this.options.textNodeName]:T}]):V.add(this.options.textNodeName,Y),j=F+2}else{let F=S(I,j,this.options.removeNSPrefix),T=F.tagName;const Y=F.rawTagName;let _=F.tagExp,ie=F.attrExpPresent,Z=F.closeIndex;this.options.transformTagName&&(T=this.options.transformTagName(T)),V&&k&&V.tagname!=="!xml"&&(k=this.saveTextToParentTag(k,V,M,!1));const me=V;if(me&&this.options.unpairedTags.indexOf(me.tagname)!==-1&&(V=this.tagsNodeStack.pop(),M=M.substring(0,M.lastIndexOf("."))),T!==D.tagname&&(M+=M?"."+T:T),this.isItStopNode(this.options.stopNodes,M,T)){let Q="";if(_.length>0&&_.lastIndexOf("/")===_.length-1)T[T.length-1]==="/"?(T=T.substr(0,T.length-1),M=M.substr(0,M.length-1),_=T):_=_.substr(0,_.length-1),j=F.closeIndex;else if(this.options.unpairedTags.indexOf(T)!==-1)j=F.closeIndex;else{const G=this.readStopNodeData(I,Y,Z+1);if(!G)throw new Error("Unexpected end of ".concat(Y));j=G.i,Q=G.tagContent}const X=new a(T);T!==_&&ie&&(X[":@"]=this.buildAttributesMap(_,M,T)),Q&&(Q=this.parseTextData(Q,T,M,!0,ie,!0,!0)),M=M.substr(0,M.lastIndexOf(".")),X.add(this.options.textNodeName,Q),this.addChild(V,X,M)}else{if(_.length>0&&_.lastIndexOf("/")===_.length-1){T[T.length-1]==="/"?(T=T.substr(0,T.length-1),M=M.substr(0,M.length-1),_=T):_=_.substr(0,_.length-1),this.options.transformTagName&&(T=this.options.transformTagName(T));const Q=new a(T);T!==_&&ie&&(Q[":@"]=this.buildAttributesMap(_,M,T)),this.addChild(V,Q,M),M=M.substr(0,M.lastIndexOf("."))}else{const Q=new a(T);this.tagsNodeStack.push(V),T!==_&&ie&&(Q[":@"]=this.buildAttributesMap(_,M,T)),this.addChild(V,Q,M),V=Q}k="",j=Z}}else k+=I[j];return D.child};function w(I,D,V){const k=this.options.updateTag(D.tagname,V,D[":@"]);k===!1||(typeof k=="string"&&(D.tagname=k),I.addChild(D))}const d=function(I){if(this.options.processEntities){for(let D in this.docTypeEntities){const V=this.docTypeEntities[D];I=I.replace(V.regx,V.val)}for(let D in this.lastEntities){const V=this.lastEntities[D];I=I.replace(V.regex,V.val)}if(this.options.htmlEntities)for(let D in this.htmlEntities){const V=this.htmlEntities[D];I=I.replace(V.regex,V.val)}I=I.replace(this.ampEntity.regex,this.ampEntity.val)}return I};function p(I,D,V,k){return I&&(k===void 0&&(k=Object.keys(D.child).length===0),(I=this.parseTextData(I,D.tagname,V,!1,!!D[":@"]&&Object.keys(D[":@"]).length!==0,k))!==void 0&&I!==""&&D.add(this.options.textNodeName,I),I=""),I}function E(I,D,V){const k="*."+V;for(const M in I){const j=I[M];if(k===j||D===j)return!0}return!1}function y(I,D,V,k){const M=I.indexOf(D,V);if(M===-1)throw new Error(k);return M+D.length-1}function S(I,D,V){const k=function(ie,Z){let me,Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:">",X="";for(let G=Z;G<ie.length;G++){let W=ie[G];if(me)W===me&&(me="");else if(W==='"'||W==="'")me=W;else if(W===Q[0]){if(!Q[1])return{data:X,index:G};if(ie[G+1]===Q[1])return{data:X,index:G}}else W==="	"&&(W=" ");X+=W}}(I,D+1,arguments.length>3&&arguments[3]!==void 0?arguments[3]:">");if(!k)return;let M=k.data;const j=k.index,F=M.search(/\s/);let T=M,Y=!0;F!==-1&&(T=M.substring(0,F),M=M.substring(F+1).trimStart());const _=T;if(V){const ie=T.indexOf(":");ie!==-1&&(T=T.substr(ie+1),Y=T!==k.data.substr(ie+1))}return{tagName:T,tagExp:M,closeIndex:j,attrExpPresent:Y,rawTagName:_}}function N(I,D,V){const k=V;let M=1;for(;V<I.length;V++)if(I[V]==="<")if(I[V+1]==="/"){const j=y(I,">",V,"".concat(D," is not closed"));if(I.substring(V+2,j).trim()===D&&(M--,M===0))return{tagContent:I.substring(k,V),i:j};V=j}else if(I[V+1]==="?")V=y(I,"?>",V+1,"StopNode is not closed.");else if(I.substr(V+1,3)==="!--")V=y(I,"-->",V+3,"StopNode is not closed.");else if(I.substr(V+1,2)==="![")V=y(I,"]]>",V,"StopNode is not closed.")-2;else{const j=S(I,V,">");j&&((j&&j.tagName)===D&&j.tagExp[j.tagExp.length-1]!=="/"&&M++,V=j.closeIndex)}}function x(I,D,V){if(D&&typeof I=="string"){const k=I.trim();return k==="true"||k!=="false"&&o(I,V)}return r.isExist(I)?I:""}s.exports=class{constructor(I){this.options=I,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(D,V)=>String.fromCharCode(Number.parseInt(V,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(D,V)=>String.fromCharCode(Number.parseInt(V,16))}},this.addExternalEntities=u,this.parseXml=g,this.parseTextData=c,this.resolveNameSpace=l,this.buildAttributesMap=h,this.isItStopNode=E,this.replaceEntitiesValue=d,this.readStopNodeData=N,this.saveTextToParentTag=p,this.addChild=w,this.ignoreAttributesFn=i(this.options.ignoreAttributes)}}},338:(s,e,t)=>{const{buildOptions:r}=t(63),a=t(299),{prettify:n}=t(728),o=t(31);s.exports=class{constructor(i){this.externalEntities={},this.options=r(i)}parse(i,u){if(typeof i!="string"){if(!i.toString)throw new Error("XML data is accepted in String or Bytes[] form.");i=i.toString()}if(u){u===!0&&(u={});const m=o.validate(i,u);if(m!==!0)throw Error("".concat(m.err.msg,":").concat(m.err.line,":").concat(m.err.col))}const c=new a(this.options);c.addExternalEntities(this.externalEntities);const l=c.parseXml(i);return this.options.preserveOrder||l===void 0?l:n(l,this.options)}addEntity(i,u){if(u.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(i.indexOf("&")!==-1||i.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(u==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[i]=u}}},728:(s,e)=>{function t(o,i,u){let c;const l={};for(let m=0;m<o.length;m++){const h=o[m],g=r(h);let w="";if(w=u===void 0?g:u+"."+g,g===i.textNodeName)c===void 0?c=h[g]:c+=""+h[g];else{if(g===void 0)continue;if(h[g]){let d=t(h[g],i,w);const p=n(d,i);h[":@"]?a(d,h[":@"],w,i):Object.keys(d).length!==1||d[i.textNodeName]===void 0||i.alwaysCreateTextNode?Object.keys(d).length===0&&(i.alwaysCreateTextNode?d[i.textNodeName]="":d=""):d=d[i.textNodeName],l[g]!==void 0&&l.hasOwnProperty(g)?(Array.isArray(l[g])||(l[g]=[l[g]]),l[g].push(d)):i.isArray(g,w,p)?l[g]=[d]:l[g]=d}}}return typeof c=="string"?c.length>0&&(l[i.textNodeName]=c):c!==void 0&&(l[i.textNodeName]=c),l}function r(o){const i=Object.keys(o);for(let u=0;u<i.length;u++){const c=i[u];if(c!==":@")return c}}function a(o,i,u,c){if(i){const l=Object.keys(i),m=l.length;for(let h=0;h<m;h++){const g=l[h];c.isArray(g,u+"."+g,!0,!0)?o[g]=[i[g]]:o[g]=i[g]}}}function n(o,i){const{textNodeName:u}=i,c=Object.keys(o).length;return c===0||!(c!==1||!o[u]&&typeof o[u]!="boolean"&&o[u]!==0)}e.prettify=function(o,i){return t(o,i)}},365:s=>{s.exports=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}},135:s=>{function e(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}s.exports=function(t){return t!=null&&(e(t)||function(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&e(r.slice(0,0))}(t)||!!t._isBuffer)}},542:(s,e,t)=>{(function(){var r=t(298),a=t(526).utf8,n=t(135),o=t(526).bin,i=function(u,c){u.constructor==String?u=c&&c.encoding==="binary"?o.stringToBytes(u):a.stringToBytes(u):n(u)?u=Array.prototype.slice.call(u,0):Array.isArray(u)||u.constructor===Uint8Array||(u=u.toString());for(var l=r.bytesToWords(u),m=8*u.length,h=1732584193,g=-271733879,w=-1732584194,d=271733878,p=0;p<l.length;p++)l[p]=16711935&(l[p]<<8|l[p]>>>24)|4278255360&(l[p]<<24|l[p]>>>8);l[m>>>5]|=128<<m%32,l[14+(m+64>>>9<<4)]=m;var E=i._ff,y=i._gg,S=i._hh,N=i._ii;for(p=0;p<l.length;p+=16){var x=h,I=g,D=w,V=d;h=E(h,g,w,d,l[p+0],7,-680876936),d=E(d,h,g,w,l[p+1],12,-389564586),w=E(w,d,h,g,l[p+2],17,606105819),g=E(g,w,d,h,l[p+3],22,-1044525330),h=E(h,g,w,d,l[p+4],7,-176418897),d=E(d,h,g,w,l[p+5],12,1200080426),w=E(w,d,h,g,l[p+6],17,-1473231341),g=E(g,w,d,h,l[p+7],22,-45705983),h=E(h,g,w,d,l[p+8],7,1770035416),d=E(d,h,g,w,l[p+9],12,-1958414417),w=E(w,d,h,g,l[p+10],17,-42063),g=E(g,w,d,h,l[p+11],22,-1990404162),h=E(h,g,w,d,l[p+12],7,1804603682),d=E(d,h,g,w,l[p+13],12,-40341101),w=E(w,d,h,g,l[p+14],17,-1502002290),h=y(h,g=E(g,w,d,h,l[p+15],22,1236535329),w,d,l[p+1],5,-165796510),d=y(d,h,g,w,l[p+6],9,-1069501632),w=y(w,d,h,g,l[p+11],14,643717713),g=y(g,w,d,h,l[p+0],20,-373897302),h=y(h,g,w,d,l[p+5],5,-701558691),d=y(d,h,g,w,l[p+10],9,38016083),w=y(w,d,h,g,l[p+15],14,-660478335),g=y(g,w,d,h,l[p+4],20,-405537848),h=y(h,g,w,d,l[p+9],5,568446438),d=y(d,h,g,w,l[p+14],9,-1019803690),w=y(w,d,h,g,l[p+3],14,-187363961),g=y(g,w,d,h,l[p+8],20,1163531501),h=y(h,g,w,d,l[p+13],5,-1444681467),d=y(d,h,g,w,l[p+2],9,-51403784),w=y(w,d,h,g,l[p+7],14,1735328473),h=S(h,g=y(g,w,d,h,l[p+12],20,-1926607734),w,d,l[p+5],4,-378558),d=S(d,h,g,w,l[p+8],11,-2022574463),w=S(w,d,h,g,l[p+11],16,1839030562),g=S(g,w,d,h,l[p+14],23,-35309556),h=S(h,g,w,d,l[p+1],4,-1530992060),d=S(d,h,g,w,l[p+4],11,1272893353),w=S(w,d,h,g,l[p+7],16,-155497632),g=S(g,w,d,h,l[p+10],23,-1094730640),h=S(h,g,w,d,l[p+13],4,681279174),d=S(d,h,g,w,l[p+0],11,-358537222),w=S(w,d,h,g,l[p+3],16,-722521979),g=S(g,w,d,h,l[p+6],23,76029189),h=S(h,g,w,d,l[p+9],4,-640364487),d=S(d,h,g,w,l[p+12],11,-421815835),w=S(w,d,h,g,l[p+15],16,530742520),h=N(h,g=S(g,w,d,h,l[p+2],23,-995338651),w,d,l[p+0],6,-198630844),d=N(d,h,g,w,l[p+7],10,1126891415),w=N(w,d,h,g,l[p+14],15,-1416354905),g=N(g,w,d,h,l[p+5],21,-57434055),h=N(h,g,w,d,l[p+12],6,1700485571),d=N(d,h,g,w,l[p+3],10,-1894986606),w=N(w,d,h,g,l[p+10],15,-1051523),g=N(g,w,d,h,l[p+1],21,-2054922799),h=N(h,g,w,d,l[p+8],6,1873313359),d=N(d,h,g,w,l[p+15],10,-30611744),w=N(w,d,h,g,l[p+6],15,-1560198380),g=N(g,w,d,h,l[p+13],21,1309151649),h=N(h,g,w,d,l[p+4],6,-145523070),d=N(d,h,g,w,l[p+11],10,-1120210379),w=N(w,d,h,g,l[p+2],15,718787259),g=N(g,w,d,h,l[p+9],21,-343485551),h=h+x>>>0,g=g+I>>>0,w=w+D>>>0,d=d+V>>>0}return r.endian([h,g,w,d])};i._ff=function(u,c,l,m,h,g,w){var d=u+(c&l|~c&m)+(h>>>0)+w;return(d<<g|d>>>32-g)+c},i._gg=function(u,c,l,m,h,g,w){var d=u+(c&m|l&~m)+(h>>>0)+w;return(d<<g|d>>>32-g)+c},i._hh=function(u,c,l,m,h,g,w){var d=u+(c^l^m)+(h>>>0)+w;return(d<<g|d>>>32-g)+c},i._ii=function(u,c,l,m,h,g,w){var d=u+(l^(c|~m))+(h>>>0)+w;return(d<<g|d>>>32-g)+c},i._blocksize=16,i._digestsize=16,s.exports=function(u,c){if(u==null)throw new Error("Illegal argument "+u);var l=r.wordsToBytes(i(u,c));return c&&c.asBytes?l:c&&c.asString?o.bytesToString(l):r.bytesToHex(l)}})()},285:(s,e,t)=>{var r=t(2);s.exports=function(E){return E?(E.substr(0,2)==="{}"&&(E="\\{\\}"+E.substr(2)),p(function(y){return y.split("\\\\").join(a).split("\\{").join(n).split("\\}").join(o).split("\\,").join(i).split("\\.").join(u)}(E),!0).map(l)):[]};var a="\0SLASH"+Math.random()+"\0",n="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",i="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function c(E){return parseInt(E,10)==E?parseInt(E,10):E.charCodeAt(0)}function l(E){return E.split(a).join("\\").split(n).join("{").split(o).join("}").split(i).join(",").split(u).join(".")}function m(E){if(!E)return[""];var y=[],S=r("{","}",E);if(!S)return E.split(",");var N=S.pre,x=S.body,I=S.post,D=N.split(",");D[D.length-1]+="{"+x+"}";var V=m(I);return I.length&&(D[D.length-1]+=V.shift(),D.push.apply(D,V)),y.push.apply(y,D),y}function h(E){return"{"+E+"}"}function g(E){return/^-?0\d/.test(E)}function w(E,y){return E<=y}function d(E,y){return E>=y}function p(E,y){var S=[],N=r("{","}",E);if(!N)return[E];var x=N.pre,I=N.post.length?p(N.post,!1):[""];if(/\$$/.test(N.pre))for(var D=0;D<I.length;D++){var V=x+"{"+N.body+"}"+I[D];S.push(V)}else{var k,M,j=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(N.body),F=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(N.body),T=j||F,Y=N.body.indexOf(",")>=0;if(!T&&!Y)return N.post.match(/,.*\}/)?p(E=N.pre+"{"+N.body+o+N.post):[E];if(T)k=N.body.split(/\.\./);else if((k=m(N.body)).length===1&&(k=p(k[0],!1).map(h)).length===1)return I.map(function(Lt){return N.pre+k[0]+Lt});if(T){var _=c(k[0]),ie=c(k[1]),Z=Math.max(k[0].length,k[1].length),me=k.length==3?Math.abs(c(k[2])):1,Q=w;ie<_&&(me*=-1,Q=d);var X=k.some(g);M=[];for(var G=_;Q(G,ie);G+=me){var W;if(F)(W=String.fromCharCode(G))==="\\"&&(W="");else if(W=String(G),X){var re=Z-W.length;if(re>0){var le=new Array(re+1).join("0");W=G<0?"-"+le+W.slice(1):le+W}}M.push(W)}}else{M=[];for(var Ne=0;Ne<k.length;Ne++)M.push.apply(M,p(k[Ne],!1))}for(Ne=0;Ne<M.length;Ne++)for(D=0;D<I.length;D++)V=x+M[Ne]+I[D],(!y||T||V)&&S.push(V)}return S}},829:s=>{function e(c){return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},e(c)}function t(c){var l=typeof Map=="function"?new Map:void 0;return t=function(m){if(m===null||(h=m,Function.toString.call(h).indexOf("[native code]")===-1))return m;var h;if(typeof m!="function")throw new TypeError("Super expression must either be null or a function");if(l!==void 0){if(l.has(m))return l.get(m);l.set(m,g)}function g(){return r(m,arguments,n(this).constructor)}return g.prototype=Object.create(m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),a(g,m)},t(c)}function r(c,l,m){return r=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}()?Reflect.construct:function(h,g,w){var d=[null];d.push.apply(d,g);var p=new(Function.bind.apply(h,d));return w&&a(p,w.prototype),p},r.apply(null,arguments)}function a(c,l){return a=Object.setPrototypeOf||function(m,h){return m.__proto__=h,m},a(c,l)}function n(c){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},n(c)}var o=function(c){function l(m){var h;return function(g,w){if(!(g instanceof w))throw new TypeError("Cannot call a class as a function")}(this,l),(h=function(g,w){return!w||e(w)!=="object"&&typeof w!="function"?function(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}(g):w}(this,n(l).call(this,m))).name="ObjectPrototypeMutationError",h}return function(m,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(h&&h.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),h&&a(m,h)}(l,c),l}(t(Error));function i(c,l){for(var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},h=l.split("."),g=h.length,w=function(E){var y=h[E];if(!c)return{v:void 0};if(y==="+"){if(Array.isArray(c))return{v:c.map(function(N,x){var I=h.slice(E+1);return I.length>0?i(N,I.join("."),m):m(c,x,h,E)})};var S=h.slice(0,E).join(".");throw new Error("Object at wildcard (".concat(S,") is not an array"))}c=m(c,y,h,E)},d=0;d<g;d++){var p=w(d);if(e(p)==="object")return p.v}return c}function u(c,l){return c.length===l+1}s.exports={set:function(c,l,m){if(e(c)!="object"||c===null||l===void 0)return c;if(typeof l=="number")return c[l]=m,c[l];try{return i(c,l,function(h,g,w,d){if(h===Reflect.getPrototypeOf({}))throw new o("Attempting to mutate Object.prototype");if(!h[g]){var p=Number.isInteger(Number(w[d+1])),E=w[d+1]==="+";h[g]=p||E?[]:{}}return u(w,d)&&(h[g]=m),h[g]})}catch(h){if(h instanceof o)throw h;return c}},get:function(c,l){if(e(c)!="object"||c===null||l===void 0)return c;if(typeof l=="number")return c[l];try{return i(c,l,function(m,h){return m[h]})}catch(m){return c}},has:function(c,l){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e(c)!="object"||c===null||l===void 0)return!1;if(typeof l=="number")return l in c;try{var h=!1;return i(c,l,function(g,w,d,p){if(!u(d,p))return g&&g[w];h=m.own?g.hasOwnProperty(w):w in g}),h}catch(g){return!1}},hasOwn:function(c,l,m){return this.has(c,l,m||{own:!0})},isIn:function(c,l,m){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(e(c)!="object"||c===null||l===void 0)return!1;try{var g=!1,w=!1;return i(c,l,function(d,p,E,y){return g=g||d===m||!!d&&d[p]===m,w=u(E,y)&&e(d)==="object"&&p in d,d&&d[p]}),h.validPath?g&&w:g}catch(d){return!1}},ObjectPrototypeMutationError:o}},47:(s,e,t)=>{var r=t(410),a=function(c){return typeof c=="string"};function n(c,l){for(var m=[],h=0;h<c.length;h++){var g=c[h];g&&g!=="."&&(g===".."?m.length&&m[m.length-1]!==".."?m.pop():l&&m.push(".."):m.push(g))}return m}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i={};function u(c){return o.exec(c).slice(1)}i.resolve=function(){for(var c="",l=!1,m=arguments.length-1;m>=-1&&!l;m--){var h=m>=0?arguments[m]:ze.cwd();if(!a(h))throw new TypeError("Arguments to path.resolve must be strings");h&&(c=h+"/"+c,l=h.charAt(0)==="/")}return(l?"/":"")+(c=n(c.split("/"),!l).join("/"))||"."},i.normalize=function(c){var l=i.isAbsolute(c),m=c.substr(-1)==="/";return(c=n(c.split("/"),!l).join("/"))||l||(c="."),c&&m&&(c+="/"),(l?"/":"")+c},i.isAbsolute=function(c){return c.charAt(0)==="/"},i.join=function(){for(var c="",l=0;l<arguments.length;l++){var m=arguments[l];if(!a(m))throw new TypeError("Arguments to path.join must be strings");m&&(c+=c?"/"+m:m)}return i.normalize(c)},i.relative=function(c,l){function m(y){for(var S=0;S<y.length&&y[S]==="";S++);for(var N=y.length-1;N>=0&&y[N]==="";N--);return S>N?[]:y.slice(S,N+1)}c=i.resolve(c).substr(1),l=i.resolve(l).substr(1);for(var h=m(c.split("/")),g=m(l.split("/")),w=Math.min(h.length,g.length),d=w,p=0;p<w;p++)if(h[p]!==g[p]){d=p;break}var E=[];for(p=d;p<h.length;p++)E.push("..");return(E=E.concat(g.slice(d))).join("/")},i._makeLong=function(c){return c},i.dirname=function(c){var l=u(c),m=l[0],h=l[1];return m||h?(h&&(h=h.substr(0,h.length-1)),m+h):"."},i.basename=function(c,l){var m=u(c)[2];return l&&m.substr(-1*l.length)===l&&(m=m.substr(0,m.length-l.length)),m},i.extname=function(c){return u(c)[3]},i.format=function(c){if(!r.isObject(c))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof c);var l=c.root||"";if(!a(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof c.root);return(c.dir?c.dir+i.sep:"")+(c.base||"")},i.parse=function(c){if(!a(c))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof c);var l=u(c);if(!l||l.length!==4)throw new TypeError("Invalid path '"+c+"'");return l[1]=l[1]||"",l[2]=l[2]||"",l[3]=l[3]||"",{root:l[0],dir:l[0]+l[1].slice(0,l[1].length-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},i.sep="/",i.delimiter=":",s.exports=i},647:(s,e)=>{var t=Object.prototype.hasOwnProperty;function r(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch(o){return null}}function a(n){try{return encodeURIComponent(n)}catch(o){return null}}e.stringify=function(n,o){o=o||"";var i,u,c=[];for(u in typeof o!="string"&&(o="?"),n)if(t.call(n,u)){if((i=n[u])||i!=null&&!isNaN(i)||(i=""),u=a(u),i=a(i),u===null||i===null)continue;c.push(u+"="+i)}return c.length?o+c.join("&"):""},e.parse=function(n){for(var o,i=/([^=?#&]+)=?([^&]*)/g,u={};o=i.exec(n);){var c=r(o[1]),l=r(o[2]);c===null||l===null||c in u||(u[c]=l)}return u}},670:s=>{s.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}},494:s=>{const e=/^[-+]?0x[a-fA-F0-9]+$/,t=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const r={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};s.exports=function(a){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n=Object.assign({},r,n),!a||typeof a!="string")return a;let o=a.trim();if(n.skipLike!==void 0&&n.skipLike.test(o))return a;if(n.hex&&e.test(o))return Number.parseInt(o,16);{const u=t.exec(o);if(u){const c=u[1],l=u[2];let m=((i=u[3])&&i.indexOf(".")!==-1&&((i=i.replace(/0+$/,""))==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i);const h=u[4]||u[6];if(!n.leadingZeros&&l.length>0&&c&&o[2]!=="."||!n.leadingZeros&&l.length>0&&!c&&o[1]!==".")return a;{const g=Number(o),w=""+g;return w.search(/[eE]/)!==-1||h?n.eNotation?g:a:o.indexOf(".")!==-1?w==="0"&&m===""||w===m||c&&w==="-"+m?g:a:l?m===w||c+m===w?g:a:o===w||o===c+w?g:a}}return a}var i}},737:(s,e,t)=>{var r=t(670),a=t(647),n=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,u=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,l=/^[a-zA-Z]:/;function m(y){return(y||"").toString().replace(n,"")}var h=[["#","hash"],["?","query"],function(y,S){return d(S.protocol)?y.replace(/\\/g,"/"):y},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],g={hash:1,query:1};function w(y){var S,N=(typeof window<"u"?window:typeof Tt<"u"?Tt:typeof self<"u"?self:{}).location||{},x={},I=typeof(y=y||N);if(y.protocol==="blob:")x=new E(unescape(y.pathname),{});else if(I==="string")for(S in x=new E(y,{}),g)delete x[S];else if(I==="object"){for(S in y)S in g||(x[S]=y[S]);x.slashes===void 0&&(x.slashes=i.test(y.href))}return x}function d(y){return y==="file:"||y==="ftp:"||y==="http:"||y==="https:"||y==="ws:"||y==="wss:"}function p(y,S){y=(y=m(y)).replace(o,""),S=S||{};var N,x=c.exec(y),I=x[1]?x[1].toLowerCase():"",D=!!x[2],V=!!x[3],k=0;return D?V?(N=x[2]+x[3]+x[4],k=x[2].length+x[3].length):(N=x[2]+x[4],k=x[2].length):V?(N=x[3]+x[4],k=x[3].length):N=x[4],I==="file:"?k>=2&&(N=N.slice(2)):d(I)?N=x[4]:I?D&&(N=N.slice(2)):k>=2&&d(S.protocol)&&(N=x[4]),{protocol:I,slashes:D||d(I),slashesCount:k,rest:N}}function E(y,S,N){if(y=(y=m(y)).replace(o,""),!(this instanceof E))return new E(y,S,N);var x,I,D,V,k,M,j=h.slice(),F=typeof S,T=this,Y=0;for(F!=="object"&&F!=="string"&&(N=S,S=null),N&&typeof N!="function"&&(N=a.parse),x=!(I=p(y||"",S=w(S))).protocol&&!I.slashes,T.slashes=I.slashes||x&&S.slashes,T.protocol=I.protocol||S.protocol||"",y=I.rest,(I.protocol==="file:"&&(I.slashesCount!==2||l.test(y))||!I.slashes&&(I.protocol||I.slashesCount<2||!d(T.protocol)))&&(j[3]=[/(.*)/,"pathname"]);Y<j.length;Y++)typeof(V=j[Y])!="function"?(D=V[0],M=V[1],D!=D?T[M]=y:typeof D=="string"?~(k=D==="@"?y.lastIndexOf(D):y.indexOf(D))&&(typeof V[2]=="number"?(T[M]=y.slice(0,k),y=y.slice(k+V[2])):(T[M]=y.slice(k),y=y.slice(0,k))):(k=D.exec(y))&&(T[M]=k[1],y=y.slice(0,k.index)),T[M]=T[M]||x&&V[3]&&S[M]||"",V[4]&&(T[M]=T[M].toLowerCase())):y=V(y,T);N&&(T.query=N(T.query)),x&&S.slashes&&T.pathname.charAt(0)!=="/"&&(T.pathname!==""||S.pathname!=="")&&(T.pathname=function(_,ie){if(_==="")return ie;for(var Z=(ie||"/").split("/").slice(0,-1).concat(_.split("/")),me=Z.length,Q=Z[me-1],X=!1,G=0;me--;)Z[me]==="."?Z.splice(me,1):Z[me]===".."?(Z.splice(me,1),G++):G&&(me===0&&(X=!0),Z.splice(me,1),G--);return X&&Z.unshift(""),Q!=="."&&Q!==".."||Z.push(""),Z.join("/")}(T.pathname,S.pathname)),T.pathname.charAt(0)!=="/"&&d(T.protocol)&&(T.pathname="/"+T.pathname),r(T.port,T.protocol)||(T.host=T.hostname,T.port=""),T.username=T.password="",T.auth&&(~(k=T.auth.indexOf(":"))?(T.username=T.auth.slice(0,k),T.username=encodeURIComponent(decodeURIComponent(T.username)),T.password=T.auth.slice(k+1),T.password=encodeURIComponent(decodeURIComponent(T.password))):T.username=encodeURIComponent(decodeURIComponent(T.auth)),T.auth=T.password?T.username+":"+T.password:T.username),T.origin=T.protocol!=="file:"&&d(T.protocol)&&T.host?T.protocol+"//"+T.host:"null",T.href=T.toString()}E.prototype={set:function(y,S,N){var x=this;switch(y){case"query":typeof S=="string"&&S.length&&(S=(N||a.parse)(S)),x[y]=S;break;case"port":x[y]=S,r(S,x.protocol)?S&&(x.host=x.hostname+":"+S):(x.host=x.hostname,x[y]="");break;case"hostname":x[y]=S,x.port&&(S+=":"+x.port),x.host=S;break;case"host":x[y]=S,u.test(S)?(S=S.split(":"),x.port=S.pop(),x.hostname=S.join(":")):(x.hostname=S,x.port="");break;case"protocol":x.protocol=S.toLowerCase(),x.slashes=!N;break;case"pathname":case"hash":if(S){var I=y==="pathname"?"/":"#";x[y]=S.charAt(0)!==I?I+S:S}else x[y]=S;break;case"username":case"password":x[y]=encodeURIComponent(S);break;case"auth":var D=S.indexOf(":");~D?(x.username=S.slice(0,D),x.username=encodeURIComponent(decodeURIComponent(x.username)),x.password=S.slice(D+1),x.password=encodeURIComponent(decodeURIComponent(x.password))):x.username=encodeURIComponent(decodeURIComponent(S))}for(var V=0;V<h.length;V++){var k=h[V];k[4]&&(x[k[1]]=x[k[1]].toLowerCase())}return x.auth=x.password?x.username+":"+x.password:x.username,x.origin=x.protocol!=="file:"&&d(x.protocol)&&x.host?x.protocol+"//"+x.host:"null",x.href=x.toString(),x},toString:function(y){y&&typeof y=="function"||(y=a.stringify);var S,N=this,x=N.host,I=N.protocol;I&&I.charAt(I.length-1)!==":"&&(I+=":");var D=I+(N.protocol&&N.slashes||d(N.protocol)?"//":"");return N.username?(D+=N.username,N.password&&(D+=":"+N.password),D+="@"):N.password?(D+=":"+N.password,D+="@"):N.protocol!=="file:"&&d(N.protocol)&&!x&&N.pathname!=="/"&&(D+="@"),(x[x.length-1]===":"||u.test(N.hostname)&&!N.port)&&(x+=":"),D+=x+N.pathname,(S=typeof N.query=="object"?y(N.query):N.query)&&(D+=S.charAt(0)!=="?"?"?"+S:S),N.hash&&(D+=N.hash),D}},E.extractProtocol=p,E.location=w,E.trimLeft=m,E.qs=a,s.exports=E},410:()=>{},388:()=>{},805:()=>{},345:()=>{},800:()=>{}},Jd={};function be(s){var e=Jd[s];if(e!==void 0)return e.exports;var t=Jd[s]={id:s,loaded:!1,exports:{}};return dy[s].call(t.exports,t,t.exports,be),t.loaded=!0,t.exports}be.n=s=>{var e=s&&s.__esModule?()=>s.default:()=>s;return be.d(e,{a:e}),e},be.d=(s,e)=>{for(var t in e)be.o(e,t)&&!be.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})},be.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),be.nmd=s=>(s.paths=[],s.children||(s.children=[]),s);var ts={};be.d(ts,{hT:()=>kt,O4:()=>Ys,Kd:()=>Ny,YK:()=>ky,UU:()=>B0,Gu:()=>vg,ky:()=>Bg,h4:()=>pc,ch:()=>em,hq:()=>jn,i5:()=>Pg});var py=be(737),gy=be.n(py);function hm(s){if(!yf(s))throw new Error("Parameter was not an error")}function yf(s){return!!s&&typeof s=="object"&&(e=s,Object.prototype.toString.call(e)==="[object Error]")||s instanceof Error;var e}class It extends Error{constructor(e,t){const r=[...arguments],{options:a,shortMessage:n}=function(i){let u,c="";if(i.length===0)u={};else if(yf(i[0]))u={cause:i[0]},c=i.slice(1).join(" ")||"";else if(i[0]&&typeof i[0]=="object")u=Object.assign({},i[0]),c=i.slice(1).join(" ")||"";else{if(typeof i[0]!="string")throw new Error("Invalid arguments passed to Layerr");u={},c=c=i.join(" ")||""}return{options:u,shortMessage:c}}(r);let o=n;if(a.cause&&(o="".concat(o,": ").concat(a.cause.message)),super(o),this.message=o,a.name&&typeof a.name=="string"?this.name=a.name:this.name="Layerr",a.cause&&Object.defineProperty(this,"_cause",{value:a.cause}),Object.defineProperty(this,"_info",{value:{}}),a.info&&typeof a.info=="object"&&Object.assign(this._info,a.info),Error.captureStackTrace){const i=a.constructorOpt||this.constructor;Error.captureStackTrace(this,i)}}static cause(e){return hm(e),e._cause&&yf(e._cause)?e._cause:null}static fullStack(e){var r;hm(e);const t=It.cause(e);return t?"".concat(e.stack,"\ncaused by: ").concat(It.fullStack(t)):(r=e.stack)!=null?r:""}static info(e){hm(e);const t={},r=It.cause(e);return r&&Object.assign(t,It.info(r)),e._info&&Object.assign(t,e._info),t}toString(){let e=this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e="".concat(e,": ").concat(this.message)),e}}var wy=be(47),Oh=be.n(wy);const qd="__PATH_SEPARATOR_POSIX__",Wd="__PATH_SEPARATOR_WINDOWS__";function Be(s){try{const e=s.replace(/\//g,qd).replace(/\\\\/g,Wd);return encodeURIComponent(e).split(Wd).join("\\\\").split(qd).join("/")}catch(e){throw new It(e,"Failed encoding path")}}function _d(s){return s.startsWith("/")?s:"/"+s}function ic(s){let e=s;return e[0]!=="/"&&(e="/"+e),/^.+\/$/.test(e)&&(e=e.substr(0,e.length-1)),e}function yy(s){let e=new(gy())(s).pathname;return e.length<=0&&(e="/"),ic(e)}function Pe(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(){return function(r){var a=[];if(r.length===0)return"";if(typeof r[0]!="string")throw new TypeError("Url must be a string. Received "+r[0]);if(r[0].match(/^[^/:]+:\/*$/)&&r.length>1){var n=r.shift();r[0]=n+r[0]}r[0].match(/^file:\/\/\//)?r[0]=r[0].replace(/^([^/:]+):\/*/,"$1:///"):r[0]=r[0].replace(/^([^/:]+):\/*/,"$1://");for(var o=0;o<r.length;o++){var i=r[o];if(typeof i!="string")throw new TypeError("Url must be a string. Received "+i);i!==""&&(o>0&&(i=i.replace(/^[\/]+/,"")),i=o<r.length-1?i.replace(/[\/]+$/,""):i.replace(/[\/]+$/,"/"),a.push(i))}var u=a.join("/"),c=(u=u.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return c.shift()+(c.length>0?"?":"")+c.join("&")}(typeof arguments[0]=="object"?arguments[0]:[].slice.call(arguments))}(e.reduce((r,a,n)=>((n===0||a!=="/"||a==="/"&&r[r.length-1]!=="/")&&r.push(a),r),[]))}var vy=be(542),Uo=be.n(vy);const by="abcdef0123456789";function Gd(s,e){const t=s.url.replace("//",""),r=t.indexOf("/")==-1?"/":t.slice(t.indexOf("/")),a=s.method?s.method.toUpperCase():"GET",n=!!/(^|,)\s*auth\s*($|,)/.test(e.qop)&&"auth",o="00000000".concat(e.nc).slice(-8),i=function(h,g,w,d,p,E,y){const S=y||Uo()("".concat(g,":").concat(w,":").concat(d));return h&&h.toLowerCase()==="md5-sess"?Uo()("".concat(S,":").concat(p,":").concat(E)):S}(e.algorithm,e.username,e.realm,e.password,e.nonce,e.cnonce,e.ha1),u=Uo()("".concat(a,":").concat(r)),c=n?Uo()("".concat(i,":").concat(e.nonce,":").concat(o,":").concat(e.cnonce,":").concat(n,":").concat(u)):Uo()("".concat(i,":").concat(e.nonce,":").concat(u)),l={username:e.username,realm:e.realm,nonce:e.nonce,uri:r,qop:n,response:c,nc:o,cnonce:e.cnonce,algorithm:e.algorithm,opaque:e.opaque},m=[];for(const h in l)l[h]&&(h==="qop"||h==="nc"||h==="algorithm"?m.push("".concat(h,"=").concat(l[h])):m.push("".concat(h,'="').concat(l[h],'"')));return"Digest ".concat(m.join(", "))}function gg(s){return(s.headers&&s.headers.get("www-authenticate")||"").split(/\s/)[0].toLowerCase()==="digest"}var Sy=be(101),wg=be.n(Sy);function Xd(s){return wg().decode(s)}function zd(s,e){var t;return"Basic ".concat((t="".concat(s,":").concat(e),wg().encode(t)))}const Dh=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:typeof window<"u"?window:globalThis,Ay=Dh.fetch.bind(Dh),Ny=Dh.Request,ky=Dh.Response;let kt=function(s){return s.Auto="auto",s.Digest="digest",s.None="none",s.Password="password",s.Token="token",s}({}),Ys=function(s){return s.DataTypeNoLength="data-type-no-length",s.InvalidAuthType="invalid-auth-type",s.InvalidOutputFormat="invalid-output-format",s.LinkUnsupportedAuthType="link-unsupported-auth",s.InvalidUpdateRange="invalid-update-range",s.NotSupported="not-supported",s}({});function yg(s,e,t,r,a){switch(s.authType){case kt.Auto:e&&t&&(s.headers.Authorization=zd(e,t));break;case kt.Digest:s.digest=function(o,i,u){return{username:o,password:i,ha1:u,nc:0,algorithm:"md5",hasDigestAuth:!1}}(e,t,a);break;case kt.None:break;case kt.Password:s.headers.Authorization=zd(e,t);break;case kt.Token:s.headers.Authorization="".concat((n=r).token_type," ").concat(n.access_token);break;default:throw new It({info:{code:Ys.InvalidAuthType}},"Invalid auth type: ".concat(s.authType))}var n}be(345),be(800);const Yd="@@HOTPATCHER",Ey=()=>{};function mm(s){return{original:s,methods:[s],final:!1}}class Cy{constructor(){this._configuration={registry:{},getEmptyAction:"null"},this.__type__=Yd}get configuration(){return this._configuration}get getEmptyAction(){return this.configuration.getEmptyAction}set getEmptyAction(e){this.configuration.getEmptyAction=e}control(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!e||e.__type__!==Yd)throw new Error("Failed taking control of target HotPatcher instance: Invalid type or object");return Object.keys(e.configuration.registry).forEach(r=>{this.configuration.registry.hasOwnProperty(r)?t&&(this.configuration.registry[r]=Object.assign({},e.configuration.registry[r])):this.configuration.registry[r]=Object.assign({},e.configuration.registry[r])}),e._configuration=this.configuration,this}execute(e){const t=this.get(e)||Ey;for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return t(...a)}get(e){const t=this.configuration.registry[e];if(!t)switch(this.getEmptyAction){case"null":return null;case"throw":throw new Error("Failed handling method request: No method provided for override: ".concat(e));default:throw new Error("Failed handling request which resulted in an empty method: Invalid empty-action specified: ".concat(this.getEmptyAction))}return function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];if(a.length===0)throw new Error("Failed creating sequence: No functions provided");return function(){for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];let c=i;const l=this;for(;a.length>0;)c=[a.shift().apply(l,c)];return c[0]}}(...t.methods)}isPatched(e){return!!this.configuration.registry[e]}patch(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{chain:a=!1}=r;if(this.configuration.registry[e]&&this.configuration.registry[e].final)throw new Error("Failed patching '".concat(e,"': Method marked as being final"));if(typeof t!="function")throw new Error("Failed patching '".concat(e,"': Provided method is not a function"));if(a)this.configuration.registry[e]?this.configuration.registry[e].methods.push(t):this.configuration.registry[e]=mm(t);else if(this.isPatched(e)){const{original:n}=this.configuration.registry[e];this.configuration.registry[e]=Object.assign(mm(t),{original:n})}else this.configuration.registry[e]=mm(t);return this}patchInline(e,t){this.isPatched(e)||this.patch(e,t);for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];return this.execute(e,...a)}plugin(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach(n=>{this.patch(e,n,{chain:!0})}),this}restore(e){if(!this.isPatched(e))throw new Error("Failed restoring method: No method present for key: ".concat(e));if(typeof this.configuration.registry[e].original!="function")throw new Error("Failed restoring method: Original method not found or of invalid type for key: ".concat(e));return this.configuration.registry[e].methods=[this.configuration.registry[e].original],this}setFinal(e){if(!this.configuration.registry.hasOwnProperty(e))throw new Error("Failed marking '".concat(e,"' as final: No method found for key"));return this.configuration.registry[e].final=!0,this}}let fm=null;function vg(){return fm||(fm=new Cy),fm}function Th(s){return function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(s)?Object.assign({},s):Object.setPrototypeOf(Object.assign({},s),Object.getPrototypeOf(s))}function Zd(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];let r=null,a=[...e];for(;a.length>0;){const n=a.shift();r=r?bg(r,n):Th(n)}return r}function bg(s,e){const t=Th(s);return Object.keys(e).forEach(r=>{t.hasOwnProperty(r)?Array.isArray(e[r])?t[r]=Array.isArray(t[r])?[...t[r],...e[r]]:[...e[r]]:typeof e[r]=="object"&&e[r]?t[r]=typeof t[r]=="object"&&t[r]?bg(t[r],e[r]):Th(e[r]):t[r]=e[r]:t[r]=e[r]}),t}function Iy(s){const e={};for(const t of s.keys())e[t]=s.get(t);return e}function vf(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];if(e.length===0)return{};const r={};return e.reduce((a,n)=>(Object.keys(n).forEach(o=>{const i=o.toLowerCase();r.hasOwnProperty(i)?a[r[i]]=n[o]:(r[i]=o,a[o]=n[o])}),a),{})}be(805);const Vy=typeof ArrayBuffer=="function",{toString:xy}=Object.prototype;function Sg(s){return Vy&&(s instanceof ArrayBuffer||xy.call(s)==="[object ArrayBuffer]")}function Ag(s){return s!=null&&s.constructor!=null&&typeof s.constructor.isBuffer=="function"&&s.constructor.isBuffer(s)}function rd(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}function bf(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const Ng=rd(function(s){const e=s._digest;return delete s._digest,e.hasDigestAuth&&(s=Zd(s,{headers:{Authorization:Gd(s,e)}})),bf(Rh(s),function(t){let r=!1;return a=function(o){return r?o:t},(n=function(){if(t.status==401)return e.hasDigestAuth=function(o,i){if(!gg(o))return!1;const u=/([a-z0-9_-]+)=(?:"([^"]+)"|([a-z0-9_-]+))/gi;for(;;){const c=o.headers&&o.headers.get("www-authenticate")||"",l=u.exec(c);if(!l)break;i[l[1]]=l[2]||l[3]}return i.nc+=1,i.cnonce=function(){let c="";for(let l=0;l<32;++l)c="".concat(c).concat(by[Math.floor(16*Math.random())]);return c}(),!0}(t,e),function(){if(e.hasDigestAuth)return bf(Rh(s=Zd(s,{headers:{Authorization:Gd(s,e)}})),function(o){return o.status==401?e.hasDigestAuth=!1:e.nc++,r=!0,o})}();e.nc++}())&&n.then?n.then(a):a(n);var a,n})}),By=rd(function(s,e){return bf(Rh(s),function(t){return t.ok?(e.authType=kt.Password,t):t.status==401&&gg(t)?(e.authType=kt.Digest,yg(e,e.username,e.password,void 0,void 0),s._digest=e.digest,Ng(s)):t})}),Qe=rd(function(s,e){return e.authType===kt.Auto?By(s,e):s._digest?Ng(s):Rh(s)});function et(s,e,t){const r=Th(s);return r.headers=vf(e.headers,r.headers||{},t.headers||{}),t.data!==void 0&&(r.data=t.data),t.signal&&(r.signal=t.signal),e.httpAgent&&(r.httpAgent=e.httpAgent),e.httpsAgent&&(r.httpsAgent=e.httpsAgent),e.digest&&(r._digest=e.digest),typeof e.withCredentials=="boolean"&&(r.withCredentials=e.withCredentials),r}function Rh(s){const e=vg();return e.patchInline("request",t=>e.patchInline("fetch",Ay,t.url,function(r){let a={};const n={method:r.method};if(r.headers&&(a=vf(a,r.headers)),r.data!==void 0){const[o,i]=function(u){if(typeof u=="string")return[u,{}];if(Ag(u))return[u,{}];if(Sg(u))return[u,{}];if(u&&typeof u=="object")return[JSON.stringify(u),{"content-type":"application/json"}];throw new Error("Unable to convert request body: Unexpected body type: "+typeof u)}(r.data);n.body=o,a=vf(a,i)}return r.signal&&(n.signal=r.signal),r.withCredentials&&(n.credentials="include"),n.headers=a,n}(t)),s)}var Py=be(285);const Lh=s=>{if(typeof s!="string")throw new TypeError("invalid pattern");if(s.length>65536)throw new TypeError("pattern is too long")},Oy={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},jo=s=>s.replace(/[[\]\\-]/g,"\\$&"),Qd=s=>s.join(""),Dy=(s,e)=>{const t=e;if(s.charAt(t)!=="[")throw new Error("not in a brace expression");const r=[],a=[];let n=t+1,o=!1,i=!1,u=!1,c=!1,l=t,m="";e:for(;n<s.length;){const d=s.charAt(n);if(d!=="!"&&d!=="^"||n!==t+1){if(d==="]"&&o&&!u){l=n+1;break}if(o=!0,d!=="\\"||u){if(d==="["&&!u){for(const[p,[E,y,S]]of Object.entries(Oy))if(s.startsWith(p,n)){if(m)return["$.",!1,s.length-t,!0];n+=p.length,S?a.push(E):r.push(E),i=i||y;continue e}}u=!1,m?(d>m?r.push(jo(m)+"-"+jo(d)):d===m&&r.push(jo(d)),m="",n++):s.startsWith("-]",n+1)?(r.push(jo(d+"-")),n+=2):s.startsWith("-",n+1)?(m=d,n+=2):(r.push(jo(d)),n++)}else u=!0,n++}else c=!0,n++}if(l<n)return["",!1,0,!1];if(!r.length&&!a.length)return["$.",!1,s.length-t,!0];if(a.length===0&&r.length===1&&/^\\?.$/.test(r[0])&&!c)return[(h=r[0].length===2?r[0].slice(-1):r[0],h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")),!1,l-t,!1];var h;const g="["+(c?"^":"")+Qd(r)+"]",w="["+(c?"":"^")+Qd(a)+"]";return[r.length&&a.length?"("+g+"|"+w+")":r.length?g:w,i,l-t,!0]},tl=function(s){let{windowsPathsNoEscape:e=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e?s.replace(/\[([^\/\\])\]/g,"$1"):s.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")},Ty=new Set(["!","?","+","*","@"]),ep=s=>Ty.has(s),dm="(?!\\.)",Ry=new Set(["[","."]),Ly=new Set(["..","."]),Uy=new Set("().*{}+?[]^$\\!"),ad="[^/]",tp=ad+"*?",sp=ad+"+?";var Xe,rt,$s,Ee,Je,Yr,En,Zr,ws,Cn,dc,Un,kg,ca,zc,Sf,Eg;const vt=class vt{constructor(e,t){Ot(this,Un);Fe(this,"type");Ot(this,Xe);Ot(this,rt);Ot(this,$s,!1);Ot(this,Ee,[]);Ot(this,Je);Ot(this,Yr);Ot(this,En);Ot(this,Zr,!1);Ot(this,ws);Ot(this,Cn);Ot(this,dc,!1);let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.type=e,e&&De(this,rt,!0),De(this,Je,t),De(this,Xe,q(this,Je)?q(q(this,Je),Xe):this),De(this,ws,q(this,Xe)===this?r:q(q(this,Xe),ws)),De(this,En,q(this,Xe)===this?[]:q(q(this,Xe),En)),e!=="!"||q(q(this,Xe),Zr)||q(this,En).push(this),De(this,Yr,q(this,Je)?q(q(this,Je),Ee).length:0)}get hasMagic(){if(q(this,rt)!==void 0)return q(this,rt);for(const e of q(this,Ee))if(typeof e!="string"&&(e.type||e.hasMagic))return De(this,rt,!0);return q(this,rt)}toString(){return q(this,Cn)!==void 0?q(this,Cn):this.type?De(this,Cn,this.type+"("+q(this,Ee).map(e=>String(e)).join("|")+")"):De(this,Cn,q(this,Ee).map(e=>String(e)).join(""))}push(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(const a of t)if(a!==""){if(typeof a!="string"&&!(a instanceof vt&&q(a,Je)===this))throw new Error("invalid part: "+a);q(this,Ee).push(a)}}toJSON(){var t;const e=this.type===null?q(this,Ee).slice().map(r=>typeof r=="string"?r:r.toJSON()):[this.type,...q(this,Ee).map(r=>r.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===q(this,Xe)||q(q(this,Xe),Zr)&&((t=q(this,Je))==null?void 0:t.type)==="!")&&e.push({}),e}isStart(){var t;if(q(this,Xe)===this)return!0;if(!((t=q(this,Je))!=null&&t.isStart()))return!1;if(q(this,Yr)===0)return!0;const e=q(this,Je);for(let r=0;r<q(this,Yr);r++){const a=q(e,Ee)[r];if(!(a instanceof vt&&a.type==="!"))return!1}return!0}isEnd(){var t,r,a;if(q(this,Xe)===this||((t=q(this,Je))==null?void 0:t.type)==="!")return!0;if(!((r=q(this,Je))!=null&&r.isEnd()))return!1;if(!this.type)return(a=q(this,Je))==null?void 0:a.isEnd();const e=q(this,Je)?q(q(this,Je),Ee).length:0;return q(this,Yr)===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){const t=new vt(this.type,e);for(const r of q(this,Ee))t.copyIn(r);return t}static fromGlob(e){var a;let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new vt(null,void 0,t);return Qs(a=vt,ca,zc).call(a,e,r,0,t),r}toMMPattern(){if(this!==q(this,Xe))return q(this,Xe).toMMPattern();const e=this.toString(),[t,r,a,n]=this.toRegExpSource();if(!(a||q(this,rt)||q(this,ws).nocase&&!q(this,ws).nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return r;const o=(q(this,ws).nocase?"i":"")+(n?"u":"");return Object.assign(new RegExp("^".concat(t,"$"),o),{_src:t,_glob:e})}get options(){return q(this,ws)}toRegExpSource(e){var u;const t=e!=null?e:!!q(this,ws).dot;if(q(this,Xe)===this&&Qs(this,Un,kg).call(this),!this.type){const c=this.isStart()&&this.isEnd(),l=q(this,Ee).map(g=>{var y;const[w,d,p,E]=typeof g=="string"?Qs(y=vt,ca,Eg).call(y,g,q(this,rt),c):g.toRegExpSource(e);return De(this,rt,q(this,rt)||p),De(this,$s,q(this,$s)||E),w}).join("");let m="";if(this.isStart()&&typeof q(this,Ee)[0]=="string"&&(q(this,Ee).length!==1||!Ly.has(q(this,Ee)[0]))){const g=Ry,w=t&&g.has(l.charAt(0))||l.startsWith("\\.")&&g.has(l.charAt(2))||l.startsWith("\\.\\.")&&g.has(l.charAt(4)),d=!t&&!e&&g.has(l.charAt(0));m=w?"(?!(?:^|/)\\.\\.?(?:$|/))":d?dm:""}let h="";return this.isEnd()&&q(q(this,Xe),Zr)&&((u=q(this,Je))==null?void 0:u.type)==="!"&&(h="(?:$|\\/)"),[m+l+h,tl(l),De(this,rt,!!q(this,rt)),q(this,$s)]}const r=this.type==="*"||this.type==="+",a=this.type==="!"?"(?:(?!(?:":"(?:";let n=Qs(this,Un,Sf).call(this,t);if(this.isStart()&&this.isEnd()&&!n&&this.type!=="!"){const c=this.toString();return De(this,Ee,[c]),this.type=null,De(this,rt,void 0),[c,tl(this.toString()),!1,!1]}let o=!r||e||t?"":Qs(this,Un,Sf).call(this,!0);o===n&&(o=""),o&&(n="(?:".concat(n,")(?:").concat(o,")*?"));let i="";return i=this.type==="!"&&q(this,dc)?(this.isStart()&&!t?dm:"")+sp:a+n+(this.type==="!"?"))"+(!this.isStart()||t||e?"":dm)+tp+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&o?")":this.type==="*"&&o?")?":")".concat(this.type)),[i,tl(n),De(this,rt,!!q(this,rt)),q(this,$s)]}};Xe=new WeakMap,rt=new WeakMap,$s=new WeakMap,Ee=new WeakMap,Je=new WeakMap,Yr=new WeakMap,En=new WeakMap,Zr=new WeakMap,ws=new WeakMap,Cn=new WeakMap,dc=new WeakMap,Un=new WeakSet,kg=function(){if(this!==q(this,Xe))throw new Error("should only call on root");if(q(this,Zr))return this;let e;for(this.toString(),De(this,Zr,!0);e=q(this,En).pop();){if(e.type!=="!")continue;let t=e,r=q(t,Je);for(;r;){for(let a=q(t,Yr)+1;!r.type&&a<q(r,Ee).length;a++)for(const n of q(e,Ee)){if(typeof n=="string")throw new Error("string part in extglob AST??");n.copyIn(q(r,Ee)[a])}t=r,r=q(t,Je)}}return this},ca=new WeakSet,zc=function(e,t,r,a){var g,w;let n=!1,o=!1,i=-1,u=!1;if(t.type===null){let d=r,p="";for(;d<e.length;){const E=e.charAt(d++);if(n||E==="\\")n=!n,p+=E;else if(o)d===i+1?E!=="^"&&E!=="!"||(u=!0):E!=="]"||d===i+2&&u||(o=!1),p+=E;else if(E!=="[")if(a.noext||!ep(E)||e.charAt(d)!=="(")p+=E;else{t.push(p),p="";const y=new vt(E,t);d=Qs(g=vt,ca,zc).call(g,e,y,d,a),t.push(y)}else o=!0,i=d,u=!1,p+=E}return t.push(p),d}let c=r+1,l=new vt(null,t);const m=[];let h="";for(;c<e.length;){const d=e.charAt(c++);if(n||d==="\\")n=!n,h+=d;else if(o)c===i+1?d!=="^"&&d!=="!"||(u=!0):d!=="]"||c===i+2&&u||(o=!1),h+=d;else if(d!=="[")if(ep(d)&&e.charAt(c)==="("){l.push(h),h="";const p=new vt(d,l);l.push(p),c=Qs(w=vt,ca,zc).call(w,e,p,c,a)}else if(d!=="|"){if(d===")")return h===""&&q(t,Ee).length===0&&De(t,dc,!0),l.push(h),h="",t.push(...m,l),c;h+=d}else l.push(h),h="",m.push(l),l=new vt(null,t);else o=!0,i=c,u=!1,h+=d}return t.type=null,De(t,rt,void 0),De(t,Ee,[e.substring(r-1)]),c},Sf=function(e){return q(this,Ee).map(t=>{if(typeof t=="string")throw new Error("string type in extglob ast??");const[r,a,n,o]=t.toRegExpSource(e);return De(this,$s,q(this,$s)||o),r}).filter(t=>!(this.isStart()&&this.isEnd()&&!t)).join("|")},Eg=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=!1,n="",o=!1;for(let i=0;i<e.length;i++){const u=e.charAt(i);if(a)a=!1,n+=(Uy.has(u)?"\\":"")+u;else if(u!=="\\"){if(u==="["){const[c,l,m,h]=Dy(e,i);if(m){n+=c,o=o||l,i+=m-1,t=t||h;continue}}u!=="*"?u!=="?"?n+=u.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):(n+=ad,t=!0):(n+=r&&e==="*"?sp:tp,t=!0)}else i===e.length-1?n+="\\\\":a=!0}return[n,tl(e),!!t,o]},Ot(vt,ca);let Uh=vt;const wt=function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Lh(e),!(!t.nocomment&&e.charAt(0)==="#")&&new jh(e,t).match(s)},jy=/^\*+([^+@!?\*\[\(]*)$/,$y=s=>e=>!e.startsWith(".")&&e.endsWith(s),Ky=s=>e=>e.endsWith(s),Hy=s=>(s=s.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(s)),My=s=>(s=s.toLowerCase(),e=>e.toLowerCase().endsWith(s)),Fy=/^\*+\.\*+$/,Jy=s=>!s.startsWith(".")&&s.includes("."),qy=s=>s!=="."&&s!==".."&&s.includes("."),Wy=/^\.\*+$/,_y=s=>s!=="."&&s!==".."&&s.startsWith("."),Gy=/^\*+$/,Xy=s=>s.length!==0&&!s.startsWith("."),zy=s=>s.length!==0&&s!=="."&&s!=="..",Yy=/^\?+([^+@!?\*\[\(]*)?$/,Zy=s=>{let[e,t=""]=s;const r=Cg([e]);return t?(t=t.toLowerCase(),a=>r(a)&&a.toLowerCase().endsWith(t)):r},Qy=s=>{let[e,t=""]=s;const r=Ig([e]);return t?(t=t.toLowerCase(),a=>r(a)&&a.toLowerCase().endsWith(t)):r},e0=s=>{let[e,t=""]=s;const r=Ig([e]);return t?a=>r(a)&&a.endsWith(t):r},t0=s=>{let[e,t=""]=s;const r=Cg([e]);return t?a=>r(a)&&a.endsWith(t):r},Cg=s=>{let[e]=s;const t=e.length;return r=>r.length===t&&!r.startsWith(".")},Ig=s=>{let[e]=s;const t=e.length;return r=>r.length===t&&r!=="."&&r!==".."},Vg=typeof ze=="object"&&ze?typeof cm=="object"&&cm&&cm.__MINIMATCH_TESTING_PLATFORM__||ze.platform:"posix";wt.sep=Vg==="win32"?"\\":"/";const _t=Symbol("globstar **");wt.GLOBSTAR=_t,wt.filter=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t=>wt(t,s,e)};const qt=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.assign({},s,e)};wt.defaults=s=>{if(!s||typeof s!="object"||!Object.keys(s).length)return wt;const e=wt;return Object.assign(function(t,r){return e(t,r,qt(s,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}))},{Minimatch:class extends e.Minimatch{constructor(t){super(t,qt(s,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}))}static defaults(t){return e.defaults(qt(s,t)).Minimatch}},AST:class extends e.AST{constructor(t,r){super(t,r,qt(s,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}))}static fromGlob(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.AST.fromGlob(t,qt(s,r))}},unescape:function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.unescape(t,qt(s,r))},escape:function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.escape(t,qt(s,r))},filter:function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.filter(t,qt(s,r))},defaults:t=>e.defaults(qt(s,t)),makeRe:function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.makeRe(t,qt(s,r))},braceExpand:function(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.braceExpand(t,qt(s,r))},match:function(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e.match(t,r,qt(s,a))},sep:e.sep,GLOBSTAR:_t})};const xg=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Lh(s),e.nobrace||!/\{(?:(?!\{).)*\}/.test(s)?[s]:Py(s)};wt.braceExpand=xg,wt.makeRe=function(s){return new jh(s,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).makeRe()},wt.match=function(s,e){const t=new jh(e,arguments.length>2&&arguments[2]!==void 0?arguments[2]:{});return s=s.filter(r=>t.match(r)),t.options.nonull&&!s.length&&s.push(e),s};const rp=/[?*]|[+@!]\(.*?\)|\[|\]/;class jh{constructor(e){Fe(this,"options");Fe(this,"set");Fe(this,"pattern");Fe(this,"windowsPathsNoEscape");Fe(this,"nonegate");Fe(this,"negate");Fe(this,"comment");Fe(this,"empty");Fe(this,"preserveMultipleSlashes");Fe(this,"partial");Fe(this,"globSet");Fe(this,"globParts");Fe(this,"nocase");Fe(this,"isWindows");Fe(this,"platform");Fe(this,"windowsNoMagicRoot");Fe(this,"regexp");let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Lh(e),t=t||{},this.options=t,this.pattern=e,this.platform=t.platform||Vg,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=t.windowsNoMagicRoot!==void 0?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(const e of this.set)for(const t of e)if(typeof t!="string")return!0;return!1}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#")return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=function(){return console.error(...arguments)}),this.debug(this.pattern,this.globSet);const r=this.globSet.map(n=>this.slashSplit(n));this.globParts=this.preprocess(r),this.debug(this.pattern,this.globParts);let a=this.globParts.map((n,o,i)=>{if(this.isWindows&&this.windowsNoMagicRoot){const u=!(n[0]!==""||n[1]!==""||n[2]!=="?"&&rp.test(n[2])||rp.test(n[3])),c=/^[a-z]:/i.test(n[0]);if(u)return[...n.slice(0,4),...n.slice(4).map(l=>this.parse(l))];if(c)return[n[0],...n.slice(1).map(l=>this.parse(l))]}return n.map(u=>this.parse(u))});if(this.debug(this.pattern,a),this.set=a.filter(n=>n.indexOf(!1)===-1),this.isWindows)for(let n=0;n<this.set.length;n++){const o=this.set[n];o[0]===""&&o[1]===""&&this.globParts[n][2]==="?"&&typeof o[3]=="string"&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let r=0;r<e.length;r++)for(let a=0;a<e[r].length;a++)e[r][a]==="**"&&(e[r][a]="*");const{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(t=>{let r=-1;for(;(r=t.indexOf("**",r+1))!==-1;){let a=r;for(;t[a+1]==="**";)a++;a!==r&&t.splice(r,a-r)}return t})}levelOneOptimize(e){return e.map(t=>(t=t.reduce((r,a)=>{const n=r[r.length-1];return a==="**"&&n==="**"?r:a===".."&&n&&n!==".."&&n!=="."&&n!=="**"?(r.pop(),r):(r.push(a),r)},[])).length===0?[""]:t)}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let a=1;a<e.length-1;a++){const n=e[a];a===1&&n===""&&e[0]===""||n!=="."&&n!==""||(t=!0,e.splice(a,1),a--)}e[0]!=="."||e.length!==2||e[1]!=="."&&e[1]!==""||(t=!0,e.pop())}let r=0;for(;(r=e.indexOf("..",r+1))!==-1;){const a=e[r-1];a&&a!=="."&&a!==".."&&a!=="**"&&(t=!0,e.splice(r-1,2),r-=2)}}while(t);return e.length===0?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let r of e){let a=-1;for(;(a=r.indexOf("**",a+1))!==-1;){let o=a;for(;r[o+1]==="**";)o++;o>a&&r.splice(a+1,o-a);let i=r[a+1];const u=r[a+2],c=r[a+3];if(i!==".."||!u||u==="."||u===".."||!c||c==="."||c==="..")continue;t=!0,r.splice(a,1);const l=r.slice(0);l[a]="**",e.push(l),a--}if(!this.preserveMultipleSlashes){for(let o=1;o<r.length-1;o++){const i=r[o];o===1&&i===""&&r[0]===""||i!=="."&&i!==""||(t=!0,r.splice(o,1),o--)}r[0]!=="."||r.length!==2||r[1]!=="."&&r[1]!==""||(t=!0,r.pop())}let n=0;for(;(n=r.indexOf("..",n+1))!==-1;){const o=r[n-1];if(o&&o!=="."&&o!==".."&&o!=="**"){t=!0;const i=n===1&&r[n+1]==="**"?["."]:[];r.splice(n-1,2,...i),r.length===0&&r.push(""),n-=2}}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let r=t+1;r<e.length;r++){const a=this.partsMatch(e[t],e[r],!this.preserveMultipleSlashes);if(a){e[t]=[],e[r]=a;break}}return e.filter(t=>t.length)}partsMatch(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2],a=0,n=0,o=[],i="";for(;a<e.length&&n<t.length;)if(e[a]===t[n])o.push(i==="b"?t[n]:e[a]),a++,n++;else if(r&&e[a]==="**"&&t[n]===e[a+1])o.push(e[a]),a++;else if(r&&t[n]==="**"&&e[a]===t[n+1])o.push(t[n]),n++;else if(e[a]!=="*"||!t[n]||!this.options.dot&&t[n].startsWith(".")||t[n]==="**"){if(t[n]!=="*"||!e[a]||!this.options.dot&&e[a].startsWith(".")||e[a]==="**"||i==="a")return!1;i="b",o.push(t[n]),a++,n++}else{if(i==="b")return!1;i="a",o.push(e[a]),a++,n++}return e.length===t.length&&o}parseNegate(){if(this.nonegate)return;const e=this.pattern;let t=!1,r=0;for(let a=0;a<e.length&&e.charAt(a)==="!";a++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t){let r=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const a=this.options;if(this.isWindows){const d=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),p=!d&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),E=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),y=p?3:d?0:void 0,S=!E&&t[0]===""&&t[1]===""&&t[2]==="?"&&typeof t[3]=="string"&&/^[a-z]:$/i.test(t[3])?3:E?0:void 0;if(typeof y=="number"&&typeof S=="number"){const[N,x]=[e[y],t[S]];N.toLowerCase()===x.toLowerCase()&&(t[S]=N,S>y?t=t.slice(S):y>S&&(e=e.slice(y)))}}const{optimizationLevel:n=1}=this.options;n>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,i=0,u=e.length,c=t.length;o<u&&i<c;o++,i++){this.debug("matchOne loop");var l=t[i],m=e[o];if(this.debug(t,l,m),l===!1)return!1;if(l===_t){this.debug("GLOBSTAR",[t,l,m]);var h=o,g=i+1;if(g===c){for(this.debug("** at the end");o<u;o++)if(e[o]==="."||e[o]===".."||!a.dot&&e[o].charAt(0)===".")return!1;return!0}for(;h<u;){var w=e[h];if(this.debug("\nglobstar while",e,h,t,g,w),this.matchOne(e.slice(h),t.slice(g),r))return this.debug("globstar found match!",h,u,w),!0;if(w==="."||w===".."||!a.dot&&w.charAt(0)==="."){this.debug("dot detected!",e,h,t,g);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",e,h,t,g),h!==u))}let d;if(typeof l=="string"?(d=m===l,this.debug("string match",l,m,d)):(d=l.test(m),this.debug("pattern match",l,m,d)),!d)return!1}if(o===u&&i===c)return!0;if(o===u)return r;if(i===c)return o===u-1&&e[o]==="";throw new Error("wtf?")}braceExpand(){return xg(this.pattern,this.options)}parse(e){Lh(e);const t=this.options;if(e==="**")return _t;if(e==="")return"";let r,a=null;(r=e.match(Gy))?a=t.dot?zy:Xy:(r=e.match(jy))?a=(t.nocase?t.dot?My:Hy:t.dot?Ky:$y)(r[1]):(r=e.match(Yy))?a=(t.nocase?t.dot?Qy:Zy:t.dot?e0:t0)(r):(r=e.match(Fy))?a=t.dot?qy:Jy:(r=e.match(Wy))&&(a=_y);const n=Uh.fromGlob(e,this.options).toMMPattern();return a&&typeof n=="object"&&Reflect.defineProperty(n,"test",{value:a}),n}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,r=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",a=new Set(t.nocase?["i"]:[]);let n=e.map(u=>{const c=u.map(l=>{if(l instanceof RegExp)for(const m of l.flags.split(""))a.add(m);return typeof l=="string"?l.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):l===_t?_t:l._src});return c.forEach((l,m)=>{const h=c[m+1],g=c[m-1];l===_t&&g!==_t&&(g===void 0?h!==void 0&&h!==_t?c[m+1]="(?:\\/|"+r+"\\/)?"+h:c[m]=r:h===void 0?c[m-1]=g+"(?:\\/|"+r+")?":h!==_t&&(c[m-1]=g+"(?:\\/|\\/"+r+"\\/)"+h,c[m+1]=_t))}),c.filter(l=>l!==_t).join("/")}).join("|");const[o,i]=e.length>1?["(?:",")"]:["",""];n="^"+o+n+i+"$",this.negate&&(n="^(?!"+n+").+$");try{this.regexp=new RegExp(n,[...a].join(""))}catch(u){this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.partial;if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;const r=this.options;this.isWindows&&(e=e.split("\\").join("/"));const a=this.slashSplit(e);this.debug(this.pattern,"split",a);const n=this.set;this.debug(this.pattern,"set",n);let o=a[a.length-1];if(!o)for(let i=a.length-2;!o&&i>=0;i--)o=a[i];for(let i=0;i<n.length;i++){const u=n[i];let c=a;if(r.matchBase&&u.length===1&&(c=[o]),this.matchOne(c,u,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}static defaults(e){return wt.defaults(e).Minimatch}}function nd(s){const e=new Error("".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"","Invalid response: ").concat(s.status," ").concat(s.statusText));return e.status=s.status,e.response=s,e}function tt(s,e){const{status:t}=e;if(t===401&&s.digest)return e;if(t>=400)throw nd(e);return e}function jn(s,e){return arguments.length>2&&arguments[2]!==void 0&&arguments[2]?{data:e,headers:s.headers?Iy(s.headers):{},status:s.status,statusText:s.statusText}:e}wt.AST=Uh,wt.Minimatch=jh,wt.escape=function(s){let{windowsPathsNoEscape:e=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e?s.replace(/[?*()[\]]/g,"[$&]"):s.replace(/[?*()[\]\\]/g,"\\$&")},wt.unescape=tl;const s0=(ap=function(s,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=et({url:Pe(s.remoteURL,Be(e)),method:"COPY",headers:{Destination:Pe(s.remoteURL,Be(t)),Overwrite:r.overwrite===!1?"F":"T",Depth:r.shallow?"0":"infinity"}},s,r);return o=function(i){tt(s,i)},(n=Qe(a,s))&&n.then||(n=Promise.resolve(n)),o?n.then(o):n;var n,o},function(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];try{return Promise.resolve(ap.apply(this,s))}catch(t){return Promise.reject(t)}});var ap,id=be(635),r0=be(829),js=be.n(r0),wo=function(s){return s.Array="array",s.Object="object",s.Original="original",s}(wo||{});function bc(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wo.Original;const r=js().get(s,e);return t==="array"&&Array.isArray(r)===!1?[r]:t==="object"&&Array.isArray(r)?r[0]:r}function pc(s){return new Promise(e=>{e(function(t){const{multistatus:r}=t;if(r==="")return{multistatus:{response:[]}};if(!r)throw new Error("Invalid response: No root multistatus found");const a={multistatus:Array.isArray(r)?r[0]:r};return js().set(a,"multistatus.response",bc(a,"multistatus.response",wo.Array)),js().set(a,"multistatus.response",js().get(a,"multistatus.response").map(n=>function(o){const i=Object.assign({},o);return i.status?js().set(i,"status",bc(i,"status",wo.Object)):(js().set(i,"propstat",bc(i,"propstat",wo.Object)),js().set(i,"propstat.prop",bc(i,"propstat.prop",wo.Object))),i}(n))),a}(new id.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",textNodeName:"text",ignoreAttributes:!1,removeNSPrefix:!0,numberParseOptions:{hex:!0,leadingZeros:!1},attributeValueProcessor:(t,r,a)=>r==="true"||r==="false"?r==="true":r,tagValueProcessor(t,r,a){if(!a.endsWith("propstat.prop.displayname"))return r}}).parse(s)))})}function em(s,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const{getlastmodified:r=null,getcontentlength:a="0",resourcetype:n=null,getcontenttype:o=null,getetag:i=null}=s,u=n&&typeof n=="object"&&n.collection!==void 0?"directory":"file",c={filename:e,basename:Oh().basename(e),lastmod:r,size:parseInt(a,10),type:u,etag:typeof i=="string"?i.replace(/"/g,""):null};return u==="file"&&(c.mime=o&&typeof o=="string"?o.split(";")[0]:""),t&&(s.displayname!==void 0&&(s.displayname=String(s.displayname)),c.props=s),c}function Bg(s,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r=null;try{s.multistatus.response[0].propstat&&(r=s.multistatus.response[0])}catch(l){}if(!r)throw new Error("Failed getting item stat: bad response");const{propstat:{prop:a,status:n}}=r,[o,i,u]=n.split(" ",3),c=parseInt(i,10);if(c>=400){const l=new Error("Invalid response: ".concat(c," ").concat(u));throw l.status=c,l}return em(a,ic(e),t)}function Pg(s){switch(String(s)){case"-3":return"unlimited";case"-2":case"-1":return"unknown";default:return parseInt(String(s),10)}}function pm(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const od=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:r=!1}=t,a=et({url:Pe(s.remoteURL,Be(e)),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},s,t);return pm(Qe(a,s),function(n){return tt(s,n),pm(n.text(),function(o){return pm(pc(o),function(i){const u=Bg(i,e,r);return jn(n,u,r)})})})});function Og(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const a0=Dg(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=function(n){if(!n||n==="/")return[];let o=n;const i=[];do i.push(o),o=Oh().dirname(o);while(o&&o!=="/");return i}(ic(e));r.sort((n,o)=>n.length>o.length?1:o.length>n.length?-1:0);let a=!1;return function(n,o,i){if(typeof n[ip]=="function"){let d=function(p){try{for(;!(u=m.next()).done;)if((p=o(u.value))&&p.then){if(!op(p))return void p.then(d,l||(l=Et.bind(null,c=new yo,2)));p=p.v}c?Et(c,1,p):c=p}catch(E){Et(c||(c=new yo),2,E)}};var u,c,l,m=n[ip]();if(d(),m.return){var h=function(p){try{u.done||m.return()}catch(E){}return p};if(c&&c.then)return c.then(h,function(p){throw h(p)});h()}return c}if(!("length"in n))throw new TypeError("Object is not iterable");for(var g=[],w=0;w<n.length;w++)g.push(n[w]);return function(d,p,E){var y,S,N=-1;return function x(I){try{for(;++N<d.length&&(!E||!E());)if((I=p(N))&&I.then){if(!op(I))return void I.then(x,S||(S=Et.bind(null,y=new yo,2)));I=I.v}y?Et(y,1,I):y=I}catch(D){Et(y||(y=new yo),2,D)}}(),y}(g,function(d){return o(g[d])},i)}(r,function(n){return o=function(){return function(u,c){try{var l=Og(od(s,n),function(m){if(m.type!=="directory")throw new Error("Path includes a file: ".concat(e))})}catch(m){return c(m)}return l&&l.then?l.then(void 0,c):l}(0,function(u){const c=u;return function(){if(c.status===404)return a=!0,np(Af(s,n,fs(ct({},t),{recursive:!1})));throw u}()})},(i=function(){if(a)return np(Af(s,n,fs(ct({},t),{recursive:!1})))}())&&i.then?i.then(o):o();var o,i},function(){return!1})});function Dg(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}function n0(){}function np(s,e){return s&&s.then?s.then(n0):Promise.resolve()}const ip=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function Et(s,e,t){if(!s.s){if(t instanceof yo){if(!t.s)return void(t.o=Et.bind(null,s,e));1&e&&(e=t.s),t=t.v}if(t&&t.then)return void t.then(Et.bind(null,s,e),Et.bind(null,s,2));s.s=e,s.v=t;const r=s.o;r&&r(s)}}const yo=function(){function s(){}return s.prototype.then=function(e,t){const r=new s,a=this.s;if(a){const n=1&a?e:t;if(n){try{Et(r,1,n(this.v))}catch(o){Et(r,2,o)}return r}return this}return this.o=function(n){try{const o=n.v;1&n.s?Et(r,1,e?e(o):o):t?Et(r,1,t(o)):Et(r,2,o)}catch(o){Et(r,2,o)}},r},s}();function op(s){return s instanceof yo&&1&s.s}const Af=Dg(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t.recursive===!0)return a0(s,e,t);const r=et({url:Pe(s.remoteURL,(a=Be(e),a.endsWith("/")?a:a+"/")),method:"MKCOL"},s,t);var a;return Og(Qe(r,s),function(n){tt(s,n)})});var i0=be(388),lp=be.n(i0);const o0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r={};if(typeof t.range=="object"&&typeof t.range.start=="number"){let i="bytes=".concat(t.range.start,"-");typeof t.range.end=="number"&&(i="".concat(i).concat(t.range.end)),r.Range=i}const a=et({url:Pe(s.remoteURL,Be(e)),method:"GET",headers:r},s,t);return o=function(i){if(tt(s,i),r.Range&&i.status!==206){const u=new Error("Invalid response code for partial request: ".concat(i.status));throw u.status=i.status,u}return t.callback&&setTimeout(()=>{t.callback(i)},0),i.body},(n=Qe(a,s))&&n.then||(n=Promise.resolve(n)),o?n.then(o):n;var n,o}),l0=()=>{},u0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e,t){t.url||(t.url=Pe(s.remoteURL,Be(e)));const r=et(t,s,{});return n=function(o){return tt(s,o),o},(a=Qe(r,s))&&a.then||(a=Promise.resolve(a)),n?a.then(n):a;var a,n}),c0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=et({url:Pe(s.remoteURL,Be(e)),method:"DELETE"},s,t);return n=function(o){tt(s,o)},(a=Qe(r,s))&&a.then||(a=Promise.resolve(a)),n?a.then(n):a;var a,n}),h0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function(r,a){try{var n=(o=od(s,e,t),i=function(){return!0},u?i?i(o):o:(o&&o.then||(o=Promise.resolve(o)),i?o.then(i):o))}catch(c){return a(c)}var o,i,u;return n&&n.then?n.then(void 0,a):n}(0,function(r){if(r.status===404)return!1;throw r})});function gm(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const m0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=et({url:Pe(s.remoteURL,Be(e),"/"),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:t.deep?"infinity":"1"}},s,t);return gm(Qe(r,s),function(a){return tt(s,a),gm(a.text(),function(n){if(!n)throw new Error("Failed parsing directory contents: Empty response");return gm(pc(n),function(o){const i=_d(e);let u=function(c,l,m){let h=arguments.length>3&&arguments[3]!==void 0&&arguments[3],g=arguments.length>4&&arguments[4]!==void 0&&arguments[4];const w=Oh().join(l,"/"),{multistatus:{response:d}}=c,p=d.map(E=>{const y=function(N){try{return N.replace(/^https?:\/\/[^\/]+/,"")}catch(x){throw new It(x,"Failed normalising HREF")}}(E.href),{propstat:{prop:S}}=E;return em(S,w==="/"?decodeURIComponent(ic(y)):ic(Oh().relative(decodeURIComponent(w),decodeURIComponent(y))),h)});return g?p:p.filter(E=>E.basename&&(E.type==="file"||E.filename!==m.replace(/\/$/,"")))}(o,_d(s.remoteBasePath||s.remotePath),i,t.details,t.includeSelf);return t.glob&&(u=function(c,l){return c.filter(m=>wt(m.filename,l,{matchBase:!0}))}(u,t.glob)),jn(a,u,t.details)})})})});function ld(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}const f0=ld(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=et({url:Pe(s.remoteURL,Be(e)),method:"GET",headers:{Accept:"text/plain"},transformResponse:[g0]},s,t);return $h(Qe(r,s),function(a){return tt(s,a),$h(a.text(),function(n){return jn(a,n,t.details)})})});function $h(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const d0=ld(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=et({url:Pe(s.remoteURL,Be(e)),method:"GET"},s,t);return $h(Qe(r,s),function(a){let n;return tt(s,a),function(o,i){var u=o();return u&&u.then?u.then(i):i()}(function(){return $h(a.arrayBuffer(),function(o){n=o})},function(){return jn(a,n,t.details)})})}),p0=ld(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{format:r="binary"}=t;if(r!=="binary"&&r!=="text")throw new It({info:{code:Ys.InvalidOutputFormat}},"Invalid output format: ".concat(r));return r==="text"?f0(s,e,t):d0(s,e,t)}),g0=s=>s;function w0(s){return new id.XMLBuilder({attributeNamePrefix:"@_",format:!0,ignoreAttributes:!1,suppressEmptyNode:!0}).build(Tg({lockinfo:{"@_xmlns:d":"DAV:",lockscope:{exclusive:{}},locktype:{write:{}},owner:{href:s}}},"d"))}function Tg(s,e){const t=ct({},s);for(const r in t)t.hasOwnProperty(r)&&(t[r]&&typeof t[r]=="object"&&r.indexOf(":")===-1?(t["".concat(e,":").concat(r)]=Tg(t[r],e),delete t[r]):/^@_/.test(r)===!1&&(t["".concat(e,":").concat(r)]=t[r],delete t[r]));return t}function Nf(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}function Rg(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}const y0=Rg(function(s,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=et({url:Pe(s.remoteURL,Be(e)),method:"UNLOCK",headers:{"Lock-Token":t}},s,r);return Nf(Qe(a,s),function(n){if(tt(s,n),n.status!==204&&n.status!==200)throw nd(n)})}),v0=Rg(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{refreshToken:r,timeout:a=b0}=t,n={Accept:"text/plain,application/xml",Timeout:a};r&&(n.If=r);const o=et({url:Pe(s.remoteURL,Be(e)),method:"LOCK",headers:n,data:w0(s.contactHref)},s,t);return Nf(Qe(o,s),function(i){return tt(s,i),Nf(i.text(),function(u){const c=(h=u,new id.XMLParser({removeNSPrefix:!0,parseAttributeValue:!0,parseTagValue:!0}).parse(h)),l=js().get(c,"prop.lockdiscovery.activelock.locktoken.href"),m=js().get(c,"prop.lockdiscovery.activelock.timeout");var h;if(!l)throw nd(i,"No lock token received: ");return{token:l,serverTimeout:m}})})}),b0="Infinite, Second-4100000000";function wm(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const S0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.path||"/",r=et({url:Pe(s.remoteURL,t),method:"PROPFIND",headers:{Accept:"text/plain,application/xml",Depth:"0"}},s,e);return wm(Qe(r,s),function(a){return tt(s,a),wm(a.text(),function(n){return wm(pc(n),function(o){const i=function(u){try{const[c]=u.multistatus.response,{propstat:{prop:{"quota-used-bytes":l,"quota-available-bytes":m}}}=c;return l!==void 0&&m!==void 0?{used:parseInt(String(l),10),available:Pg(m)}:null}catch(c){}return null}(o);return jn(a,i,e.details)})})})});function ym(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const A0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{details:r=!1}=t,a=et({url:Pe(s.remoteURL,Be(e)),method:"SEARCH",headers:{Accept:"text/plain,application/xml","Content-Type":s.headers["Content-Type"]||"application/xml; charset=utf-8"}},s,t);return ym(Qe(a,s),function(n){return tt(s,n),ym(n.text(),function(o){return ym(pc(o),function(i){const u=function(c,l,m){const h={truncated:!1,results:[]};return h.truncated=c.multistatus.response.some(g=>{var w,d;return((d=(g.status||((w=g.propstat)==null?void 0:w.status)).split(" ",3))==null?void 0:d[1])==="507"&&g.href.replace(/\/$/,"").endsWith(Be(l).replace(/\/$/,""))}),c.multistatus.response.forEach(g=>{if(g.propstat===void 0)return;const w=g.href.split("/").map(decodeURIComponent).join("/");h.results.push(em(g.propstat.prop,w,m))}),h}(i,e,r);return jn(n,u,r)})})})}),N0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=et({url:Pe(s.remoteURL,Be(e)),method:"MOVE",headers:{Destination:Pe(s.remoteURL,Be(t)),Overwrite:r.overwrite===!1?"F":"T"}},s,r);return o=function(i){tt(s,i)},(n=Qe(a,s))&&n.then||(n=Promise.resolve(n)),o?n.then(o):n;var n,o});var k0=be(172);const E0=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const{contentLength:a=!0,overwrite:n=!0}=r,o={"Content-Type":"application/octet-stream"};a===!1||(o["Content-Length"]=typeof a=="number"?"".concat(a):"".concat(function(l){if(Sg(l))return l.byteLength;if(Ag(l))return l.length;if(typeof l=="string")return(0,k0.d)(l);throw new It({info:{code:Ys.DataTypeNoLength}},"Cannot calculate data length: Invalid type")}(t))),n||(o["If-None-Match"]="*");const i=et({url:Pe(s.remoteURL,Be(e)),method:"PUT",headers:o,data:t},s,r);return c=function(l){try{tt(s,l)}catch(m){const h=m;if(h.status!==412||n)throw h;return!1}return!0},(u=Qe(i,s))&&u.then||(u=Promise.resolve(u)),c?u.then(c):u;var u,c}),Lg=function(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}(function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=et({url:Pe(s.remoteURL,Be(e)),method:"OPTIONS"},s,t);return n=function(o){var i,u;try{tt(s,o)}catch(c){throw c}return{compliance:((i=o.headers.get("DAV"))!=null?i:"").split(",").map(c=>c.trim()),server:(u=o.headers.get("Server"))!=null?u:""}},(a=Qe(r,s))&&a.then||(a=Promise.resolve(a)),n?a.then(n):a;var a,n});function Qu(s,e,t){return s&&s.then||(s=Promise.resolve(s)),e?s.then(e):s}const C0=ud(function(s,e,t,r,a){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(t>r||t<0)throw new It({info:{code:Ys.InvalidUpdateRange}},"Invalid update range ".concat(t," for partial update"));const o={"Content-Type":"application/octet-stream","Content-Length":""+(r-t+1),"Content-Range":"bytes ".concat(t,"-").concat(r,"/*")},i=et({url:Pe(s.remoteURL,Be(e)),method:"PUT",headers:o,data:a},s,n);return Qu(Qe(i,s),function(u){tt(s,u)})});function up(s,e){var t=s();return t&&t.then?t.then(e):e(t)}const I0=ud(function(s,e,t,r,a){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(t>r||t<0)throw new It({info:{code:Ys.InvalidUpdateRange}},"Invalid update range ".concat(t," for partial update"));const o={"Content-Type":"application/x-sabredav-partialupdate","Content-Length":""+(r-t+1),"X-Update-Range":"bytes=".concat(t,"-").concat(r)},i=et({url:Pe(s.remoteURL,Be(e)),method:"PATCH",headers:o,data:a},s,n);return Qu(Qe(i,s),function(u){tt(s,u)})});function ud(s){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(s.apply(this,e))}catch(r){return Promise.reject(r)}}}const V0=ud(function(s,e,t,r,a){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};return Qu(Lg(s,e,n),function(o){let i=!1;return up(function(){if(o.compliance.includes("sabredav-partialupdate"))return Qu(I0(s,e,t,r,a,n),function(u){return i=!0,u})},function(u){let c=!1;return i?u:up(function(){if(o.server.includes("Apache")&&o.compliance.includes("<http://apache.org/dav/propset/fs/1>"))return Qu(C0(s,e,t,r,a,n),function(l){return c=!0,l})},function(l){if(c)return l;throw new It({info:{code:Ys.NotSupported}},"Not supported")})})})}),x0="https://github.com/perry-mitchell/webdav-client/blob/master/LOCK_CONTACT.md";function B0(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{authType:t=null,remoteBasePath:r,contactHref:a=x0,ha1:n,headers:o={},httpAgent:i,httpsAgent:u,password:c,token:l,username:m,withCredentials:h}=e;let g=t;g||(g=m||c?kt.Password:kt.None);const w={authType:g,remoteBasePath:r,contactHref:a,ha1:n,headers:Object.assign({},o),httpAgent:i,httpsAgent:u,password:c,remotePath:yy(s),remoteURL:s,token:l,username:m,withCredentials:h};return yg(w,m,c,l,n),{copyFile:(d,p,E)=>s0(w,d,p,E),createDirectory:(d,p)=>Af(w,d,p),createReadStream:(d,p)=>function(E,y){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const N=new(lp()).PassThrough;return o0(E,y,S).then(x=>{x.pipe(N)}).catch(x=>{N.emit("error",x)}),N}(w,d,p),createWriteStream:(d,p,E)=>function(y,S){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:l0;const I=new(lp()).PassThrough,D={};N.overwrite===!1&&(D["If-None-Match"]="*");const V=et({url:Pe(y.remoteURL,Be(S)),method:"PUT",headers:D,data:I,maxRedirects:0},y,N);return Qe(V,y).then(k=>tt(y,k)).then(k=>{setTimeout(()=>{x(k)},0)}).catch(k=>{I.emit("error",k)}),I}(w,d,p,E),customRequest:(d,p)=>u0(w,d,p),deleteFile:(d,p)=>c0(w,d,p),exists:(d,p)=>h0(w,d,p),getDirectoryContents:(d,p)=>m0(w,d,p),getFileContents:(d,p)=>p0(w,d,p),getFileDownloadLink:d=>function(p,E){let y=Pe(p.remoteURL,Be(E));const S=/^https:/i.test(y)?"https":"http";switch(p.authType){case kt.None:break;case kt.Password:{const N=Xd(p.headers.Authorization.replace(/^Basic /i,"").trim());y=y.replace(/^https?:\/\//,"".concat(S,"://").concat(N,"@"));break}default:throw new It({info:{code:Ys.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(p.authType))}return y}(w,d),getFileUploadLink:d=>function(p,E){let y="".concat(Pe(p.remoteURL,Be(E)),"?Content-Type=application/octet-stream");const S=/^https:/i.test(y)?"https":"http";switch(p.authType){case kt.None:break;case kt.Password:{const N=Xd(p.headers.Authorization.replace(/^Basic /i,"").trim());y=y.replace(/^https?:\/\//,"".concat(S,"://").concat(N,"@"));break}default:throw new It({info:{code:Ys.LinkUnsupportedAuthType}},"Unsupported auth type for file link: ".concat(p.authType))}return y}(w,d),getHeaders:()=>Object.assign({},w.headers),getQuota:d=>S0(w,d),lock:(d,p)=>v0(w,d,p),moveFile:(d,p,E)=>N0(w,d,p,E),putFileContents:(d,p,E)=>E0(w,d,p,E),partialUpdateFileContents:(d,p,E,y,S)=>V0(w,d,p,E,y,S),getDAVCompliance:d=>Lg(w,d),search:(d,p)=>A0(w,d,p),setHeaders:d=>{w.headers=Object.assign({},d)},stat:(d,p)=>od(w,d,p),unlock:(d,p,E)=>y0(w,d,p,E)}}ts.hT,ts.O4,ts.Kd,ts.YK;var P0=ts.UU,O0=ts.Gu,D0=ts.ky,T0=ts.h4;ts.ch,ts.hq,ts.i5;const Ao=hf().setApp("@nextcloud/files").detectUser().build();var Ug=(s=>(s.Folder="folder",s.File="file",s))(Ug||{}),jg=(s=>(s[s.NONE=0]="NONE",s[s.CREATE=4]="CREATE",s[s.READ=1]="READ",s[s.UPDATE=2]="UPDATE",s[s.DELETE=8]="DELETE",s[s.SHARE=16]="SHARE",s[s.ALL=31]="ALL",s))(jg||{});const $g=["d:getcontentlength","d:getcontenttype","d:getetag","d:getlastmodified","d:creationdate","d:displayname","d:quota-available-bytes","d:resourcetype","nc:has-preview","nc:is-encrypted","nc:mount-type","oc:comments-unread","oc:favorite","oc:fileid","oc:owner-display-name","oc:owner-id","oc:permissions","oc:size"],Kg={d:"DAV:",nc:"http://nextcloud.org/ns",oc:"http://owncloud.org/ns",ocs:"http://open-collaboration-services.org/ns"},vm=function(s,e={nc:"http://nextcloud.org/ns"}){typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...$g],window._nc_dav_namespaces=ct({},Kg));const t=ct(ct({},window._nc_dav_namespaces),e);if(window._nc_dav_properties.find(a=>a===s))return Ao.warn("".concat(s," already registered"),{prop:s}),!1;if(s.startsWith("<")||s.split(":").length!==2)return Ao.error("".concat(s," is not valid. See example: 'oc:fileid'"),{prop:s}),!1;const r=s.split(":")[0];return t[r]?(window._nc_dav_properties.push(s),window._nc_dav_namespaces=t,!0):(Ao.error("".concat(s," namespace unknown"),{prop:s,namespaces:t}),!1)},R0=function(){return typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...$g]),window._nc_dav_properties.map(s=>"<".concat(s," />")).join(" ")},L0=function(){return typeof window._nc_dav_namespaces>"u"&&(window._nc_dav_namespaces=ct({},Kg)),Object.keys(window._nc_dav_namespaces).map(s=>{var e;return"xmlns:".concat(s,'="').concat((e=window._nc_dav_namespaces)==null?void 0:e[s],'"')}).join(" ")},U0=function(){return'<?xml version="1.0"?>\n		<d:propfind '.concat(L0(),">\n			<d:prop>\n				").concat(R0(),"\n			</d:prop>\n		</d:propfind>")};function j0(){var s;return dg()?"/files/".concat(uy()):"/files/".concat((s=ed())==null?void 0:s.uid)}j0();function $0(){const s=Dw("dav");return dg()?s.replace("remote.php","public.php"):s}const K0=$0(),H0=function(s=K0,e={}){const t=P0(s,{headers:e});function r(a){t.setHeaders(fs(ct({},e),{"X-Requested-With":"XMLHttpRequest",requesttoken:a!=null?a:""}))}return Tw(r),r(Rw()),O0().patch("fetch",(a,n)=>{const o=n.headers;return o!=null&&o.method&&(n.method=o.method,delete o.method),fetch(a,n)}),t};var Hg={},kf={exports:{}};const M0=Lw(Uw);(function(s,e){var t=M0,r=t.Buffer;function a(o,i){for(var u in o)i[u]=o[u]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?s.exports=t:(a(t,e),e.Buffer=n);function n(o,i,u){return r(o,i,u)}n.prototype=Object.create(r.prototype),a(r,n),n.from=function(o,i,u){if(typeof o=="number")throw new TypeError("Argument must not be a number");return r(o,i,u)},n.alloc=function(o,i,u){if(typeof o!="number")throw new TypeError("Argument must be a number");var c=r(o);return i!==void 0?typeof u=="string"?c.fill(i,u):c.fill(i):c.fill(0),c},n.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r(o)},n.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}})(kf,kf.exports);var F0=kf.exports,cd=F0.Buffer,cp=cd.isEncoding||function(s){switch(s=""+s,s&&s.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function J0(s){if(!s)return"utf8";for(var e;;)switch(s){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return s;default:if(e)return;s=(""+s).toLowerCase(),e=!0}}function q0(s){var e=J0(s);if(typeof e!="string"&&(cd.isEncoding===cp||!cp(s)))throw new Error("Unknown encoding: "+s);return e||s}Hg.StringDecoder=sl;function sl(s){this.encoding=q0(s);var e;switch(this.encoding){case"utf16le":this.text=Y0,this.end=Z0,e=4;break;case"utf8":this.fillLast=G0,e=4;break;case"base64":this.text=Q0,this.end=ev,e=3;break;default:this.write=tv,this.end=sv;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=cd.allocUnsafe(e)}sl.prototype.write=function(s){if(s.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(s),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<s.length?e?e+this.text(s,t):this.text(s,t):e||""},sl.prototype.end=z0,sl.prototype.text=X0,sl.prototype.fillLast=function(s){if(this.lastNeed<=s.length)return s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);s.copy(this.lastChar,this.lastTotal-this.lastNeed,0,s.length),this.lastNeed-=s.length};function bm(s){return s<=127?0:s>>5===6?2:s>>4===14?3:s>>3===30?4:s>>6===2?-1:-2}function W0(s,e,t){var r=e.length-1;if(r<t)return 0;var a=bm(e[r]);return a>=0?(a>0&&(s.lastNeed=a-1),a):--r<t||a===-2?0:(a=bm(e[r]),a>=0?(a>0&&(s.lastNeed=a-2),a):--r<t||a===-2?0:(a=bm(e[r]),a>=0?(a>0&&(a===2?a=0:s.lastNeed=a-3),a):0))}function _0(s,e,t){if((e[0]&192)!==128)return s.lastNeed=0,"";if(s.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return s.lastNeed=1,"";if(s.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return s.lastNeed=2,""}}function G0(s){var e=this.lastTotal-this.lastNeed,t=_0(this,s);if(t!==void 0)return t;if(this.lastNeed<=s.length)return s.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);s.copy(this.lastChar,e,0,s.length),this.lastNeed-=s.length}function X0(s,e){var t=W0(this,s,e);if(!this.lastNeed)return s.toString("utf8",e);this.lastTotal=t;var r=s.length-(t-this.lastNeed);return s.copy(this.lastChar,0,r),s.toString("utf8",e,r)}function z0(s){var e=s&&s.length?this.write(s):"";return this.lastNeed?e+"":e}function Y0(s,e){if((s.length-e)%2===0){var t=s.toString("utf16le",e);if(t){var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=s[s.length-1],s.toString("utf16le",e,s.length-1)}function Z0(s){var e=s&&s.length?this.write(s):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Q0(s,e){var t=(s.length-e)%3;return t===0?s.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=s[s.length-1]:(this.lastChar[0]=s[s.length-2],this.lastChar[1]=s[s.length-1]),s.toString("base64",e,s.length-t))}function ev(s){var e=s&&s.length?this.write(s):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function tv(s){return s.toString(this.encoding)}function sv(s){return s&&s.length?this.write(s):""}var Sm={},hd=(s=>(s.DEFAULT="default",s.HIDDEN="hidden",s))(hd||{});class rv{constructor(e){Fe(this,"_action");this.validateAction(e),this._action=e}get id(){return this._action.id}get displayName(){return this._action.displayName}get title(){return this._action.title}get iconSvgInline(){return this._action.iconSvgInline}get enabled(){return this._action.enabled}get exec(){return this._action.exec}get execBatch(){return this._action.execBatch}get hotkey(){return this._action.hotkey}get order(){return this._action.order}get parent(){return this._action.parent}get default(){return this._action.default}get destructive(){return this._action.destructive}get inline(){return this._action.inline}get renderInline(){return this._action.renderInline}validateAction(e){if(!e.id||typeof e.id!="string")throw new Error("Invalid id");if(!e.displayName||typeof e.displayName!="function")throw new Error("Invalid displayName function");if("title"in e&&typeof e.title!="function")throw new Error("Invalid title function");if(!e.iconSvgInline||typeof e.iconSvgInline!="function")throw new Error("Invalid iconSvgInline function");if(!e.exec||typeof e.exec!="function")throw new Error("Invalid exec function");if("enabled"in e&&typeof e.enabled!="function")throw new Error("Invalid enabled function");if("execBatch"in e&&typeof e.execBatch!="function")throw new Error("Invalid execBatch function");if("order"in e&&typeof e.order!="number")throw new Error("Invalid order");if(e.destructive!==void 0&&typeof e.destructive!="boolean")throw new Error("Invalid destructive flag");if("parent"in e&&typeof e.parent!="string")throw new Error("Invalid parent");if(e.default&&!Object.values(hd).includes(e.default))throw new Error("Invalid default");if("inline"in e&&typeof e.inline!="function")throw new Error("Invalid inline function");if("renderInline"in e&&typeof e.renderInline!="function")throw new Error("Invalid renderInline function");if("hotkey"in e&&e.hotkey!==void 0){if(typeof e.hotkey!="object")throw new Error("Invalid hotkey configuration");if(typeof e.hotkey.key!="string"||!e.hotkey.key)throw new Error("Missing or invalid hotkey key");if(typeof e.hotkey.description!="string"||!e.hotkey.description)throw new Error("Missing or invalid hotkey description")}}}const av=function(s){if(typeof window._nc_fileactions>"u"&&(window._nc_fileactions=[],Ao.debug("FileActions initialized")),window._nc_fileactions.find(e=>e.id===s.id)){Ao.error("FileAction ".concat(s.id," already registered"),{action:s});return}window._nc_fileactions.push(s)},nv=function(){return typeof window._nc_fileactions>"u"&&(window._nc_fileactions=[],Ao.debug("FileActions initialized")),window._nc_fileactions};var hp,mp;function Mg(){return mp||(mp=1,hp=typeof ze=="object"&&Sm&&Sm.NODE_DEBUG&&/\bsemver\b/i.test(Sm.NODE_DEBUG)?(...s)=>console.error("SEMVER",...s):()=>{}),hp}var Am,fp;function Fg(){if(fp)return Am;fp=1;const s="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,a=e-6;return Am={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:a,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:s,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Am}var Nm={exports:{}},dp;function iv(){return dp||(dp=1,function(s,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:a}=Fg(),n=Mg();e=s.exports={};const o=e.re=[],i=e.safeRe=[],u=e.src=[],c=e.safeSrc=[],l=e.t={};let m=0;const h="[a-zA-Z0-9-]",g=[["\\s",1],["\\d",a],[h,r]],w=p=>{for(const[E,y]of g)p=p.split("".concat(E,"*")).join("".concat(E,"{0,").concat(y,"}")).split("".concat(E,"+")).join("".concat(E,"{1,").concat(y,"}"));return p},d=(p,E,y)=>{const S=w(E),N=m++;n(p,N,E),l[p]=N,u[N]=E,c[N]=S,o[N]=new RegExp(E,y?"g":void 0),i[N]=new RegExp(S,y?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(h,"*")),d("MAINVERSION","(".concat(u[l.NUMERICIDENTIFIER],")\\.(").concat(u[l.NUMERICIDENTIFIER],")\\.(").concat(u[l.NUMERICIDENTIFIER],")")),d("MAINVERSIONLOOSE","(".concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.(").concat(u[l.NUMERICIDENTIFIERLOOSE],")\\.(").concat(u[l.NUMERICIDENTIFIERLOOSE],")")),d("PRERELEASEIDENTIFIER","(?:".concat(u[l.NONNUMERICIDENTIFIER],"|").concat(u[l.NUMERICIDENTIFIER],")")),d("PRERELEASEIDENTIFIERLOOSE","(?:".concat(u[l.NONNUMERICIDENTIFIER],"|").concat(u[l.NUMERICIDENTIFIERLOOSE],")")),d("PRERELEASE","(?:-(".concat(u[l.PRERELEASEIDENTIFIER],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIER],")*))")),d("PRERELEASELOOSE","(?:-?(".concat(u[l.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(u[l.PRERELEASEIDENTIFIERLOOSE],")*))")),d("BUILDIDENTIFIER","".concat(h,"+")),d("BUILD","(?:\\+(".concat(u[l.BUILDIDENTIFIER],"(?:\\.").concat(u[l.BUILDIDENTIFIER],")*))")),d("FULLPLAIN","v?".concat(u[l.MAINVERSION]).concat(u[l.PRERELEASE],"?").concat(u[l.BUILD],"?")),d("FULL","^".concat(u[l.FULLPLAIN],"$")),d("LOOSEPLAIN","[v=\\s]*".concat(u[l.MAINVERSIONLOOSE]).concat(u[l.PRERELEASELOOSE],"?").concat(u[l.BUILD],"?")),d("LOOSE","^".concat(u[l.LOOSEPLAIN],"$")),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE","".concat(u[l.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),d("XRANGEIDENTIFIER","".concat(u[l.NUMERICIDENTIFIER],"|x|X|\\*")),d("XRANGEPLAIN","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIER],")(?:\\.(").concat(u[l.XRANGEIDENTIFIER],")(?:\\.(").concat(u[l.XRANGEIDENTIFIER],")(?:").concat(u[l.PRERELEASE],")?").concat(u[l.BUILD],"?)?)?")),d("XRANGEPLAINLOOSE","[v=\\s]*(".concat(u[l.XRANGEIDENTIFIERLOOSE],")(?:\\.(").concat(u[l.XRANGEIDENTIFIERLOOSE],")(?:\\.(").concat(u[l.XRANGEIDENTIFIERLOOSE],")(?:").concat(u[l.PRERELEASELOOSE],")?").concat(u[l.BUILD],"?)?)?")),d("XRANGE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAIN],"$")),d("XRANGELOOSE","^".concat(u[l.GTLT],"\\s*").concat(u[l.XRANGEPLAINLOOSE],"$")),d("COERCEPLAIN","(^|[^\\d])(\\d{1,".concat(t,"})(?:\\.(\\d{1,").concat(t,"}))?(?:\\.(\\d{1,").concat(t,"}))?")),d("COERCE","".concat(u[l.COERCEPLAIN],"(?:$|[^\\d])")),d("COERCEFULL",u[l.COERCEPLAIN]+"(?:".concat(u[l.PRERELEASE],")?(?:").concat(u[l.BUILD],")?(?:$|[^\\d])")),d("COERCERTL",u[l.COERCE],!0),d("COERCERTLFULL",u[l.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM","(\\s*)".concat(u[l.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",d("TILDE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAIN],"$")),d("TILDELOOSE","^".concat(u[l.LONETILDE]).concat(u[l.XRANGEPLAINLOOSE],"$")),d("LONECARET","(?:\\^)"),d("CARETTRIM","(\\s*)".concat(u[l.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",d("CARET","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAIN],"$")),d("CARETLOOSE","^".concat(u[l.LONECARET]).concat(u[l.XRANGEPLAINLOOSE],"$")),d("COMPARATORLOOSE","^".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],")$|^$")),d("COMPARATOR","^".concat(u[l.GTLT],"\\s*(").concat(u[l.FULLPLAIN],")$|^$")),d("COMPARATORTRIM","(\\s*)".concat(u[l.GTLT],"\\s*(").concat(u[l.LOOSEPLAIN],"|").concat(u[l.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE","^\\s*(".concat(u[l.XRANGEPLAIN],")\\s+-\\s+(").concat(u[l.XRANGEPLAIN],")\\s*$")),d("HYPHENRANGELOOSE","^\\s*(".concat(u[l.XRANGEPLAINLOOSE],")\\s+-\\s+(").concat(u[l.XRANGEPLAINLOOSE],")\\s*$")),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Nm,Nm.exports)),Nm.exports}var km,pp;function ov(){if(pp)return km;pp=1;const s=Object.freeze({loose:!0}),e=Object.freeze({});return km=t=>t?typeof t!="object"?s:t:e,km}var Em,gp;function lv(){if(gp)return Em;gp=1;const s=/^[0-9]+$/,e=(t,r)=>{if(typeof t=="number"&&typeof r=="number")return t===r?0:t<r?-1:1;const a=s.test(t),n=s.test(r);return a&&n&&(t=+t,r=+r),t===r?0:a&&!n?-1:n&&!a?1:t<r?-1:1};return Em={compareIdentifiers:e,rcompareIdentifiers:(t,r)=>e(r,t)},Em}var Cm,wp;function Jg(){if(wp)return Cm;wp=1;const s=Mg(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=Fg(),{safeRe:r,t:a}=iv(),n=ov(),{compareIdentifiers:o}=lv();class i{constructor(c,l){if(l=n(l),c instanceof i){if(c.loose===!!l.loose&&c.includePrerelease===!!l.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof c,'".'));if(c.length>e)throw new TypeError("version is longer than ".concat(e," characters"));s("SemVer",c,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const m=c.trim().match(l.loose?r[a.LOOSE]:r[a.FULL]);if(!m)throw new TypeError("Invalid Version: ".concat(c));if(this.raw=c,this.major=+m[1],this.minor=+m[2],this.patch=+m[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");m[4]?this.prerelease=m[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const g=+h;if(g>=0&&g<t)return g}return h}):this.prerelease=[],this.build=m[5]?m[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(c){if(s("SemVer.compare",this.version,this.options,c),!(c instanceof i)){if(typeof c=="string"&&c===this.version)return 0;c=new i(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof i||(c=new i(c,this.options)),this.major<c.major?-1:this.major>c.major?1:this.minor<c.minor?-1:this.minor>c.minor?1:this.patch<c.patch?-1:this.patch>c.patch?1:0}comparePre(c){if(c instanceof i||(c=new i(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let l=0;do{const m=this.prerelease[l],h=c.prerelease[l];if(s("prerelease compare",l,m,h),m===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(m===void 0)return-1;if(m!==h)return o(m,h)}while(++l)}compareBuild(c){c instanceof i||(c=new i(c,this.options));let l=0;do{const m=this.build[l],h=c.build[l];if(s("build compare",l,m,h),m===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(m===void 0)return-1;if(m!==h)return o(m,h)}while(++l)}inc(c,l,m){if(c.startsWith("pre")){if(!l&&m===!1)throw new Error("invalid increment argument: identifier is empty");if(l){const h="-".concat(l).match(this.options.loose?r[a.PRERELEASELOOSE]:r[a.PRERELEASE]);if(!h||h[1]!==l)throw new Error("invalid identifier: ".concat(l))}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",l,m);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",l,m);break;case"prepatch":this.prerelease.length=0,this.inc("patch",l,m),this.inc("pre",l,m);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",l,m),this.inc("pre",l,m);break;case"release":if(this.prerelease.length===0)throw new Error("version ".concat(this.raw," is not a prerelease"));this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(m)?1:0;if(this.prerelease.length===0)this.prerelease=[h];else{let g=this.prerelease.length;for(;--g>=0;)typeof this.prerelease[g]=="number"&&(this.prerelease[g]++,g=-2);if(g===-1){if(l===this.prerelease.join(".")&&m===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(l){let g=[l,h];m===!1&&(g=[l]),o(this.prerelease[0],l)===0?isNaN(this.prerelease[1])&&(this.prerelease=g):this.prerelease=g}break}default:throw new Error("invalid increment argument: ".concat(c))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}return Cm=i,Cm}var Im,yp;function uv(){if(yp)return Im;yp=1;const s=Jg();return Im=(e,t)=>new s(e,t).major,Im}uv();var Vm,vp;function cv(){if(vp)return Vm;vp=1;const s=Jg();return Vm=(e,t,r=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(a){if(!r)return null;throw a}},Vm}var xm,bp;function hv(){if(bp)return xm;bp=1;const s=cv();return xm=(e,t)=>{const r=s(e,t);return r?r.version:null},xm}hv();var Sp={},Ap;function mv(){return Ap||(Ap=1,function(s){(function(e){e.parser=function(A,v){return new r(A,v)},e.SAXParser=r,e.SAXStream=l,e.createStream=c,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function r(A,v){if(!(this instanceof r))return new r(A,v);var O=this;n(O),O.q=O.c="",O.bufferCheckPosition=e.MAX_BUFFER_LENGTH,O.opt=v||{},O.opt.lowercase=O.opt.lowercase||O.opt.lowercasetags,O.looseCase=O.opt.lowercase?"toLowerCase":"toUpperCase",O.tags=[],O.closed=O.closedRoot=O.sawRoot=!1,O.tag=O.error=null,O.strict=!!A,O.noscript=!!(A||O.opt.noscript),O.state=k.BEGIN,O.strictEntities=O.opt.strictEntities,O.ENTITIES=O.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),O.attribList=[],O.opt.xmlns&&(O.ns=Object.create(d)),O.opt.unquotedAttributeValues===void 0&&(O.opt.unquotedAttributeValues=!A),O.trackPosition=O.opt.position!==!1,O.trackPosition&&(O.position=O.line=O.column=0),j(O,"onready")}Object.create||(Object.create=function(A){function v(){}v.prototype=A;var O=new v;return O}),Object.keys||(Object.keys=function(A){var v=[];for(var O in A)A.hasOwnProperty(O)&&v.push(O);return v});function a(A){for(var v=Math.max(e.MAX_BUFFER_LENGTH,10),O=0,B=0,ue=t.length;B<ue;B++){var ye=A[t[B]].length;if(ye>v)switch(t[B]){case"textNode":T(A);break;case"cdata":F(A,"oncdata",A.cdata),A.cdata="";break;case"script":F(A,"onscript",A.script),A.script="";break;default:_(A,"Max buffer length exceeded: "+t[B])}O=Math.max(O,ye)}var ae=e.MAX_BUFFER_LENGTH-O;A.bufferCheckPosition=ae+A.position}function n(A){for(var v=0,O=t.length;v<O;v++)A[t[v]]=""}function o(A){T(A),A.cdata!==""&&(F(A,"oncdata",A.cdata),A.cdata=""),A.script!==""&&(F(A,"onscript",A.script),A.script="")}r.prototype={end:function(){ie(this)},write:Lt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var i;try{i=require("stream").Stream}catch(A){i=function(){}}i||(i=function(){});var u=e.EVENTS.filter(function(A){return A!=="error"&&A!=="end"});function c(A,v){return new l(A,v)}function l(A,v){if(!(this instanceof l))return new l(A,v);i.apply(this),this._parser=new r(A,v),this.writable=!0,this.readable=!0;var O=this;this._parser.onend=function(){O.emit("end")},this._parser.onerror=function(B){O.emit("error",B),O._parser.error=null},this._decoder=null,u.forEach(function(B){Object.defineProperty(O,"on"+B,{get:function(){return O._parser["on"+B]},set:function(ue){if(!ue)return O.removeAllListeners(B),O._parser["on"+B]=ue,ue;O.on(B,ue)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(i.prototype,{constructor:{value:l}}),l.prototype.write=function(A){if(typeof lm=="function"&&typeof lm.isBuffer=="function"&&lm.isBuffer(A)){if(!this._decoder){var v=Hg.StringDecoder;this._decoder=new v("utf8")}A=this._decoder.write(A)}return this._parser.write(A.toString()),this.emit("data",A),!0},l.prototype.end=function(A){return A&&A.length&&this.write(A),this._parser.end(),!0},l.prototype.on=function(A,v){var O=this;return!O._parser["on"+A]&&u.indexOf(A)!==-1&&(O._parser["on"+A]=function(){var B=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);B.splice(0,0,A),O.emit.apply(O,B)}),i.prototype.on.call(O,A,v)};var m="[CDATA[",h="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",d={xml:g,xmlns:w},p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(A){return A===" "||A==="\n"||A==="\r"||A==="	"}function x(A){return A==='"'||A==="'"}function I(A){return A===">"||N(A)}function D(A,v){return A.test(v)}function V(A,v){return!D(A,v)}var k=0;e.STATE={BEGIN:k++,BEGIN_WHITESPACE:k++,TEXT:k++,TEXT_ENTITY:k++,OPEN_WAKA:k++,SGML_DECL:k++,SGML_DECL_QUOTED:k++,DOCTYPE:k++,DOCTYPE_QUOTED:k++,DOCTYPE_DTD:k++,DOCTYPE_DTD_QUOTED:k++,COMMENT_STARTING:k++,COMMENT:k++,COMMENT_ENDING:k++,COMMENT_ENDED:k++,CDATA:k++,CDATA_ENDING:k++,CDATA_ENDING_2:k++,PROC_INST:k++,PROC_INST_BODY:k++,PROC_INST_ENDING:k++,OPEN_TAG:k++,OPEN_TAG_SLASH:k++,ATTRIB:k++,ATTRIB_NAME:k++,ATTRIB_NAME_SAW_WHITE:k++,ATTRIB_VALUE:k++,ATTRIB_VALUE_QUOTED:k++,ATTRIB_VALUE_CLOSED:k++,ATTRIB_VALUE_UNQUOTED:k++,ATTRIB_VALUE_ENTITY_Q:k++,ATTRIB_VALUE_ENTITY_U:k++,CLOSE_TAG:k++,CLOSE_TAG_SAW_WHITE:k++,SCRIPT:k++,SCRIPT_ENDING:k++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(A){var v=e.ENTITIES[A],O=typeof v=="number"?String.fromCharCode(v):v;e.ENTITIES[A]=O});for(var M in e.STATE)e.STATE[e.STATE[M]]=M;k=e.STATE;function j(A,v,O){A[v]&&A[v](O)}function F(A,v,O){A.textNode&&T(A),j(A,v,O)}function T(A){A.textNode=Y(A.opt,A.textNode),A.textNode&&j(A,"ontext",A.textNode),A.textNode=""}function Y(A,v){return A.trim&&(v=v.trim()),A.normalize&&(v=v.replace(/\s+/g," ")),v}function _(A,v){return T(A),A.trackPosition&&(v+="\nLine: "+A.line+"\nColumn: "+A.column+"\nChar: "+A.c),v=new Error(v),A.error=v,j(A,"onerror",v),A}function ie(A){return A.sawRoot&&!A.closedRoot&&Z(A,"Unclosed root tag"),A.state!==k.BEGIN&&A.state!==k.BEGIN_WHITESPACE&&A.state!==k.TEXT&&_(A,"Unexpected end"),T(A),A.c="",A.closed=!0,j(A,"onend"),r.call(A,A.strict,A.opt),A}function Z(A,v){if(typeof A!="object"||!(A instanceof r))throw new Error("bad call to strictFail");A.strict&&_(A,v)}function me(A){A.strict||(A.tagName=A.tagName[A.looseCase]());var v=A.tags[A.tags.length-1]||A,O=A.tag={name:A.tagName,attributes:{}};A.opt.xmlns&&(O.ns=v.ns),A.attribList.length=0,F(A,"onopentagstart",O)}function Q(A,v){var O=A.indexOf(":"),B=O<0?["",A]:A.split(":"),ue=B[0],ye=B[1];return v&&A==="xmlns"&&(ue="xmlns",ye=""),{prefix:ue,local:ye}}function X(A){if(A.strict||(A.attribName=A.attribName[A.looseCase]()),A.attribList.indexOf(A.attribName)!==-1||A.tag.attributes.hasOwnProperty(A.attribName)){A.attribName=A.attribValue="";return}if(A.opt.xmlns){var v=Q(A.attribName,!0),O=v.prefix,B=v.local;if(O==="xmlns")if(B==="xml"&&A.attribValue!==g)Z(A,"xml: prefix must be bound to "+g+"\nActual: "+A.attribValue);else if(B==="xmlns"&&A.attribValue!==w)Z(A,"xmlns: prefix must be bound to "+w+"\nActual: "+A.attribValue);else{var ue=A.tag,ye=A.tags[A.tags.length-1]||A;ue.ns===ye.ns&&(ue.ns=Object.create(ye.ns)),ue.ns[B]=A.attribValue}A.attribList.push([A.attribName,A.attribValue])}else A.tag.attributes[A.attribName]=A.attribValue,F(A,"onattribute",{name:A.attribName,value:A.attribValue});A.attribName=A.attribValue=""}function G(A,v){if(A.opt.xmlns){var O=A.tag,B=Q(A.tagName);O.prefix=B.prefix,O.local=B.local,O.uri=O.ns[B.prefix]||"",O.prefix&&!O.uri&&(Z(A,"Unbound namespace prefix: "+JSON.stringify(A.tagName)),O.uri=B.prefix);var ue=A.tags[A.tags.length-1]||A;O.ns&&ue.ns!==O.ns&&Object.keys(O.ns).forEach(function(Td){F(A,"onopennamespace",{prefix:Td,uri:O.ns[Td]})});for(var ye=0,ae=A.attribList.length;ye<ae;ye++){var Bt=A.attribList[ye],Pt=Bt[0],Mn=Bt[1],ot=Q(Pt,!0),ks=ot.prefix,Iw=ot.local,Dd=ks===""?"":O.ns[ks]||"",nm={name:Pt,value:Mn,prefix:ks,local:Iw,uri:Dd};ks&&ks!=="xmlns"&&!Dd&&(Z(A,"Unbound namespace prefix: "+JSON.stringify(ks)),nm.uri=ks),A.tag.attributes[Pt]=nm,F(A,"onattribute",nm)}A.attribList.length=0}A.tag.isSelfClosing=!!v,A.sawRoot=!0,A.tags.push(A.tag),F(A,"onopentag",A.tag),v||(!A.noscript&&A.tagName.toLowerCase()==="script"?A.state=k.SCRIPT:A.state=k.TEXT,A.tag=null,A.tagName=""),A.attribName=A.attribValue="",A.attribList.length=0}function W(A){if(!A.tagName){Z(A,"Weird empty close tag."),A.textNode+="</>",A.state=k.TEXT;return}if(A.script){if(A.tagName!=="script"){A.script+="</"+A.tagName+">",A.tagName="",A.state=k.SCRIPT;return}F(A,"onscript",A.script),A.script=""}var v=A.tags.length,O=A.tagName;A.strict||(O=O[A.looseCase]());for(var B=O;v--;){var ue=A.tags[v];if(ue.name!==B)Z(A,"Unexpected close tag");else break}if(v<0){Z(A,"Unmatched closing tag: "+A.tagName),A.textNode+="</"+A.tagName+">",A.state=k.TEXT;return}A.tagName=O;for(var ye=A.tags.length;ye-- >v;){var ae=A.tag=A.tags.pop();A.tagName=A.tag.name,F(A,"onclosetag",A.tagName);var Bt={};for(var Pt in ae.ns)Bt[Pt]=ae.ns[Pt];var Mn=A.tags[A.tags.length-1]||A;A.opt.xmlns&&ae.ns!==Mn.ns&&Object.keys(ae.ns).forEach(function(ot){var ks=ae.ns[ot];F(A,"onclosenamespace",{prefix:ot,uri:ks})})}v===0&&(A.closedRoot=!0),A.tagName=A.attribValue=A.attribName="",A.attribList.length=0,A.state=k.TEXT}function re(A){var v=A.entity,O=v.toLowerCase(),B,ue="";return A.ENTITIES[v]?A.ENTITIES[v]:A.ENTITIES[O]?A.ENTITIES[O]:(v=O,v.charAt(0)==="#"&&(v.charAt(1)==="x"?(v=v.slice(2),B=parseInt(v,16),ue=B.toString(16)):(v=v.slice(1),B=parseInt(v,10),ue=B.toString(10))),v=v.replace(/^0+/,""),isNaN(B)||ue.toLowerCase()!==v?(Z(A,"Invalid character entity"),"&"+A.entity+";"):String.fromCodePoint(B))}function le(A,v){v==="<"?(A.state=k.OPEN_WAKA,A.startTagPosition=A.position):N(v)||(Z(A,"Non-whitespace before first tag."),A.textNode=v,A.state=k.TEXT)}function Ne(A,v){var O="";return v<A.length&&(O=A.charAt(v)),O}function Lt(A){var v=this;if(this.error)throw this.error;if(v.closed)return _(v,"Cannot write after close. Assign an onready handler.");if(A===null)return ie(v);typeof A=="object"&&(A=A.toString());for(var O=0,B="";B=Ne(A,O++),v.c=B,!!B;)switch(v.trackPosition&&(v.position++,B==="\n"?(v.line++,v.column=0):v.column++),v.state){case k.BEGIN:if(v.state=k.BEGIN_WHITESPACE,B==="\uFEFF")continue;le(v,B);continue;case k.BEGIN_WHITESPACE:le(v,B);continue;case k.TEXT:if(v.sawRoot&&!v.closedRoot){for(var ue=O-1;B&&B!=="<"&&B!=="&";)B=Ne(A,O++),B&&v.trackPosition&&(v.position++,B==="\n"?(v.line++,v.column=0):v.column++);v.textNode+=A.substring(ue,O-1)}B==="<"&&!(v.sawRoot&&v.closedRoot&&!v.strict)?(v.state=k.OPEN_WAKA,v.startTagPosition=v.position):(!N(B)&&(!v.sawRoot||v.closedRoot)&&Z(v,"Text data outside of root node."),B==="&"?v.state=k.TEXT_ENTITY:v.textNode+=B);continue;case k.SCRIPT:B==="<"?v.state=k.SCRIPT_ENDING:v.script+=B;continue;case k.SCRIPT_ENDING:B==="/"?v.state=k.CLOSE_TAG:(v.script+="<"+B,v.state=k.SCRIPT);continue;case k.OPEN_WAKA:if(B==="!")v.state=k.SGML_DECL,v.sgmlDecl="";else if(!N(B))if(D(p,B))v.state=k.OPEN_TAG,v.tagName=B;else if(B==="/")v.state=k.CLOSE_TAG,v.tagName="";else if(B==="?")v.state=k.PROC_INST,v.procInstName=v.procInstBody="";else{if(Z(v,"Unencoded <"),v.startTagPosition+1<v.position){var ye=v.position-v.startTagPosition;B=new Array(ye).join(" ")+B}v.textNode+="<"+B,v.state=k.TEXT}continue;case k.SGML_DECL:if(v.sgmlDecl+B==="--"){v.state=k.COMMENT,v.comment="",v.sgmlDecl="";continue}v.doctype&&v.doctype!==!0&&v.sgmlDecl?(v.state=k.DOCTYPE_DTD,v.doctype+="<!"+v.sgmlDecl+B,v.sgmlDecl=""):(v.sgmlDecl+B).toUpperCase()===m?(F(v,"onopencdata"),v.state=k.CDATA,v.sgmlDecl="",v.cdata=""):(v.sgmlDecl+B).toUpperCase()===h?(v.state=k.DOCTYPE,(v.doctype||v.sawRoot)&&Z(v,"Inappropriately located doctype declaration"),v.doctype="",v.sgmlDecl=""):B===">"?(F(v,"onsgmldeclaration",v.sgmlDecl),v.sgmlDecl="",v.state=k.TEXT):(x(B)&&(v.state=k.SGML_DECL_QUOTED),v.sgmlDecl+=B);continue;case k.SGML_DECL_QUOTED:B===v.q&&(v.state=k.SGML_DECL,v.q=""),v.sgmlDecl+=B;continue;case k.DOCTYPE:B===">"?(v.state=k.TEXT,F(v,"ondoctype",v.doctype),v.doctype=!0):(v.doctype+=B,B==="["?v.state=k.DOCTYPE_DTD:x(B)&&(v.state=k.DOCTYPE_QUOTED,v.q=B));continue;case k.DOCTYPE_QUOTED:v.doctype+=B,B===v.q&&(v.q="",v.state=k.DOCTYPE);continue;case k.DOCTYPE_DTD:B==="]"?(v.doctype+=B,v.state=k.DOCTYPE):B==="<"?(v.state=k.OPEN_WAKA,v.startTagPosition=v.position):x(B)?(v.doctype+=B,v.state=k.DOCTYPE_DTD_QUOTED,v.q=B):v.doctype+=B;continue;case k.DOCTYPE_DTD_QUOTED:v.doctype+=B,B===v.q&&(v.state=k.DOCTYPE_DTD,v.q="");continue;case k.COMMENT:B==="-"?v.state=k.COMMENT_ENDING:v.comment+=B;continue;case k.COMMENT_ENDING:B==="-"?(v.state=k.COMMENT_ENDED,v.comment=Y(v.opt,v.comment),v.comment&&F(v,"oncomment",v.comment),v.comment=""):(v.comment+="-"+B,v.state=k.COMMENT);continue;case k.COMMENT_ENDED:B!==">"?(Z(v,"Malformed comment"),v.comment+="--"+B,v.state=k.COMMENT):v.doctype&&v.doctype!==!0?v.state=k.DOCTYPE_DTD:v.state=k.TEXT;continue;case k.CDATA:B==="]"?v.state=k.CDATA_ENDING:v.cdata+=B;continue;case k.CDATA_ENDING:B==="]"?v.state=k.CDATA_ENDING_2:(v.cdata+="]"+B,v.state=k.CDATA);continue;case k.CDATA_ENDING_2:B===">"?(v.cdata&&F(v,"oncdata",v.cdata),F(v,"onclosecdata"),v.cdata="",v.state=k.TEXT):B==="]"?v.cdata+="]":(v.cdata+="]]"+B,v.state=k.CDATA);continue;case k.PROC_INST:B==="?"?v.state=k.PROC_INST_ENDING:N(B)?v.state=k.PROC_INST_BODY:v.procInstName+=B;continue;case k.PROC_INST_BODY:if(!v.procInstBody&&N(B))continue;B==="?"?v.state=k.PROC_INST_ENDING:v.procInstBody+=B;continue;case k.PROC_INST_ENDING:B===">"?(F(v,"onprocessinginstruction",{name:v.procInstName,body:v.procInstBody}),v.procInstName=v.procInstBody="",v.state=k.TEXT):(v.procInstBody+="?"+B,v.state=k.PROC_INST_BODY);continue;case k.OPEN_TAG:D(E,B)?v.tagName+=B:(me(v),B===">"?G(v):B==="/"?v.state=k.OPEN_TAG_SLASH:(N(B)||Z(v,"Invalid character in tag name"),v.state=k.ATTRIB));continue;case k.OPEN_TAG_SLASH:B===">"?(G(v,!0),W(v)):(Z(v,"Forward-slash in opening tag not followed by >"),v.state=k.ATTRIB);continue;case k.ATTRIB:if(N(B))continue;B===">"?G(v):B==="/"?v.state=k.OPEN_TAG_SLASH:D(p,B)?(v.attribName=B,v.attribValue="",v.state=k.ATTRIB_NAME):Z(v,"Invalid attribute name");continue;case k.ATTRIB_NAME:B==="="?v.state=k.ATTRIB_VALUE:B===">"?(Z(v,"Attribute without value"),v.attribValue=v.attribName,X(v),G(v)):N(B)?v.state=k.ATTRIB_NAME_SAW_WHITE:D(E,B)?v.attribName+=B:Z(v,"Invalid attribute name");continue;case k.ATTRIB_NAME_SAW_WHITE:if(B==="=")v.state=k.ATTRIB_VALUE;else{if(N(B))continue;Z(v,"Attribute without value"),v.tag.attributes[v.attribName]="",v.attribValue="",F(v,"onattribute",{name:v.attribName,value:""}),v.attribName="",B===">"?G(v):D(p,B)?(v.attribName=B,v.state=k.ATTRIB_NAME):(Z(v,"Invalid attribute name"),v.state=k.ATTRIB)}continue;case k.ATTRIB_VALUE:if(N(B))continue;x(B)?(v.q=B,v.state=k.ATTRIB_VALUE_QUOTED):(v.opt.unquotedAttributeValues||_(v,"Unquoted attribute value"),v.state=k.ATTRIB_VALUE_UNQUOTED,v.attribValue=B);continue;case k.ATTRIB_VALUE_QUOTED:if(B!==v.q){B==="&"?v.state=k.ATTRIB_VALUE_ENTITY_Q:v.attribValue+=B;continue}X(v),v.q="",v.state=k.ATTRIB_VALUE_CLOSED;continue;case k.ATTRIB_VALUE_CLOSED:N(B)?v.state=k.ATTRIB:B===">"?G(v):B==="/"?v.state=k.OPEN_TAG_SLASH:D(p,B)?(Z(v,"No whitespace between attributes"),v.attribName=B,v.attribValue="",v.state=k.ATTRIB_NAME):Z(v,"Invalid attribute name");continue;case k.ATTRIB_VALUE_UNQUOTED:if(!I(B)){B==="&"?v.state=k.ATTRIB_VALUE_ENTITY_U:v.attribValue+=B;continue}X(v),B===">"?G(v):v.state=k.ATTRIB;continue;case k.CLOSE_TAG:if(v.tagName)B===">"?W(v):D(E,B)?v.tagName+=B:v.script?(v.script+="</"+v.tagName,v.tagName="",v.state=k.SCRIPT):(N(B)||Z(v,"Invalid tagname in closing tag"),v.state=k.CLOSE_TAG_SAW_WHITE);else{if(N(B))continue;V(p,B)?v.script?(v.script+="</"+B,v.state=k.SCRIPT):Z(v,"Invalid tagname in closing tag."):v.tagName=B}continue;case k.CLOSE_TAG_SAW_WHITE:if(N(B))continue;B===">"?W(v):Z(v,"Invalid characters in closing tag");continue;case k.TEXT_ENTITY:case k.ATTRIB_VALUE_ENTITY_Q:case k.ATTRIB_VALUE_ENTITY_U:var ae,Bt;switch(v.state){case k.TEXT_ENTITY:ae=k.TEXT,Bt="textNode";break;case k.ATTRIB_VALUE_ENTITY_Q:ae=k.ATTRIB_VALUE_QUOTED,Bt="attribValue";break;case k.ATTRIB_VALUE_ENTITY_U:ae=k.ATTRIB_VALUE_UNQUOTED,Bt="attribValue";break}if(B===";"){var Pt=re(v);v.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(Pt)?(v.entity="",v.state=ae,v.write(Pt)):(v[Bt]+=Pt,v.entity="",v.state=ae)}else D(v.entity.length?S:y,B)?v.entity+=B:(Z(v,"Invalid character in entity name"),v[Bt]+="&"+v.entity+B,v.entity="",v.state=ae);continue;default:throw new Error(v,"Unknown state: "+v.state)}return v.position>=v.bufferCheckPosition&&a(v),v}String.fromCodePoint||function(){var A=String.fromCharCode,v=Math.floor,O=function(){var B=16384,ue=[],ye,ae,Bt=-1,Pt=arguments.length;if(!Pt)return"";for(var Mn="";++Bt<Pt;){var ot=Number(arguments[Bt]);if(!isFinite(ot)||ot<0||ot>1114111||v(ot)!==ot)throw RangeError("Invalid code point: "+ot);ot<=65535?ue.push(ot):(ot-=65536,ye=(ot>>10)+55296,ae=ot%1024+56320,ue.push(ye,ae)),(Bt+1===Pt||ue.length>B)&&(Mn+=A.apply(null,ue),ue.length=0)}return Mn};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:O,configurable:!0,writable:!0}):String.fromCodePoint=O}()})(s)}(Sp)),Sp}mv();var md={},tm={};(function(s){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",r="["+e+"]["+t+"]*",a=new RegExp("^"+r+"$"),n=function(i,u){const c=[];let l=u.exec(i);for(;l;){const m=[];m.startIndex=u.lastIndex-l[0].length;const h=l.length;for(let g=0;g<h;g++)m.push(l[g]);c.push(m),l=u.exec(i)}return c},o=function(i){const u=a.exec(i);return!(u===null||typeof u>"u")};s.isExist=function(i){return typeof i<"u"},s.isEmptyObject=function(i){return Object.keys(i).length===0},s.merge=function(i,u,c){if(u){const l=Object.keys(u),m=l.length;for(let h=0;h<m;h++)c==="strict"?i[l[h]]=[u[l[h]]]:i[l[h]]=u[l[h]]}},s.getValue=function(i){return s.isExist(i)?i:""},s.isName=o,s.getAllMatches=n,s.nameRegexp=r})(tm);const fd=tm,fv={allowBooleanAttributes:!1,unpairedTags:[]};md.validate=function(s,e){e=Object.assign({},fv,e);const t=[];let r=!1,a=!1;s[0]==="\uFEFF"&&(s=s.substr(1));for(let n=0;n<s.length;n++)if(s[n]==="<"&&s[n+1]==="?"){if(n+=2,n=kp(s,n),n.err)return n}else if(s[n]==="<"){let o=n;if(n++,s[n]==="!"){n=Ep(s,n);continue}else{let i=!1;s[n]==="/"&&(i=!0,n++);let u="";for(;n<s.length&&s[n]!==">"&&s[n]!==" "&&s[n]!=="	"&&s[n]!=="\n"&&s[n]!=="\r";n++)u+=s[n];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),n--),!Sv(u)){let m;return u.trim().length===0?m="Invalid space after '<'.":m="Tag '"+u+"' is an invalid name.",Te("InvalidTag",m,yt(s,n))}const c=gv(s,n);if(c===!1)return Te("InvalidAttr","Attributes for '"+u+"' have open quote.",yt(s,n));let l=c.value;if(n=c.index,l[l.length-1]==="/"){const m=n-l.length;l=l.substring(0,l.length-1);const h=Cp(l,e);if(h===!0)r=!0;else return Te(h.err.code,h.err.msg,yt(s,m+h.err.line))}else if(i)if(c.tagClosed){if(l.trim().length>0)return Te("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",yt(s,o));if(t.length===0)return Te("InvalidTag","Closing tag '"+u+"' has not been opened.",yt(s,o));{const m=t.pop();if(u!==m.tagName){let h=yt(s,m.tagStartPos);return Te("InvalidTag","Expected closing tag '"+m.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+u+"'.",yt(s,o))}t.length==0&&(a=!0)}}else return Te("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",yt(s,n));else{const m=Cp(l,e);if(m!==!0)return Te(m.err.code,m.err.msg,yt(s,n-l.length+m.err.line));if(a===!0)return Te("InvalidXml","Multiple possible root nodes found.",yt(s,n));e.unpairedTags.indexOf(u)!==-1||t.push({tagName:u,tagStartPos:o}),r=!0}for(n++;n<s.length;n++)if(s[n]==="<")if(s[n+1]==="!"){n++,n=Ep(s,n);continue}else if(s[n+1]==="?"){if(n=kp(s,++n),n.err)return n}else break;else if(s[n]==="&"){const m=vv(s,n);if(m==-1)return Te("InvalidChar","char '&' is not expected.",yt(s,n));n=m}else if(a===!0&&!Np(s[n]))return Te("InvalidXml","Extra text at the end",yt(s,n));s[n]==="<"&&n--}}else{if(Np(s[n]))continue;return Te("InvalidChar","char '"+s[n]+"' is not expected.",yt(s,n))}if(r){if(t.length==1)return Te("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",yt(s,t[0].tagStartPos));if(t.length>0)return Te("InvalidXml","Invalid '"+JSON.stringify(t.map(n=>n.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Te("InvalidXml","Start tag expected.",1);return!0};function Np(s){return s===" "||s==="	"||s==="\n"||s==="\r"}function kp(s,e){const t=e;for(;e<s.length;e++)if(s[e]=="?"||s[e]==" "){const r=s.substr(t,e-t);if(e>5&&r==="xml")return Te("InvalidXml","XML declaration allowed only at the start of the document.",yt(s,e));if(s[e]=="?"&&s[e+1]==">"){e++;break}else continue}return e}function Ep(s,e){if(s.length>e+5&&s[e+1]==="-"&&s[e+2]==="-"){for(e+=3;e<s.length;e++)if(s[e]==="-"&&s[e+1]==="-"&&s[e+2]===">"){e+=2;break}}else if(s.length>e+8&&s[e+1]==="D"&&s[e+2]==="O"&&s[e+3]==="C"&&s[e+4]==="T"&&s[e+5]==="Y"&&s[e+6]==="P"&&s[e+7]==="E"){let t=1;for(e+=8;e<s.length;e++)if(s[e]==="<")t++;else if(s[e]===">"&&(t--,t===0))break}else if(s.length>e+9&&s[e+1]==="["&&s[e+2]==="C"&&s[e+3]==="D"&&s[e+4]==="A"&&s[e+5]==="T"&&s[e+6]==="A"&&s[e+7]==="["){for(e+=8;e<s.length;e++)if(s[e]==="]"&&s[e+1]==="]"&&s[e+2]===">"){e+=2;break}}return e}const dv='"',pv="'";function gv(s,e){let t="",r="",a=!1;for(;e<s.length;e++){if(s[e]===dv||s[e]===pv)r===""?r=s[e]:r!==s[e]||(r="");else if(s[e]===">"&&r===""){a=!0;break}t+=s[e]}return r!==""?!1:{value:t,index:e,tagClosed:a}}const wv=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function Cp(s,e){const t=fd.getAllMatches(s,wv),r={};for(let a=0;a<t.length;a++){if(t[a][1].length===0)return Te("InvalidAttr","Attribute '"+t[a][2]+"' has no space in starting.",$o(t[a]));if(t[a][3]!==void 0&&t[a][4]===void 0)return Te("InvalidAttr","Attribute '"+t[a][2]+"' is without value.",$o(t[a]));if(t[a][3]===void 0&&!e.allowBooleanAttributes)return Te("InvalidAttr","boolean attribute '"+t[a][2]+"' is not allowed.",$o(t[a]));const n=t[a][2];if(!bv(n))return Te("InvalidAttr","Attribute '"+n+"' is an invalid name.",$o(t[a]));if(!r.hasOwnProperty(n))r[n]=1;else return Te("InvalidAttr","Attribute '"+n+"' is repeated.",$o(t[a]))}return!0}function yv(s,e){let t=/\d/;for(s[e]==="x"&&(e++,t=/[\da-fA-F]/);e<s.length;e++){if(s[e]===";")return e;if(!s[e].match(t))break}return-1}function vv(s,e){if(e++,s[e]===";")return-1;if(s[e]==="#")return e++,yv(s,e);let t=0;for(;e<s.length;e++,t++)if(!(s[e].match(/\w/)&&t<20)){if(s[e]===";")break;return-1}return e}function Te(s,e,t){return{err:{code:s,msg:e,line:t.line||t,col:t.col}}}function bv(s){return fd.isName(s)}function Sv(s){return fd.isName(s)}function yt(s,e){const t=s.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function $o(s){return s.startIndex+s[1].length}var Ef={};const qg={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(s,e){return e},attributeValueProcessor:function(s,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(s,e,t){return s}},Av=function(s){return Object.assign({},qg,s)};Ef.buildOptions=Av,Ef.defaultOptions=qg;class Nv{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var kv=Nv;const Ev=tm;function Cv(s,e){const t={};if(s[e+3]==="O"&&s[e+4]==="C"&&s[e+5]==="T"&&s[e+6]==="Y"&&s[e+7]==="P"&&s[e+8]==="E"){e=e+9;let r=1,a=!1,n=!1,o="";for(;e<s.length;e++)if(s[e]==="<"&&!n){if(a&&xv(s,e)){e+=7;let i,u;[i,u,e]=Iv(s,e+1),u.indexOf("&")===-1&&(t[Dv(i)]={regx:RegExp("&".concat(i,";"),"g"),val:u})}else if(a&&Bv(s,e))e+=8;else if(a&&Pv(s,e))e+=8;else if(a&&Ov(s,e))e+=9;else if(Vv)n=!0;else throw new Error("Invalid DOCTYPE");r++,o=""}else if(s[e]===">"){if(n?s[e-1]==="-"&&s[e-2]==="-"&&(n=!1,r--):r--,r===0)break}else s[e]==="["?a=!0:o+=s[e];if(r!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}function Iv(s,e){let t="";for(;e<s.length&&s[e]!=="'"&&s[e]!=='"';e++)t+=s[e];if(t=t.trim(),t.indexOf(" ")!==-1)throw new Error("External entites are not supported");const r=s[e++];let a="";for(;e<s.length&&s[e]!==r;e++)a+=s[e];return[t,a,e]}function Vv(s,e){return s[e+1]==="!"&&s[e+2]==="-"&&s[e+3]==="-"}function xv(s,e){return s[e+1]==="!"&&s[e+2]==="E"&&s[e+3]==="N"&&s[e+4]==="T"&&s[e+5]==="I"&&s[e+6]==="T"&&s[e+7]==="Y"}function Bv(s,e){return s[e+1]==="!"&&s[e+2]==="E"&&s[e+3]==="L"&&s[e+4]==="E"&&s[e+5]==="M"&&s[e+6]==="E"&&s[e+7]==="N"&&s[e+8]==="T"}function Pv(s,e){return s[e+1]==="!"&&s[e+2]==="A"&&s[e+3]==="T"&&s[e+4]==="T"&&s[e+5]==="L"&&s[e+6]==="I"&&s[e+7]==="S"&&s[e+8]==="T"}function Ov(s,e){return s[e+1]==="!"&&s[e+2]==="N"&&s[e+3]==="O"&&s[e+4]==="T"&&s[e+5]==="A"&&s[e+6]==="T"&&s[e+7]==="I"&&s[e+8]==="O"&&s[e+9]==="N"}function Dv(s){if(Ev.isName(s))return s;throw new Error("Invalid entity name ".concat(s))}var Tv=Cv;const Rv=/^[-+]?0x[a-fA-F0-9]+$/,Lv=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const Uv={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function jv(s,e={}){if(e=Object.assign({},Uv,e),!s||typeof s!="string")return s;let t=s.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return s;if(e.hex&&Rv.test(t))return Number.parseInt(t,16);{const r=Lv.exec(t);if(r){const a=r[1],n=r[2];let o=$v(r[3]);const i=r[4]||r[6];if(!e.leadingZeros&&n.length>0&&a&&t[2]!=="."||!e.leadingZeros&&n.length>0&&!a&&t[1]!==".")return s;{const u=Number(t),c=""+u;return c.search(/[eE]/)!==-1||i?e.eNotation?u:s:t.indexOf(".")!==-1?c==="0"&&o===""||c===o||a&&c==="-"+o?u:s:n?o===c||a+o===c?u:s:t===c||t===a+c?u:s}}else return s}}function $v(s){return s&&s.indexOf(".")!==-1&&(s=s.replace(/0+$/,""),s==="."?s="0":s[0]==="."?s="0"+s:s[s.length-1]==="."&&(s=s.substr(0,s.length-1))),s}var Kv=jv;function Hv(s){return typeof s=="function"?s:Array.isArray(s)?e=>{for(const t of s)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}var Wg=Hv;const _g=tm,Ko=kv,Mv=Tv,Fv=Kv,Jv=Wg;let qv=class{constructor(s){this.options=s,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,16))}},this.addExternalEntities=Wv,this.parseXml=Yv,this.parseTextData=_v,this.resolveNameSpace=Gv,this.buildAttributesMap=zv,this.isItStopNode=t1,this.replaceEntitiesValue=Qv,this.readStopNodeData=r1,this.saveTextToParentTag=e1,this.addChild=Zv,this.ignoreAttributesFn=Jv(this.options.ignoreAttributes)}};function Wv(s){const e=Object.keys(s);for(let t=0;t<e.length;t++){const r=e[t];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:s[r]}}}function _v(s,e,t,r,a,n,o){if(s!==void 0&&(this.options.trimValues&&!r&&(s=s.trim()),s.length>0)){o||(s=this.replaceEntitiesValue(s));const i=this.options.tagValueProcessor(e,s,t,a,n);return i==null?s:typeof i!=typeof s||i!==s?i:this.options.trimValues?If(s,this.options.parseTagValue,this.options.numberParseOptions):s.trim()===s?If(s,this.options.parseTagValue,this.options.numberParseOptions):s}}function Gv(s){if(this.options.removeNSPrefix){const e=s.split(":"),t=s.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(s=t+e[1])}return s}const Xv=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function zv(s,e,t){if(this.options.ignoreAttributes!==!0&&typeof s=="string"){const r=_g.getAllMatches(s,Xv),a=r.length,n={};for(let o=0;o<a;o++){const i=this.resolveNameSpace(r[o][1]);if(this.ignoreAttributesFn(i,e))continue;let u=r[o][4],c=this.options.attributeNamePrefix+i;if(i.length)if(this.options.transformAttributeName&&(c=this.options.transformAttributeName(c)),c==="__proto__"&&(c="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);const l=this.options.attributeValueProcessor(i,u,e);l==null?n[c]=u:typeof l!=typeof u||l!==u?n[c]=l:n[c]=If(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[c]=!0)}if(!Object.keys(n).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=n,o}return n}}const Yv=function(s){s=s.replace(/\r\n?/g,"\n");const e=new Ko("!xml");let t=e,r="",a="";for(let n=0;n<s.length;n++)if(s[n]==="<")if(s[n+1]==="/"){const o=Sn(s,">",n,"Closing Tag is not closed.");let i=s.substring(n+2,o).trim();if(this.options.removeNSPrefix){const l=i.indexOf(":");l!==-1&&(i=i.substr(l+1))}this.options.transformTagName&&(i=this.options.transformTagName(i)),t&&(r=this.saveTextToParentTag(r,t,a));const u=a.substring(a.lastIndexOf(".")+1);if(i&&this.options.unpairedTags.indexOf(i)!==-1)throw new Error("Unpaired tag can not be used as closing tag: </".concat(i,">"));let c=0;u&&this.options.unpairedTags.indexOf(u)!==-1?(c=a.lastIndexOf(".",a.lastIndexOf(".")-1),this.tagsNodeStack.pop()):c=a.lastIndexOf("."),a=a.substring(0,c),t=this.tagsNodeStack.pop(),r="",n=o}else if(s[n+1]==="?"){let o=Cf(s,n,!1,"?>");if(!o)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,t,a),!(this.options.ignoreDeclaration&&o.tagName==="?xml"||this.options.ignorePiTags)){const i=new Ko(o.tagName);i.add(this.options.textNodeName,""),o.tagName!==o.tagExp&&o.attrExpPresent&&(i[":@"]=this.buildAttributesMap(o.tagExp,a,o.tagName)),this.addChild(t,i,a)}n=o.closeIndex+1}else if(s.substr(n+1,3)==="!--"){const o=Sn(s,"-->",n+4,"Comment is not closed.");if(this.options.commentPropName){const i=s.substring(n+4,o-2);r=this.saveTextToParentTag(r,t,a),t.add(this.options.commentPropName,[{[this.options.textNodeName]:i}])}n=o}else if(s.substr(n+1,2)==="!D"){const o=Mv(s,n);this.docTypeEntities=o.entities,n=o.i}else if(s.substr(n+1,2)==="!["){const o=Sn(s,"]]>",n,"CDATA is not closed.")-2,i=s.substring(n+9,o);r=this.saveTextToParentTag(r,t,a);let u=this.parseTextData(i,t.tagname,a,!0,!1,!0,!0);u==null&&(u=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:i}]):t.add(this.options.textNodeName,u),n=o+2}else{let o=Cf(s,n,this.options.removeNSPrefix),i=o.tagName;const u=o.rawTagName;let c=o.tagExp,l=o.attrExpPresent,m=o.closeIndex;this.options.transformTagName&&(i=this.options.transformTagName(i)),t&&r&&t.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,t,a,!1));const h=t;if(h&&this.options.unpairedTags.indexOf(h.tagname)!==-1&&(t=this.tagsNodeStack.pop(),a=a.substring(0,a.lastIndexOf("."))),i!==e.tagname&&(a+=a?"."+i:i),this.isItStopNode(this.options.stopNodes,a,i)){let g="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)i[i.length-1]==="/"?(i=i.substr(0,i.length-1),a=a.substr(0,a.length-1),c=i):c=c.substr(0,c.length-1),n=o.closeIndex;else if(this.options.unpairedTags.indexOf(i)!==-1)n=o.closeIndex;else{const d=this.readStopNodeData(s,u,m+1);if(!d)throw new Error("Unexpected end of ".concat(u));n=d.i,g=d.tagContent}const w=new Ko(i);i!==c&&l&&(w[":@"]=this.buildAttributesMap(c,a,i)),g&&(g=this.parseTextData(g,i,a,!0,l,!0,!0)),a=a.substr(0,a.lastIndexOf(".")),w.add(this.options.textNodeName,g),this.addChild(t,w,a)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){i[i.length-1]==="/"?(i=i.substr(0,i.length-1),a=a.substr(0,a.length-1),c=i):c=c.substr(0,c.length-1),this.options.transformTagName&&(i=this.options.transformTagName(i));const g=new Ko(i);i!==c&&l&&(g[":@"]=this.buildAttributesMap(c,a,i)),this.addChild(t,g,a),a=a.substr(0,a.lastIndexOf("."))}else{const g=new Ko(i);this.tagsNodeStack.push(t),i!==c&&l&&(g[":@"]=this.buildAttributesMap(c,a,i)),this.addChild(t,g,a),t=g}r="",n=m}}else r+=s[n];return e.child};function Zv(s,e,t){const r=this.options.updateTag(e.tagname,t,e[":@"]);r===!1||(typeof r=="string"&&(e.tagname=r),s.addChild(e))}const Qv=function(s){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];s=s.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];s=s.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];s=s.replace(t.regex,t.val)}s=s.replace(this.ampEntity.regex,this.ampEntity.val)}return s};function e1(s,e,t,r){return s&&(r===void 0&&(r=Object.keys(e.child).length===0),s=this.parseTextData(s,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,r),s!==void 0&&s!==""&&e.add(this.options.textNodeName,s),s=""),s}function t1(s,e,t){const r="*."+t;for(const a in s){const n=s[a];if(r===n||e===n)return!0}return!1}function s1(s,e,t=">"){let r,a="";for(let n=e;n<s.length;n++){let o=s[n];if(r)o===r&&(r="");else if(o==='"'||o==="'")r=o;else if(o===t[0])if(t[1]){if(s[n+1]===t[1])return{data:a,index:n}}else return{data:a,index:n};else o==="	"&&(o=" ");a+=o}}function Sn(s,e,t,r){const a=s.indexOf(e,t);if(a===-1)throw new Error(r);return a+e.length-1}function Cf(s,e,t,r=">"){const a=s1(s,e+1,r);if(!a)return;let n=a.data;const o=a.index,i=n.search(/\s/);let u=n,c=!0;i!==-1&&(u=n.substring(0,i),n=n.substring(i+1).trimStart());const l=u;if(t){const m=u.indexOf(":");m!==-1&&(u=u.substr(m+1),c=u!==a.data.substr(m+1))}return{tagName:u,tagExp:n,closeIndex:o,attrExpPresent:c,rawTagName:l}}function r1(s,e,t){const r=t;let a=1;for(;t<s.length;t++)if(s[t]==="<")if(s[t+1]==="/"){const n=Sn(s,">",t,"".concat(e," is not closed"));if(s.substring(t+2,n).trim()===e&&(a--,a===0))return{tagContent:s.substring(r,t),i:n};t=n}else if(s[t+1]==="?")t=Sn(s,"?>",t+1,"StopNode is not closed.");else if(s.substr(t+1,3)==="!--")t=Sn(s,"-->",t+3,"StopNode is not closed.");else if(s.substr(t+1,2)==="![")t=Sn(s,"]]>",t,"StopNode is not closed.")-2;else{const n=Cf(s,t,">");n&&((n&&n.tagName)===e&&n.tagExp[n.tagExp.length-1]!=="/"&&a++,t=n.closeIndex)}}function If(s,e,t){if(e&&typeof s=="string"){const r=s.trim();return r==="true"?!0:r==="false"?!1:Fv(s,t)}else return _g.isExist(s)?s:""}var a1=qv,Gg={};function n1(s,e){return Xg(s,e)}function Xg(s,e,t){let r;const a={};for(let n=0;n<s.length;n++){const o=s[n],i=i1(o);let u="";if(t===void 0?u=i:u=t+"."+i,i===e.textNodeName)r===void 0?r=o[i]:r+=""+o[i];else{if(i===void 0)continue;if(o[i]){let c=Xg(o[i],e,u);const l=l1(c,e);o[":@"]?o1(c,o[":@"],u,e):Object.keys(c).length===1&&c[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?c=c[e.textNodeName]:Object.keys(c).length===0&&(e.alwaysCreateTextNode?c[e.textNodeName]="":c=""),a[i]!==void 0&&a.hasOwnProperty(i)?(Array.isArray(a[i])||(a[i]=[a[i]]),a[i].push(c)):e.isArray(i,u,l)?a[i]=[c]:a[i]=c}}}return typeof r=="string"?r.length>0&&(a[e.textNodeName]=r):r!==void 0&&(a[e.textNodeName]=r),a}function i1(s){const e=Object.keys(s);for(let t=0;t<e.length;t++){const r=e[t];if(r!==":@")return r}}function o1(s,e,t,r){if(e){const a=Object.keys(e),n=a.length;for(let o=0;o<n;o++){const i=a[o];r.isArray(i,t+"."+i,!0,!0)?s[i]=[e[i]]:s[i]=e[i]}}}function l1(s,e){const{textNodeName:t}=e,r=Object.keys(s).length;return!!(r===0||r===1&&(s[t]||typeof s[t]=="boolean"||s[t]===0))}Gg.prettify=n1;const{buildOptions:u1}=Ef,c1=a1,{prettify:h1}=Gg,m1=md;let f1=class{constructor(s){this.externalEntities={},this.options=u1(s)}parse(s,e){if(typeof s!="string")if(s.toString)s=s.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const a=m1.validate(s,e);if(a!==!0)throw Error("".concat(a.err.msg,":").concat(a.err.line,":").concat(a.err.col))}const t=new c1(this.options);t.addExternalEntities(this.externalEntities);const r=t.parseXml(s);return this.options.preserveOrder||r===void 0?r:h1(r,this.options)}addEntity(s,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(s.indexOf("&")!==-1||s.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[s]=e}};var d1=f1;const p1="\n";function g1(s,e){let t="";return e.format&&e.indentBy.length>0&&(t=p1),zg(s,e,"",t)}function zg(s,e,t,r){let a="",n=!1;for(let o=0;o<s.length;o++){const i=s[o],u=w1(i);if(u===void 0)continue;let c="";if(t.length===0?c=u:c="".concat(t,".").concat(u),u===e.textNodeName){let w=i[u];y1(c,e)||(w=e.tagValueProcessor(u,w),w=Yg(w,e)),n&&(a+=r),a+=w,n=!1;continue}else if(u===e.cdataPropName){n&&(a+=r),a+="<![CDATA[".concat(i[u][0][e.textNodeName],"]]>"),n=!1;continue}else if(u===e.commentPropName){a+=r+"<!--".concat(i[u][0][e.textNodeName],"-->"),n=!0;continue}else if(u[0]==="?"){const w=Ip(i[":@"],e),d=u==="?xml"?"":r;let p=i[u][0][e.textNodeName];p=p.length!==0?" "+p:"",a+=d+"<".concat(u).concat(p).concat(w,"?>"),n=!0;continue}let l=r;l!==""&&(l+=e.indentBy);const m=Ip(i[":@"],e),h=r+"<".concat(u).concat(m),g=zg(i[u],e,c,l);e.unpairedTags.indexOf(u)!==-1?e.suppressUnpairedNode?a+=h+">":a+=h+"/>":(!g||g.length===0)&&e.suppressEmptyNode?a+=h+"/>":g&&g.endsWith(">")?a+=h+">".concat(g).concat(r,"</").concat(u,">"):(a+=h+">",g&&r!==""&&(g.includes("/>")||g.includes("</"))?a+=r+e.indentBy+g+r:a+=g,a+="</".concat(u,">")),n=!0}return a}function w1(s){const e=Object.keys(s);for(let t=0;t<e.length;t++){const r=e[t];if(s.hasOwnProperty(r)&&r!==":@")return r}}function Ip(s,e){let t="";if(s&&!e.ignoreAttributes)for(let r in s){if(!s.hasOwnProperty(r))continue;let a=e.attributeValueProcessor(r,s[r]);a=Yg(a,e),a===!0&&e.suppressBooleanAttributes?t+=" ".concat(r.substr(e.attributeNamePrefix.length)):t+=" ".concat(r.substr(e.attributeNamePrefix.length),'="').concat(a,'"')}return t}function y1(s,e){s=s.substr(0,s.length-e.textNodeName.length-1);let t=s.substr(s.lastIndexOf(".")+1);for(let r in e.stopNodes)if(e.stopNodes[r]===s||e.stopNodes[r]==="*."+t)return!0;return!1}function Yg(s,e){if(s&&s.length>0&&e.processEntities)for(let t=0;t<e.entities.length;t++){const r=e.entities[t];s=s.replace(r.regex,r.val)}return s}var v1=g1;const b1=v1,S1=Wg,A1={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(s,e){return e},attributeValueProcessor:function(s,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Qr(s){this.options=Object.assign({},A1,s),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=S1(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=E1),this.processTextOrObjNode=N1,this.options.format?(this.indentate=k1,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Qr.prototype.build=function(s){return this.options.preserveOrder?b1(s,this.options):(Array.isArray(s)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(s={[this.options.arrayNodeName]:s}),this.j2x(s,0,[]).val)},Qr.prototype.j2x=function(s,e,t){let r="",a="";const n=t.join(".");for(let o in s)if(Object.prototype.hasOwnProperty.call(s,o))if(typeof s[o]>"u")this.isAttribute(o)&&(a+="");else if(s[o]===null)this.isAttribute(o)?a+="":o[0]==="?"?a+=this.indentate(e)+"<"+o+"?"+this.tagEndChar:a+=this.indentate(e)+"<"+o+"/"+this.tagEndChar;else if(s[o]instanceof Date)a+=this.buildTextValNode(s[o],o,"",e);else if(typeof s[o]!="object"){const i=this.isAttribute(o);if(i&&!this.ignoreAttributesFn(i,n))r+=this.buildAttrPairStr(i,""+s[o]);else if(!i)if(o===this.options.textNodeName){let u=this.options.tagValueProcessor(o,""+s[o]);a+=this.replaceEntitiesValue(u)}else a+=this.buildTextValNode(s[o],o,"",e)}else if(Array.isArray(s[o])){const i=s[o].length;let u="",c="";for(let l=0;l<i;l++){const m=s[o][l];if(!(typeof m>"u"))if(m===null)o[0]==="?"?a+=this.indentate(e)+"<"+o+"?"+this.tagEndChar:a+=this.indentate(e)+"<"+o+"/"+this.tagEndChar;else if(typeof m=="object")if(this.options.oneListGroup){const h=this.j2x(m,e+1,t.concat(o));u+=h.val,this.options.attributesGroupName&&m.hasOwnProperty(this.options.attributesGroupName)&&(c+=h.attrStr)}else u+=this.processTextOrObjNode(m,o,e,t);else if(this.options.oneListGroup){let h=this.options.tagValueProcessor(o,m);h=this.replaceEntitiesValue(h),u+=h}else u+=this.buildTextValNode(m,o,"",e)}this.options.oneListGroup&&(u=this.buildObjectNode(u,o,c,e)),a+=u}else if(this.options.attributesGroupName&&o===this.options.attributesGroupName){const i=Object.keys(s[o]),u=i.length;for(let c=0;c<u;c++)r+=this.buildAttrPairStr(i[c],""+s[o][i[c]])}else a+=this.processTextOrObjNode(s[o],o,e,t);return{attrStr:r,val:a}},Qr.prototype.buildAttrPairStr=function(s,e){return e=this.options.attributeValueProcessor(s,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+s:" "+s+'="'+e+'"'};function N1(s,e,t,r){const a=this.j2x(s,t+1,r.concat(e));return s[this.options.textNodeName]!==void 0&&Object.keys(s).length===1?this.buildTextValNode(s[this.options.textNodeName],e,a.attrStr,t):this.buildObjectNode(a.val,e,a.attrStr,t)}Qr.prototype.buildObjectNode=function(s,e,t,r){if(s==="")return e[0]==="?"?this.indentate(r)+"<"+e+t+"?"+this.tagEndChar:this.indentate(r)+"<"+e+t+this.closeTag(e)+this.tagEndChar;{let a="</"+e+this.tagEndChar,n="";return e[0]==="?"&&(n="?",a=""),(t||t==="")&&s.indexOf("<")===-1?this.indentate(r)+"<"+e+t+n+">"+s+a:this.options.commentPropName!==!1&&e===this.options.commentPropName&&n.length===0?this.indentate(r)+"<!--".concat(s,"-->")+this.newLine:this.indentate(r)+"<"+e+t+n+this.tagEndChar+s+this.indentate(r)+a}},Qr.prototype.closeTag=function(s){let e="";return this.options.unpairedTags.indexOf(s)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e="></".concat(s),e},Qr.prototype.buildTextValNode=function(s,e,t,r){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(r)+"<![CDATA[".concat(s,"]]>")+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(r)+"<!--".concat(s,"-->")+this.newLine;if(e[0]==="?")return this.indentate(r)+"<"+e+t+"?"+this.tagEndChar;{let a=this.options.tagValueProcessor(e,s);return a=this.replaceEntitiesValue(a),a===""?this.indentate(r)+"<"+e+t+this.closeTag(e)+this.tagEndChar:this.indentate(r)+"<"+e+t+">"+a+"</"+e+this.tagEndChar}},Qr.prototype.replaceEntitiesValue=function(s){if(s&&s.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const t=this.options.entities[e];s=s.replace(t.regex,t.val)}return s};function k1(s){return this.options.indentBy.repeat(s)}function E1(s){return s.startsWith(this.options.attributeNamePrefix)&&s!==this.options.textNodeName?s.substr(this.attrPrefixLen):!1}var C1=Qr;const I1=md,V1=d1,x1=C1;var B1={XMLParser:V1,XMLValidator:I1,XMLBuilder:x1};function Yc(s){return s.users!==void 0}const P1=s=>s===null?hf().setApp("end_to_end_encryption").build():hf().setApp("end_to_end_encryption").setUid(s.uid).build(),Ze=P1(ed());class Ie{constructor(e={}){if("view"in e)this.fromUint8Array(e.view);else if("buffer"in e)this.fromArrayBuffer(e.buffer);else if("string"in e)this.fromString(e.string);else if("hexstring"in e)this.fromHexString(e.hexstring);else if("length"in e&&e.length>0){if(this.length=e.length,e.stub)for(let t=0;t<this._view.length;t++)this._view[t]=e.stub}else this.length=0}set buffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this.view.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this._buffer=e,this._view=new Uint8Array(this._buffer)}fromUint8Array(e){this.fromArrayBuffer(new Uint8Array(e).buffer)}fromString(e){const t=e.length;this.length=t;for(let r=0;r<t;r++)this.view[r]=e.charCodeAt(r)}toString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++)r+=String.fromCharCode(this.view[a]);return r}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const r=new Map;r.set("0",0),r.set("1",1),r.set("2",2),r.set("3",3),r.set("4",4),r.set("5",5),r.set("6",6),r.set("7",7),r.set("8",8),r.set("9",9),r.set("A",10),r.set("a",10),r.set("B",11),r.set("b",11),r.set("C",12),r.set("c",12),r.set("D",13),r.set("d",13),r.set("E",14),r.set("e",14),r.set("F",15),r.set("f",15);let a=0,n=0;for(let o=0;o<t;o++)o%2?(n|=r.get(e.charAt(o)),this.view[a]=n,a++):n=r.get(e.charAt(o))<<4}toHexString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let a=e;a<e+t;a++){const n=this.view[a].toString(16).toUpperCase();r=r+(n.length==1?"0":"")+n}return r}copy(e=0,t=this.length-e){if(!e&&!this.length)return new Ie;if(e<0||e>this.length-1)throw new Error("Wrong start position: ".concat(e));return new Ie({buffer:this._buffer.slice(e,e+t)})}slice(e=0,t=this.length){if(!e&&!this.length)return new Ie;if(e<0||e>this.length-1)throw new Error("Wrong start position: ".concat(e));return new Ie({buffer:this._buffer.slice(e,t)})}realloc(e){const t=new ArrayBuffer(e),r=new Uint8Array(t);e>this._view.length?r.set(this._view):r.set(new Uint8Array(this._buffer,0,e)),this._buffer=t,this._view=new Uint8Array(this._buffer)}append(e){const t=this.length,r=e.length,a=e._view.subarray();this.realloc(t+r),this._view.set(a,t)}insert(e,t=0,r=this.length-t){return t>this.length-1?!1:(r>this.length-t&&(r=this.length-t),r>e.length&&(r=e.length),r==e.length?this._view.set(e._view,t):this._view.set(e._view.subarray(0,r),t),!0)}isEqual(e){if(this.length!=e.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t,r,a){const{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a),u=e.length;if(u>o)return-1;const c=[];for(let l=0;l<u;l++)c.push(e.view[l]);for(let l=0;l<=o-u;l++){let m=!0;const h=i?n-u-l:n+l;for(let g=0;g<u;g++)if(this.view[g+h]!=c[g]){m=!1;break}if(m)return i?n-u-l:n+u+l}return-1}findFirstIn(e,t,r,a){const{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a),u={id:-1,position:i?0:n+o,length:0};for(let c=0;c<e.length;c++){const l=this.findPattern(e[c],n,o,i);if(l!=-1){let m=!1;const h=e[c].length;i?l-h>=u.position-u.length&&(m=!0):l-h<=u.position-u.length&&(m=!0),m&&(u.position=l,u.id=c,u.length=h)}}return u}findAllIn(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const o=[];let i={id:-1,position:a};do{const u=i.position;if(i=this.findFirstIn(e,i.position,n),i.id==-1)break;n-=i.position-u,o.push({id:i.id,position:i.position})}while(!0);return o}findAllPatternIn(e,t,r){const{start:a,length:n}=this.prepareFindParameters(t,r),o=[],i=e.length;if(i>n)return-1;const u=Array.from(e.view);for(let c=0;c<=n-i;c++){let l=!0;const m=a+c;for(let h=0;h<i;h++)if(this.view[h+m]!=u[h]){l=!1;break}l&&(o.push(a+i+c),c+=i-1)}return o}findFirstNotIn(e,t,r,a){let{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a);const u={left:{id:-1,position:n},right:{id:-1,position:0},value:new Ie};let c=o;for(;c>0;){if(u.right=this.findFirstIn(e,i?n-o+c:n+o-c,c,i),u.right.id==-1){o=c,i?n-=o:n=u.left.position,u.value=new Ie({buffer:this._buffer.slice(n,n+o)});break}if(u.right.position!=(i?u.left.position-e[u.right.id].length:u.left.position+e[u.right.id].length)){i?(n=u.right.position+e[u.right.id].length,o=u.left.position-u.right.position-e[u.right.id].length):(n=u.left.position,o=u.right.position-u.left.position-e[u.right.id].length),u.value=new Ie({buffer:this._buffer.slice(n,n+o)});break}u.left=u.right,c-=e[u.right.id].length}if(i){const l=u.right;u.right=u.left,u.left=l}return u}findAllNotIn(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const o=[];let i={left:{id:-1,position:a},right:{id:-1,position:a},value:new Ie};do{const u=i.right.position;i=this.findFirstNotIn(e,i.right.position,n),n-=i.right.position-u,o.push({left:{id:i.left.id,position:i.left.position},right:{id:i.right.id,position:i.right.position},value:i.value})}while(i.right.id!=-1);return o}findFirstSequence(e,t,r,a){let{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a);const u=this.skipNotPatterns(e,n,o,i);if(u==-1)return{position:-1,value:new Ie};const c=this.skipPatterns(e,u,o-(i?n-u:u-n),i);i?(n=c,o=u-c):(n=u,o=c-u);const l=new Ie({buffer:this._buffer.slice(n,n+o)});return{position:c,value:l}}findAllSequences(e,t,r){let{start:a,length:n}=this.prepareFindParameters(t,r);const o=[];let i={position:a,value:new Ie};do{const u=i.position;i=this.findFirstSequence(e,i.position,n),i.position!=-1&&(n-=i.position-u,o.push({position:i.position,value:i.value}))}while(i.position!=-1);return o}findPairedPatterns(e,t,r,a){const n=[];if(e.isEqual(t))return n;const{start:o,length:i}=this.prepareFindParameters(r,a);let u=0;const c=this.findAllPatternIn(e,o,i);if(!Array.isArray(c)||c.length==0)return n;const l=this.findAllPatternIn(t,o,i);if(!Array.isArray(l)||l.length==0)return n;for(;u<c.length&&l.length!=0;){if(c[0]==l[0]){n.push({left:c[0],right:l[0]}),c.splice(0,1),l.splice(0,1);continue}if(c[u]>l[0])break;for(;c[u]<l[0]&&(u++,!(u>=c.length)););n.push({left:c[u-1],right:l[0]}),c.splice(u-1,1),l.splice(0,1),u=0}return n.sort((m,h)=>m.left-h.left),n}findPairedArrays(e,t,r,a){const{start:n,length:o}=this.prepareFindParameters(r,a),i=[];let u=0;const c=this.findAllIn(e,n,o);if(c.length==0)return i;const l=this.findAllIn(t,n,o);if(l.length==0)return i;for(;u<c.length&&l.length!=0;){if(c[0].position==l[0].position){i.push({left:c[0],right:l[0]}),c.splice(0,1),l.splice(0,1);continue}if(c[u].position>l[0].position)break;for(;c[u].position<l[0].position&&(u++,!(u>=c.length)););i.push({left:c[u-1],right:l[0]}),c.splice(u-1,1),l.splice(0,1),u=0}return i.sort((m,h)=>m.left.position-h.left.position),i}replacePattern(e,t,r,a,n=null){let o=[],i;const u={status:-1,searchPatternPositions:[],replacePatternPositions:[]},{start:c,length:l}=this.prepareFindParameters(r,a);if(n==null){if(o=this.findAllIn([e],c,l),o.length==0)return u}else o=n;u.searchPatternPositions.push(...Array.from(o,w=>w.position));const m=e.length-t.length,h=new ArrayBuffer(this.view.length-o.length*m),g=new Uint8Array(h);for(g.set(new Uint8Array(this.buffer,0,c)),i=0;i<o.length;i++){const w=i==0?c:o[i-1].position;g.set(new Uint8Array(this.buffer,w,o[i].position-e.length-w),w-i*m),g.set(t.view,o[i].position-e.length-i*m),u.replacePatternPositions.push(o[i].position-e.length-i*m)}return i--,g.set(new Uint8Array(this.buffer,o[i].position,this.length-o[i].position),o[i].position-e.length+t.length-i*m),this.buffer=h,this.view=new Uint8Array(this.buffer),u.status=1,u}skipPatterns(e,t,r,a){const{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a);let u=n;for(let c=0;c<e.length;c++){const l=e[c].length,m=i?u-l:u;let h=!0;for(let g=0;g<l;g++)if(this.view[g+m]!=e[c].view[g]){h=!1;break}if(h){if(c=-1,i){if(u-=l,u<=0)return u}else if(u+=l,u>=n+o)return u}}return u}skipNotPatterns(e,t,r,a){const{start:n,length:o,backward:i}=this.prepareFindParameters(t,r,a);let u=-1;for(let c=0;c<o;c++){for(let l=0;l<e.length;l++){const m=e[l].length,h=i?n-c-m:n+c;let g=!0;for(let w=0;w<m;w++)if(this.view[w+h]!=e[l].view[w]){g=!1;break}if(g){u=i?n-c:n+c;break}}if(u!=-1)break}return u}prepareFindParameters(e=null,t=null,r=!1){return e===null&&(e=r?this.length:0),e>this.length&&(e=this.length),r?(t===null&&(t=e),t>e&&(t=e)):(t===null&&(t=this.length-e),t>this.length-e&&(t=this.length-e)),{start:e,length:t,backward:r}}}const O1=16777216;class ia{constructor(e={}){this._stream=new Ie,this._length=0,this._start=0,this.backward=!1,this.appendBlock=0,this.prevLength=0,this.prevStart=0,"view"in e?this.stream=new Ie({view:e.view}):"buffer"in e?this.stream=new Ie({buffer:e.buffer}):"string"in e?this.stream=new Ie({string:e.string}):"hexstring"in e?this.stream=new Ie({hexstring:e.hexstring}):"stream"in e?this.stream=e.stream.slice():this.stream=new Ie,"backward"in e&&e.backward&&(this.backward=e.backward,this._start=this.stream.length),"length"in e&&e.length>0&&(this._length=e.length),"start"in e&&e.start&&e.start>0&&(this._start=e.start),"appendBlock"in e&&e.appendBlock&&e.appendBlock>0&&(this.appendBlock=e.appendBlock)}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e.length,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.length||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream.buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(t==null||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(r==-1)return r;if(this.backward){if(r<this.start-e.length-t)return-1}else if(r>this.start+e.length+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(t==null||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(r.id==-1)return r;if(this.backward){if(r.position<this.start-e[r.id].length-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].length+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(t==null||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(r.left.id==-1&&r.right.id==-1)return r;if(this.backward){if(r.right.id!=-1&&r.right.position<this._start-e[r.right.id].length-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Ie}}else if(r.left.id!=-1&&r.left.position>this._start+e[r.left.id].length+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Ie};return this.backward?r.left.id==-1?this.start=0:this.start=r.left.position:r.right.id==-1?this.start=this._start+this._length:this.start=r.right.position,r}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,r=null){(t==null||t>this._length)&&(t=this._length),(r==null||r>t)&&(r=t);const a=this._stream.findFirstSequence(e,this._start,t,this.backward);if(a.value.length==0)return a;if(this.backward){if(a.position<this._start-a.value.length-r)return{position:-1,value:new Ie}}else if(a.position>this._start+a.value.length+r)return{position:-1,value:new Ie};return this.start=a.position,a}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,r=null){(r==null||r>this.length)&&(r=this.length);const a=this.backward?this.start-this.length:this.start,n=this.stream.findPairedPatterns(e,t,a,this.length);if(n.length){if(this.backward){if(n[0].right<this.start-t.length-r)return[]}else if(n[0].left>this.start+e.length+r)return[]}return n}findPairedArrays(e,t,r=null){(r==null||r>this.length)&&(r=this.length);const a=this.backward?this.start-this.length:this.start,n=this.stream.findPairedArrays(e,t,a,this.length);if(n.length){if(this.backward){if(n[0].right.position<this.start-t[n[0].right.id].length-r)return[]}else if(n[0].left.position>this.start+e[n[0].left.id].length+r)return[]}return n}replacePattern(e,t){const r=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,r,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return t==-1?-1:(this.start=t,t)}append(e){this.beforeAppend(e.length),this._stream.view.set(e.view,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendView(e){this.beforeAppend(e.length),this._stream.view.set(e,this._start),this._length+=e.length*2,this.start=this._start+e.length,this.prevLength-=e.length*2}appendChar(e){this.beforeAppend(1),this._stream.view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this.beforeAppend(2);const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this.stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this.beforeAppend(3);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[2],this._stream.view[this._start+1]=r[1],this._stream.view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this.beforeAppend(4);const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}appendInt16(e){this.beforeAppend(2);const t=new Int16Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[1],this._stream.view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendInt32(e){this.beforeAppend(4);const t=new Int32Array([e]),r=new Uint8Array(t.buffer);this._stream.view[this._start]=r[3],this._stream.view[this._start+1]=r[2],this._stream.view[this._start+2]=r[1],this._stream.view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return new Uint8Array(0);this._length<e&&(e=this._length);let r;if(this.backward){const a=this._stream.view.subarray(this._length-e,this._length);r=new Uint8Array(e);for(let n=0;n<e;n++)r[e-1-n]=a[n]}else r=this._stream.view.subarray(this._start,this._start+e);return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);return t.length<2?0:t[0]<<8|t[1]}getInt16(e=!0){const t=this.getUint16(e),r=32768;return t&r?-(r-(t^r)):t}getUint24(e=!0){const t=this.getBlock(4,e);return t.length<3?0:t[0]<<16|t[1]<<8|t[2]}getUint32(e=!0){const t=this.getBlock(4,e);return t.length<4?0:t[0]*O1+(t[1]<<16)+(t[2]<<8)+t[3]}getInt32(e=!0){const t=this.getUint32(e),r=2147483648;return t&r?-(r-(t^r)):t}beforeAppend(e){this._start+e>this._stream.length&&(e>this.appendBlock&&(this.appendBlock=e+ia.APPEND_BLOCK),this._stream.realloc(this._stream.length+this.appendBlock))}}ia.APPEND_BLOCK=1e3;function D1(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Zg(s,...e){if(!D1(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function Vp(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function T1(s,e){Zg(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Bm=s=>new DataView(s.buffer,s.byteOffset,s.byteLength),ds=(s,e)=>s<<32-e|s>>>e,Pm=(s,e)=>s<<e|s>>>32-e>>>0;function R1(s){if(typeof s!="string")throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array(new TextEncoder().encode(s))}function Qg(s){return typeof s=="string"&&(s=R1(s)),Zg(s),s}class L1{clone(){return this._cloneInto()}}function sm(s){const e=r=>s().update(Qg(r)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}function U1(s,e,t,r){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,t,r);const a=BigInt(32),n=BigInt(4294967295),o=Number(t>>a&n),i=Number(t&n),u=r?4:0,c=r?0:4;s.setUint32(e+u,o,r),s.setUint32(e+c,i,r)}const ew=(s,e,t)=>s&e^~s&t,tw=(s,e,t)=>s&e^s&t^e&t;class dd extends L1{constructor(e,t,r,a){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Bm(this.buffer)}update(e){Vp(this);const{view:t,buffer:r,blockLen:a}=this;e=Qg(e);const n=e.length;for(let o=0;o<n;){const i=Math.min(a-this.pos,n-o);if(i===a){const u=Bm(e);for(;a<=n-o;o+=a)this.process(u,o);continue}r.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===a&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Vp(this),T1(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:a,isLE:n}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>a-o&&(this.process(r,0),o=0);for(let m=o;m<a;m++)t[m]=0;U1(r,a-8,BigInt(this.length*8),n),this.process(r,0);const i=Bm(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=u/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<c;m++)i.setUint32(4*m,l[m],n)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:a,finished:n,destroyed:o,pos:i}=this;return e.length=a,e.pos=i,e.finished=n,e.destroyed=o,a%t&&e.buffer.set(r),e}}const Ho=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),er=new Uint32Array(80);let j1=class extends dd{constructor(){super(64,20,8,!1),this.A=Ho[0]|0,this.B=Ho[1]|0,this.C=Ho[2]|0,this.D=Ho[3]|0,this.E=Ho[4]|0}get(){const{A:s,B:e,C:t,D:r,E:a}=this;return[s,e,t,r,a]}set(s,e,t,r,a){this.A=s|0,this.B=e|0,this.C=t|0,this.D=r|0,this.E=a|0}process(s,e){for(let i=0;i<16;i++,e+=4)er[i]=s.getUint32(e,!1);for(let i=16;i<80;i++)er[i]=Pm(er[i-3]^er[i-8]^er[i-14]^er[i-16],1);let{A:t,B:r,C:a,D:n,E:o}=this;for(let i=0;i<80;i++){let u,c;i<20?(u=ew(r,a,n),c=1518500249):i<40?(u=r^a^n,c=1859775393):i<60?(u=tw(r,a,n),c=2400959708):(u=r^a^n,c=3395469782);const l=Pm(t,5)+u+o+c+er[i]|0;o=n,n=a,a=Pm(r,30),r=t,t=l}t=t+this.A|0,r=r+this.B|0,a=a+this.C|0,n=n+this.D|0,o=o+this.E|0,this.set(t,r,a,n,o)}roundClean(){er.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}};const $1=sm(()=>new j1),K1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sr=new Uint32Array(64);let H1=class extends dd{constructor(){super(64,32,8,!1),this.A=tr[0]|0,this.B=tr[1]|0,this.C=tr[2]|0,this.D=tr[3]|0,this.E=tr[4]|0,this.F=tr[5]|0,this.G=tr[6]|0,this.H=tr[7]|0}get(){const{A:s,B:e,C:t,D:r,E:a,F:n,G:o,H:i}=this;return[s,e,t,r,a,n,o,i]}set(s,e,t,r,a,n,o,i){this.A=s|0,this.B=e|0,this.C=t|0,this.D=r|0,this.E=a|0,this.F=n|0,this.G=o|0,this.H=i|0}process(s,e){for(let l=0;l<16;l++,e+=4)sr[l]=s.getUint32(e,!1);for(let l=16;l<64;l++){const m=sr[l-15],h=sr[l-2],g=ds(m,7)^ds(m,18)^m>>>3,w=ds(h,17)^ds(h,19)^h>>>10;sr[l]=w+sr[l-7]+g+sr[l-16]|0}let{A:t,B:r,C:a,D:n,E:o,F:i,G:u,H:c}=this;for(let l=0;l<64;l++){const m=ds(o,6)^ds(o,11)^ds(o,25),h=c+m+ew(o,i,u)+K1[l]+sr[l]|0,g=(ds(t,2)^ds(t,13)^ds(t,22))+tw(t,r,a)|0;c=u,u=i,i=o,o=n+h|0,n=a,a=r,r=t,t=h+g|0}t=t+this.A|0,r=r+this.B|0,a=a+this.C|0,n=n+this.D|0,o=o+this.E|0,i=i+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(t,r,a,n,o,i,u,c)}roundClean(){sr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const M1=sm(()=>new H1),Sc=BigInt(2**32-1),Vf=BigInt(32);function sw(s,e=!1){return e?{h:Number(s&Sc),l:Number(s>>Vf&Sc)}:{h:Number(s>>Vf&Sc)|0,l:Number(s&Sc)|0}}function F1(s,e=!1){let t=new Uint32Array(s.length),r=new Uint32Array(s.length);for(let a=0;a<s.length;a++){const{h:n,l:o}=sw(s[a],e);[t[a],r[a]]=[n,o]}return[t,r]}const J1=(s,e)=>BigInt(s>>>0)<<Vf|BigInt(e>>>0),q1=(s,e,t)=>s>>>t,W1=(s,e,t)=>s<<32-t|e>>>t,_1=(s,e,t)=>s>>>t|e<<32-t,G1=(s,e,t)=>s<<32-t|e>>>t,X1=(s,e,t)=>s<<64-t|e>>>t-32,z1=(s,e,t)=>s>>>t-32|e<<64-t,Y1=(s,e)=>e,Z1=(s,e)=>s,Q1=(s,e,t)=>s<<t|e>>>32-t,eb=(s,e,t)=>e<<t|s>>>32-t,tb=(s,e,t)=>e<<t-32|s>>>64-t,sb=(s,e,t)=>s<<t-32|e>>>64-t;function rb(s,e,t,r){const a=(e>>>0)+(r>>>0);return{h:s+t+(a/2**32|0)|0,l:a|0}}const ab=(s,e,t)=>(s>>>0)+(e>>>0)+(t>>>0),nb=(s,e,t,r)=>e+t+r+(s/2**32|0)|0,ib=(s,e,t,r)=>(s>>>0)+(e>>>0)+(t>>>0)+(r>>>0),ob=(s,e,t,r,a)=>e+t+r+a+(s/2**32|0)|0,lb=(s,e,t,r,a)=>(s>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(a>>>0),ub=(s,e,t,r,a,n)=>e+t+r+a+n+(s/2**32|0)|0,oe={fromBig:sw,split:F1,toBig:J1,shrSH:q1,shrSL:W1,rotrSH:_1,rotrSL:G1,rotrBH:X1,rotrBL:z1,rotr32H:Y1,rotr32L:Z1,rotlSH:Q1,rotlSL:eb,rotlBH:tb,rotlBL:sb,add:rb,add3L:ab,add3H:nb,add4L:ib,add4H:ob,add5H:ub,add5L:lb},[cb,hb]=oe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),rr=new Uint32Array(80),ar=new Uint32Array(80);let rw=class extends dd{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:s,Al:e,Bh:t,Bl:r,Ch:a,Cl:n,Dh:o,Dl:i,Eh:u,El:c,Fh:l,Fl:m,Gh:h,Gl:g,Hh:w,Hl:d}=this;return[s,e,t,r,a,n,o,i,u,c,l,m,h,g,w,d]}set(s,e,t,r,a,n,o,i,u,c,l,m,h,g,w,d){this.Ah=s|0,this.Al=e|0,this.Bh=t|0,this.Bl=r|0,this.Ch=a|0,this.Cl=n|0,this.Dh=o|0,this.Dl=i|0,this.Eh=u|0,this.El=c|0,this.Fh=l|0,this.Fl=m|0,this.Gh=h|0,this.Gl=g|0,this.Hh=w|0,this.Hl=d|0}process(s,e){for(let y=0;y<16;y++,e+=4)rr[y]=s.getUint32(e),ar[y]=s.getUint32(e+=4);for(let y=16;y<80;y++){const S=rr[y-15]|0,N=ar[y-15]|0,x=oe.rotrSH(S,N,1)^oe.rotrSH(S,N,8)^oe.shrSH(S,N,7),I=oe.rotrSL(S,N,1)^oe.rotrSL(S,N,8)^oe.shrSL(S,N,7),D=rr[y-2]|0,V=ar[y-2]|0,k=oe.rotrSH(D,V,19)^oe.rotrBH(D,V,61)^oe.shrSH(D,V,6),M=oe.rotrSL(D,V,19)^oe.rotrBL(D,V,61)^oe.shrSL(D,V,6),j=oe.add4L(I,M,ar[y-7],ar[y-16]),F=oe.add4H(j,x,k,rr[y-7],rr[y-16]);rr[y]=F|0,ar[y]=j|0}let{Ah:t,Al:r,Bh:a,Bl:n,Ch:o,Cl:i,Dh:u,Dl:c,Eh:l,El:m,Fh:h,Fl:g,Gh:w,Gl:d,Hh:p,Hl:E}=this;for(let y=0;y<80;y++){const S=oe.rotrSH(l,m,14)^oe.rotrSH(l,m,18)^oe.rotrBH(l,m,41),N=oe.rotrSL(l,m,14)^oe.rotrSL(l,m,18)^oe.rotrBL(l,m,41),x=l&h^~l&w,I=m&g^~m&d,D=oe.add5L(E,N,I,hb[y],ar[y]),V=oe.add5H(D,p,S,x,cb[y],rr[y]),k=D|0,M=oe.rotrSH(t,r,28)^oe.rotrBH(t,r,34)^oe.rotrBH(t,r,39),j=oe.rotrSL(t,r,28)^oe.rotrBL(t,r,34)^oe.rotrBL(t,r,39),F=t&a^t&o^a&o,T=r&n^r&i^n&i;p=w|0,E=d|0,w=h|0,d=g|0,h=l|0,g=m|0,{h:l,l:m}=oe.add(u|0,c|0,V|0,k|0),u=o|0,c=i|0,o=a|0,i=n|0,a=t|0,n=r|0;const Y=oe.add3L(k,j,T);t=oe.add3H(Y,V,M,F),r=Y|0}({h:t,l:r}=oe.add(this.Ah|0,this.Al|0,t|0,r|0)),{h:a,l:n}=oe.add(this.Bh|0,this.Bl|0,a|0,n|0),{h:o,l:i}=oe.add(this.Ch|0,this.Cl|0,o|0,i|0),{h:u,l:c}=oe.add(this.Dh|0,this.Dl|0,u|0,c|0),{h:l,l:m}=oe.add(this.Eh|0,this.El|0,l|0,m|0),{h,l:g}=oe.add(this.Fh|0,this.Fl|0,h|0,g|0),{h:w,l:d}=oe.add(this.Gh|0,this.Gl|0,w|0,d|0),{h:p,l:E}=oe.add(this.Hh|0,this.Hl|0,p|0,E|0),this.set(t,r,a,n,o,i,u,c,l,m,h,g,w,d,p,E)}roundClean(){rr.fill(0),ar.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},mb=class extends rw{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const fb=sm(()=>new rw),db=sm(()=>new mb),Ke=new ArrayBuffer(0),b="";class ge extends TypeError{constructor(){super(...arguments),this.name=ge.NAME}static isType(e,t){if(typeof t=="string"){if(t==="Array"&&Array.isArray(e)||t==="ArrayBuffer"&&e instanceof ArrayBuffer||t==="ArrayBufferView"&&ArrayBuffer.isView(e)||typeof e===t)return!0}else if(e instanceof t)return!0;return!1}static assert(e,t,...r){for(const n of r)if(this.isType(e,n))return;const a=r.map(n=>n instanceof Function&&"name"in n?n.name:"".concat(n));throw new ge("Parameter '".concat(t,"' is not of type ").concat(a.length>1?"(".concat(a.join(" or "),")"):a[0]))}}ge.NAME="ArgumentError";class he extends TypeError{static assert(...e){let t=null,r,a;typeof e[0]=="string"?(t=e[0],r=e[1],a=e.slice(2)):(r=e[0],a=e.slice(1)),ge.assert(r,"parameters","object");for(const n of a)if(r[n]==null)throw new he(n,t)}static assertEmpty(e,t,r){if(e==null)throw new he(t,r)}constructor(e,t=null,r){super(),this.name=he.NAME,this.field=e,t&&(this.target=t),r?this.message=r:this.message="Absent mandatory parameter '".concat(e,"' ").concat(t?" in '".concat(t,"'"):b)}}he.NAME="ParameterError";class U extends Error{static assertSchema(e,t){if(!e.verified)throw new Error("Object's schema was not verified against input data for ".concat(t))}static assert(e,t){if(e.offset===-1)throw new U("Error during parsing of ASN.1 data. Data is not correct for '".concat(t,"'."))}constructor(e){super(e),this.name="AsnError"}}class ${static blockName(){return this.CLASS_NAME}static fromBER(e){const t=$e(e);U.assert(t,this.name);try{return new this({schema:t.result})}catch(r){throw new U("Cannot create '".concat(this.CLASS_NAME,"' from ASN.1 object"))}}static defaultValues(e){throw new Error("Invalid member name for ".concat(this.CLASS_NAME," class: ").concat(e))}static schema(e={}){throw new Error("Method '".concat(this.CLASS_NAME,".schema' should be overridden"))}get className(){return this.constructor.CLASS_NAME}toString(e="hex"){let t;try{t=this.toSchema()}catch(r){t=this.toSchema(!0)}return pe.ToString(t.toBER(),e)}}$.CLASS_NAME="PkiObject";function Wr(s){let e=!1,t=b;const r=s.trim();for(let a=0;a<r.length;a++)r.charCodeAt(a)===32?e===!1&&(e=!0):(e&&(t+=" ",e=!1),t+=r[a]);return t.toLowerCase()}const Mo="type",Om="value";class ea extends ${constructor(e={}){super(),this.type=f(e,Mo,ea.defaultValues(Mo)),this.value=f(e,Om,ea.defaultValues(Om)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mo:return b;case Om:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.type||b}),new te({name:t.value||b})]})}fromSchema(e){K(e,[Mo,"typeValue"]);const t=H(e,e,ea.schema({names:{type:Mo,value:"typeValue"}}));U.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new C({value:[new z({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return Object.keys(this.value).length!==0?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[Ph.blockName(),pf.blockName(),gf.blockName(),Gc.blockName(),Hs.blockName(),wf.blockName(),Qw.blockName(),hg.blockName(),ey.blockName(),ty.blockName(),sy.blockName(),ry.blockName()];if(e instanceof ArrayBuffer)return Se.isEqual(this.value.valueBeforeDecodeView,e);if(e.constructor.blockName()===ea.blockName()){if(this.type!==e.type)return!1;const r=[!1,!1],a=this.value.constructor.blockName();for(const n of t)a===n&&(r[0]=!0),e.value.constructor.blockName()===n&&(r[1]=!0);if(r[0]!==r[1])return!1;if(r[0]&&r[1]){const n=Wr(this.value.valueBlock.value),o=Wr(e.value.valueBlock.value);if(n.localeCompare(o)!==0)return!1}else if(!Se.isEqual(this.value.valueBeforeDecodeView,e.value.valueBeforeDecodeView))return!1;return!0}return!1}}ea.CLASS_NAME="AttributeTypeAndValue";const fa="typesAndValues",Ac="valueBeforeDecode",xp="RDN";class we extends ${constructor(e={}){super(),this.typesAndValues=f(e,fa,we.defaultValues(fa)),this.valueBeforeDecode=f(e,Ac,we.defaultValues(Ac)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fa:return[];case Ac:return Ke;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case fa:return t.length===0;case Ac:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.repeatedSequence||b,value:new _e({value:[new se({name:t.repeatedSet||b,value:ea.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){K(e,[xp,fa]);const t=H(e,e,we.schema({names:{blockName:xp,repeatedSet:fa}}));U.assertSchema(t,this.className),fa in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,r=>new ea({schema:r}))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecodeView.slice().buffer}toSchema(){if(this.valueBeforeDecode.byteLength===0)return new C({value:[new _e({value:Array.from(this.typesAndValues,t=>t.toSchema())})]});const e=$e(this.valueBeforeDecode);if(U.assert(e,"RelativeDistinguishedNames"),!(e.result instanceof C))throw new Error("ASN.1 result should be SEQUENCE");return e.result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,e=>e.toJSON())}}isEqual(e){if(e instanceof we){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(r.isEqual(e.typesAndValues[t])===!1)return!1;return!0}return e instanceof ArrayBuffer?rc(this.valueBeforeDecode,e):!1}}we.CLASS_NAME="RelativeDistinguishedNames";const rl="type",al="value";function pb(s={},e=!1){const t=f(s,"names",{});return new C({optional:e,value:[new P({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:t.country_name||b,value:[new Ve({value:[new Gc,new Hs]})]}),new P({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:t.administration_domain_name||b,value:[new Ve({value:[new Gc,new Hs]})]}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:t.network_address||b,isHexOnly:!0}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:t.terminal_identifier||b,isHexOnly:!0}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:t.private_domain_name||b,value:[new Ve({value:[new Gc,new Hs]})]}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:t.organization_name||b,isHexOnly:!0}),new ee({optional:!0,name:t.numeric_user_identifier||b,idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new P({optional:!0,name:t.personal_name||b,idBlock:{tagClass:3,tagNumber:5},value:[new ee({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new ee({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new P({optional:!0,name:t.organizational_unit_names||b,idBlock:{tagClass:3,tagNumber:6},value:[new se({value:new Hs})]})]})}function gb(s=!1){return new C({optional:s,value:[new Hs,new Hs]})}function wb(s=!1){return new _e({optional:s,value:[new ee({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new te]})]})}class de extends ${constructor(e={}){super(),this.type=f(e,rl,de.defaultValues(rl)),this.value=f(e,al,de.defaultValues(al)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rl:return 9;case al:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case rl:return t===de.defaultValues(e);case al:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new Ve({value:[new P({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||b,value:[new z,new P({idBlock:{tagClass:3,tagNumber:0},value:[new te]})]}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:1}}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:2}}),new P({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||b,value:[pb(t.builtInStandardAttributes||{},!1),gb(!0),wb(!0)]}),new P({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||b,value:[we.schema(t.directoryName||{})]}),new P({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||b,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:[new wf,new Hs,new gf,new Ph,new pf]})]}),new P({idBlock:{tagClass:3,tagNumber:1},value:[new Ve({value:[new wf,new Hs,new gf,new Ph,new pf]})]})]}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:6}}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:7}}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){K(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=H(e,e,de.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));switch(U.assertSchema(t,this.className),this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=t.result.blockName;break;case 1:case 2:case 6:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=22;const a=r.toBER(!1),n=$e(a);U.assert(n,"GeneralName value"),this.value=n.result.valueBlock.value}break;case 3:this.value=t.result.blockName;break;case 4:this.value=new we({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new J({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const r=t.result.blockName;r.idBlock.tagClass=1,r.idBlock.tagNumber=6;const a=r.toBER(!1),n=$e(a);U.assert(n,"GeneralName registeredID"),this.value=n.result.valueBlock.toString()}break}}toSchema(){switch(this.type){case 0:case 3:case 5:return new P({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new hg({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new P({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new z({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return de.schema()}}toJSON(){const e={type:this.type,value:b};if(typeof this.value=="string")e.value=this.value;else try{e.value=this.value.toJSON()}catch(t){}return e}}de.CLASS_NAME="GeneralName";const nl="accessMethod",il="accessLocation",yb=[nl,il];class In extends ${constructor(e={}){super(),this.accessMethod=f(e,nl,In.defaultValues(nl)),this.accessLocation=f(e,il,In.defaultValues(il)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case nl:return b;case il:return new de;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.accessMethod||b}),de.schema(t.accessLocation||{})]})}fromSchema(e){K(e,yb);const t=H(e,e,In.schema({names:{accessMethod:nl,accessLocation:{names:{blockName:il}}}}));U.assertSchema(t,this.className),this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new de({schema:t.result.accessLocation})}toSchema(){return new C({value:[new z({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}In.CLASS_NAME="AccessDescription";const lr="seconds",ur="millis",cr="micros";class Kt extends ${constructor(e={}){super(),lr in e&&(this.seconds=f(e,lr,Kt.defaultValues(lr))),ur in e&&(this.millis=f(e,ur,Kt.defaultValues(ur))),cr in e&&(this.micros=f(e,cr,Kt.defaultValues(cr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lr:case ur:case cr:return 0;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case lr:case ur:case cr:return t===Kt.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,optional:!0,value:[new L({optional:!0,name:t.seconds||b}),new ee({name:t.millis||b,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new ee({name:t.micros||b,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){K(e,[lr,ur,cr]);const t=H(e,e,Kt.schema({names:{seconds:lr,millis:ur,micros:cr}}));if(U.assertSchema(t,this.className),"seconds"in t.result&&(this.seconds=t.result.seconds.valueBlock.valueDec),"millis"in t.result){const r=new L({valueHex:t.result.millis.valueBlock.valueHex});this.millis=r.valueBlock.valueDec}if("micros"in t.result){const r=new L({valueHex:t.result.micros.valueBlock.valueHex});this.micros=r.valueBlock.valueDec}}toSchema(){const e=[];if(this.seconds!==void 0&&e.push(new L({value:this.seconds})),this.millis!==void 0){const t=new L({value:this.millis});e.push(new ee({idBlock:{tagClass:3,tagNumber:0},valueHex:t.valueBlock.valueHexView}))}if(this.micros!==void 0){const t=new L({value:this.micros});e.push(new ee({idBlock:{tagClass:3,tagNumber:1},valueHex:t.valueBlock.valueHexView}))}return new C({value:e})}toJSON(){const e={};return this.seconds!==void 0&&(e.seconds=this.seconds),this.millis!==void 0&&(e.millis=this.millis),this.micros!==void 0&&(e.micros=this.micros),e}}Kt.CLASS_NAME="Accuracy";const Nc="algorithmId",Fo="algorithmParams",aw="algorithm",xf="params",vb=[aw,xf];class R extends ${constructor(e={}){super(),this.algorithmId=f(e,Nc,R.defaultValues(Nc)),Fo in e&&(this.algorithmParams=f(e,Fo,R.defaultValues(Fo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Nc:return b;case Fo:return new te;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Nc:return t===b;case Fo:return t instanceof te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,optional:t.optional||!1,value:[new z({name:t.algorithmIdentifier||b}),new te({name:t.algorithmParams||b,optional:!0})]})}fromSchema(e){K(e,vb);const t=H(e,e,R.schema({names:{algorithmIdentifier:aw,algorithmParams:xf}}));U.assertSchema(t,this.className),this.algorithmId=t.result.algorithm.valueBlock.toString(),xf in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new z({value:this.algorithmId})),this.algorithmParams&&!(this.algorithmParams instanceof te)&&e.push(this.algorithmParams),new C({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return this.algorithmParams&&!(this.algorithmParams instanceof te)&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return!(e instanceof R)||this.algorithmId!==e.algorithmId?!1:this.algorithmParams?e.algorithmParams?JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!1:!e.algorithmParams}}R.CLASS_NAME="AlgorithmIdentifier";const zn="altNames",bb=[zn];class Bo extends ${constructor(e={}){super(),this.altNames=f(e,zn,Bo.defaultValues(zn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case zn:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.altNames||b,value:de.schema()})]})}fromSchema(e){K(e,bb);const t=H(e,e,Bo.schema({names:{altNames:zn}}));U.assertSchema(t,this.className),zn in t.result&&(this.altNames=Array.from(t.result.altNames,r=>new de({schema:r})))}toSchema(){return new C({value:Array.from(this.altNames,e=>e.toSchema())})}toJSON(){return{altNames:Array.from(this.altNames,e=>e.toJSON())}}}Bo.CLASS_NAME="AltName";const Yn="type",Zn="values",Sb=[Yn,Zn];class Ae extends ${constructor(e={}){super(),this.type=f(e,Yn,Ae.defaultValues(Yn)),this.values=f(e,Zn,Ae.defaultValues(Zn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Yn:return b;case Zn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Yn:return t===b;case Zn:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.type||b}),new _e({name:t.setName||b,value:[new se({name:t.values||b,value:new te})]})]})}fromSchema(e){K(e,Sb);const t=H(e,e,Ae.schema({names:{type:Yn,values:Zn}}));U.assertSchema(t,this.className),this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new C({value:[new z({value:this.type}),new _e({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,e=>e.toJSON())}}}Ae.CLASS_NAME="Attribute";const ol="notBeforeTime",ll="notAfterTime",Ab=[ol,ll];class cs extends ${constructor(e={}){super(),this.notBeforeTime=f(e,ol,cs.defaultValues(ol)),this.notAfterTime=f(e,ll,cs.defaultValues(ll)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ol:case ll:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new xe({name:t.notBeforeTime||b}),new xe({name:t.notAfterTime||b})]})}fromSchema(e){K(e,Ab);const t=H(e,e,cs.schema({names:{notBeforeTime:ol,notAfterTime:ll}}));U.assertSchema(t,this.className),this.notBeforeTime=t.result.notBeforeTime.toDate(),this.notAfterTime=t.result.notAfterTime.toDate()}toSchema(){return new C({value:[new xe({valueDate:this.notBeforeTime}),new xe({valueDate:this.notAfterTime})]})}toJSON(){return{notBeforeTime:this.notBeforeTime,notAfterTime:this.notAfterTime}}}cs.CLASS_NAME="AttCertValidityPeriod";const Jo="names",Bp="generalNames";class Ge extends ${constructor(e={}){super(),this.names=f(e,Jo,Ge.defaultValues(Jo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"names":return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=f(e,Jo,{});return new C({optional:t,name:r.blockName||b,value:[new se({name:r.generalNames||b,value:de.schema()})]})}fromSchema(e){K(e,[Jo,Bp]);const t=H(e,e,Ge.schema({names:{blockName:Jo,generalNames:Bp}}));U.assertSchema(t,this.className),this.names=Array.from(t.result.generalNames,r=>new de({schema:r}))}toSchema(){return new C({value:Array.from(this.names,e=>e.toSchema())})}toJSON(){return{names:Array.from(this.names,e=>e.toJSON())}}}Ge.CLASS_NAME="GeneralNames";const Nb="2.5.29.9",kb="2.5.29.14",Eb="2.5.29.15",Cb="2.5.29.16",nw="2.5.29.17",iw="2.5.29.18",pd="2.5.29.19",Ib="2.5.29.20",Vb="2.5.29.27",xb="2.5.29.21",Bb="2.5.29.24",ow="2.5.29.28",lw="2.5.29.29",uw="2.5.29.30",cw="2.5.29.31",gd="2.5.29.46",hw="2.5.29.32",Wt="2.5.29.32.0",Pb="1.3.6.1.4.1.311.21.10",mw="2.5.29.33",wd="2.5.29.35",fw="2.5.29.36",Ob="2.5.29.37",Db="2.5.29.54",yd="1.3.6.1.5.5.7.1.1",Tb="1.3.6.1.5.5.7.1.11",Rb="1.3.6.1.4.1.11129.2.4.2",Lb="1.3.6.1.4.1.311.21.7",Ub="1.3.6.1.4.1.311.21.1",jb="1.3.6.1.5.5.7.1.3",vd="1.2.840.113549.1.7.1",dw="1.2.840.113549.1.7.2",pw="1.2.840.113549.1.7.3",gw="1.2.840.113549.1.7.6",$b="1.2.840.113549.1.9.16.1.4",Pp="1.2.840.113549.1.9.22.1",Kb="1.2.840.113549.1.9.22.2",Op="1.2.840.113549.1.9.22.3",Dp="1.2.840.113549.1.9.23.1",Hb="1.3.6.1.5.5.7",Mb="".concat(Hb,".48"),Zc="".concat(Mb,".1.1"),ya="keyIdentifier",va="authorityCertIssuer",ba="authorityCertSerialNumber",Fb=[ya,va,ba];class ta extends ${constructor(e={}){super(),ya in e&&(this.keyIdentifier=f(e,ya,ta.defaultValues(ya))),va in e&&(this.authorityCertIssuer=f(e,va,ta.defaultValues(va))),ba in e&&(this.authorityCertSerialNumber=f(e,ba,ta.defaultValues(ba))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ya:return new J;case va:return[];case ba:return new L;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new ee({name:t.keyIdentifier||b,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new se({name:t.authorityCertIssuer||b,value:de.schema()})]}),new ee({name:t.authorityCertSerialNumber||b,optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){K(e,Fb);const t=H(e,e,ta.schema({names:{keyIdentifier:ya,authorityCertIssuer:va,authorityCertSerialNumber:ba}}));U.assertSchema(t,this.className),ya in t.result&&(this.keyIdentifier=new J({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),va in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,r=>new de({schema:r}))),ba in t.result&&(this.authorityCertSerialNumber=new L({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return this.keyIdentifier&&e.push(new ee({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHexView})),this.authorityCertIssuer&&e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,t=>t.toSchema())})),this.authorityCertSerialNumber&&e.push(new ee({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHexView})),new C({value:e})}toJSON(){const e={};return this.keyIdentifier&&(e.keyIdentifier=this.keyIdentifier.toJSON()),this.authorityCertIssuer&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,t=>t.toJSON())),this.authorityCertSerialNumber&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}ta.CLASS_NAME="AuthorityKeyIdentifier";const da="pathLenConstraint",pa="cA";class Vn extends ${constructor(e={}){super(),this.cA=f(e,pa,!1),da in e&&(this.pathLenConstraint=f(e,da,0)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pa:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new ha({optional:!0,name:t.cA||b}),new L({optional:!0,name:t.pathLenConstraint||b})]})}fromSchema(e){K(e,[pa,da]);const t=H(e,e,Vn.schema({names:{cA:pa,pathLenConstraint:da}}));U.assertSchema(t,this.className),pa in t.result&&(this.cA=t.result.cA.valueBlock.value),da in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==Vn.defaultValues(pa)&&e.push(new ha({value:this.cA})),da in this&&(this.pathLenConstraint instanceof L?e.push(this.pathLenConstraint):e.push(new L({value:this.pathLenConstraint}))),new C({value:e})}toJSON(){const e={};return this.cA!==Vn.defaultValues(pa)&&(e.cA=this.cA),da in this&&(this.pathLenConstraint instanceof L?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}Vn.CLASS_NAME="BasicConstraints";const Dm="certificateIndex",Tm="keyIndex";class oc extends ${constructor(e={}){super(),this.certificateIndex=f(e,Dm,oc.defaultValues(Dm)),this.keyIndex=f(e,Tm,oc.defaultValues(Tm)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dm:case Tm:return 0;default:return super.defaultValues(e)}}static schema(){return new L}fromSchema(e){if(e.constructor.blockName()!==L.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const m=new ArrayBuffer(4);new Uint8Array(m).set(r,4-t.byteLength),t=m.slice(0)}break;case t.byteLength>4:{const m=new ArrayBuffer(4);new Uint8Array(m).set(r.slice(0,4)),t=m.slice(0)}break}const a=t.slice(0,2),n=new Uint8Array(a);let o=n[0];n[0]=n[1],n[1]=o;const i=new Uint16Array(a);this.keyIndex=i[0];const u=t.slice(2),c=new Uint8Array(u);o=c[0],c[0]=c[1],c[1]=o;const l=new Uint16Array(u);this.certificateIndex=l[0]}toSchema(){const e=new ArrayBuffer(2),t=new Uint16Array(e);t[0]=this.certificateIndex;const r=new Uint8Array(e);let a=r[0];r[0]=r[1],r[1]=a;const n=new ArrayBuffer(2),o=new Uint16Array(n);o[0]=this.keyIndex;const i=new Uint8Array(n);return a=i[0],i[0]=i[1],i[1]=a,new L({valueHex:So(n,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}oc.CLASS_NAME="CAVersion";const ul="policyQualifierId",cl="qualifier",Jb=[ul,cl];class xn extends ${constructor(e={}){super(),this.policyQualifierId=f(e,ul,xn.defaultValues(ul)),this.qualifier=f(e,cl,xn.defaultValues(cl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ul:return b;case cl:return new te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.policyQualifierId||b}),new te({name:t.qualifier||b})]})}fromSchema(e){K(e,Jb);const t=H(e,e,xn.schema({names:{policyQualifierId:ul,qualifier:cl}}));U.assertSchema(t,this.className),this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new C({value:[new z({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}xn.CLASS_NAME="PolicyQualifierInfo";const hl="policyIdentifier",Sa="policyQualifiers",qb=[hl,Sa];class Bn extends ${constructor(e={}){super(),this.policyIdentifier=f(e,hl,Bn.defaultValues(hl)),Sa in e&&(this.policyQualifiers=f(e,Sa,Bn.defaultValues(Sa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hl:return b;case Sa:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.policyIdentifier||b}),new C({optional:!0,value:[new se({name:t.policyQualifiers||b,value:xn.schema()})]})]})}fromSchema(e){K(e,qb);const t=H(e,e,Bn.schema({names:{policyIdentifier:hl,policyQualifiers:Sa}}));U.assertSchema(t,this.className),this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),Sa in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,r=>new xn({schema:r})))}toSchema(){const e=[];return e.push(new z({value:this.policyIdentifier})),this.policyQualifiers&&e.push(new C({value:Array.from(this.policyQualifiers,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return this.policyQualifiers&&(e.policyQualifiers=Array.from(this.policyQualifiers,t=>t.toJSON())),e}}Bn.CLASS_NAME="PolicyInformation";const ml="certificatePolicies",Wb=[ml];class Po extends ${constructor(e={}){super(),this.certificatePolicies=f(e,ml,Po.defaultValues(ml)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ml:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.certificatePolicies||b,value:Bn.schema()})]})}fromSchema(e){K(e,Wb);const t=H(e,e,Po.schema({names:{certificatePolicies:ml}}));U.assertSchema(t,this.className),this.certificatePolicies=Array.from(t.result.certificatePolicies,r=>new Bn({schema:r}))}toSchema(){return new C({value:Array.from(this.certificatePolicies,e=>e.toSchema())})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,e=>e.toJSON())}}}Po.CLASS_NAME="CertificatePolicies";const fl="templateID",Cs="templateMajorVersion",Is="templateMinorVersion",_b=[fl,Cs,Is];class vo extends ${constructor(e={}){super(),this.templateID=f(e,fl,vo.defaultValues(fl)),Cs in e&&(this.templateMajorVersion=f(e,Cs,vo.defaultValues(Cs))),Is in e&&(this.templateMinorVersion=f(e,Is,vo.defaultValues(Is))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fl:return b;case Cs:case Is:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.templateID||b}),new L({name:t.templateMajorVersion||b,optional:!0}),new L({name:t.templateMinorVersion||b,optional:!0})]})}fromSchema(e){K(e,_b);const t=H(e,e,vo.schema({names:{templateID:fl,templateMajorVersion:Cs,templateMinorVersion:Is}}));U.assertSchema(t,this.className),this.templateID=t.result.templateID.valueBlock.toString(),Cs in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),Is in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new z({value:this.templateID})),Cs in this&&e.push(new L({value:this.templateMajorVersion})),Is in this&&e.push(new L({value:this.templateMinorVersion})),new C({value:e})}toJSON(){const e={templateID:this.templateID};return Cs in this&&(e.templateMajorVersion=this.templateMajorVersion),Is in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}const Aa="distributionPoint",ww="distributionPointNames",Na="reasons",ka="cRLIssuer",yw="cRLIssuerNames",Gb=[Aa,ww,Na,ka,yw];class sa extends ${constructor(e={}){super(),Aa in e&&(this.distributionPoint=f(e,Aa,sa.defaultValues(Aa))),Na in e&&(this.reasons=f(e,Na,sa.defaultValues(Na))),ka in e&&(this.cRLIssuer=f(e,ka,sa.defaultValues(ka))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Aa:return[];case Na:return new ce;case ka:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:[new P({name:t.distributionPoint||b,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new se({name:t.distributionPointNames||b,value:de.schema()})]}),new P({name:t.distributionPoint||b,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:we.schema().valueBlock.value})]})]}),new ee({name:t.reasons||b,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new P({name:t.cRLIssuer||b,optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new se({name:t.cRLIssuerNames||b,value:de.schema()})]})]})}fromSchema(e){K(e,Gb);const t=H(e,e,sa.schema({names:{distributionPoint:Aa,distributionPointNames:ww,reasons:Na,cRLIssuer:ka,cRLIssuerNames:yw}}));U.assertSchema(t,this.className),Aa in t.result&&(t.result.distributionPoint.idBlock.tagNumber===0&&(this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new de({schema:r}))),t.result.distributionPoint.idBlock.tagNumber===1&&(this.distributionPoint=new we({schema:new C({value:t.result.distributionPoint.valueBlock.value})}))),Na in t.result&&(this.reasons=new ce({valueHex:t.result.reasons.valueBlock.valueHex})),ka in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,r=>new de({schema:r})))}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new P({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}):t=new P({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return this.reasons&&e.push(new ee({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHexView})),this.cRLIssuer&&e.push(new P({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.reasons&&(e.reasons=this.reasons.toJSON()),this.cRLIssuer&&(e.cRLIssuer=Array.from(this.cRLIssuer,t=>t.toJSON())),e}}sa.CLASS_NAME="DistributionPoint";const dl="distributionPoints",Xb=[dl];class Oo extends ${constructor(e={}){super(),this.distributionPoints=f(e,dl,Oo.defaultValues(dl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case dl:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.distributionPoints||b,value:sa.schema()})]})}fromSchema(e){K(e,Xb);const t=H(e,e,Oo.schema({names:{distributionPoints:dl}}));U.assertSchema(t,this.className),this.distributionPoints=Array.from(t.result.distributionPoints,r=>new sa({schema:r}))}toSchema(){return new C({value:Array.from(this.distributionPoints,e=>e.toSchema())})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,e=>e.toJSON())}}}Oo.CLASS_NAME="CRLDistributionPoints";const pl="keyPurposes",zb=[pl];class lc extends ${constructor(e={}){super(),this.keyPurposes=f(e,pl,lc.defaultValues(pl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pl:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.keyPurposes||b,value:new z})]})}fromSchema(e){K(e,zb);const t=H(e,e,lc.schema({names:{keyPurposes:pl}}));U.assertSchema(t,this.className),this.keyPurposes=Array.from(t.result.keyPurposes,r=>r.valueBlock.toString())}toSchema(){return new C({value:Array.from(this.keyPurposes,e=>new z({value:e}))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}lc.CLASS_NAME="ExtKeyUsage";const qo="accessDescriptions";class Do extends ${constructor(e={}){super(),this.accessDescriptions=f(e,qo,Do.defaultValues(qo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qo:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.accessDescriptions||b,value:In.schema()})]})}fromSchema(e){K(e,[qo]);const t=H(e,e,Do.schema({names:{accessDescriptions:qo}}));U.assertSchema(t,this.className),this.accessDescriptions=Array.from(t.result.accessDescriptions,r=>new In({schema:r}))}toSchema(){return new C({value:Array.from(this.accessDescriptions,e=>e.toSchema())})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,e=>e.toJSON())}}}Do.CLASS_NAME="InfoAccess";const Ea="distributionPoint",vw="distributionPointNames",hr="onlyContainsUserCerts",mr="onlyContainsCACerts",fr="onlySomeReasons",dr="indirectCRL",pr="onlyContainsAttributeCerts",Yb=[Ea,vw,hr,mr,fr,dr,pr];class st extends ${constructor(e={}){super(),Ea in e&&(this.distributionPoint=f(e,Ea,st.defaultValues(Ea))),this.onlyContainsUserCerts=f(e,hr,st.defaultValues(hr)),this.onlyContainsCACerts=f(e,mr,st.defaultValues(mr)),fr in e&&(this.onlySomeReasons=f(e,fr,st.defaultValues(fr))),this.indirectCRL=f(e,dr,st.defaultValues(dr)),this.onlyContainsAttributeCerts=f(e,pr,st.defaultValues(pr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ea:return[];case hr:return!1;case mr:return!1;case fr:return 0;case dr:return!1;case pr:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Ve({value:[new P({name:t.distributionPoint||b,idBlock:{tagClass:3,tagNumber:0},value:[new se({name:t.distributionPointNames||b,value:de.schema()})]}),new P({name:t.distributionPoint||b,idBlock:{tagClass:3,tagNumber:1},value:we.schema().valueBlock.value})]})]}),new ee({name:t.onlyContainsUserCerts||b,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new ee({name:t.onlyContainsCACerts||b,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new ee({name:t.onlySomeReasons||b,optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new ee({name:t.indirectCRL||b,optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new ee({name:t.onlyContainsAttributeCerts||b,optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){K(e,Yb);const t=H(e,e,st.schema({names:{distributionPoint:Ea,distributionPointNames:vw,onlyContainsUserCerts:hr,onlyContainsCACerts:mr,onlySomeReasons:fr,indirectCRL:dr,onlyContainsAttributeCerts:pr}}));if(U.assertSchema(t,this.className),Ea in t.result)switch(!0){case t.result.distributionPoint.idBlock.tagNumber===0:this.distributionPoint=Array.from(t.result.distributionPointNames,r=>new de({schema:r}));break;case t.result.distributionPoint.idBlock.tagNumber===1:this.distributionPoint=new we({schema:new C({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if(hr in t.result){const r=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=r[0]!==0}if(mr in t.result){const r=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=r[0]!==0}if(fr in t.result){const r=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=r[0]}if(dr in t.result){const r=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=r[0]!==0}if(pr in t.result){const r=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=r[0]!==0}}toSchema(){const e=[];if(this.distributionPoint){let t;this.distributionPoint instanceof Array?t=new P({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,r=>r.toSchema())}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==st.defaultValues(hr)&&e.push(new ee({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==st.defaultValues(mr)&&e.push(new ee({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),this.onlySomeReasons!==void 0){const t=new ArrayBuffer(1),r=new Uint8Array(t);r[0]=this.onlySomeReasons,e.push(new ee({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==st.defaultValues(dr)&&e.push(new ee({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==st.defaultValues(pr)&&e.push(new ee({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new C({value:e})}toJSON(){const e={};return this.distributionPoint&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,t=>t.toJSON()):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==st.defaultValues(hr)&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==st.defaultValues(mr)&&(e.onlyContainsCACerts=this.onlyContainsCACerts),fr in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==st.defaultValues(dr)&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==st.defaultValues(pr)&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}st.CLASS_NAME="IssuingDistributionPoint";const gl="base",Qn="minimum",gr="maximum",Zb=[gl,Qn,gr];class vs extends ${constructor(e={}){super(),this.base=f(e,gl,vs.defaultValues(gl)),this.minimum=f(e,Qn,vs.defaultValues(Qn)),gr in e&&(this.maximum=f(e,gr,vs.defaultValues(gr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gl:return new de;case Qn:return 0;case gr:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[de.schema(t.base||{}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new L({name:t.minimum||b})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new L({name:t.maximum||b})]})]})}fromSchema(e){K(e,Zb);const t=H(e,e,vs.schema({names:{base:{names:{blockName:gl}},minimum:Qn,maximum:gr}}));U.assertSchema(t,this.className),this.base=new de({schema:t.result.base}),Qn in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),gr in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),this.minimum!==0){let t=0;this.minimum instanceof L?t=this.minimum:t=new L({value:this.minimum}),e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(gr in this){let t=0;this.maximum instanceof L?t=this.maximum:t=new L({value:this.maximum}),e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new C({value:e})}toJSON(){const e={base:this.base.toJSON()};return this.minimum!==0&&(typeof this.minimum=="number"?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),this.maximum!==void 0&&(typeof this.maximum=="number"?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}vs.CLASS_NAME="GeneralSubtree";const Ca="permittedSubtrees",Ia="excludedSubtrees",Qb=[Ca,Ia];class No extends ${constructor(e={}){super(),Ca in e&&(this.permittedSubtrees=f(e,Ca,No.defaultValues(Ca))),Ia in e&&(this.excludedSubtrees=f(e,Ia,No.defaultValues(Ia))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ca:case Ia:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new se({name:t.permittedSubtrees||b,value:vs.schema()})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new se({name:t.excludedSubtrees||b,value:vs.schema()})]})]})}fromSchema(e){K(e,Qb);const t=H(e,e,No.schema({names:{permittedSubtrees:Ca,excludedSubtrees:Ia}}));U.assertSchema(t,this.className),Ca in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,r=>new vs({schema:r}))),Ia in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,r=>new vs({schema:r})))}toSchema(){const e=[];return this.permittedSubtrees&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,t=>t.toSchema())})),this.excludedSubtrees&&e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={};return this.permittedSubtrees&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,t=>t.toJSON())),this.excludedSubtrees&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,t=>t.toJSON())),e}}No.CLASS_NAME="NameConstraints";const Vs="requireExplicitPolicy",xs="inhibitPolicyMapping",eS=[Vs,xs];class ko extends ${constructor(e={}){super(),Vs in e&&(this.requireExplicitPolicy=f(e,Vs,ko.defaultValues(Vs))),xs in e&&(this.inhibitPolicyMapping=f(e,xs,ko.defaultValues(xs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vs:return 0;case xs:return 0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new ee({name:t.requireExplicitPolicy||b,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new ee({name:t.inhibitPolicyMapping||b,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){K(e,eS);const t=H(e,e,ko.schema({names:{requireExplicitPolicy:Vs,inhibitPolicyMapping:xs}}));if(U.assertSchema(t,this.className),Vs in t.result){const r=t.result.requireExplicitPolicy;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const a=r.toBER(!1),n=$e(a);U.assert(n,"Integer"),this.requireExplicitPolicy=n.result.valueBlock.valueDec}if(xs in t.result){const r=t.result.inhibitPolicyMapping;r.idBlock.tagClass=1,r.idBlock.tagNumber=2;const a=r.toBER(!1),n=$e(a);U.assert(n,"Integer"),this.inhibitPolicyMapping=n.result.valueBlock.valueDec}}toSchema(){const e=[];if(Vs in this){const t=new L({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if(xs in this){const t=new L({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new C({value:e})}toJSON(){const e={};return Vs in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),xs in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}ko.CLASS_NAME="PolicyConstraints";const wl="issuerDomainPolicy",yl="subjectDomainPolicy",tS=[wl,yl];class Pn extends ${constructor(e={}){super(),this.issuerDomainPolicy=f(e,wl,Pn.defaultValues(wl)),this.subjectDomainPolicy=f(e,yl,Pn.defaultValues(yl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wl:return b;case yl:return b;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.issuerDomainPolicy||b}),new z({name:t.subjectDomainPolicy||b})]})}fromSchema(e){K(e,tS);const t=H(e,e,Pn.schema({names:{issuerDomainPolicy:wl,subjectDomainPolicy:yl}}));U.assertSchema(t,this.className),this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new C({value:[new z({value:this.issuerDomainPolicy}),new z({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}Pn.CLASS_NAME="PolicyMapping";const vl="mappings",sS=[vl];class uc extends ${constructor(e={}){super(),this.mappings=f(e,vl,uc.defaultValues(vl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vl:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.mappings||b,value:Pn.schema()})]})}fromSchema(e){K(e,sS);const t=H(e,e,uc.schema({names:{mappings:vl}}));U.assertSchema(t,this.className),this.mappings=Array.from(t.result.mappings,r=>new Pn({schema:r}))}toSchema(){return new C({value:Array.from(this.mappings,e=>e.toSchema())})}toJSON(){return{mappings:Array.from(this.mappings,e=>e.toJSON())}}}uc.CLASS_NAME="PolicyMappings";const wr="notBefore",yr="notAfter",rS=[wr,yr];class Eo extends ${constructor(e={}){super(),wr in e&&(this.notBefore=f(e,wr,Eo.defaultValues(wr))),yr in e&&(this.notAfter=f(e,yr,Eo.defaultValues(yr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wr:return new Date;case yr:return new Date;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new ee({name:t.notBefore||b,optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new ee({name:t.notAfter||b,optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){K(e,rS);const t=H(e,e,Eo.schema({names:{notBefore:wr,notAfter:yr}}));if(U.assertSchema(t,this.className),wr in t.result){const r=new xe;r.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=r.toDate()}if(yr in t.result){const r=new xe({valueHex:t.result.notAfter.valueBlock.valueHex});r.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=r.toDate()}}toSchema(){const e=[];return wr in this&&e.push(new ee({idBlock:{tagClass:3,tagNumber:0},valueHex:new xe({valueDate:this.notBefore}).valueBlock.valueHexView})),yr in this&&e.push(new ee({idBlock:{tagClass:3,tagNumber:1},valueHex:new xe({valueDate:this.notAfter}).valueBlock.valueHexView})),new C({value:e})}toJSON(){const e={};return this.notBefore&&(e.notBefore=this.notBefore),this.notAfter&&(e.notAfter=this.notAfter),e}}Eo.CLASS_NAME="PrivateKeyUsagePeriod";const ei="id",Bs="type",ti="values",aS=[ei,Bs],nS=[ti];class On extends ${constructor(e={}){super(),this.id=f(e,ei,On.defaultValues(ei)),Bs in e&&(this.type=f(e,Bs,On.defaultValues(Bs))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ei:return b;case Bs:return new We;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ei:return t===b;case Bs:return t instanceof We;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.id||b}),new te({name:t.type||b,optional:!0})]})}fromSchema(e){K(e,aS);const t=H(e,e,On.schema({names:{id:ei,type:Bs}}));U.assertSchema(t,this.className),this.id=t.result.id.valueBlock.toString(),Bs in t.result&&(this.type=t.result.type)}toSchema(){const e=[new z({value:this.id})];return Bs in this&&e.push(this.type),new C({value:e})}toJSON(){const e={id:this.id};return this.type&&(e.type=this.type.toJSON()),e}}On.CLASS_NAME="QCStatement";class cc extends ${constructor(e={}){super(),this.values=f(e,ti,cc.defaultValues(ti)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ti:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ti:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.values||b,value:On.schema(t.value||{})})]})}fromSchema(e){K(e,nS);const t=H(e,e,cc.schema({names:{values:ti}}));U.assertSchema(t,this.className),this.values=Array.from(t.result.values,r=>new On({schema:r}))}toSchema(){return new C({value:Array.from(this.values,e=>e.toSchema())})}toJSON(){return{values:Array.from(this.values,e=>e.toJSON())}}}cc.CLASS_NAME="QCStatements";var ga;class oa{static register(e,t,r){this.namedCurves[e.toLowerCase()]=this.namedCurves[t]={name:e,id:t,size:r}}static find(e){return this.namedCurves[e.toLowerCase()]||null}}ga=oa,oa.namedCurves={},ga.register("P-256","1.2.840.10045.3.1.7",32),ga.register("P-384","1.3.132.0.34",48),ga.register("P-521","1.3.132.0.35",66),ga.register("brainpoolP256r1","1.3.36.3.3.2.8.1.1.7",32),ga.register("brainpoolP384r1","1.3.36.3.3.2.8.1.1.11",48),ga.register("brainpoolP512r1","1.3.36.3.3.2.8.1.1.13",64);const kc="x",Ec="y",Cc="namedCurve";class Ct extends ${constructor(e={}){super(),this.x=f(e,kc,Ct.defaultValues(kc)),this.y=f(e,Ec,Ct.defaultValues(Ec)),this.namedCurve=f(e,Cc,Ct.defaultValues(Cc)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kc:case Ec:return Ke;case Cc:return b;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case kc:case Ec:return t instanceof ArrayBuffer&&rc(t,Ct.defaultValues(e));case Cc:return typeof t=="string"&&t===Ct.defaultValues(e);default:return super.defaultValues(e)}}static schema(){return new Bh}fromSchema(e){const t=Se.toUint8Array(e);if(t[0]!==4)throw new Error("Object's schema was not verified against input data for ECPublicKey");const r=oa.find(this.namedCurve);if(!r)throw new Error("Incorrect curve OID: ".concat(this.namedCurve));const a=r.size;if(t.byteLength!==a*2+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.namedCurve=r.name,this.x=t.slice(1,a+1).buffer,this.y=t.slice(1+a,a*2+1).buffer}toSchema(){return new Bh({data:So(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){const e=oa.find(this.namedCurve);return{crv:e?e.name:this.namedCurve,x:ff(xh(this.x),!0,!0,!1),y:ff(xh(this.y),!0,!0,!1)}}fromJSON(e){he.assert("json",e,"crv","x","y");let t=0;const r=oa.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=Vo(ac(e.x,!0));if(a.byteLength<t){this.x=new ArrayBuffer(t);const o=new Uint8Array(this.x),i=new Uint8Array(a);o.set(i,1)}else this.x=a.slice(0,t);const n=Vo(ac(e.y,!0));if(n.byteLength<t){this.y=new ArrayBuffer(t);const o=new Uint8Array(this.y),i=new Uint8Array(n);o.set(i,1)}else this.y=n.slice(0,t)}}Ct.CLASS_NAME="ECPublicKey";const bl="modulus",Sl="publicExponent",iS=[bl,Sl];class Dn extends ${constructor(e={}){super(),this.modulus=f(e,bl,Dn.defaultValues(bl)),this.publicExponent=f(e,Sl,Dn.defaultValues(Sl)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bl:return new L;case Sl:return new L;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.modulus||b}),new L({name:t.publicExponent||b})]})}fromSchema(e){K(e,iS);const t=H(e,e,Dn.schema({names:{modulus:bl,publicExponent:Sl}}));U.assertSchema(t,this.className),this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new C({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:pe.ToBase64Url(this.modulus.valueBlock.valueHexView),e:pe.ToBase64Url(this.publicExponent.valueBlock.valueHexView)}}fromJSON(e){he.assert("json",e,"n","e");const t=Vo(ac(e.n,!0));this.modulus=new L({valueHex:t.slice(0,Math.pow(2,Yw(t.byteLength)))}),this.publicExponent=new L({valueHex:Vo(ac(e.e,!0)).slice(0,3)})}}Dn.CLASS_NAME="RSAPublicKey";const Al="algorithm",Nl="subjectPublicKey",oS=[Al,Nl];class xt extends ${get parsedKey(){if(this._parsedKey===void 0){switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===z.blockName())try{this._parsedKey=new Ct({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHexView})}catch(e){}break;case"1.2.840.113549.1.1.1":{const e=$e(this.subjectPublicKey.valueBlock.valueHexView);if(e.offset!==-1)try{this._parsedKey=new Dn({schema:e.result})}catch(t){}}break}this._parsedKey||(this._parsedKey=null)}return this._parsedKey||void 0}set parsedKey(e){this._parsedKey=e}constructor(e={}){super(),this.algorithm=f(e,Al,xt.defaultValues(Al)),this.subjectPublicKey=f(e,Nl,xt.defaultValues(Nl));const t=f(e,"parsedKey",null);t&&(this.parsedKey=t),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Al:return new R;case Nl:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.algorithm||{}),new ce({name:t.subjectPublicKey||b})]})}fromSchema(e){K(e,oS);const t=H(e,e,xt.schema({names:{algorithm:{names:{blockName:Al}},subjectPublicKey:Nl}}));U.assertSchema(t,this.className),this.algorithm=new R({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey}toSchema(){return new C({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if(!this.parsedKey)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Ct({json:e}),this.algorithm=new R({algorithmId:"1.2.840.10045.2.1",algorithmParams:new z({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new Dn({json:e}),this.algorithm=new R({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new We});break;default:throw new Error('Invalid value for "kty" parameter: '.concat(e.kty))}this.subjectPublicKey=new ce({valueHex:this.parsedKey.toSchema().toBER(!1)})}}async importKey(e,t=ne(!0)){try{if(!e)throw new Error("Need to provide publicKey input parameter");const r=await t.exportKey("spki",e),a=$e(r);try{this.fromSchema(a.result)}catch(n){throw new Error("Error during initializing object from schema")}}catch(r){const a=r instanceof Error?r.message:"".concat(r);throw new Error("Error during exporting public key: ".concat(a))}}}xt.CLASS_NAME="PublicKeyInfo";const si="version",ri="privateKey",ss="namedCurve",vr="publicKey",lS=[si,ri,ss,vr];class Gt extends ${constructor(e={}){super(),this.version=f(e,si,Gt.defaultValues(si)),this.privateKey=f(e,ri,Gt.defaultValues(ri)),ss in e&&(this.namedCurve=f(e,ss,Gt.defaultValues(ss))),vr in e&&(this.publicKey=f(e,vr,Gt.defaultValues(vr))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case si:return 1;case ri:return new J;case ss:return b;case vr:return new Ct;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case si:return t===Gt.defaultValues(e);case ri:return t.isEqual(Gt.defaultValues(e));case ss:return t===b;case vr:return Ct.compareWithDefault(ss,t.namedCurve)&&Ct.compareWithDefault("x",t.x)&&Ct.compareWithDefault("y",t.y);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new J({name:t.privateKey||b}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new z({name:t.namedCurve||b})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ce({name:t.publicKey||b})]})]})}fromSchema(e){K(e,lS);const t=H(e,e,Gt.schema({names:{version:si,privateKey:ri,namedCurve:ss,publicKey:vr}}));if(U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,ss in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),vr in t.result){const r={schema:t.result.publicKey.valueBlock.valueHex};ss in this&&(r.namedCurve=this.namedCurve),this.publicKey=new Ct(r)}}toSchema(){const e=[new L({value:this.version}),this.privateKey];return this.namedCurve&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[new z({value:this.namedCurve})]})),this.publicKey&&e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[new ce({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new C({value:e})}toJSON(){if(!this.namedCurve||Gt.compareWithDefault(ss,this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');const e=oa.find(this.namedCurve),t={crv:e?e.name:this.namedCurve,d:pe.ToBase64Url(this.privateKey.valueBlock.valueHexView)};if(this.publicKey){const r=this.publicKey.toJSON();t.x=r.x,t.y=r.y}return t}fromJSON(e){he.assert("json",e,"crv","d");let t=0;const r=oa.find(e.crv);r&&(this.namedCurve=r.id,t=r.size);const a=pe.FromBase64Url(e.d);if(a.byteLength<t){const n=new ArrayBuffer(t),o=new Uint8Array(n),i=new Uint8Array(a);o.set(i,1),this.privateKey=new J({valueHex:n})}else this.privateKey=new J({valueHex:a.slice(0,t)});e.x&&e.y&&(this.publicKey=new Ct({json:e}))}}Gt.CLASS_NAME="ECPrivateKey";const kl="prime",El="exponent",Cl="coefficient",uS=[kl,El,Cl];class Ms extends ${constructor(e={}){super(),this.prime=f(e,kl,Ms.defaultValues(kl)),this.exponent=f(e,El,Ms.defaultValues(El)),this.coefficient=f(e,Cl,Ms.defaultValues(Cl)),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case kl:return new L;case El:return new L;case Cl:return new L;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.prime||b}),new L({name:t.exponent||b}),new L({name:t.coefficient||b})]})}fromSchema(e){K(e,uS);const t=H(e,e,Ms.schema({names:{prime:kl,exponent:El,coefficient:Cl}}));U.assertSchema(t,this.className),this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new C({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:pe.ToBase64Url(this.prime.valueBlock.valueHexView),d:pe.ToBase64Url(this.exponent.valueBlock.valueHexView),t:pe.ToBase64Url(this.coefficient.valueBlock.valueHexView)}}fromJSON(e){he.assert("json",e,"r","d","r"),this.prime=new L({valueHex:pe.FromBase64Url(e.r)}),this.exponent=new L({valueHex:pe.FromBase64Url(e.d)}),this.coefficient=new L({valueHex:pe.FromBase64Url(e.t)})}}Ms.CLASS_NAME="OtherPrimeInfo";const Il="version",Vl="modulus",xl="publicExponent",Bl="privateExponent",Pl="prime1",Ol="prime2",Dl="exponent1",Tl="exponent2",Rl="coefficient",Va="otherPrimeInfos",cS=[Il,Vl,xl,Bl,Pl,Ol,Dl,Tl,Rl,Va];class bt extends ${constructor(e={}){super(),this.version=f(e,Il,bt.defaultValues(Il)),this.modulus=f(e,Vl,bt.defaultValues(Vl)),this.publicExponent=f(e,xl,bt.defaultValues(xl)),this.privateExponent=f(e,Bl,bt.defaultValues(Bl)),this.prime1=f(e,Pl,bt.defaultValues(Pl)),this.prime2=f(e,Ol,bt.defaultValues(Ol)),this.exponent1=f(e,Dl,bt.defaultValues(Dl)),this.exponent2=f(e,Tl,bt.defaultValues(Tl)),this.coefficient=f(e,Rl,bt.defaultValues(Rl)),Va in e&&(this.otherPrimeInfos=f(e,Va,bt.defaultValues(Va))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Il:return 0;case Vl:return new L;case xl:return new L;case Bl:return new L;case Pl:return new L;case Ol:return new L;case Dl:return new L;case Tl:return new L;case Rl:return new L;case Va:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new L({name:t.modulus||b}),new L({name:t.publicExponent||b}),new L({name:t.privateExponent||b}),new L({name:t.prime1||b}),new L({name:t.prime2||b}),new L({name:t.exponent1||b}),new L({name:t.exponent2||b}),new L({name:t.coefficient||b}),new C({optional:!0,value:[new se({name:t.otherPrimeInfosName||b,value:Ms.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){K(e,cS);const t=H(e,e,bt.schema({names:{version:Il,modulus:Vl,publicExponent:xl,privateExponent:Bl,prime1:Pl,prime2:Ol,exponent1:Dl,exponent2:Tl,coefficient:Rl,otherPrimeInfo:{names:{blockName:Va}}}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),Va in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,r=>new Ms({schema:r})))}toSchema(){const e=[];return e.push(new L({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),this.otherPrimeInfos&&e.push(new C({value:Array.from(this.otherPrimeInfos,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={n:pe.ToBase64Url(this.modulus.valueBlock.valueHexView),e:pe.ToBase64Url(this.publicExponent.valueBlock.valueHexView),d:pe.ToBase64Url(this.privateExponent.valueBlock.valueHexView),p:pe.ToBase64Url(this.prime1.valueBlock.valueHexView),q:pe.ToBase64Url(this.prime2.valueBlock.valueHexView),dp:pe.ToBase64Url(this.exponent1.valueBlock.valueHexView),dq:pe.ToBase64Url(this.exponent2.valueBlock.valueHexView),qi:pe.ToBase64Url(this.coefficient.valueBlock.valueHexView)};return this.otherPrimeInfos&&(e.oth=Array.from(this.otherPrimeInfos,t=>t.toJSON())),e}fromJSON(e){he.assert("json",e,"n","e","d","p","q","dp","dq","qi"),this.modulus=new L({valueHex:pe.FromBase64Url(e.n)}),this.publicExponent=new L({valueHex:pe.FromBase64Url(e.e)}),this.privateExponent=new L({valueHex:pe.FromBase64Url(e.d)}),this.prime1=new L({valueHex:pe.FromBase64Url(e.p)}),this.prime2=new L({valueHex:pe.FromBase64Url(e.q)}),this.exponent1=new L({valueHex:pe.FromBase64Url(e.dp)}),this.exponent2=new L({valueHex:pe.FromBase64Url(e.dq)}),this.coefficient=new L({valueHex:pe.FromBase64Url(e.qi)}),e.oth&&(this.otherPrimeInfos=Array.from(e.oth,t=>new Ms({json:t})))}}bt.CLASS_NAME="RSAPrivateKey";const Ll="version",Ul="privateKeyAlgorithm",jl="privateKey",xa="attributes",Ic="parsedKey",hS=[Ll,Ul,jl,xa];class zt extends ${constructor(e={}){super(),this.version=f(e,Ll,zt.defaultValues(Ll)),this.privateKeyAlgorithm=f(e,Ul,zt.defaultValues(Ul)),this.privateKey=f(e,jl,zt.defaultValues(jl)),xa in e&&(this.attributes=f(e,xa,zt.defaultValues(xa))),Ic in e&&(this.parsedKey=f(e,Ic,zt.defaultValues(Ic))),e.json&&this.fromJSON(e.json),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ll:return 0;case Ul:return new R;case jl:return new J;case xa:return[];case Ic:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),R.schema(t.privateKeyAlgorithm||{}),new J({name:t.privateKey||b}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new se({name:t.attributes||b,value:Ae.schema()})]})]})}fromSchema(e){K(e,hS);const t=H(e,e,zt.schema({names:{version:Ll,privateKeyAlgorithm:{names:{blockName:Ul}},privateKey:jl,attributes:xa}}));switch(U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new R({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,xa in t.result&&(this.attributes=Array.from(t.result.attributes,r=>new Ae({schema:r}))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const r=$e(this.privateKey.valueBlock.valueHexView);r.offset!==-1&&(this.parsedKey=new bt({schema:r.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof z){const r=$e(this.privateKey.valueBlock.valueHexView);r.offset!==-1&&(this.parsedKey=new Gt({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:r.result}))}break}}toSchema(){const e=[new L({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return this.attributes&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,t=>t.toSchema())})),new C({value:e})}toJSON(){if(!this.parsedKey){const r={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return this.attributes&&(r.attributes=Array.from(this.attributes,a=>a.toJSON())),r}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA";break}const t=this.parsedKey.toJSON();return Object.assign(e,t),e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new Gt({json:e}),this.privateKeyAlgorithm=new R({algorithmId:"1.2.840.10045.2.1",algorithmParams:new z({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new bt({json:e}),this.privateKeyAlgorithm=new R({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new We});break;default:throw new Error('Invalid value for "kty" parameter: '.concat(e.kty))}this.privateKey=new J({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}zt.CLASS_NAME="PrivateKeyInfo";const ai="contentType",ni="contentEncryptionAlgorithm",Ba="encryptedContent",mS=[ai,ni,Ba],Tp=1024;class Re extends ${constructor(e={}){if(super(),this.contentType=f(e,ai,Re.defaultValues(ai)),this.contentEncryptionAlgorithm=f(e,ni,Re.defaultValues(ni)),Ba in e&&e.encryptedContent&&(this.encryptedContent=e.encryptedContent,this.encryptedContent.idBlock.tagClass===1&&this.encryptedContent.idBlock.tagNumber===4&&this.encryptedContent.idBlock.isConstructed===!1&&!e.disableSplit)){const t=new J({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.encryptedContent.valueBlock.valueHexView.slice().buffer;let n=a.byteLength;for(;n>0;){const o=new Uint8Array(a,r,r+Tp>a.byteLength?a.byteLength-r:Tp),i=new ArrayBuffer(o.length),u=new Uint8Array(i);for(let c=0;c<u.length;c++)u[c]=o[c];t.valueBlock.value.push(new J({valueHex:i})),n-=o.length,r+=o.length}this.encryptedContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ai:return b;case ni:return new R;case Ba:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ai:return t===b;case ni:return t.algorithmId===b&&!("algorithmParams"in t);case Ba:return t.isEqual(Re.defaultValues(Ba));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.contentType||b}),R.schema(t.contentEncryptionAlgorithm||{}),new Ve({value:[new P({name:t.encryptedContent||b,idBlock:{tagClass:3,tagNumber:0},value:[new se({value:new J})]}),new ee({name:t.encryptedContent||b,idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){K(e,mS);const t=H(e,e,Re.schema({names:{contentType:ai,contentEncryptionAlgorithm:{names:{blockName:ni}},encryptedContent:Ba}}));U.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new R({schema:t.result.contentEncryptionAlgorithm}),Ba in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new z({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),this.encryptedContent){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new C({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return this.encryptedContent&&(e.encryptedContent=this.encryptedContent.toJSON()),e}getEncryptedContent(){if(!this.encryptedContent)throw new Error("Parameter 'encryptedContent' is undefined");return J.prototype.getValue.call(this.encryptedContent)}}Re.CLASS_NAME="EncryptedContentInfo";const br="hashAlgorithm",Sr="maskGenAlgorithm",Ar="saltLength",Nr="trailerField",fS=[br,Sr,Ar,Nr];class at extends ${constructor(e={}){super(),this.hashAlgorithm=f(e,br,at.defaultValues(br)),this.maskGenAlgorithm=f(e,Sr,at.defaultValues(Sr)),this.saltLength=f(e,Ar,at.defaultValues(Ar)),this.trailerField=f(e,Nr,at.defaultValues(Nr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case br:return new R({algorithmId:"1.3.14.3.2.26",algorithmParams:new We});case Sr:return new R({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new R({algorithmId:"1.3.14.3.2.26",algorithmParams:new We}).toSchema()});case Ar:return 20;case Nr:return 1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[R.schema(t.hashAlgorithm||{})]}),new P({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[R.schema(t.maskGenAlgorithm||{})]}),new P({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new L({name:t.saltLength||b})]}),new P({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new L({name:t.trailerField||b})]})]})}fromSchema(e){K(e,fS);const t=H(e,e,at.schema({names:{hashAlgorithm:{names:{blockName:br}},maskGenAlgorithm:{names:{blockName:Sr}},saltLength:Ar,trailerField:Nr}}));U.assertSchema(t,this.className),br in t.result&&(this.hashAlgorithm=new R({schema:t.result.hashAlgorithm})),Sr in t.result&&(this.maskGenAlgorithm=new R({schema:t.result.maskGenAlgorithm})),Ar in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),Nr in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(at.defaultValues(br))||e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(at.defaultValues(Sr))||e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==at.defaultValues(Ar)&&e.push(new P({idBlock:{tagClass:3,tagNumber:2},value:[new L({value:this.saltLength})]})),this.trailerField!==at.defaultValues(Nr)&&e.push(new P({idBlock:{tagClass:3,tagNumber:3},value:[new L({value:this.trailerField})]})),new C({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(at.defaultValues(br))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(at.defaultValues(Sr))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==at.defaultValues(Ar)&&(e.saltLength=this.saltLength),this.trailerField!==at.defaultValues(Nr)&&(e.trailerField=this.trailerField),e}}at.CLASS_NAME="RSASSAPSSParams";const ii="salt",$l="iterationCount",rs="keyLength",Ps="prf",dS=[ii,$l,rs,Ps];class gt extends ${constructor(e={}){super(),this.salt=f(e,ii,gt.defaultValues(ii)),this.iterationCount=f(e,$l,gt.defaultValues($l)),rs in e&&(this.keyLength=f(e,rs,gt.defaultValues(rs))),Ps in e&&(this.prf=f(e,Ps,gt.defaultValues(Ps))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ii:return{};case $l:return-1;case rs:return 0;case Ps:return new R({algorithmId:"1.3.14.3.2.26",algorithmParams:new We});default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new Ve({value:[new J({name:t.saltPrimitive||b}),R.schema(t.saltConstructed||{})]}),new L({name:t.iterationCount||b}),new L({name:t.keyLength||b,optional:!0}),R.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){K(e,dS);const t=H(e,e,gt.schema({names:{saltPrimitive:ii,saltConstructed:{names:{blockName:ii}},iterationCount:$l,keyLength:rs,prf:{names:{blockName:Ps,optional:!0}}}}));U.assertSchema(t,this.className),this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,rs in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),Ps in t.result&&(this.prf=new R({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new L({value:this.iterationCount})),rs in this&&gt.defaultValues(rs)!==this.keyLength&&e.push(new L({value:this.keyLength})),this.prf&&gt.defaultValues(Ps).isEqual(this.prf)===!1&&e.push(this.prf.toSchema()),new C({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return rs in this&&gt.defaultValues(rs)!==this.keyLength&&(e.keyLength=this.keyLength),this.prf&&gt.defaultValues(Ps).isEqual(this.prf)===!1&&(e.prf=this.prf.toJSON()),e}}gt.CLASS_NAME="PBKDF2Params";const Kl="keyDerivationFunc",Hl="encryptionScheme",pS=[Kl,Hl];class Tn extends ${constructor(e={}){super(),this.keyDerivationFunc=f(e,Kl,Tn.defaultValues(Kl)),this.encryptionScheme=f(e,Hl,Tn.defaultValues(Hl)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Kl:return new R;case Hl:return new R;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.keyDerivationFunc||{}),R.schema(t.encryptionScheme||{})]})}fromSchema(e){K(e,pS);const t=H(e,e,Tn.schema({names:{keyDerivationFunc:{names:{blockName:Kl}},encryptionScheme:{names:{blockName:Hl}}}}));U.assertSchema(t,this.className),this.keyDerivationFunc=new R({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new R({schema:t.result.encryptionScheme})}toSchema(){return new C({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}Tn.CLASS_NAME="PBES2Params";class gS{constructor(e){this.crypto=e.crypto,this.subtle="webkitSubtle"in e.crypto?e.crypto.webkitSubtle:e.crypto.subtle,this.name=f(e,"name",b)}async encrypt(...e){return this.subtle.encrypt(...e)}async decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}async verify(...e){return this.subtle.verify(...e)}async digest(...e){return this.subtle.digest(...e)}async generateKey(...e){return this.subtle.generateKey(...e)}async deriveKey(...e){return this.subtle.deriveKey(...e)}async deriveBits(...e){return this.subtle.deriveBits(...e)}async wrapKey(...e){return this.subtle.wrapKey(...e)}async unwrapKey(...e){return this.subtle.unwrapKey(...e)}exportKey(...e){return this.subtle.exportKey(...e)}importKey(...e){return this.subtle.importKey(...e)}getRandomValues(e){return this.crypto.getRandomValues(e)}}async function Rp(s,e,t,r,a){let n,o,i;switch(s.toUpperCase()){case"SHA-1":n=20,o=64,i=$1;break;case"SHA-256":n=32,o=64,i=M1;break;case"SHA-384":n=48,o=128,i=db;break;case"SHA-512":n=64,o=128,i=fb;break;default:throw new Error("Unsupported hashing algorithm")}const u=new Uint8Array(t);let c=new TextDecoder().decode(t);new TextEncoder().encode(c).some((S,N)=>S!==u[N])&&(c=String.fromCharCode(...u));const l=new Uint8Array(c.length*2+2),m=new DataView(l.buffer);for(let S=0;S<c.length;S++)m.setUint16(S*2,c.charCodeAt(S),!1);m.setUint16(c.length*2,0,!1);const h=new Uint8Array(o).fill(3),g=new Uint8Array(r),w=new Uint8Array(o*Math.ceil(g.length/o)).map((S,N)=>g[N%g.length]),d=new Uint8Array(o*Math.ceil(l.length/o)).map((S,N)=>l[N%l.length]);let p=new Uint8Array(w.length+d.length);p.set(w),p.set(d,w.length);const E=Math.ceil((e>>3)/n),y=[];for(let S=0;S<E;S++){let N=new Uint8Array(h.length+p.length);N.set(h),N.set(p,h.length);for(let V=0;V<a;V++)N=i(N);const x=new Uint8Array(o).map((V,k)=>N[k%N.length]),I=Math.ceil(g.length/o)+Math.ceil(l.length/o),D=[];for(let V=0;V<I;V++){const k=Array.from(p.slice(V*o,(V+1)*o));let M=511;for(let j=x.length-1;j>=0;j--)M>>=8,M+=x[j]+(k[j]||0),k[j]=M&255;D.push(...k)}p=new Uint8Array(D),y.push(...N)}return new Uint8Array(y.slice(0,e>>3)).buffer}function bw(s){const e=typeof s=="string"?{name:s}:s;return"hash"in e?fs(ct({},e),{hash:bw(e.hash)}):e}class hc extends gS{async importKey(e,t,r,a,n){var o,i,u,c,l,m;let h={};const g=bw(r);switch(e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,a,n);case"spki":{const w=$e(Se.toArrayBuffer(t));U.assert(w,"keyData");const d=new xt;try{d.fromSchema(w.result)}catch(p){throw new ge("Incorrect keyData")}switch(g.name.toUpperCase()){case"RSA-PSS":{if(!g.hash)throw new he("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="PS1";break;case"SHA-256":h.alg="PS256";break;case"SHA-384":h.alg="PS384";break;case"SHA-512":h.alg="PS512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}case"RSASSA-PKCS1-V1_5":{if(n=["verify"],h.kty="RSA",h.ext=a,h.key_ops=n,d.algorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error("Incorrect public key algorithm: ".concat(d.algorithm.algorithmId));if(!h.alg){if(!g.hash)throw new he("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="RS1";break;case"SHA-256":h.alg="RS256";break;case"SHA-384":h.alg="RS384";break;case"SHA-512":h.alg="RS512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}const p=d.toJSON();Object.assign(h,p)}break;case"ECDSA":n=["verify"];case"ECDH":{if(h={kty:"EC",ext:a,key_ops:n},d.algorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error("Incorrect public key algorithm: ".concat(d.algorithm.algorithmId));const p=d.toJSON();Object.assign(h,p)}break;case"RSA-OAEP":{if(h.kty="RSA",h.ext=a,h.key_ops=n,this.name.toLowerCase()==="safari")h.alg="RSA-OAEP";else{if(!g.hash)throw new he("hash","algorithm.hash","Incorrect hash algorithm: Hash algorithm is missed");switch(g.hash.name.toUpperCase()){case"SHA-1":h.alg="RSA-OAEP";break;case"SHA-256":h.alg="RSA-OAEP-256";break;case"SHA-384":h.alg="RSA-OAEP-384";break;case"SHA-512":h.alg="RSA-OAEP-512";break;default:throw new Error("Incorrect hash algorithm: ".concat(g.hash.name.toUpperCase()))}}const p=d.toJSON();Object.assign(h,p)}break;case"RSAES-PKCS1-V1_5":{h.kty="RSA",h.ext=a,h.key_ops=n,h.alg="PS1";const p=d.toJSON();Object.assign(h,p)}break;default:throw new Error("Incorrect algorithm name: ".concat(g.name.toUpperCase()))}}break;case"pkcs8":{const w=new zt,d=$e(Se.toArrayBuffer(t));U.assert(d,"keyData");try{w.fromSchema(d.result)}catch(p){throw new Error("Incorrect keyData")}if(!w.parsedKey)throw new Error("Incorrect keyData");switch(g.name.toUpperCase()){case"RSA-PSS":switch((o=g.hash)===null||o===void 0?void 0:o.name.toUpperCase()){case"SHA-1":h.alg="PS1";break;case"SHA-256":h.alg="PS256";break;case"SHA-384":h.alg="PS384";break;case"SHA-512":h.alg="PS512";break;default:throw new Error("Incorrect hash algorithm: ".concat((i=g.hash)===null||i===void 0?void 0:i.name.toUpperCase()))}case"RSASSA-PKCS1-V1_5":{if(n=["sign"],h.kty="RSA",h.ext=a,h.key_ops=n,w.privateKeyAlgorithm.algorithmId!=="1.2.840.113549.1.1.1")throw new Error("Incorrect private key algorithm: ".concat(w.privateKeyAlgorithm.algorithmId));if(!("alg"in h))switch((u=g.hash)===null||u===void 0?void 0:u.name.toUpperCase()){case"SHA-1":h.alg="RS1";break;case"SHA-256":h.alg="RS256";break;case"SHA-384":h.alg="RS384";break;case"SHA-512":h.alg="RS512";break;default:throw new Error("Incorrect hash algorithm: ".concat((c=g.hash)===null||c===void 0?void 0:c.name.toUpperCase()))}const p=w.toJSON();Object.assign(h,p)}break;case"ECDSA":n=["sign"];case"ECDH":{if(h={kty:"EC",ext:a,key_ops:n},w.privateKeyAlgorithm.algorithmId!=="1.2.840.10045.2.1")throw new Error("Incorrect algorithm: ".concat(w.privateKeyAlgorithm.algorithmId));const p=w.toJSON();Object.assign(h,p)}break;case"RSA-OAEP":{if(h.kty="RSA",h.ext=a,h.key_ops=n,this.name.toLowerCase()==="safari")h.alg="RSA-OAEP";else switch((l=g.hash)===null||l===void 0?void 0:l.name.toUpperCase()){case"SHA-1":h.alg="RSA-OAEP";break;case"SHA-256":h.alg="RSA-OAEP-256";break;case"SHA-384":h.alg="RSA-OAEP-384";break;case"SHA-512":h.alg="RSA-OAEP-512";break;default:throw new Error("Incorrect hash algorithm: ".concat((m=g.hash)===null||m===void 0?void 0:m.name.toUpperCase()))}const p=w.toJSON();Object.assign(h,p)}break;case"RSAES-PKCS1-V1_5":{n=["decrypt"],h.kty="RSA",h.ext=a,h.key_ops=n,h.alg="PS1";const p=w.toJSON();Object.assign(h,p)}break;default:throw new Error("Incorrect algorithm name: ".concat(g.name.toUpperCase()))}}break;case"jwk":h=t;break;default:throw new Error("Incorrect format: ".concat(e))}if(this.name.toLowerCase()==="safari")try{return this.subtle.importKey("jwk",Vo(JSON.stringify(h)),r,a,n)}catch(w){return this.subtle.importKey("jwk",h,r,a,n)}return this.subtle.importKey("jwk",h,r,a,n)}async exportKey(e,t){let r=await this.subtle.exportKey("jwk",t);switch(this.name.toLowerCase()==="safari"&&r instanceof ArrayBuffer&&(r=JSON.parse(xh(r))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":{const a=new xt;try{a.fromJSON(r)}catch(n){throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"pkcs8":{const a=new zt;try{a.fromJSON(r)}catch(n){throw new Error("Incorrect key data")}return a.toSchema().toBER(!1)}case"jwk":return r;default:throw new Error("Incorrect format: ".concat(e))}}async convert(e,t,r,a,n,o){if(e.toLowerCase()===t.toLowerCase())return r;const i=await this.importKey(e,r,a,n,o);return this.exportKey(t,i)}getAlgorithmByOID(e,t=!1,r){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}if(t)throw new Error("Unsupported algorithm identifier ".concat(r?"for ".concat(r," "):b,": ").concat(e));return{}}getOIDByAlgorithm(e,t=!1,r){let a=b;switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":a="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.1.1.5";break;case"SHA-256":a="1.2.840.113549.1.1.11";break;case"SHA-384":a="1.2.840.113549.1.1.12";break;case"SHA-512":a="1.2.840.113549.1.1.13";break}break;case"RSA-PSS":a="1.2.840.113549.1.1.10";break;case"RSA-OAEP":a="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.10045.4.1";break;case"SHA-256":a="1.2.840.10045.4.3.2";break;case"SHA-384":a="1.2.840.10045.4.3.3";break;case"SHA-512":a="1.2.840.10045.4.3.4";break}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":a="1.3.133.16.840.63.0.2";break;case"SHA-256":a="1.3.132.1.11.1";break;case"SHA-384":a="1.3.132.1.11.2";break;case"SHA-512":a="1.3.132.1.11.3";break}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.2";break;case 192:a="2.16.840.1.101.3.4.1.22";break;case 256:a="2.16.840.1.101.3.4.1.42";break}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.6";break;case 192:a="2.16.840.1.101.3.4.1.26";break;case 256:a="2.16.840.1.101.3.4.1.46";break}break;case"AES-CFB":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.4";break;case 192:a="2.16.840.1.101.3.4.1.24";break;case 256:a="2.16.840.1.101.3.4.1.44";break}break;case"AES-KW":switch(e.length){case 128:a="2.16.840.1.101.3.4.1.5";break;case 192:a="2.16.840.1.101.3.4.1.25";break;case 256:a="2.16.840.1.101.3.4.1.45";break}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":a="1.2.840.113549.2.7";break;case"SHA-256":a="1.2.840.113549.2.9";break;case"SHA-384":a="1.2.840.113549.2.10";break;case"SHA-512":a="1.2.840.113549.2.11";break}break;case"DH":a="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":a="1.3.14.3.2.26";break;case"SHA-256":a="2.16.840.1.101.3.4.2.1";break;case"SHA-384":a="2.16.840.1.101.3.4.2.2";break;case"SHA-512":a="2.16.840.1.101.3.4.2.3";break;case"CONCAT":break;case"HKDF":break;case"PBKDF2":a="1.2.840.113549.1.5.12";break;case"P-256":a="1.2.840.10045.3.1.7";break;case"P-384":a="1.3.132.0.34";break;case"P-521":a="1.3.132.0.35";break}if(!a&&t)throw new Error("Unsupported algorithm ".concat(r?"for ".concat(r," "):b,": ").concat(e.name));return a}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}break}return r}getHashAlgorithm(e){let t=b;switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new at({schema:e.algorithmParams});if(r.hashAlgorithm){const a=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in a)t=a.name;else return b}else t="SHA-1"}catch(r){}break}return t}async encryptEncryptedContentInfo(e){he.assert(e,"password","contentEncryptionAlgorithm","hmacHashAlgorithm","iterationCount","contentToEncrypt","contentToEncrypt","contentType");const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm,!0,"contentEncryptionAlgorithm"),r=this.getOIDByAlgorithm({name:"PBKDF2"},!0,"PBKDF2"),a=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),n=new ArrayBuffer(16),o=new Uint8Array(n);this.getRandomValues(o);const i=new ArrayBuffer(64),u=new Uint8Array(i);this.getRandomValues(u);const c=new Uint8Array(e.contentToEncrypt),l=new gt({salt:new J({valueHex:i}),iterationCount:e.iterationCount,prf:new R({algorithmId:a,algorithmParams:new We})}),m=new Uint8Array(e.password),h=await this.importKey("raw",m,"PBKDF2",!1,["deriveKey"]),g=await this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:u,iterations:e.iterationCount},h,e.contentEncryptionAlgorithm,!1,["encrypt"]),w=await this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:o},g,c),d=new Tn({keyDerivationFunc:new R({algorithmId:r,algorithmParams:l.toSchema()}),encryptionScheme:new R({algorithmId:t,algorithmParams:new J({valueHex:n})})});return new Re({contentType:e.contentType,contentEncryptionAlgorithm:new R({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:d.toSchema()}),encryptedContent:new J({valueHex:w})})}async decryptEncryptedContentInfo(e){if(he.assert(e,"password","encryptedContentInfo"),e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId!=="1.2.840.113549.1.5.13")throw new Error('Unknown "contentEncryptionAlgorithm": '.concat(e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId));let t;try{t=new Tn({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(w){throw new Error('Incorrectly encoded "pbes2Parameters"')}let r;try{r=new gt({schema:t.keyDerivationFunc.algorithmParams})}catch(w){throw new Error('Incorrectly encoded "pbkdf2Params"')}const a=this.getAlgorithmByOID(t.encryptionScheme.algorithmId,!0),n=t.encryptionScheme.algorithmParams.valueBlock.valueHex,o=new Uint8Array(n),i=r.salt.valueBlock.valueHex,u=new Uint8Array(i),c=r.iterationCount;let l="SHA-1";r.prf&&(l=this.getAlgorithmByOID(r.prf.algorithmId,!0).hash.name);const m=await this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"]),h=await this.deriveKey({name:"PBKDF2",hash:{name:l},salt:u,iterations:c},m,a,!1,["decrypt"]),g=e.encryptedContentInfo.getEncryptedContent();return this.decrypt({name:a.name,iv:o},h,g)}async stampDataWithPassword(e){if(!(e instanceof Object))throw new Error('Parameters must have type "Object"');he.assert(e,"password","hashAlgorithm","iterationCount","salt","contentToStamp");let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error('Incorrect "parameters.hashAlgorithm" parameter: '.concat(e.hashAlgorithm))}const r={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await Rp(e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),n=await this.importKey("raw",new Uint8Array(a),r,!1,["sign"]);return this.sign(r,n,new Uint8Array(e.contentToStamp))}async verifyDataStampedWithPassword(e){he.assert(e,"password","hashAlgorithm","salt","iterationCount","contentToVerify","signatureToVerify");let t=0;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:throw new Error('Incorrect "parameters.hashAlgorithm" parameter: '.concat(e.hashAlgorithm))}const r={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}},a=await Rp(e.hashAlgorithm,t,e.password,e.salt,e.iterationCount),n=await this.importKey("raw",new Uint8Array(a),r,!1,["verify"]);return this.verify(r,n,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))}async getSignatureParameters(e,t="SHA-1"){this.getOIDByAlgorithm({name:t},!0,"hashAlgorithm");const r=new R,a=this.getAlgorithmParameters(e.algorithm.name,"sign");if(!Object.keys(a.algorithm).length)throw new Error("Parameter 'algorithm' is empty");const n=a.algorithm;switch("hash"in e.algorithm&&e.algorithm.hash&&e.algorithm.hash.name?n.hash.name=e.algorithm.hash.name:n.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(n,!0);break;case"RSA-PSS":{switch(n.hash.name.toUpperCase()){case"SHA-256":n.saltLength=32;break;case"SHA-384":n.saltLength=48;break;case"SHA-512":n.saltLength=64;break}const o={};if(n.hash.name.toUpperCase()!=="SHA-1"){const u=this.getOIDByAlgorithm({name:n.hash.name},!0,"hashAlgorithm");o.hashAlgorithm=new R({algorithmId:u,algorithmParams:new We}),o.maskGenAlgorithm=new R({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:o.hashAlgorithm.toSchema()})}n.saltLength!==20&&(o.saltLength=n.saltLength);const i=new at(o);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=i.toSchema()}break;default:throw new Error("Unsupported signature algorithm: ".concat(e.algorithm.name))}return{signatureAlgorithm:r,parameters:a}}async signWithPrivateKey(e,t,r){const a=await this.sign(r.algorithm,t,e);return r.algorithm.name==="ECDSA"?yS(a):a}fillPublicKeyParameters(e,t){const r={},a=this.getHashAlgorithm(t);if(a===b)throw new Error("Unsupported signature algorithm: ".concat(t.algorithmId));let n;t.algorithmId==="1.2.840.113549.1.1.10"?n=t.algorithmId:n=e.algorithm.algorithmId;const o=this.getAlgorithmByOID(n,!0);if(r.algorithm=this.getAlgorithmParameters(o.name,"importKey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=a),o.name==="ECDSA"){const i=e.algorithm;if(!i.algorithmParams)throw new Error("Algorithm parameters for ECDSA public key are missed");const u=i.algorithmParams;if("idBlock"in i.algorithmParams&&!(u.idBlock.tagClass===1&&u.idBlock.tagNumber===6))throw new Error("Incorrect type for ECDSA public key parameters");const c=this.getAlgorithmByOID(u.valueBlock.toString(),!0);r.algorithm.algorithm.namedCurve=c.name}return r}async getPublicKey(e,t,r){r||(r=this.fillPublicKeyParameters(e,t));const a=e.toSchema().toBER(!1);return this.importKey("spki",a,r.algorithm.algorithm,!0,r.algorithm.usages)}async verifyWithPublicKey(e,t,r,a,n){let o;if(n){const c={};let l;a.algorithmId==="1.2.840.113549.1.1.10"?l=a.algorithmId:l=r.algorithm.algorithmId;const m=this.getAlgorithmByOID(l,!0);if(c.algorithm=this.getAlgorithmParameters(m.name,"importKey"),"hash"in c.algorithm.algorithm&&(c.algorithm.algorithm.hash.name=n),m.name==="ECDSA"){let h=!1;if("algorithmParams"in r.algorithm&&"idBlock"in r.algorithm.algorithmParams&&r.algorithm.algorithmParams.idBlock.tagClass===1&&r.algorithm.algorithmParams.idBlock.tagNumber===6&&(h=!0),h===!1)throw new Error("Incorrect type for ECDSA public key parameters");const g=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString(),!0);c.algorithm.algorithm.namedCurve=g.name}o=await this.getPublicKey(r,null,c)}else{if(n=this.getHashAlgorithm(a),!n)throw new Error("Unsupported signature algorithm: ".concat(a.algorithmId));o=await this.getPublicKey(r,a)}const i=this.getAlgorithmParameters(o.algorithm.name,"verify");"hash"in i.algorithm&&(i.algorithm.hash.name=n);let u=t.valueBlock.valueHexView;if(o.algorithm.name==="ECDSA"){const c=oa.find(o.algorithm.namedCurve);if(!c)throw new Error("Unsupported named curve in use");const l=$e(u);U.assert(l,"Signature value"),u=vS(l.result,c.size)}if(o.algorithm.name==="RSA-PSS"){const c=new at({schema:a.algorithmParams});"saltLength"in c?i.algorithm.saltLength=c.saltLength:i.algorithm.saltLength=20;let l="SHA-1";"hashAlgorithm"in c&&(l=this.getAlgorithmByOID(c.hashAlgorithm.algorithmId,!0).name),i.algorithm.hash.name=l}return this.verify(i.algorithm,o,u,e)}}let Sw={name:"none",crypto:null};function Lp(s){return!!(s&&typeof s=="object"&&"crypto"in s)}function Up(s,...e){let t=null;if(e.length<2)e.length?t=e[0]:t=typeof self<"u"&&self.crypto?new hc({name:"browser",crypto:self.crypto}):null;else{const r=e[0],a=e[1];Lp(a)?t=a:Lp(r)?t=r:"subtle"in r&&"getRandomValues"in r&&(t=new hc({crypto:r}))}if(typeof ze<"u"&&"pid"in ze&&typeof Tt<"u"&&typeof window>"u"){if(typeof Tt[ze.pid]>"u")Tt[ze.pid]={};else if(typeof Tt[ze.pid]!="object")throw new Error("Name global.".concat(ze.pid," already exists and it is not an object"));if(typeof Tt[ze.pid].pkijs>"u")Tt[ze.pid].pkijs={};else if(typeof Tt[ze.pid].pkijs!="object")throw new Error("Name global.".concat(ze.pid,".pkijs already exists and it is not an object"));Tt[ze.pid].pkijs.engine={name:s,crypto:t}}else Sw={name:s,crypto:t}}function wS(){if(typeof ze<"u"&&"pid"in ze&&typeof Tt<"u"&&typeof window>"u"){let s;try{s=Tt[ze.pid].pkijs.engine}catch(e){throw new Error("Please call 'setEngine' before call to 'getEngine'")}return s}return Sw}function ne(s=!1){const e=wS();if(!e.crypto&&s)throw new Error("Unable to create WebCrypto object");return e.crypto}function yS(s){if(s.byteLength%2!==0)return Ke;const e=s.byteLength/2,t=new ArrayBuffer(e);new Uint8Array(t).set(new Uint8Array(s,0,e));const r=new L({valueHex:t}),a=new ArrayBuffer(e);new Uint8Array(a).set(new Uint8Array(s,e,e));const n=new L({valueHex:a});return new C({value:[r.convertToDER(),n.convertToDER()]}).toBER(!1)}function vS(s,e){if(!(s instanceof C&&s.valueBlock.value.length===2&&s.valueBlock.value[0]instanceof L&&s.valueBlock.value[1]instanceof L))return Ke;const t=s.valueBlock.value[0].convertFromDER().valueBlock.valueHexView,r=s.valueBlock.value[1].convertFromDER().valueBlock.valueHexView,a=new Uint8Array(e*2);return a.set(t,e-t.byteLength),a.set(r,2*e-r.byteLength),a.buffer}async function bS(s,e,t,r,a){switch(s.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;default:throw new ge("Unknown hash function: ".concat(s))}if(ge.assert(e,"zBuffer","ArrayBuffer"),e.byteLength===0)throw new ge("'zBuffer' has zero length, error");if(ge.assert(r,"SharedInfo","ArrayBuffer"),t>255)throw new ge("Please set 'Counter' argument to value less or equal to 255");const n=new ArrayBuffer(4),o=new Uint8Array(n);o[0]=0,o[1]=0,o[2]=0,o[3]=t;let i=Ke;i=So(i,e),i=So(i,n),i=So(i,r);const u=await a.digest({name:s},i);return{counter:t,result:u}}async function jp(s,e,t,r,a=ne(!0)){let n=0,o=1;switch(s.toUpperCase()){case"SHA-1":n=160;break;case"SHA-256":n=256;break;case"SHA-384":n=384;break;case"SHA-512":n=512;break;default:throw new ge("Unknown hash function: ".concat(s))}if(ge.assert(e,"Zbuffer","ArrayBuffer"),e.byteLength===0)throw new ge("'Zbuffer' has zero length, error");ge.assert(r,"SharedInfo","ArrayBuffer");const i=t/n;Math.floor(i)>0&&(o=Math.floor(i),i-o>0&&o++);const u=[];for(let h=1;h<=o;h++)u.push(await bS(s,e,h,r,a));let c=Ke,l=1,m=!0;for(;m;){m=!1;for(const h of u)if(h.counter===l){c=So(c,h.result),m=!0;break}l++}if(t>>=3,c.byteLength>t){const h=new ArrayBuffer(t),g=new Uint8Array(h),w=new Uint8Array(c);for(let d=0;d<t;d++)g[d]=w[d];return h}return c}const Rm="version",Lm="logID",Um="extensions",jm="timestamp",$m="hashAlgorithm",Km="signatureAlgorithm",Hm="signature",$p="none",Kp="md5",Hp="sha1",Mp="sha224",Fp="sha256",Jp="sha384",qp="sha512",Wp="anonymous",_p="rsa",Gp="dsa",Xp="ecdsa";class gs extends ${constructor(e={}){super(),this.version=f(e,Rm,gs.defaultValues(Rm)),this.logID=f(e,Lm,gs.defaultValues(Lm)),this.timestamp=f(e,jm,gs.defaultValues(jm)),this.extensions=f(e,Um,gs.defaultValues(Um)),this.hashAlgorithm=f(e,$m,gs.defaultValues($m)),this.signatureAlgorithm=f(e,Km,gs.defaultValues(Km)),this.signature=f(e,Hm,gs.defaultValues(Hm)),"stream"in e&&e.stream&&this.fromStream(e.stream),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Rm:return 0;case Lm:case Um:return Ke;case jm:return new Date(0);case $m:case Km:return b;case Hm:return new te;default:return super.defaultValues(e)}}fromSchema(e){if(!(e instanceof Bh))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new ia({stream:new Ie({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],this.version===0){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(Zw(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm=$p;break;case 1:this.hashAlgorithm=Kp;break;case 2:this.hashAlgorithm=Hp;break;case 3:this.hashAlgorithm=Mp;break;case 4:this.hashAlgorithm=Fp;break;case 5:this.hashAlgorithm=Jp;break;case 6:this.hashAlgorithm=qp;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm=Wp;break;case 1:this.signatureAlgorithm=_p;break;case 2:this.signatureAlgorithm=Gp;break;case 3:this.signatureAlgorithm=Xp;break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const a=e.getUint16(),n=new Uint8Array(e.getBlock(a)).buffer.slice(0),o=$e(n);if(U.assert(o,"SignedCertificateTimestamp"),this.signature=o.result,t!==47+r+a)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Bh({data:e.stream.buffer})}toStream(){const e=new ia;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecodeView.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),a=$d(this.timestamp.valueOf(),8);r.set(new Uint8Array(a),8-a.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions));let n;switch(this.hashAlgorithm.toLowerCase()){case $p:n=0;break;case Kp:n=1;break;case Hp:n=2;break;case Mp:n=3;break;case Fp:n=4;break;case Jp:n=5;break;case qp:n=6;break;default:throw new Error("Incorrect data for hashAlgorithm: ".concat(this.hashAlgorithm))}e.appendChar(n);let o;switch(this.signatureAlgorithm.toLowerCase()){case Wp:o=0;break;case _p:o=1;break;case Gp:o=2;break;case Xp:o=3;break;default:throw new Error("Incorrect data for signatureAlgorithm: ".concat(this.signatureAlgorithm))}e.appendChar(o);const i=this.signature.toBER(!1);return e.appendUint16(i.byteLength),e.appendView(new Uint8Array(i)),e}toJSON(){return{version:this.version,logID:Kd(this.logID),timestamp:this.timestamp,extensions:Kd(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,r=0,a=ne(!0)){const n=ff(xh(this.logID));let o=null;const i=new ia;for(const g of e)if(g.log_id===n){o=g.key;break}if(!o)throw new Error("Public key not found for CT with logId: ".concat(n));const u=Vo(ac(o)),c=xt.fromBER(u);i.appendChar(0),i.appendChar(0);const l=new ArrayBuffer(8),m=new Uint8Array(l),h=$d(this.timestamp.valueOf(),8);return m.set(new Uint8Array(h),8-h.byteLength),i.appendView(m),i.appendUint16(r),r===0&&i.appendUint24(t.byteLength),i.appendView(new Uint8Array(t)),i.appendUint16(this.extensions.byteLength),this.extensions.byteLength!==0&&i.appendView(new Uint8Array(this.extensions)),a.verifyWithPublicKey(i.buffer.slice(0,i.length),new J({valueHex:this.signature.toBER(!1)}),c,{algorithmId:b},"SHA-256")}}gs.CLASS_NAME="SignedCertificateTimestamp";const Vc="timestamps";class rm extends ${constructor(e={}){super(),this.timestamps=f(e,Vc,rm.defaultValues(Vc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vc:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Vc:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){var t;const r=f(e,"names",{});return(t=r.optional)!==null&&t!==void 0||(r.optional=!1),new J({name:r.blockName||"SignedCertificateTimestampList",optional:r.optional})}fromSchema(e){if(!(e instanceof J))throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new ia({stream:new Ie({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new gs({stream:t}))}toSchema(){const e=new ia;let t=0;const r=[];for(const a of this.timestamps){const n=a.toStream();r.push(n),t+=n.stream.buffer.byteLength}e.appendUint16(t);for(const a of r)e.appendView(a.stream.view);return new J({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,e=>e.toJSON())}}}rm.CLASS_NAME="SignedCertificateTimestampList";const Ml="attributes",SS=[Ml];class mc extends ${constructor(e={}){super(),this.attributes=f(e,Ml,mc.defaultValues(Ml)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ml:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.attributes||b,value:Ae.schema()})]})}fromSchema(e){K(e,SS);const t=H(e,e,mc.schema({names:{attributes:Ml}}));U.assertSchema(t,this.className),this.attributes=Array.from(t.result.attributes,r=>new Ae({schema:r}))}toSchema(){return new C({value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){return{attributes:Array.from(this.attributes,e=>e.toJSON())}}}mc.CLASS_NAME="SubjectDirectoryAttributes";class ke{static getItems(){return this.types||(this.types={},ke.register(nw,"SubjectAltName",Bo),ke.register(iw,"IssuerAltName",Bo),ke.register(wd,"AuthorityKeyIdentifier",ta),ke.register(pd,"BasicConstraints",Vn),ke.register(Ub,"MicrosoftCaVersion",oc),ke.register(hw,"CertificatePolicies",Po),ke.register(Pb,"CertificatePoliciesMicrosoft",Po),ke.register(Lb,"MicrosoftCertTemplateV2",vo),ke.register(cw,"CRLDistributionPoints",Oo),ke.register(gd,"FreshestCRL",Oo),ke.register(Ob,"ExtKeyUsage",lc),ke.register(lw,"CertificateIssuer",Ge),ke.register(yd,"AuthorityInfoAccess",Do),ke.register(Tb,"SubjectInfoAccess",Do),ke.register(ow,"IssuingDistributionPoint",st),ke.register(uw,"NameConstraints",No),ke.register(fw,"PolicyConstraints",ko),ke.register(mw,"PolicyMappings",uc),ke.register(Cb,"PrivateKeyUsagePeriod",Eo),ke.register(jb,"QCStatements",cc),ke.register(Rb,"SignedCertificateTimestampList",rm),ke.register(Nb,"SubjectDirectoryAttributes",mc)),this.types}static fromBER(e,t){const r=$e(t);if(r.offset===-1)return null;const a=this.find(e);if(a)try{return new a.type({schema:r.result})}catch(n){const o=new a.type;return o.parsingError="Incorrectly formatted value of extension ".concat(a.name," (").concat(e,")"),o}return r.result}static find(e){return this.getItems()[e]||null}static register(e,t,r){this.getItems()[e]={name:t,type:r}}}const Fl="extnID",kr="critical",Jl="extnValue",xc="parsedValue",AS=[Fl,kr,Jl];class Le extends ${get parsedValue(){if(this._parsedValue===void 0){const e=ke.fromBER(this.extnID,this.extnValue.valueBlock.valueHexView);this._parsedValue=e}return this._parsedValue||void 0}set parsedValue(e){this._parsedValue=e}constructor(e={}){super(),this.extnID=f(e,Fl,Le.defaultValues(Fl)),this.critical=f(e,kr,Le.defaultValues(kr)),Jl in e?this.extnValue=new J({valueHex:e.extnValue}):this.extnValue=Le.defaultValues(Jl),xc in e&&(this.parsedValue=f(e,xc,Le.defaultValues(xc))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fl:return b;case kr:return!1;case Jl:return new J;case xc:return{};default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.extnID||b}),new ha({name:t.critical||b,optional:!0}),new J({name:t.extnValue||b})]})}fromSchema(e){K(e,AS);const t=H(e,e,Le.schema({names:{extnID:Fl,critical:kr,extnValue:Jl}}));U.assertSchema(t,this.className),this.extnID=t.result.extnID.valueBlock.toString(),kr in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue}toSchema(){const e=[];return e.push(new z({value:this.extnID})),this.critical!==Le.defaultValues(kr)&&e.push(new ha({value:this.critical})),e.push(this.extnValue),new C({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==Le.defaultValues(kr)&&(e.critical=this.critical),this.parsedValue&&this.parsedValue.toJSON&&(e.parsedValue=this.parsedValue.toJSON()),e}}Le.CLASS_NAME="Extension";const ql="extensions",NS=[ql];class He extends ${constructor(e={}){super(),this.extensions=f(e,ql,He.defaultValues(ql)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ql:return[];default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=f(e,"names",{});return new C({optional:t,name:r.blockName||b,value:[new se({name:r.extensions||b,value:Le.schema(r.extension||{})})]})}fromSchema(e){K(e,NS);const t=H(e,e,He.schema({names:{extensions:ql}}));U.assertSchema(t,this.className),this.extensions=Array.from(t.result.extensions,r=>new Le({schema:r}))}toSchema(){return new C({value:Array.from(this.extensions,e=>e.toSchema())})}toJSON(){return{extensions:this.extensions.map(e=>e.toJSON())}}}He.CLASS_NAME="Extensions";const Wl="issuer",_l="serialNumber",Pa="issuerUID",kS=[Wl,_l,Pa];class Vt extends ${constructor(e={}){super(),this.issuer=f(e,Wl,Vt.defaultValues(Wl)),this.serialNumber=f(e,_l,Vt.defaultValues(_l)),Pa in e&&(this.issuerUID=f(e,Pa,Vt.defaultValues(Pa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Wl:return new Ge;case _l:return new L;case Pa:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[Ge.schema(t.issuer||{}),new L({name:t.serialNumber||b}),new ce({optional:!0,name:t.issuerUID||b})]})}fromSchema(e){K(e,kS);const t=H(e,e,Vt.schema({names:{issuer:{names:{blockName:Wl}},serialNumber:_l,issuerUID:Pa}}));U.assertSchema(t,this.className),this.issuer=new Ge({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber,Pa in t.result&&(this.issuerUID=t.result.issuerUID)}toSchema(){const e=new C({value:[this.issuer.toSchema(),this.serialNumber]});return this.issuerUID&&e.valueBlock.value.push(this.issuerUID),e}toJSON(){const e={issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()};return this.issuerUID&&(e.issuerUID=this.issuerUID.toJSON()),e}}Vt.CLASS_NAME="IssuerSerial";const Gl="version",Oa="baseCertificateID",Da="subjectName",Xl="issuer",zl="signature",Yl="serialNumber",Zl="attrCertValidityPeriod",Ql="attributes",Ta="issuerUniqueID",Ra="extensions",ES=[Gl,Oa,Da,Xl,zl,Yl,Zl,Ql,Ta,Ra];class dt extends ${constructor(e={}){super(),this.version=f(e,Gl,dt.defaultValues(Gl)),Oa in e&&(this.baseCertificateID=f(e,Oa,dt.defaultValues(Oa))),Da in e&&(this.subjectName=f(e,Da,dt.defaultValues(Da))),this.issuer=f(e,Xl,dt.defaultValues(Xl)),this.signature=f(e,zl,dt.defaultValues(zl)),this.serialNumber=f(e,Yl,dt.defaultValues(Yl)),this.attrCertValidityPeriod=f(e,Zl,dt.defaultValues(Zl)),this.attributes=f(e,Ql,dt.defaultValues(Ql)),Ta in e&&(this.issuerUniqueID=f(e,Ta,dt.defaultValues(Ta))),Ra in e&&(this.extensions=f(e,Ra,dt.defaultValues(Ra))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gl:return 0;case Oa:return new Vt;case Da:return new Ge;case Xl:return new Ge;case zl:return new R;case Yl:return new L;case Zl:return new cs;case Ql:return[];case Ta:return new ce;case Ra:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new Ve({value:[new P({name:t.baseCertificateID||b,idBlock:{tagClass:3,tagNumber:0},value:Vt.schema().valueBlock.value}),new P({name:t.subjectName||b,idBlock:{tagClass:3,tagNumber:1},value:Ge.schema().valueBlock.value})]}),Ge.schema({names:{blockName:t.issuer||b}}),R.schema(t.signature||{}),new L({name:t.serialNumber||b}),cs.schema(t.attrCertValidityPeriod||{}),new C({name:t.attributes||b,value:[new se({value:Ae.schema()})]}),new ce({optional:!0,name:t.issuerUniqueID||b}),He.schema(t.extensions||{},!0)]})}fromSchema(e){K(e,ES);const t=H(e,e,dt.schema({names:{version:Gl,baseCertificateID:Oa,subjectName:Da,issuer:Xl,signature:{names:{blockName:zl}},serialNumber:Yl,attrCertValidityPeriod:{names:{blockName:Zl}},attributes:Ql,issuerUniqueID:Ta,extensions:{names:{blockName:Ra}}}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Oa in t.result&&(this.baseCertificateID=new Vt({schema:new C({value:t.result.baseCertificateID.valueBlock.value})})),Da in t.result&&(this.subjectName=new Ge({schema:new C({value:t.result.subjectName.valueBlock.value})})),this.issuer=t.result.issuer,this.signature=new R({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new cs({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new Ae({schema:r})),Ta in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Ra in t.result&&(this.extensions=new He({schema:t.result.extensions}))}toSchema(){const e=new C({value:[new L({value:this.version})]});return this.baseCertificateID&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.subjectName&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:1},value:this.subjectName.toSchema().valueBlock.value})),e.valueBlock.value.push(this.issuer.toSchema()),e.valueBlock.value.push(this.signature.toSchema()),e.valueBlock.value.push(this.serialNumber),e.valueBlock.value.push(this.attrCertValidityPeriod.toSchema()),e.valueBlock.value.push(new C({value:Array.from(this.attributes,t=>t.toSchema())})),this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.subjectName&&(e.subjectName=this.subjectName.toJSON()),e.issuer=this.issuer.toJSON(),e.signature=this.signature.toJSON(),e.serialNumber=this.serialNumber.toJSON(),e.attrCertValidityPeriod=this.attrCertValidityPeriod.toJSON(),e.attributes=Array.from(this.attributes,t=>t.toJSON()),this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}dt.CLASS_NAME="AttributeCertificateInfoV1";const eu="acinfo",tu="signatureAlgorithm",su="signatureValue",CS=[eu,su,tu];class Fs extends ${constructor(e={}){super(),this.acinfo=f(e,eu,Fs.defaultValues(eu)),this.signatureAlgorithm=f(e,tu,Fs.defaultValues(tu)),this.signatureValue=f(e,su,Fs.defaultValues(su)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case eu:return new dt;case tu:return new R;case su:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[dt.schema(t.acinfo||{}),R.schema(t.signatureAlgorithm||{}),new ce({name:t.signatureValue||b})]})}fromSchema(e){K(e,CS);const t=H(e,e,Fs.schema({names:{acinfo:{names:{blockName:eu}},signatureAlgorithm:{names:{blockName:tu}},signatureValue:su}}));U.assertSchema(t,this.className),this.acinfo=new dt({schema:t.result.acinfo}),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new C({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Fs.CLASS_NAME="AttributeCertificateV1";const ru="digestedObjectType",La="otherObjectTypeID",au="digestAlgorithm",nu="objectDigest",IS=[ru,La,au,nu];class Mt extends ${constructor(e={}){super(),this.digestedObjectType=f(e,ru,Mt.defaultValues(ru)),La in e&&(this.otherObjectTypeID=f(e,La,Mt.defaultValues(La))),this.digestAlgorithm=f(e,au,Mt.defaultValues(au)),this.objectDigest=f(e,nu,Mt.defaultValues(nu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ru:return new nc;case La:return new z;case au:return new R;case nu:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new nc({name:t.digestedObjectType||b}),new z({optional:!0,name:t.otherObjectTypeID||b}),R.schema(t.digestAlgorithm||{}),new ce({name:t.objectDigest||b})]})}fromSchema(e){K(e,IS);const t=H(e,e,Mt.schema({names:{digestedObjectType:ru,otherObjectTypeID:La,digestAlgorithm:{names:{blockName:au}},objectDigest:nu}}));U.assertSchema(t,this.className),this.digestedObjectType=t.result.digestedObjectType,La in t.result&&(this.otherObjectTypeID=t.result.otherObjectTypeID),this.digestAlgorithm=new R({schema:t.result.digestAlgorithm}),this.objectDigest=t.result.objectDigest}toSchema(){const e=new C({value:[this.digestedObjectType]});return this.otherObjectTypeID&&e.valueBlock.value.push(this.otherObjectTypeID),e.valueBlock.value.push(this.digestAlgorithm.toSchema()),e.valueBlock.value.push(this.objectDigest),e}toJSON(){const e={digestedObjectType:this.digestedObjectType.toJSON(),digestAlgorithm:this.digestAlgorithm.toJSON(),objectDigest:this.objectDigest.toJSON()};return this.otherObjectTypeID&&(e.otherObjectTypeID=this.otherObjectTypeID.toJSON()),e}}Mt.CLASS_NAME="ObjectDigestInfo";const Ua="issuerName",ja="baseCertificateID",$a="objectDigestInfo",VS=[Ua,ja,$a];class ra extends ${constructor(e={}){super(),Ua in e&&(this.issuerName=f(e,Ua,ra.defaultValues(Ua))),ja in e&&(this.baseCertificateID=f(e,ja,ra.defaultValues(ja))),$a in e&&(this.objectDigestInfo=f(e,$a,ra.defaultValues($a))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ua:return new Ge;case ja:return new Vt;case $a:return new Mt;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[Ge.schema({names:{blockName:t.issuerName}},!0),new P({optional:!0,name:t.baseCertificateID||b,idBlock:{tagClass:3,tagNumber:0},value:Vt.schema().valueBlock.value}),new P({optional:!0,name:t.objectDigestInfo||b,idBlock:{tagClass:3,tagNumber:1},value:Mt.schema().valueBlock.value})]})}fromSchema(e){K(e,VS);const t=H(e,e,ra.schema({names:{issuerName:Ua,baseCertificateID:ja,objectDigestInfo:$a}}));U.assertSchema(t,this.className),Ua in t.result&&(this.issuerName=new Ge({schema:t.result.issuerName})),ja in t.result&&(this.baseCertificateID=new Vt({schema:new C({value:t.result.baseCertificateID.valueBlock.value})})),$a in t.result&&(this.objectDigestInfo=new Mt({schema:new C({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new C;return this.issuerName&&e.valueBlock.value.push(this.issuerName.toSchema()),this.baseCertificateID&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:1},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.issuerName&&(e.issuerName=this.issuerName.toJSON()),this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}ra.CLASS_NAME="V2Form";const Ka="baseCertificateID",Ha="entityName",Ma="objectDigestInfo",xS=[Ka,Ha,Ma];class Js extends ${constructor(e={}){super(),Ka in e&&(this.baseCertificateID=f(e,Ka,Js.defaultValues(Ka))),Ha in e&&(this.entityName=f(e,Ha,Js.defaultValues(Ha))),Ma in e&&(this.objectDigestInfo=f(e,Ma,Js.defaultValues(Ma))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ka:return new Vt;case Ha:return new Ge;case Ma:return new Mt;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({optional:!0,name:t.baseCertificateID||b,idBlock:{tagClass:3,tagNumber:0},value:Vt.schema().valueBlock.value}),new P({optional:!0,name:t.entityName||b,idBlock:{tagClass:3,tagNumber:1},value:Ge.schema().valueBlock.value}),new P({optional:!0,name:t.objectDigestInfo||b,idBlock:{tagClass:3,tagNumber:2},value:Mt.schema().valueBlock.value})]})}fromSchema(e){K(e,xS);const t=H(e,e,Js.schema({names:{baseCertificateID:Ka,entityName:Ha,objectDigestInfo:Ma}}));U.assertSchema(t,this.className),Ka in t.result&&(this.baseCertificateID=new Vt({schema:new C({value:t.result.baseCertificateID.valueBlock.value})})),Ha in t.result&&(this.entityName=new Ge({schema:new C({value:t.result.entityName.valueBlock.value})})),Ma in t.result&&(this.objectDigestInfo=new Mt({schema:new C({value:t.result.objectDigestInfo.valueBlock.value})}))}toSchema(){const e=new C;return this.baseCertificateID&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:0},value:this.baseCertificateID.toSchema().valueBlock.value})),this.entityName&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:1},value:this.entityName.toSchema().valueBlock.value})),this.objectDigestInfo&&e.valueBlock.value.push(new P({idBlock:{tagClass:3,tagNumber:2},value:this.objectDigestInfo.toSchema().valueBlock.value})),e}toJSON(){const e={};return this.baseCertificateID&&(e.baseCertificateID=this.baseCertificateID.toJSON()),this.entityName&&(e.entityName=this.entityName.toJSON()),this.objectDigestInfo&&(e.objectDigestInfo=this.objectDigestInfo.toJSON()),e}}Js.CLASS_NAME="Holder";const iu="version",ou="holder",lu="issuer",uu="signature",cu="serialNumber",hu="attrCertValidityPeriod",mu="attributes",Fa="issuerUniqueID",Ja="extensions",BS=[iu,ou,lu,uu,cu,hu,mu,Fa,Ja];class St extends ${constructor(e={}){super(),this.version=f(e,iu,St.defaultValues(iu)),this.holder=f(e,ou,St.defaultValues(ou)),this.issuer=f(e,lu,St.defaultValues(lu)),this.signature=f(e,uu,St.defaultValues(uu)),this.serialNumber=f(e,cu,St.defaultValues(cu)),this.attrCertValidityPeriod=f(e,hu,St.defaultValues(hu)),this.attributes=f(e,mu,St.defaultValues(mu)),Fa in e&&(this.issuerUniqueID=f(e,Fa,St.defaultValues(Fa))),Ja in e&&(this.extensions=f(e,Ja,St.defaultValues(Ja))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case iu:return 1;case ou:return new Js;case lu:return{};case uu:return new R;case cu:return new L;case hu:return new cs;case mu:return[];case Fa:return new ce;case Ja:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),Js.schema(t.holder||{}),new Ve({value:[Ge.schema({names:{blockName:t.issuer||b}}),new P({name:t.issuer||b,idBlock:{tagClass:3,tagNumber:0},value:ra.schema().valueBlock.value})]}),R.schema(t.signature||{}),new L({name:t.serialNumber||b}),cs.schema(t.attrCertValidityPeriod||{}),new C({name:t.attributes||b,value:[new se({value:Ae.schema()})]}),new ce({optional:!0,name:t.issuerUniqueID||b}),He.schema(t.extensions||{},!0)]})}fromSchema(e){K(e,BS);const t=H(e,e,St.schema({names:{version:iu,holder:{names:{blockName:ou}},issuer:lu,signature:{names:{blockName:uu}},serialNumber:cu,attrCertValidityPeriod:{names:{blockName:hu}},attributes:mu,issuerUniqueID:Fa,extensions:{names:{blockName:Ja}}}}));switch(U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.holder=new Js({schema:t.result.holder}),t.result.issuer.idBlock.tagClass){case 3:this.issuer=new ra({schema:new C({value:t.result.issuer.valueBlock.value})});break;case 1:default:throw new Error("Incorrect value for 'issuer' in AttributeCertificateInfoV2")}this.signature=new R({schema:t.result.signature}),this.serialNumber=t.result.serialNumber,this.attrCertValidityPeriod=new cs({schema:t.result.attrCertValidityPeriod}),this.attributes=Array.from(t.result.attributes.valueBlock.value,r=>new Ae({schema:r})),Fa in t.result&&(this.issuerUniqueID=t.result.issuerUniqueID),Ja in t.result&&(this.extensions=new He({schema:t.result.extensions}))}toSchema(){const e=new C({value:[new L({value:this.version}),this.holder.toSchema(),new P({idBlock:{tagClass:3,tagNumber:0},value:this.issuer.toSchema().valueBlock.value}),this.signature.toSchema(),this.serialNumber,this.attrCertValidityPeriod.toSchema(),new C({value:Array.from(this.attributes,t=>t.toSchema())})]});return this.issuerUniqueID&&e.valueBlock.value.push(this.issuerUniqueID),this.extensions&&e.valueBlock.value.push(this.extensions.toSchema()),e}toJSON(){const e={version:this.version,holder:this.holder.toJSON(),issuer:this.issuer.toJSON(),signature:this.signature.toJSON(),serialNumber:this.serialNumber.toJSON(),attrCertValidityPeriod:this.attrCertValidityPeriod.toJSON(),attributes:Array.from(this.attributes,t=>t.toJSON())};return this.issuerUniqueID&&(e.issuerUniqueID=this.issuerUniqueID.toJSON()),this.extensions&&(e.extensions=this.extensions.toJSON()),e}}St.CLASS_NAME="AttributeCertificateInfoV2";const fu="acinfo",du="signatureAlgorithm",pu="signatureValue",PS=[fu,du,pu];class Ft extends ${constructor(e={}){super(),this.acinfo=f(e,fu,Ft.defaultValues(fu)),this.signatureAlgorithm=f(e,du,Ft.defaultValues(du)),this.signatureValue=f(e,pu,Ft.defaultValues(pu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fu:return new St;case du:return new R;case pu:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[St.schema(t.acinfo||{}),R.schema(t.signatureAlgorithm||{}),new ce({name:t.signatureValue||b})]})}fromSchema(e){K(e,PS);const t=H(e,e,Ft.schema({names:{acinfo:{names:{blockName:fu}},signatureAlgorithm:{names:{blockName:du}},signatureValue:pu}}));U.assertSchema(t,this.className),this.acinfo=new St({schema:t.result.acinfo}),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}toSchema(){return new C({value:[this.acinfo.toSchema(),this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){return{acinfo:this.acinfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()}}}Ft.CLASS_NAME="AttributeCertificateV2";const qa="contentType",oi="content",OS=[qa,oi];class ve extends ${constructor(e={}){super(),this.contentType=f(e,qa,ve.defaultValues(qa)),this.content=f(e,oi,ve.defaultValues(oi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qa:return b;case oi:return new te;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qa:return typeof t=="string"&&t===this.defaultValues(qa);case oi:return t instanceof te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return"optional"in t||(t.optional=!1),new C({name:t.blockName||"ContentInfo",optional:t.optional,value:[new z({name:t.contentType||qa}),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.content||oi})]})]})}fromSchema(e){K(e,OS);const t=H(e,e,ve.schema());U.assertSchema(t,this.className),this.contentType=t.result.contentType.valueBlock.toString(),this.content=t.result.content}toSchema(){return new C({value:[new z({value:this.contentType}),new P({idBlock:{tagClass:3,tagNumber:0},value:[this.content]})]})}toJSON(){const e={contentType:this.contentType};return this.content instanceof te||(e.content=this.content.toJSON()),e}}ve.CLASS_NAME="ContentInfo",ve.DATA=vd,ve.SIGNED_DATA=dw,ve.ENVELOPED_DATA=pw,ve.ENCRYPTED_DATA=gw;const Mm="type",Fm="value",Bf="utcTimeName",Pf="generalTimeName",DS=[Bf,Pf];var zp;(function(s){s[s.UTCTime=0]="UTCTime",s[s.GeneralizedTime=1]="GeneralizedTime",s[s.empty=2]="empty"})(zp||(zp={}));class je extends ${constructor(e={}){super(),this.type=f(e,Mm,je.defaultValues(Mm)),this.value=f(e,Fm,je.defaultValues(Fm)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Mm:return 0;case Fm:return new Date(0,0,0);default:return super.defaultValues(e)}}static schema(e={},t=!1){const r=f(e,"names",{});return new Ve({optional:t,value:[new df({name:r.utcTimeName||b}),new xe({name:r.generalTimeName||b})]})}fromSchema(e){K(e,DS);const t=H(e,e,je.schema({names:{utcTimeName:Bf,generalTimeName:Pf}}));U.assertSchema(t,this.className),Bf in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),Pf in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){return this.type===0?new df({valueDate:this.value}):this.type===1?new xe({valueDate:this.value}):{}}toJSON(){return{type:this.type,value:this.value}}}je.CLASS_NAME="Time";const Jm="tbs",Er="version",Qc="serialNumber",eh="signature",th="issuer",sh="notBefore",rh="notAfter",ah="subject",nh="subjectPublicKeyInfo",gu="issuerUniqueID",wu="subjectUniqueID",yu="extensions",vu="signatureAlgorithm",bu="signatureValue",Jt="tbsCertificate",Kh="".concat(Jt,".").concat(Er),bd="".concat(Jt,".").concat(Qc),Sd="".concat(Jt,".").concat(eh),Ad="".concat(Jt,".").concat(th),Hh="".concat(Jt,".").concat(sh),Mh="".concat(Jt,".").concat(rh),Nd="".concat(Jt,".").concat(ah),kd="".concat(Jt,".").concat(nh),Fh="".concat(Jt,".").concat(gu),Jh="".concat(Jt,".").concat(wu),ec="".concat(Jt,".").concat(yu),TS=[Jt,Kh,bd,Sd,Ad,Hh,Mh,Nd,kd,Fh,Jh,ec,vu,bu];function RS(s={}){const e=f(s,"names",{});return new C({name:e.blockName||Jt,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new L({name:e.tbsCertificateVersion||Kh})]}),new L({name:e.tbsCertificateSerialNumber||bd}),R.schema(e.signature||{names:{blockName:Sd}}),we.schema(e.issuer||{names:{blockName:Ad}}),new C({name:e.tbsCertificateValidity||"tbsCertificate.validity",value:[je.schema(e.notBefore||{names:{utcTimeName:Hh,generalTimeName:Hh}}),je.schema(e.notAfter||{names:{utcTimeName:Mh,generalTimeName:Mh}})]}),we.schema(e.subject||{names:{blockName:Nd}}),xt.schema(e.subjectPublicKeyInfo||{names:{blockName:kd}}),new ee({name:e.tbsCertificateIssuerUniqueID||Fh,optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new ee({name:e.tbsCertificateSubjectUniqueID||Jh,optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[He.schema(e.extensions||{names:{blockName:ec}})]})]})}class fe extends ${get tbs(){return Se.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(f(e,Jm,fe.defaultValues(Jm))),this.version=f(e,Er,fe.defaultValues(Er)),this.serialNumber=f(e,Qc,fe.defaultValues(Qc)),this.signature=f(e,eh,fe.defaultValues(eh)),this.issuer=f(e,th,fe.defaultValues(th)),this.notBefore=f(e,sh,fe.defaultValues(sh)),this.notAfter=f(e,rh,fe.defaultValues(rh)),this.subject=f(e,ah,fe.defaultValues(ah)),this.subjectPublicKeyInfo=f(e,nh,fe.defaultValues(nh)),gu in e&&(this.issuerUniqueID=f(e,gu,fe.defaultValues(gu))),wu in e&&(this.subjectUniqueID=f(e,wu,fe.defaultValues(wu))),yu in e&&(this.extensions=f(e,yu,fe.defaultValues(yu))),this.signatureAlgorithm=f(e,vu,fe.defaultValues(vu)),this.signatureValue=f(e,bu,fe.defaultValues(bu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Jm:return Ke;case Er:return 0;case Qc:return new L;case eh:return new R;case th:return new we;case sh:return new je;case rh:return new je;case ah:return new we;case nh:return new xt;case gu:return Ke;case wu:return Ke;case yu:return[];case vu:return new R;case bu:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[RS(t.tbsCertificate),R.schema(t.signatureAlgorithm||{names:{blockName:vu}}),new ce({name:t.signatureValue||bu})]})}fromSchema(e){K(e,TS);const t=H(e,e,fe.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:ec}}}}}}));U.assertSchema(t,this.className),this.tbsView=t.result.tbsCertificate.valueBeforeDecodeView,Kh in t.result&&(this.version=t.result[Kh].valueBlock.valueDec),this.serialNumber=t.result[bd],this.signature=new R({schema:t.result[Sd]}),this.issuer=new we({schema:t.result[Ad]}),this.notBefore=new je({schema:t.result[Hh]}),this.notAfter=new je({schema:t.result[Mh]}),this.subject=new we({schema:t.result[Nd]}),this.subjectPublicKeyInfo=new xt({schema:t.result[kd]}),Fh in t.result&&(this.issuerUniqueID=t.result[Fh].valueBlock.valueHex),Jh in t.result&&(this.subjectUniqueID=t.result[Jh].valueBlock.valueHex),ec in t.result&&(this.extensions=Array.from(t.result[ec],r=>new Le({schema:r}))),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return Er in this&&this.version!==fe.defaultValues(Er)&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new L({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new C({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),this.issuerUniqueID&&e.push(new ee({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),this.subjectUniqueID&&e.push(new ee({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),this.extensions&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new C({value:Array.from(this.extensions,t=>t.toSchema())})]})),new C({value:e})}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return fe.schema().value[0];const r=$e(this.tbsView);U.assert(r,"TBS Certificate"),t=r.result}else t=this.encodeTBS();return new C({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:pe.ToHex(this.tbsView),version:this.version,serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Er in this&&this.version!==fe.defaultValues(Er)&&(e.version=this.version),this.issuerUniqueID&&(e.issuerUniqueID=pe.ToHex(this.issuerUniqueID)),this.subjectUniqueID&&(e.subjectUniqueID=pe.ToHex(this.subjectUniqueID)),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async getPublicKey(e,t=ne(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}async getKeyHash(e="SHA-1",t=ne(!0)){return t.digest({name:e},this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView)}async sign(e,t="SHA-1",r=ne(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const o=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new ce({valueHex:o})}async verify(e,t=ne(!0)){let r;if(e?r=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(r=this.subjectPublicKeyInfo),!(r instanceof xt))throw new Error("Please provide issuer certificate as a parameter");return t.verifyWithPublicKey(this.tbsView,this.signatureValue,r,this.signatureAlgorithm)}}fe.CLASS_NAME="Certificate";function Aw(s,e=null){if(e&&s.issuer.isEqual(e.issuer)&&s.serialNumber.isEqual(e.serialNumber))return null;let t=!1;if(s.extensions){for(const r of s.extensions)if(r.extnID===pd&&r.parsedValue instanceof Vn&&r.parsedValue.cA){t=!0;break}}return t?s:null}const li="certId",ui="certValue",Fn="parsedValue",LS=[li,ui];class An extends ${constructor(e={}){super(),this.certId=f(e,li,An.defaultValues(li)),this.certValue=f(e,ui,An.defaultValues(ui)),Fn in e&&(this.parsedValue=f(e,Fn,An.defaultValues(Fn))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case li:return b;case ui:return new te;case Fn:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case li:return t===b;case ui:return t instanceof te;case Fn:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.id||"id"}),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.value||"value"})]})]})}fromSchema(e){K(e,LS);const t=H(e,e,An.schema({names:{id:li,value:ui}}));U.assertSchema(t,this.className),this.certId=t.result.certId.valueBlock.toString(),this.certValue=t.result.certValue;const r=this.certValue.valueBlock.valueHexView;switch(this.certId){case Pp:try{this.parsedValue=fe.fromBER(r)}catch(a){Ft.fromBER(r)}break;case Op:this.parsedValue=Ft.fromBER(r);break;case Kb:default:throw new Error("Incorrect CERT_ID value in CertBag: ".concat(this.certId))}}toSchema(){return Fn in this&&("acinfo"in this.parsedValue?this.certId=Op:this.certId=Pp,this.certValue=new J({valueHex:this.parsedValue.toSchema().toBER(!1)})),new C({value:[new z({value:this.certId}),new P({idBlock:{tagClass:3,tagNumber:0},value:["toSchema"in this.certValue?this.certValue.toSchema():this.certValue]})]})}toJSON(){return{certId:this.certId,certValue:this.certValue.toJSON()}}}An.CLASS_NAME="CertBag";const Su="userCertificate",ci="revocationDate",Wa="crlEntryExtensions",US=[Su,ci,Wa];class Nn extends ${constructor(e={}){super(),this.userCertificate=f(e,Su,Nn.defaultValues(Su)),this.revocationDate=f(e,ci,Nn.defaultValues(ci)),Wa in e&&(this.crlEntryExtensions=f(e,Wa,Nn.defaultValues(Wa))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Su:return new L;case ci:return new je;case Wa:return new He;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.userCertificate||Su}),je.schema({names:{utcTimeName:t.revocationDate||ci,generalTimeName:t.revocationDate||ci}}),He.schema({names:{blockName:t.crlEntryExtensions||Wa}},!0)]})}fromSchema(e){K(e,US);const t=H(e,e,Nn.schema());U.assertSchema(t,this.className),this.userCertificate=t.result.userCertificate,this.revocationDate=new je({schema:t.result.revocationDate}),Wa in t.result&&(this.crlEntryExtensions=new He({schema:t.result.crlEntryExtensions}))}toSchema(){const e=[this.userCertificate,this.revocationDate.toSchema()];return this.crlEntryExtensions&&e.push(this.crlEntryExtensions.toSchema()),new C({value:e})}toJSON(){const e={userCertificate:this.userCertificate.toJSON(),revocationDate:this.revocationDate.toJSON()};return this.crlEntryExtensions&&(e.crlEntryExtensions=this.crlEntryExtensions.toJSON()),e}}Nn.CLASS_NAME="RevokedCertificate";const qm="tbs",Wo="version",Wm="signature",_m="issuer",Gm="thisUpdate",Bc="nextUpdate",Pc="revokedCertificates",Oc="crlExtensions",Au="signatureAlgorithm",Nu="signatureValue",Zs="tbsCertList",qh="".concat(Zs,".version"),Ed="".concat(Zs,".signature"),Cd="".concat(Zs,".issuer"),Wh="".concat(Zs,".thisUpdate"),fc="".concat(Zs,".nextUpdate"),_h="".concat(Zs,".revokedCertificates"),Gh="".concat(Zs,".extensions"),jS=[Zs,qh,Ed,Cd,Wh,fc,_h,Gh,Au,Nu];function $S(s={}){const e=f(s,"names",{});return new C({name:e.blockName||Zs,value:[new L({optional:!0,name:e.tbsCertListVersion||qh,value:2}),R.schema(e.signature||{names:{blockName:Ed}}),we.schema(e.issuer||{names:{blockName:Cd}}),je.schema(e.tbsCertListThisUpdate||{names:{utcTimeName:Wh,generalTimeName:Wh}}),je.schema(e.tbsCertListNextUpdate||{names:{utcTimeName:fc,generalTimeName:fc}},!0),new C({optional:!0,value:[new se({name:e.tbsCertListRevokedCertificates||_h,value:new C({value:[new L,je.schema(),He.schema({},!0)]})})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[He.schema(e.crlExtensions||{names:{blockName:Gh}})]})]})}const KS=[wd,iw,Ib,Vb,ow,gd,yd,xb,Bb,lw];class qe extends ${get tbs(){return Se.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(f(e,qm,qe.defaultValues(qm))),this.version=f(e,Wo,qe.defaultValues(Wo)),this.signature=f(e,Wm,qe.defaultValues(Wm)),this.issuer=f(e,_m,qe.defaultValues(_m)),this.thisUpdate=f(e,Gm,qe.defaultValues(Gm)),Bc in e&&(this.nextUpdate=f(e,Bc,qe.defaultValues(Bc))),Pc in e&&(this.revokedCertificates=f(e,Pc,qe.defaultValues(Pc))),Oc in e&&(this.crlExtensions=f(e,Oc,qe.defaultValues(Oc))),this.signatureAlgorithm=f(e,Au,qe.defaultValues(Au)),this.signatureValue=f(e,Nu,qe.defaultValues(Nu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qm:return Ke;case Wo:return 0;case Wm:return new R;case _m:return new we;case Gm:return new je;case Bc:return new je;case Pc:return[];case Oc:return new He;case Au:return new R;case Nu:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||"CertificateList",value:[$S(e),R.schema(t.signatureAlgorithm||{names:{blockName:Au}}),new ce({name:t.signatureValue||Nu})]})}fromSchema(e){K(e,jS);const t=H(e,e,qe.schema());U.assertSchema(t,this.className),this.tbsView=t.result.tbsCertList.valueBeforeDecodeView,qh in t.result&&(this.version=t.result[qh].valueBlock.valueDec),this.signature=new R({schema:t.result[Ed]}),this.issuer=new we({schema:t.result[Cd]}),this.thisUpdate=new je({schema:t.result[Wh]}),fc in t.result&&(this.nextUpdate=new je({schema:t.result[fc]})),_h in t.result&&(this.revokedCertificates=Array.from(t.result[_h],r=>new Nn({schema:r}))),Gh in t.result&&(this.crlExtensions=new He({schema:t.result[Gh]})),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return this.version!==qe.defaultValues(Wo)&&e.push(new L({value:this.version})),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(this.thisUpdate.toSchema()),this.nextUpdate&&e.push(this.nextUpdate.toSchema()),this.revokedCertificates&&e.push(new C({value:Array.from(this.revokedCertificates,t=>t.toSchema())})),this.crlExtensions&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.crlExtensions.toSchema()]})),new C({value:e})}toSchema(e=!1){let t;if(e)t=this.encodeTBS();else{if(!this.tbsView.byteLength)return qe.schema();const r=$e(this.tbsView);U.assert(r,"TBS Certificate Revocation List"),t=r.result}return new C({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:pe.ToHex(this.tbsView),version:this.version,signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),thisUpdate:this.thisUpdate.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return this.version!==qe.defaultValues(Wo)&&(e.version=this.version),this.nextUpdate&&(e.nextUpdate=this.nextUpdate.toJSON()),this.revokedCertificates&&(e.revokedCertificates=Array.from(this.revokedCertificates,t=>t.toJSON())),this.crlExtensions&&(e.crlExtensions=this.crlExtensions.toJSON()),e}isCertificateRevoked(e){if(!this.issuer.isEqual(e.issuer)||!this.revokedCertificates)return!1;for(const t of this.revokedCertificates)if(t.userCertificate.isEqual(e.serialNumber))return!0;return!1}async sign(e,t="SHA-1",r=ne(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),{parameters:n}=a;this.signature=a.signatureAlgorithm,this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const o=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new ce({valueHex:o})}async verify(e={},t=ne(!0)){let r;if(e.issuerCertificate&&(r=e.issuerCertificate.subjectPublicKeyInfo,!this.issuer.isEqual(e.issuerCertificate.subject)))return!1;if(e.publicKeyInfo&&(r=e.publicKeyInfo),!r)throw new Error("Issuer's certificate must be provided as an input parameter");if(this.crlExtensions){for(const a of this.crlExtensions.extensions)if(a.critical&&!KS.includes(a.extnID))return!1}return t.verifyWithPublicKey(this.tbsView,this.signatureValue,r,this.signatureAlgorithm)}}qe.CLASS_NAME="CertificateRevocationList";const hi="crlId",mi="crlValue",_o="parsedValue",HS=[hi,mi];class kn extends ${constructor(e={}){super(),this.crlId=f(e,hi,kn.defaultValues(hi)),this.crlValue=f(e,mi,kn.defaultValues(mi)),_o in e&&(this.parsedValue=f(e,_o,kn.defaultValues(_o))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hi:return b;case mi:return new te;case _o:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hi:return t===b;case mi:return t instanceof te;case _o:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.id||"id"}),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.value||"value"})]})]})}fromSchema(e){K(e,HS);const t=H(e,e,kn.schema({names:{id:hi,value:mi}}));switch(U.assertSchema(t,this.className),this.crlId=t.result.crlId.valueBlock.toString(),this.crlValue=t.result.crlValue,this.crlId){case Dp:this.parsedValue=qe.fromBER(this.certValue.valueBlock.valueHex);break;default:throw new Error("Incorrect CRL_ID value in CRLBag: ".concat(this.crlId))}}toSchema(){return this.parsedValue&&(this.crlId=Dp,this.crlValue=new J({valueHex:this.parsedValue.toSchema().toBER(!1)})),new C({value:[new z({value:this.crlId}),new P({idBlock:{tagClass:3,tagNumber:0},value:[this.crlValue.toSchema()]})]})}toJSON(){return{crlId:this.crlId,crlValue:this.crlValue.toJSON()}}}kn.CLASS_NAME="CRLBag";const fi="version",di="encryptedContentInfo",Cr="unprotectedAttrs",MS=[fi,di,Cr];class bs extends ${constructor(e={}){super(),this.version=f(e,fi,bs.defaultValues(fi)),this.encryptedContentInfo=f(e,di,bs.defaultValues(di)),Cr in e&&(this.unprotectedAttrs=f(e,Cr,bs.defaultValues(Cr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case fi:return 0;case di:return new Re;case Cr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case fi:return t===0;case di:return Re.compareWithDefault("contentType",t.contentType)&&Re.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Re.compareWithDefault("encryptedContent",t.encryptedContent);case Cr:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),Re.schema(t.encryptedContentInfo||{}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new se({name:t.unprotectedAttrs||b,value:Ae.schema()})]})]})}fromSchema(e){K(e,MS);const t=H(e,e,bs.schema({names:{version:fi,encryptedContentInfo:{names:{blockName:di}},unprotectedAttrs:Cr}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.encryptedContentInfo=new Re({schema:t.result.encryptedContentInfo}),Cr in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new Ae({schema:r})))}toSchema(){const e=[];return e.push(new L({value:this.version})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={version:this.version,encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}async encrypt(e,t=ne(!0)){ge.assert(e,"parameters","object");const r=fs(ct({},e),{contentType:"1.2.840.113549.1.7.1"});this.encryptedContentInfo=await t.encryptEncryptedContentInfo(r)}async decrypt(e,t=ne(!0)){ge.assert(e,"parameters","object");const r=fs(ct({},e),{encryptedContentInfo:this.encryptedContentInfo});return t.decryptEncryptedContentInfo(r)}}bs.CLASS_NAME="EncryptedData";const _a="encryptionAlgorithm",Ir="encryptedData",Go="parsedValue",FS=[_a,Ir];class Xr extends ${constructor(e={}){super(),this.encryptionAlgorithm=f(e,_a,Xr.defaultValues(_a)),this.encryptedData=f(e,Ir,Xr.defaultValues(Ir)),Go in e&&(this.parsedValue=f(e,Go,Xr.defaultValues(Go))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _a:return new R;case Ir:return new J;case Go:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _a:return R.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case Ir:return t.isEqual(Xr.defaultValues(e));case Go:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.encryptionAlgorithm||{names:{blockName:_a}}),new Ve({value:[new J({name:t.encryptedData||Ir}),new J({idBlock:{isConstructed:!0},name:t.encryptedData||Ir})]})]})}fromSchema(e){K(e,FS);const t=H(e,e,Xr.schema({names:{encryptionAlgorithm:{names:{blockName:_a}},encryptedData:Ir}}));U.assertSchema(t,this.className),this.encryptionAlgorithm=new R({schema:t.result.encryptionAlgorithm}),this.encryptedData=t.result.encryptedData}toSchema(){return new C({value:[this.encryptionAlgorithm.toSchema(),this.encryptedData]})}toJSON(){return{encryptionAlgorithm:this.encryptionAlgorithm.toJSON(),encryptedData:this.encryptedData.toJSON()}}async parseInternalValues(e,t=ne(!0)){const r=await new bs({encryptedContentInfo:new Re({contentEncryptionAlgorithm:this.encryptionAlgorithm,encryptedContent:this.encryptedData})}).decrypt(e,t);this.parsedValue=zt.fromBER(r)}async makeInternalValues(e,t=ne(!0)){if(!this.parsedValue)throw new Error('Please initialize "parsedValue" first');const r=new bs,a=fs(ct({},e),{contentToEncrypt:this.parsedValue.toSchema().toBER(!1)});if(await r.encrypt(a,t),!r.encryptedContentInfo.encryptedContent)throw new Error("The filed `encryptedContent` in EncryptedContentInfo is empty");this.encryptionAlgorithm=r.encryptedContentInfo.contentEncryptionAlgorithm,this.encryptedData=r.encryptedContentInfo.encryptedContent}}Xr.CLASS_NAME="PKCS8ShroudedKeyBag";const pi="secretTypeId",gi="secretValue",JS=[pi,gi];class Co extends ${constructor(e={}){super(),this.secretTypeId=f(e,pi,Co.defaultValues(pi)),this.secretValue=f(e,gi,Co.defaultValues(gi)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case pi:return b;case gi:return new te;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case pi:return t===b;case gi:return t instanceof te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.id||"id"}),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.value||"value"})]})]})}fromSchema(e){K(e,JS);const t=H(e,e,Co.schema({names:{id:pi,value:gi}}));U.assertSchema(t,this.className),this.secretTypeId=t.result.secretTypeId.valueBlock.toString(),this.secretValue=t.result.secretValue}toSchema(){return new C({value:[new z({value:this.secretTypeId}),new P({idBlock:{tagClass:3,tagNumber:0},value:[this.secretValue.toSchema()]})]})}toJSON(){return{secretTypeId:this.secretTypeId,secretValue:this.secretValue.toJSON()}}}Co.CLASS_NAME="SecretBag";class _r{static getItems(){return this.items||(this.items={},_r.register("1.2.840.113549.1.12.10.1.1",zt),_r.register("1.2.840.113549.1.12.10.1.2",Xr),_r.register("1.2.840.113549.1.12.10.1.3",An),_r.register("1.2.840.113549.1.12.10.1.4",kn),_r.register("1.2.840.113549.1.12.10.1.5",Co),_r.register("1.2.840.113549.1.12.10.1.6",qs)),this.items}static register(e,t){this.getItems()[e]=t}static find(e){return this.getItems()[e]||null}}const Ga="bagId",Xa="bagValue",Os="bagAttributes",qS=[Ga,Xa,Os];class aa extends ${constructor(e={}){super(),this.bagId=f(e,Ga,aa.defaultValues(Ga)),this.bagValue=f(e,Xa,aa.defaultValues(Xa)),Os in e&&(this.bagAttributes=f(e,Os,aa.defaultValues(Os))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ga:return b;case Xa:return new te;case Os:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ga:return t===b;case Xa:return t instanceof te;case Os:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.bagId||Ga}),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.bagValue||Xa})]}),new _e({optional:!0,value:[new se({name:t.bagAttributes||Os,value:Ae.schema()})]})]})}fromSchema(e){K(e,qS);const t=H(e,e,aa.schema({names:{bagId:Ga,bagValue:Xa,bagAttributes:Os}}));U.assertSchema(t,this.className),this.bagId=t.result.bagId.valueBlock.toString();const r=_r.find(this.bagId);if(!r)throw new Error("Invalid BAG_ID for SafeBag: ".concat(this.bagId));this.bagValue=new r({schema:t.result.bagValue}),Os in t.result&&(this.bagAttributes=Array.from(t.result.bagAttributes,a=>new Ae({schema:a})))}toSchema(){const e=[new z({value:this.bagId}),new P({idBlock:{tagClass:3,tagNumber:0},value:[this.bagValue.toSchema()]})];return this.bagAttributes&&e.push(new _e({value:Array.from(this.bagAttributes,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={bagId:this.bagId,bagValue:this.bagValue.toJSON()};return this.bagAttributes&&(e.bagAttributes=Array.from(this.bagAttributes,t=>t.toJSON())),e}}aa.CLASS_NAME="SafeBag";const Jn="safeBags";class qs extends ${constructor(e={}){super(),this.safeBags=f(e,Jn,qs.defaultValues(Jn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Jn:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Jn:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.safeBags||b,value:aa.schema()})]})}fromSchema(e){K(e,[Jn]);const t=H(e,e,qs.schema({names:{safeBags:Jn}}));U.assertSchema(t,this.className),this.safeBags=Array.from(t.result.safeBags,r=>new aa({schema:r}))}toSchema(){return new C({value:Array.from(this.safeBags,e=>e.toSchema())})}toJSON(){return{safeBags:Array.from(this.safeBags,e=>e.toJSON())}}}qs.CLASS_NAME="SafeContents";const ku="otherCertFormat",Eu="otherCert",WS=[ku,Eu];class la extends ${constructor(e={}){super(),this.otherCertFormat=f(e,ku,la.defaultValues(ku)),this.otherCert=f(e,Eu,la.defaultValues(Eu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ku:return b;case Eu:return new te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.otherCertFormat||ku}),new te({name:t.otherCert||Eu})]})}fromSchema(e){K(e,WS);const t=H(e,e,la.schema());U.assertSchema(t,this.className),this.otherCertFormat=t.result.otherCertFormat.valueBlock.toString(),this.otherCert=t.result.otherCert}toSchema(){return new C({value:[new z({value:this.otherCertFormat}),this.otherCert]})}toJSON(){const e={otherCertFormat:this.otherCertFormat};return this.otherCert instanceof te||(e.otherCert=this.otherCert.toJSON()),e}}const Cu="certificates",_S=[Cu];class Ss extends ${constructor(e={}){super(),this.certificates=f(e,Cu,Ss.defaultValues(Cu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Cu:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new _e({name:t.blockName||b,value:[new se({name:t.certificates||Cu,value:new Ve({value:[fe.schema(),new P({idBlock:{tagClass:3,tagNumber:0},value:[new te]}),new P({idBlock:{tagClass:3,tagNumber:1},value:[new C]}),new P({idBlock:{tagClass:3,tagNumber:2},value:Ft.schema().valueBlock.value}),new P({idBlock:{tagClass:3,tagNumber:3},value:la.schema().valueBlock.value})]})})]})}fromSchema(e){K(e,_S);const t=H(e,e,Ss.schema());U.assertSchema(t,this.className),this.certificates=Array.from(t.result.certificates||[],r=>{const a=r.idBlock.tagNumber;if(r.idBlock.tagClass===1)return new fe({schema:r});const n=new C({value:r.valueBlock.value});switch(a){case 1:return n.valueBlock.value[0].valueBlock.value[0].valueBlock.valueDec===1?new Ft({schema:n}):new Fs({schema:n});case 2:return new Ft({schema:n});case 3:return new la({schema:n})}return r})}toSchema(){return new _e({value:Array.from(this.certificates,e=>{switch(!0){case e instanceof fe:return e.toSchema();case e instanceof Fs:return new P({idBlock:{tagClass:3,tagNumber:1},value:e.toSchema().valueBlock.value});case e instanceof Ft:return new P({idBlock:{tagClass:3,tagNumber:2},value:e.toSchema().valueBlock.value});case e instanceof la:return new P({idBlock:{tagClass:3,tagNumber:3},value:e.toSchema().valueBlock.value})}return e.toSchema()})})}toJSON(){return{certificates:Array.from(this.certificates,e=>e.toJSON())}}}Ss.CLASS_NAME="CertificateSet";const Iu="otherRevInfoFormat",Vu="otherRevInfo",GS=[Iu,Vu];class Gs extends ${constructor(e={}){super(),this.otherRevInfoFormat=f(e,Iu,Gs.defaultValues(Iu)),this.otherRevInfo=f(e,Vu,Gs.defaultValues(Vu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Iu:return b;case Vu:return new te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.otherRevInfoFormat||Iu}),new te({name:t.otherRevInfo||Vu})]})}fromSchema(e){K(e,GS);const t=H(e,e,Gs.schema());U.assertSchema(t,this.className),this.otherRevInfoFormat=t.result.otherRevInfoFormat.valueBlock.toString(),this.otherRevInfo=t.result.otherRevInfo}toSchema(){return new C({value:[new z({value:this.otherRevInfoFormat}),this.otherRevInfo]})}toJSON(){const e={otherRevInfoFormat:this.otherRevInfoFormat};return this.otherRevInfo instanceof te||(e.otherRevInfo=this.otherRevInfo.toJSON()),e}}Gs.CLASS_NAME="OtherRevocationInfoFormat";const xu="crls",Xm="otherRevocationInfos",XS=[xu];class Xs extends ${constructor(e={}){super(),this.crls=f(e,xu,Xs.defaultValues(xu)),this.otherRevocationInfos=f(e,Xm,Xs.defaultValues(Xm)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case xu:return[];case Xm:return[];default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new _e({name:t.blockName||b,value:[new se({name:t.crls||b,value:new Ve({value:[qe.schema(),new P({idBlock:{tagClass:3,tagNumber:1},value:[new z,new te]})]})})]})}fromSchema(e){K(e,XS);const t=H(e,e,Xs.schema({names:{crls:xu}}));if(U.assertSchema(t,this.className),t.result.crls)for(const r of t.result.crls)r.idBlock.tagClass===1?this.crls.push(new qe({schema:r})):this.otherRevocationInfos.push(new Gs({schema:r}))}toSchema(){const e=[];return e.push(...Array.from(this.crls,t=>t.toSchema())),e.push(...Array.from(this.otherRevocationInfos,t=>{const r=t.toSchema();return r.idBlock.tagClass=3,r.idBlock.tagNumber=1,r})),new _e({value:e})}toJSON(){return{crls:Array.from(this.crls,e=>e.toJSON()),otherRevocationInfos:Array.from(this.otherRevocationInfos,e=>e.toJSON())}}}Xs.CLASS_NAME="RevocationInfoChoices";const Bu="certs",za="crls",zS=[Bu,za];class Rn extends ${constructor(e={}){super(),this.crls=f(e,za,Rn.defaultValues(za)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Bu:return new Ss;case za:return new Xs;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Bu:return t.certificates.length===0;case za:return t.crls.length===0&&t.otherRevocationInfos.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({name:t.certs||b,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Ss.schema().valueBlock.value}),new P({name:t.crls||b,optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Xs.schema().valueBlock.value})]})}fromSchema(e){K(e,zS);const t=H(e,e,Rn.schema({names:{certs:Bu,crls:za}}));U.assertSchema(t,this.className),Bu in t.result&&(this.certs=new Ss({schema:new _e({value:t.result.certs.valueBlock.value})})),za in t.result&&(this.crls=new Xs({schema:new _e({value:t.result.crls.valueBlock.value})}))}toSchema(){const e=[];return this.certs&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:this.certs.toSchema().valueBlock.value})),this.crls&&e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:this.crls.toSchema().valueBlock.value})),new C({value:e})}toJSON(){const e={};return this.certs&&(e.certs=this.certs.toJSON()),this.crls&&(e.crls=this.crls.toJSON()),e}}Rn.CLASS_NAME="OriginatorInfo";const Pu="issuer",Ou="serialNumber",YS=[Pu,Ou];class Me extends ${constructor(e={}){super(),this.issuer=f(e,Pu,Me.defaultValues(Pu)),this.serialNumber=f(e,Ou,Me.defaultValues(Ou)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pu:return new we;case Ou:return new L;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[we.schema(t.issuer||{}),new L({name:t.serialNumber||b})]})}fromSchema(e){K(e,YS);const t=H(e,e,Me.schema({names:{issuer:{names:{blockName:Pu}},serialNumber:Ou}}));U.assertSchema(t,this.className),this.issuer=new we({schema:t.result.issuer}),this.serialNumber=t.result.serialNumber}toSchema(){return new C({value:[this.issuer.toSchema(),this.serialNumber]})}toJSON(){return{issuer:this.issuer.toJSON(),serialNumber:this.serialNumber.toJSON()}}}Me.CLASS_NAME="IssuerAndSerialNumber";const Dc="variant",Xo="value",ZS=["blockName"];class Io extends ${constructor(e={}){super(),this.variant=f(e,Dc,Io.defaultValues(Dc)),Xo in e&&(this.value=f(e,Xo,Io.defaultValues(Xo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dc:return-1;case Xo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Dc:return t===-1;case Xo:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new Ve({value:[Me.schema({names:{blockName:t.blockName||b}}),new ee({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:0}})]})}fromSchema(e){K(e,ZS);const t=H(e,e,Io.schema({names:{blockName:"blockName"}}));U.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Me({schema:t.result.blockName})):(this.variant=2,this.value=new J({valueHex:t.result.blockName.valueBlock.valueHex}))}toSchema(){switch(this.variant){case 1:if(!(this.value instanceof Me))throw new Error("Incorrect type of RecipientIdentifier.value. It should be IssuerAndSerialNumber.");return this.value.toSchema();case 2:if(!(this.value instanceof J))throw new Error("Incorrect type of RecipientIdentifier.value. It should be ASN.1 OctetString.");return new ee({idBlock:{tagClass:3,tagNumber:0},valueHex:this.value.valueBlock.valueHexView});default:return new te}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&this.value&&(e.value=this.value.toJSON()),e}}Io.CLASS_NAME="RecipientIdentifier";const Ya="version",wi="rid",yi="keyEncryptionAlgorithm",vi="encryptedKey",Tc="recipientCertificate",QS=[Ya,wi,yi,vi];class jt extends ${constructor(e={}){super(),this.version=f(e,Ya,jt.defaultValues(Ya)),this.rid=f(e,wi,jt.defaultValues(wi)),this.keyEncryptionAlgorithm=f(e,yi,jt.defaultValues(yi)),this.encryptedKey=f(e,vi,jt.defaultValues(vi)),this.recipientCertificate=f(e,Tc,jt.defaultValues(Tc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ya:return-1;case wi:return{};case yi:return new R;case vi:return new J;case Tc:return new fe;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ya:return t===jt.defaultValues(Ya);case wi:return Object.keys(t).length===0;case yi:case vi:return t.isEqual(jt.defaultValues(e));case Tc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),Io.schema(t.rid||{}),R.schema(t.keyEncryptionAlgorithm||{}),new J({name:t.encryptedKey||b})]})}fromSchema(e){K(e,QS);const t=H(e,e,jt.schema({names:{version:Ya,rid:{names:{blockName:wi}},keyEncryptionAlgorithm:{names:{blockName:yi}},encryptedKey:vi}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,t.result.rid.idBlock.tagClass===3?this.rid=new J({valueHex:t.result.rid.valueBlock.valueHex}):this.rid=new Me({schema:t.result.rid}),this.keyEncryptionAlgorithm=new R({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return this.rid instanceof Me?(this.version=0,e.push(new L({value:this.version})),e.push(this.rid.toSchema())):(this.version=2,e.push(new L({value:this.version})),e.push(new ee({idBlock:{tagClass:3,tagNumber:0},valueHex:this.rid.valueBlock.valueHexView}))),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new C({value:e})}toJSON(){return{version:this.version,rid:this.rid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}jt.CLASS_NAME="KeyTransRecipientInfo";const bi="algorithm",Si="publicKey",eA=[bi,Si];class Ws extends ${constructor(e={}){super(),this.algorithm=f(e,bi,Ws.defaultValues(bi)),this.publicKey=f(e,Si,Ws.defaultValues(Si)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case bi:return new R;case Si:return new ce;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case bi:case Si:return t.isEqual(Ws.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.algorithm||{}),new ce({name:t.publicKey||b})]})}fromSchema(e){K(e,eA);const t=H(e,e,Ws.schema({names:{algorithm:{names:{blockName:bi}},publicKey:Si}}));U.assertSchema(t,this.className),this.algorithm=new R({schema:t.result.algorithm}),this.publicKey=t.result.publicKey}toSchema(){return new C({value:[this.algorithm.toSchema(),this.publicKey]})}toJSON(){return{algorithm:this.algorithm.toJSON(),publicKey:this.publicKey.toJSON()}}}Ws.CLASS_NAME="OriginatorPublicKey";const Rc="variant",zo="value",tA=["blockName"];class zs extends ${constructor(e={}){super(),this.variant=f(e,Rc,zs.defaultValues(Rc)),zo in e&&(this.value=f(e,zo,zs.defaultValues(zo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Rc:return-1;case zo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Rc:return t===-1;case zo:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new Ve({value:[Me.schema({names:{blockName:t.blockName||b}}),new ee({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||b}),new P({idBlock:{tagClass:3,tagNumber:1},name:t.blockName||b,value:Ws.schema().valueBlock.value})]})}fromSchema(e){K(e,tA);const t=H(e,e,zs.schema({names:{blockName:"blockName"}}));U.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Me({schema:t.result.blockName})):t.result.blockName.idBlock.tagNumber===0?(t.result.blockName.idBlock.tagClass=1,t.result.blockName.idBlock.tagNumber=4,this.variant=2,this.value=t.result.blockName):(this.variant=3,this.value=new Ws({schema:new C({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return this.value.idBlock.tagClass=3,this.value.idBlock.tagNumber=0,this.value;case 3:{const e=this.value.toSchema();return e.idBlock.tagClass=3,e.idBlock.tagNumber=1,e}default:return new te}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2||this.variant===3)&&(e.value=this.value.toJSON()),e}}zs.CLASS_NAME="OriginatorIdentifierOrKey";const Ai="keyAttrId",ps="keyAttr",sA=[Ai,ps];class hs extends ${constructor(e={}){super(),this.keyAttrId=f(e,Ai,hs.defaultValues(Ai)),ps in e&&(this.keyAttr=f(e,ps,hs.defaultValues(ps))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ai:return b;case ps:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ai:return typeof t=="string"&&t===b;case ps:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({optional:t.optional||!0,name:t.blockName||b,value:[new z({name:t.keyAttrId||b}),new te({optional:!0,name:t.keyAttr||b})]})}fromSchema(e){K(e,sA);const t=H(e,e,hs.schema({names:{keyAttrId:Ai,keyAttr:ps}}));U.assertSchema(t,this.className),this.keyAttrId=t.result.keyAttrId.valueBlock.toString(),ps in t.result&&(this.keyAttr=t.result.keyAttr)}toSchema(){const e=[];return e.push(new z({value:this.keyAttrId})),ps in this&&e.push(this.keyAttr),new C({value:e})}toJSON(){const e={keyAttrId:this.keyAttrId};return ps in this&&(e.keyAttr=this.keyAttr.toJSON()),e}}hs.CLASS_NAME="OtherKeyAttribute";const Za="subjectKeyIdentifier",Vr="date",xr="other",rA=[Za,Vr,xr];class ys extends ${constructor(e={}){super(),this.subjectKeyIdentifier=f(e,Za,ys.defaultValues(Za)),Vr in e&&(this.date=f(e,Vr,ys.defaultValues(Vr))),xr in e&&(this.other=f(e,xr,ys.defaultValues(xr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Za:return new J;case Vr:return new xe;case xr:return new hs;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Za:return t.isEqual(ys.defaultValues(Za));case Vr:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case xr:return t.keyAttrId===b&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new J({name:t.subjectKeyIdentifier||b}),new xe({optional:!0,name:t.date||b}),hs.schema(t.other||{})]})}fromSchema(e){K(e,rA);const t=H(e,e,ys.schema({names:{subjectKeyIdentifier:Za,date:Vr,other:{names:{blockName:xr}}}}));U.assertSchema(t,this.className),this.subjectKeyIdentifier=t.result.subjectKeyIdentifier,Vr in t.result&&(this.date=t.result.date),xr in t.result&&(this.other=new hs({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.subjectKeyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new C({value:e})}toJSON(){const e={subjectKeyIdentifier:this.subjectKeyIdentifier.toJSON()};return this.date&&(e.date=this.date.toJSON()),this.other&&(e.other=this.other.toJSON()),e}}ys.CLASS_NAME="RecipientKeyIdentifier";const Lc="variant",Uc="value",aA=["blockName"];class As extends ${constructor(e={}){super(),this.variant=f(e,Lc,As.defaultValues(Lc)),this.value=f(e,Uc,As.defaultValues(Uc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Lc:return-1;case Uc:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Lc:return t===-1;case Uc:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new Ve({value:[Me.schema(t.issuerAndSerialNumber||{names:{blockName:t.blockName||b}}),new P({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:0},value:ys.schema(t.rKeyId||{names:{blockName:t.blockName||b}}).valueBlock.value})]})}fromSchema(e){K(e,aA);const t=H(e,e,As.schema({names:{blockName:"blockName"}}));U.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1?(this.variant=1,this.value=new Me({schema:t.result.blockName})):(this.variant=2,this.value=new ys({schema:new C({value:t.result.blockName.valueBlock.value})}))}toSchema(){switch(this.variant){case 1:return this.value.toSchema();case 2:return new P({idBlock:{tagClass:3,tagNumber:0},value:this.value.toSchema().valueBlock.value});default:return new te}}toJSON(){const e={variant:this.variant};return(this.variant===1||this.variant===2)&&(e.value=this.value.toJSON()),e}}As.CLASS_NAME="KeyAgreeRecipientIdentifier";const Ni="rid",Qa="encryptedKey",nA=[Ni,Qa];class _s extends ${constructor(e={}){super(),this.rid=f(e,Ni,_s.defaultValues(Ni)),this.encryptedKey=f(e,Qa,_s.defaultValues(Qa)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ni:return new As;case Qa:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ni:return t.variant===-1&&!("value"in t);case Qa:return t.isEqual(_s.defaultValues(Qa));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[As.schema(t.rid||{}),new J({name:t.encryptedKey||b})]})}fromSchema(e){K(e,nA);const t=H(e,e,_s.schema({names:{rid:{names:{blockName:Ni}},encryptedKey:Qa}}));U.assertSchema(t,this.className),this.rid=new As({schema:t.result.rid}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new C({value:[this.rid.toSchema(),this.encryptedKey]})}toJSON(){return{rid:this.rid.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}_s.CLASS_NAME="RecipientEncryptedKey";const jc="encryptedKeys",Nw="RecipientEncryptedKeys",iA=[Nw];class ua extends ${constructor(e={}){super(),this.encryptedKeys=f(e,jc,ua.defaultValues(jc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case jc:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case jc:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.RecipientEncryptedKeys||b,value:_s.schema()})]})}fromSchema(e){K(e,iA);const t=H(e,e,ua.schema({names:{RecipientEncryptedKeys:Nw}}));U.assertSchema(t,this.className),this.encryptedKeys=Array.from(t.result.RecipientEncryptedKeys,r=>new _s({schema:r}))}toSchema(){return new C({value:Array.from(this.encryptedKeys,e=>e.toSchema())})}toJSON(){return{encryptedKeys:Array.from(this.encryptedKeys,e=>e.toJSON())}}}ua.CLASS_NAME="RecipientEncryptedKeys";const ki="version",Ei="originator",Ds="ukm",Ci="keyEncryptionAlgorithm",Ii="recipientEncryptedKeys",$c="recipientCertificate",Kc="recipientPublicKey",oA=[ki,Ei,Ds,Ci,Ii];class Dt extends ${constructor(e={}){super(),this.version=f(e,ki,Dt.defaultValues(ki)),this.originator=f(e,Ei,Dt.defaultValues(Ei)),Ds in e&&(this.ukm=f(e,Ds,Dt.defaultValues(Ds))),this.keyEncryptionAlgorithm=f(e,Ci,Dt.defaultValues(Ci)),this.recipientEncryptedKeys=f(e,Ii,Dt.defaultValues(Ii)),this.recipientCertificate=f(e,$c,Dt.defaultValues($c)),this.recipientPublicKey=f(e,Kc,Dt.defaultValues(Kc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ki:return 0;case Ei:return new zs;case Ds:return new J;case Ci:return new R;case Ii:return new ua;case $c:return new fe;case Kc:return null;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case ki:return t===0;case Ei:return t.variant===-1&&!("value"in t);case Ds:return t.isEqual(Dt.defaultValues(Ds));case Ci:return t.algorithmId===b&&!("algorithmParams"in t);case Ii:return t.encryptedKeys.length===0;case $c:return!1;case Kc:return!1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new P({idBlock:{tagClass:3,tagNumber:0},value:[zs.schema(t.originator||{})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new J({name:t.ukm||b})]}),R.schema(t.keyEncryptionAlgorithm||{}),ua.schema(t.recipientEncryptedKeys||{})]})}fromSchema(e){K(e,oA);const t=H(e,e,Dt.schema({names:{version:ki,originator:{names:{blockName:Ei}},ukm:Ds,keyEncryptionAlgorithm:{names:{blockName:Ci}},recipientEncryptedKeys:{names:{blockName:Ii}}}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.originator=new zs({schema:t.result.originator}),Ds in t.result&&(this.ukm=t.result.ukm),this.keyEncryptionAlgorithm=new R({schema:t.result.keyEncryptionAlgorithm}),this.recipientEncryptedKeys=new ua({schema:t.result.recipientEncryptedKeys})}toSchema(){const e=[];return e.push(new L({value:this.version})),e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[this.originator.toSchema()]})),this.ukm&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[this.ukm]})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.recipientEncryptedKeys.toSchema()),new C({value:e})}toJSON(){const e={version:this.version,originator:this.originator.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),recipientEncryptedKeys:this.recipientEncryptedKeys.toJSON()};return this.ukm&&(e.ukm=this.ukm.toJSON()),e}}Dt.CLASS_NAME="KeyAgreeRecipientInfo";const en="keyIdentifier",Br="date",Pr="other",lA=[en,Br,Pr];class ls extends ${constructor(e={}){super(),this.keyIdentifier=f(e,en,ls.defaultValues(en)),Br in e&&(this.date=f(e,Br,ls.defaultValues(Br))),Pr in e&&(this.other=f(e,Pr,ls.defaultValues(Pr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case en:return new J;case Br:return new xe;case Pr:return new hs;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case en:return t.isEqual(ls.defaultValues(en));case Br:return t.year===0&&t.month===0&&t.day===0&&t.hour===0&&t.minute===0&&t.second===0&&t.millisecond===0;case Pr:return t.compareWithDefault("keyAttrId",t.keyAttrId)&&!("keyAttr"in t);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new J({name:t.keyIdentifier||b}),new xe({optional:!0,name:t.date||b}),hs.schema(t.other||{})]})}fromSchema(e){K(e,lA);const t=H(e,e,ls.schema({names:{keyIdentifier:en,date:Br,other:{names:{blockName:Pr}}}}));U.assertSchema(t,this.className),this.keyIdentifier=t.result.keyIdentifier,Br in t.result&&(this.date=t.result.date),Pr in t.result&&(this.other=new hs({schema:t.result.other}))}toSchema(){const e=[];return e.push(this.keyIdentifier),this.date&&e.push(this.date),this.other&&e.push(this.other.toSchema()),new C({value:e})}toJSON(){const e={keyIdentifier:this.keyIdentifier.toJSON()};return this.date&&(e.date=this.date),this.other&&(e.other=this.other.toJSON()),e}}ls.CLASS_NAME="KEKIdentifier";const Vi="version",xi="kekid",Bi="keyEncryptionAlgorithm",tn="encryptedKey",Hc="preDefinedKEK",uA=[Vi,xi,Bi,tn];class $t extends ${constructor(e={}){super(),this.version=f(e,Vi,$t.defaultValues(Vi)),this.kekid=f(e,xi,$t.defaultValues(xi)),this.keyEncryptionAlgorithm=f(e,Bi,$t.defaultValues(Bi)),this.encryptedKey=f(e,tn,$t.defaultValues(tn)),this.preDefinedKEK=f(e,Hc,$t.defaultValues(Hc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Vi:return 0;case xi:return new ls;case Bi:return new R;case tn:return new J;case Hc:return Ke;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"KEKRecipientInfo":return t===$t.defaultValues(Vi);case xi:return t.compareWithDefault("keyIdentifier",t.keyIdentifier)&&!("date"in t)&&!("other"in t);case Bi:return t.algorithmId===b&&!("algorithmParams"in t);case tn:return t.isEqual($t.defaultValues(tn));case Hc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),ls.schema(t.kekid||{}),R.schema(t.keyEncryptionAlgorithm||{}),new J({name:t.encryptedKey||b})]})}fromSchema(e){K(e,uA);const t=H(e,e,$t.schema({names:{version:Vi,kekid:{names:{blockName:xi}},keyEncryptionAlgorithm:{names:{blockName:Bi}},encryptedKey:tn}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.kekid=new ls({schema:t.result.kekid}),this.keyEncryptionAlgorithm=new R({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){return new C({value:[new L({value:this.version}),this.kekid.toSchema(),this.keyEncryptionAlgorithm.toSchema(),this.encryptedKey]})}toJSON(){return{version:this.version,kekid:this.kekid.toJSON(),keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()}}}$t.CLASS_NAME="KEKRecipientInfo";const Pi="version",Or="keyDerivationAlgorithm",Oi="keyEncryptionAlgorithm",sn="encryptedKey",Mc="password",cA=[Pi,Or,Oi,sn];class Xt extends ${constructor(e={}){super(),this.version=f(e,Pi,Xt.defaultValues(Pi)),Or in e&&(this.keyDerivationAlgorithm=f(e,Or,Xt.defaultValues(Or))),this.keyEncryptionAlgorithm=f(e,Oi,Xt.defaultValues(Oi)),this.encryptedKey=f(e,sn,Xt.defaultValues(sn)),this.password=f(e,Mc,Xt.defaultValues(Mc)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Pi:return-1;case Or:return new R;case Oi:return new R;case sn:return new J;case Mc:return Ke;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Pi:return t===-1;case Or:case Oi:return t.algorithmId===b&&!("algorithmParams"in t);case sn:return t.isEqual(Xt.defaultValues(sn));case Mc:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new P({name:t.keyDerivationAlgorithm||b,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:R.schema().valueBlock.value}),R.schema(t.keyEncryptionAlgorithm||{}),new J({name:t.encryptedKey||b})]})}fromSchema(e){K(e,cA);const t=H(e,e,Xt.schema({names:{version:Pi,keyDerivationAlgorithm:Or,keyEncryptionAlgorithm:{names:{blockName:Oi}},encryptedKey:sn}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Or in t.result&&(this.keyDerivationAlgorithm=new R({schema:new C({value:t.result.keyDerivationAlgorithm.valueBlock.value})})),this.keyEncryptionAlgorithm=new R({schema:t.result.keyEncryptionAlgorithm}),this.encryptedKey=t.result.encryptedKey}toSchema(){const e=[];return e.push(new L({value:this.version})),this.keyDerivationAlgorithm&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:this.keyDerivationAlgorithm.toSchema().valueBlock.value})),e.push(this.keyEncryptionAlgorithm.toSchema()),e.push(this.encryptedKey),new C({value:e})}toJSON(){const e={version:this.version,keyEncryptionAlgorithm:this.keyEncryptionAlgorithm.toJSON(),encryptedKey:this.encryptedKey.toJSON()};return this.keyDerivationAlgorithm&&(e.keyDerivationAlgorithm=this.keyDerivationAlgorithm.toJSON()),e}}Xt.CLASS_NAME="PasswordRecipientInfo";const Di="oriType",rn="oriValue",hA=[Di,rn];class na extends ${constructor(e={}){super(),this.oriType=f(e,Di,na.defaultValues(Di)),this.oriValue=f(e,rn,na.defaultValues(rn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Di:return b;case rn:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Di:return t===b;case rn:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.oriType||b}),new te({name:t.oriValue||b})]})}fromSchema(e){K(e,hA);const t=H(e,e,na.schema({names:{oriType:Di,oriValue:rn}}));U.assertSchema(t,this.className),this.oriType=t.result.oriType.valueBlock.toString(),this.oriValue=t.result.oriValue}toSchema(){return new C({value:[new z({value:this.oriType}),this.oriValue]})}toJSON(){const e={oriType:this.oriType};return na.compareWithDefault(rn,this.oriValue)||(e.oriValue=this.oriValue.toJSON()),e}}na.CLASS_NAME="OtherRecipientInfo";const Fc="variant",Yo="value",mA=["blockName"];class Yt extends ${constructor(e={}){super(),this.variant=f(e,Fc,Yt.defaultValues(Fc)),Yo in e&&(this.value=f(e,Yo,Yt.defaultValues(Yo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fc:return-1;case Yo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Fc:return t===Yt.defaultValues(e);case Yo:return Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new Ve({value:[jt.schema({names:{blockName:t.blockName||b}}),new P({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:1},value:Dt.schema().valueBlock.value}),new P({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:2},value:$t.schema().valueBlock.value}),new P({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:3},value:Xt.schema().valueBlock.value}),new P({name:t.blockName||b,idBlock:{tagClass:3,tagNumber:4},value:na.schema().valueBlock.value})]})}fromSchema(e){K(e,mA);const t=H(e,e,Yt.schema({names:{blockName:"blockName"}}));if(U.assertSchema(t,this.className),t.result.blockName.idBlock.tagClass===1)this.variant=1,this.value=new jt({schema:t.result.blockName});else{const r=new C({value:t.result.blockName.valueBlock.value});switch(t.result.blockName.idBlock.tagNumber){case 1:this.variant=2,this.value=new Dt({schema:r});break;case 2:this.variant=3,this.value=new $t({schema:r});break;case 3:this.variant=4,this.value=new Xt({schema:r});break;case 4:this.variant=5,this.value=new na({schema:r});break;default:throw new Error("Incorrect structure of RecipientInfo block")}}}toSchema(){he.assertEmpty(this.value,"value","RecipientInfo");const e=this.value.toSchema();switch(this.variant){case 1:return e;case 2:case 3:case 4:return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.variant-1,e;default:return new te}}toJSON(){const e={variant:this.variant};return this.value&&this.variant>=1&&this.variant<=4&&(e.value=this.value.toJSON()),e}}Yt.CLASS_NAME="RecipientInfo";const Dr="hashAlgorithm",Tr="maskGenAlgorithm",Rr="pSourceAlgorithm",fA=[Dr,Tr,Rr];class At extends ${constructor(e={}){super(),this.hashAlgorithm=f(e,Dr,At.defaultValues(Dr)),this.maskGenAlgorithm=f(e,Tr,At.defaultValues(Tr)),this.pSourceAlgorithm=f(e,Rr,At.defaultValues(Rr)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Dr:return new R({algorithmId:"1.3.14.3.2.26",algorithmParams:new We});case Tr:return new R({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new R({algorithmId:"1.3.14.3.2.26",algorithmParams:new We}).toSchema()});case Rr:return new R({algorithmId:"1.2.840.113549.1.1.9",algorithmParams:new J({valueHex:new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer})});default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new P({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[R.schema(t.hashAlgorithm||{})]}),new P({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[R.schema(t.maskGenAlgorithm||{})]}),new P({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[R.schema(t.pSourceAlgorithm||{})]})]})}fromSchema(e){K(e,fA);const t=H(e,e,At.schema({names:{hashAlgorithm:{names:{blockName:Dr}},maskGenAlgorithm:{names:{blockName:Tr}},pSourceAlgorithm:{names:{blockName:Rr}}}}));U.assertSchema(t,this.className),Dr in t.result&&(this.hashAlgorithm=new R({schema:t.result.hashAlgorithm})),Tr in t.result&&(this.maskGenAlgorithm=new R({schema:t.result.maskGenAlgorithm})),Rr in t.result&&(this.pSourceAlgorithm=new R({schema:t.result.pSourceAlgorithm}))}toSchema(){const e=[];return this.hashAlgorithm.isEqual(At.defaultValues(Dr))||e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(At.defaultValues(Tr))||e.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.pSourceAlgorithm.isEqual(At.defaultValues(Rr))||e.push(new P({idBlock:{tagClass:3,tagNumber:2},value:[this.pSourceAlgorithm.toSchema()]})),new C({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(At.defaultValues(Dr))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(At.defaultValues(Tr))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.pSourceAlgorithm.isEqual(At.defaultValues(Rr))||(e.pSourceAlgorithm=this.pSourceAlgorithm.toJSON()),e}}At.CLASS_NAME="RSAESOAEPParams";const Ti="keyInfo",Lr="entityUInfo",Ri="suppPubInfo",dA=[Ti,Lr,Ri];class Ks extends ${constructor(e={}){super(),this.keyInfo=f(e,Ti,Ks.defaultValues(Ti)),Lr in e&&(this.entityUInfo=f(e,Lr,Ks.defaultValues(Lr))),this.suppPubInfo=f(e,Ri,Ks.defaultValues(Ri)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Ti:return new R;case Lr:return new J;case Ri:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Ti:case Lr:case Ri:return t.isEqual(Ks.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.keyInfo||{}),new P({name:t.entityUInfo||b,idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[new J]}),new P({name:t.suppPubInfo||b,idBlock:{tagClass:3,tagNumber:2},value:[new J]})]})}fromSchema(e){K(e,dA);const t=H(e,e,Ks.schema({names:{keyInfo:{names:{blockName:Ti}},entityUInfo:Lr,suppPubInfo:Ri}}));U.assertSchema(t,this.className),this.keyInfo=new R({schema:t.result.keyInfo}),Lr in t.result&&(this.entityUInfo=t.result.entityUInfo.valueBlock.value[0]),this.suppPubInfo=t.result.suppPubInfo.valueBlock.value[0]}toSchema(){const e=[];return e.push(this.keyInfo.toSchema()),this.entityUInfo&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[this.entityUInfo]})),e.push(new P({idBlock:{tagClass:3,tagNumber:2},value:[this.suppPubInfo]})),new C({value:e})}toJSON(){const e={keyInfo:this.keyInfo.toJSON(),suppPubInfo:this.suppPubInfo.toJSON()};return this.entityUInfo&&(e.entityUInfo=this.entityUInfo.toJSON()),e}}Ks.CLASS_NAME="ECCCMSSharedInfo";const Li="version",Ur="originatorInfo",Ui="recipientInfos",ji="encryptedContentInfo",jr="unprotectedAttrs",pA=[Li,Ur,Ui,ji,jr],Yp={kdfAlgorithm:"SHA-512",kekEncryptionLength:256},gA={"P-256":256,"P-384":384,"P-521":528};class is extends ${constructor(e={}){super(),this.version=f(e,Li,is.defaultValues(Li)),Ur in e&&(this.originatorInfo=f(e,Ur,is.defaultValues(Ur))),this.recipientInfos=f(e,Ui,is.defaultValues(Ui)),this.encryptedContentInfo=f(e,ji,is.defaultValues(ji)),jr in e&&(this.unprotectedAttrs=f(e,jr,is.defaultValues(jr))),this.policy={disableSplit:!!e.disableSplit},e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Li:return 0;case Ur:return new Rn;case Ui:return[];case ji:return new Re;case jr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Li:return t===is.defaultValues(e);case Ur:return t.certs.certificates.length===0&&t.crls.crls.length===0;case Ui:case jr:return t.length===0;case ji:return Re.compareWithDefault("contentType",t.contentType)&&Re.compareWithDefault("contentEncryptionAlgorithm",t.contentEncryptionAlgorithm)&&Re.compareWithDefault("encryptedContent",t.encryptedContent);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||b}),new P({name:t.originatorInfo||b,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Rn.schema().valueBlock.value}),new _e({value:[new se({name:t.recipientInfos||b,value:Yt.schema()})]}),Re.schema(t.encryptedContentInfo||{}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new se({name:t.unprotectedAttrs||b,value:Ae.schema()})]})]})}fromSchema(e){K(e,pA);const t=H(e,e,is.schema({names:{version:Li,originatorInfo:Ur,recipientInfos:Ui,encryptedContentInfo:{names:{blockName:ji}},unprotectedAttrs:jr}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,Ur in t.result&&(this.originatorInfo=new Rn({schema:new C({value:t.result.originatorInfo.valueBlock.value})})),this.recipientInfos=Array.from(t.result.recipientInfos,r=>new Yt({schema:r})),this.encryptedContentInfo=new Re({schema:t.result.encryptedContentInfo}),jr in t.result&&(this.unprotectedAttrs=Array.from(t.result.unprotectedAttrs,r=>new Ae({schema:r})))}toSchema(){const e=[];return e.push(new L({value:this.version})),this.originatorInfo&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:this.originatorInfo.toSchema().valueBlock.value})),e.push(new _e({value:Array.from(this.recipientInfos,t=>t.toSchema())})),e.push(this.encryptedContentInfo.toSchema()),this.unprotectedAttrs&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.unprotectedAttrs,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={version:this.version,recipientInfos:Array.from(this.recipientInfos,t=>t.toJSON()),encryptedContentInfo:this.encryptedContentInfo.toJSON()};return this.originatorInfo&&(e.originatorInfo=this.originatorInfo.toJSON()),this.unprotectedAttrs&&(e.unprotectedAttrs=Array.from(this.unprotectedAttrs,t=>t.toJSON())),e}addRecipientByCertificate(e,t,r,a=ne(!0)){const n=Object.assign({useOAEP:!0,oaepHashAlgorithm:"SHA-512"},Yp,t||{});if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.113549")!==-1)r=1;else if(e.subjectPublicKeyInfo.algorithm.algorithmId.indexOf("1.2.840.10045")!==-1)r=2;else throw new Error("Unknown type of certificate's public key: ".concat(e.subjectPublicKeyInfo.algorithm.algorithmId));switch(r){case 1:{let o,i;if(n.useOAEP===!0){o=a.getOIDByAlgorithm({name:"RSA-OAEP"},!0,"keyEncryptionAlgorithm");const c=a.getOIDByAlgorithm({name:n.oaepHashAlgorithm},!0,"RSAES-OAEP-params"),l=new R({algorithmId:c,algorithmParams:new We});i=new At({hashAlgorithm:l,maskGenAlgorithm:new R({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:l.toSchema()})}).toSchema()}else{if(o=a.getOIDByAlgorithm({name:"RSAES-PKCS1-v1_5"}),o===b)throw new Error("Can not find OID for RSAES-PKCS1-v1_5");i=new We}const u=new jt({version:0,rid:new Me({issuer:e.issuer,serialNumber:e.serialNumber}),keyEncryptionAlgorithm:new R({algorithmId:o,algorithmParams:i}),recipientCertificate:e});this.recipientInfos.push(new Yt({variant:1,value:u}))}break;case 2:{const o=new As({variant:1,value:new Me({issuer:e.issuer,serialNumber:e.serialNumber})});this._addKeyAgreeRecipientInfo(o,n,{recipientCertificate:e},a)}break;default:throw new Error('Unknown "variant" value: '.concat(r))}return!0}addRecipientByPreDefinedData(e,t={},r,a=ne(!0)){if(ge.assert(e,"preDefinedData","ArrayBuffer"),!e.byteLength)throw new Error("Pre-defined data could have zero length");if(!t.keyIdentifier){const n=new ArrayBuffer(16),o=new Uint8Array(n);a.getRandomValues(o),t.keyIdentifier=n}switch(t.hmacHashAlgorithm||(t.hmacHashAlgorithm="SHA-512"),t.iterationCount===void 0&&(t.iterationCount=2048),t.keyEncryptionAlgorithm||(t.keyEncryptionAlgorithm={name:"AES-KW",length:256}),t.keyEncryptionAlgorithmParams||(t.keyEncryptionAlgorithmParams=new We),r){case 1:{const n=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),o=new $t({version:4,kekid:new ls({keyIdentifier:new J({valueHex:t.keyIdentifier})}),keyEncryptionAlgorithm:new R({algorithmId:n,algorithmParams:t.keyEncryptionAlgorithmParams}),preDefinedKEK:e});this.recipientInfos.push(new Yt({variant:3,value:o}))}break;case 2:{const n=a.getOIDByAlgorithm({name:"PBKDF2"},!0,"keyDerivationAlgorithm"),o=new ArrayBuffer(64),i=new Uint8Array(o);a.getRandomValues(i);const u=a.getOIDByAlgorithm({name:"HMAC",hash:{name:t.hmacHashAlgorithm}},!0,"hmacHashAlgorithm"),c=new gt({salt:new J({valueHex:o}),iterationCount:t.iterationCount,prf:new R({algorithmId:u,algorithmParams:new We})}),l=a.getOIDByAlgorithm(t.keyEncryptionAlgorithm,!0,"keyEncryptionAlgorithm"),m=new Xt({version:0,keyDerivationAlgorithm:new R({algorithmId:n,algorithmParams:c.toSchema()}),keyEncryptionAlgorithm:new R({algorithmId:l,algorithmParams:t.keyEncryptionAlgorithmParams}),password:e});this.recipientInfos.push(new Yt({variant:4,value:m}))}break;default:throw new Error('Unknown value for "variant": '.concat(r))}}addRecipientByKeyIdentifier(e,t,r,a=ne(!0)){const n=Object.assign({},Yp,r||{}),o=new As({variant:2,value:new ys({subjectKeyIdentifier:new J({valueHex:t})})});this._addKeyAgreeRecipientInfo(o,n,{recipientPublicKey:e},a)}_addKeyAgreeRecipientInfo(e,t,r,a=ne(!0)){const n=new _s({rid:e}),o=a.getOIDByAlgorithm({name:"AES-KW",length:t.kekEncryptionLength},!0,"keyEncryptionAlgorithm"),i=new R({algorithmId:o}),u=a.getOIDByAlgorithm({name:"ECDH",kdf:t.kdfAlgorithm},!0,"KeyAgreeRecipientInfo"),c=new ArrayBuffer(64),l=new Uint8Array(c);a.getRandomValues(l);const m={version:3,ukm:new J({valueHex:c}),keyEncryptionAlgorithm:new R({algorithmId:u,algorithmParams:i.toSchema()}),recipientEncryptedKeys:new ua({encryptedKeys:[n]})},h=new Dt(Object.assign(m,r));this.recipientInfos.push(new Yt({variant:2,value:h}))}async encrypt(e,t,r=ne(!0)){const a=new ArrayBuffer(16),n=new Uint8Array(a);r.getRandomValues(n);const o=new Uint8Array(t),i=r.getOIDByAlgorithm(e,!0,"contentEncryptionAlgorithm"),u=await r.generateKey(e,!0,["encrypt"]),c=await r.encrypt({name:e.name,iv:n},u,o),l=await r.exportKey("raw",u);this.version=2,this.encryptedContentInfo=new Re({disableSplit:this.policy.disableSplit,contentType:"1.2.840.113549.1.7.1",contentEncryptionAlgorithm:new R({algorithmId:i,algorithmParams:new J({valueHex:a})}),encryptedContent:new J({valueHex:c})});const m=async p=>{const E=this.recipientInfos[p].value;let y,S;if(E.recipientPublicKey)y=E.recipientPublicKey.algorithm.namedCurve,S=E.recipientPublicKey;else if(E.recipientCertificate){const Q=E.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(Q.constructor.blockName()!==z.blockName())throw new Error('Incorrect "recipientCertificate" for index '.concat(p));switch(Q.valueBlock.toString()){case"1.2.840.10045.3.1.7":y="P-256";break;case"1.3.132.0.34":y="P-384";break;case"1.3.132.0.35":y="P-521";break;default:throw new Error("Incorrect curve OID for index ".concat(p))}S=await E.recipientCertificate.getPublicKey({algorithm:{algorithm:{name:"ECDH",namedCurve:y},usages:[]}},r)}else throw new Error("Unsupported RecipientInfo");const N=gA[y],x=await r.generateKey({name:"ECDH",namedCurve:y},!0,["deriveBits"]),I=await r.exportKey("spki",x.publicKey),D=await r.deriveBits({name:"ECDH",public:S},x.privateKey,N),V=new R({schema:E.keyEncryptionAlgorithm.algorithmParams}),k=r.getAlgorithmByOID(V.algorithmId,!0,"aesKWAlgorithm");let M=k.length;const j=new ArrayBuffer(4),F=new Uint8Array(j);for(let Q=3;Q>=0;Q--)F[Q]=M,M>>=8;const T=new Ks({keyInfo:new R({algorithmId:V.algorithmId}),entityUInfo:E.ukm,suppPubInfo:new J({valueHex:j})}).toSchema().toBER(!1),Y=r.getAlgorithmByOID(E.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm"),_=await jp(Y.kdf,D,k.length,T,r),ie=await r.importKey("raw",_,{name:"AES-KW"},!0,["wrapKey"]),Z=await r.wrapKey("raw",u,ie,{name:"AES-KW"}),me=new zs;return me.variant=3,me.value=Ws.fromBER(I),E.originator=me,E.recipientEncryptedKeys.encryptedKeys[0].encryptedKey=new J({valueHex:Z}),{ecdhPrivateKey:x.privateKey}},h=async p=>{const E=this.recipientInfos[p].value,y=r.getAlgorithmByOID(E.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(y.name==="RSA-OAEP"){const S=E.keyEncryptionAlgorithm.algorithmParams,N=new At({schema:S});if(y.hash=r.getAlgorithmByOID(N.hashAlgorithm.algorithmId),!("name"in y.hash))throw new Error("Incorrect OID for hash algorithm: ".concat(N.hashAlgorithm.algorithmId))}try{const S=await E.recipientCertificate.getPublicKey({algorithm:{algorithm:y,usages:["encrypt","wrapKey"]}},r),N=await r.encrypt(S.algorithm,S,l);E.encryptedKey=new J({valueHex:N})}catch(S){}},g=async p=>{const E=this.recipientInfos[p].value,y=r.getAlgorithmByOID(E.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),S=await r.importKey("raw",new Uint8Array(E.preDefinedKEK),y,!0,["wrapKey"]),N=await r.wrapKey("raw",u,S,y);E.encryptedKey=new J({valueHex:N})},w=async p=>{const E=this.recipientInfos[p].value;let y;if(!E.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!E.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{y=new gt({schema:E.keyDerivationAlgorithm.algorithmParams})}catch(j){throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const S=new Uint8Array(E.password),N=await r.importKey("raw",S,"PBKDF2",!1,["deriveKey"]),x=r.getAlgorithmByOID(E.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm");let I="SHA-1";y.prf&&(I=r.getAlgorithmByOID(y.prf.algorithmId,!0,"prfAlgorithm").hash.name);const D=new Uint8Array(y.salt.valueBlock.valueHex),V=y.iterationCount,k=await r.deriveKey({name:"PBKDF2",hash:{name:I},salt:D,iterations:V},N,x,!0,["wrapKey"]),M=await r.wrapKey("raw",u,k,x);E.encryptedKey=new J({valueHex:M})},d=[];for(let p=0;p<this.recipientInfos.length;p++)switch(this.recipientInfos[p].variant){case 1:d.push(await h(p));break;case 2:d.push(await m(p));break;case 3:d.push(await g(p));break;case 4:d.push(await w(p));break;default:throw new Error("Unknown recipient type in array with index ".concat(p))}return d}async decrypt(e,t,r=ne(!0)){const a=t||{};if(e+1>this.recipientInfos.length)throw new Error('Maximum value for "index" is: '.concat(this.recipientInfos.length-1));const n=async d=>{const p=this.recipientInfos[d].value;let E,y,S;const N=p.originator;if(a.recipientCertificate){const _=a.recipientCertificate.subjectPublicKeyInfo.algorithm.algorithmParams;if(_.constructor.blockName()!==z.blockName())throw new Error('Incorrect "recipientCertificate" for index '.concat(d));E=_.valueBlock.toString()}else if(N.value.algorithm.algorithmParams){const _=N.value.algorithm.algorithmParams;if(_.constructor.blockName()!==z.blockName())throw new Error("Incorrect originator for index ".concat(d));E=_.valueBlock.toString()}else throw new Error('Parameter "recipientCertificate" is mandatory for "KeyAgreeRecipientInfo" if algorithm params are missing from originator');if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyAgreeRecipientInfo"');switch(E){case"1.2.840.10045.3.1.7":y="P-256",S=256;break;case"1.3.132.0.34":y="P-384",S=384;break;case"1.3.132.0.35":y="P-521",S=528;break;default:throw new Error("Incorrect curve OID for index ".concat(d))}let x,I=r;Se.isBufferSource(a.recipientPrivateKey)?x=await r.importKey("pkcs8",a.recipientPrivateKey,{name:"ECDH",namedCurve:y},!0,["deriveBits"]):(x=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(I=a.crypto.subtle)),"algorithmParams"in N.value.algorithm||(N.value.algorithm.algorithmParams=new z({value:E}));const D=N.value.toSchema().toBER(!1),V=await r.importKey("spki",D,{name:"ECDH",namedCurve:y},!0,[]),k=await I.deriveBits({name:"ECDH",public:V},x,S);async function M(_){_=_||!1;const ie=new R({schema:p.keyEncryptionAlgorithm.algorithmParams}),Z=r.getAlgorithmByOID(ie.algorithmId,!0,"kwAlgorithm");let me=Z.length;const Q=new ArrayBuffer(4),X=new Uint8Array(Q);for(let le=3;le>=0;le--)X[le]=me,me>>=8;const G={algorithmId:ie.algorithmId};_&&(G.algorithmParams=new We);const W=new Ks({keyInfo:new R(G),entityUInfo:p.ukm,suppPubInfo:new J({valueHex:Q})}).toSchema().toBER(!1),re=r.getAlgorithmByOID(p.keyEncryptionAlgorithm.algorithmId,!0,"ecdhAlgorithm");if(!re.name)throw new Error("Incorrect OID for key encryption algorithm: ".concat(p.keyEncryptionAlgorithm.algorithmId));return jp(re.kdf,k,Z.length,W,r)}const j=await M(),F=async _=>r.importKey("raw",_,{name:"AES-KW"},!0,["unwrapKey"]),T=await F(j),Y=async _=>{const ie=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,Z=r.getAlgorithmByOID(ie,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",p.recipientEncryptedKeys.encryptedKeys[0].encryptedKey.valueBlock.valueHexView,_,{name:"AES-KW"},Z,!0,["decrypt"])};try{return await Y(T)}catch(_){const ie=await M(!0),Z=await F(ie);return Y(Z)}},o=async d=>{const p=this.recipientInfos[d].value;if(!a.recipientPrivateKey)throw new Error('Parameter "recipientPrivateKey" is mandatory for "KeyTransRecipientInfo"');const E=r.getAlgorithmByOID(p.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm");if(E.name==="RSA-OAEP"){const D=p.keyEncryptionAlgorithm.algorithmParams,V=new At({schema:D});if(E.hash=r.getAlgorithmByOID(V.hashAlgorithm.algorithmId),!("name"in E.hash))throw new Error("Incorrect OID for hash algorithm: ".concat(V.hashAlgorithm.algorithmId))}let y,S=r;Se.isBufferSource(a.recipientPrivateKey)?y=await r.importKey("pkcs8",a.recipientPrivateKey,E,!0,["decrypt"]):(y=a.recipientPrivateKey,"crypto"in a&&a.crypto&&(S=a.crypto.subtle));const N=await S.decrypt(y.algorithm,y,p.encryptedKey.valueBlock.valueHexView),x=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,I=r.getAlgorithmByOID(x,!0,"contentEncryptionAlgorithm");if(!("name"in I))throw new Error('Incorrect "contentEncryptionAlgorithm": '.concat(x));return r.importKey("raw",N,I,!0,["decrypt"])},i=async d=>{const p=this.recipientInfos[d].value;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');const E=r.getAlgorithmByOID(p.keyEncryptionAlgorithm.algorithmId,!0,"kekAlgorithm"),y=await r.importKey("raw",a.preDefinedData,E,!0,["unwrapKey"]),S=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,N=r.getAlgorithmByOID(S,!0,"contentEncryptionAlgorithm");if(!N.name)throw new Error('Incorrect "contentEncryptionAlgorithm": '.concat(S));return r.unwrapKey("raw",p.encryptedKey.valueBlock.valueHexView,y,E,N,!0,["decrypt"])},u=async d=>{const p=this.recipientInfos[d].value;let E;if(!a.preDefinedData)throw new Error('Parameter "preDefinedData" is mandatory for "KEKRecipientInfo"');if(!p.keyDerivationAlgorithm)throw new Error('Please append encoded "keyDerivationAlgorithm"');if(!p.keyDerivationAlgorithm.algorithmParams)throw new Error('Incorrectly encoded "keyDerivationAlgorithm"');try{E=new gt({schema:p.keyDerivationAlgorithm.algorithmParams})}catch(M){throw new Error('Incorrectly encoded "keyDerivationAlgorithm"')}const y=await r.importKey("raw",a.preDefinedData,"PBKDF2",!1,["deriveKey"]),S=r.getAlgorithmByOID(p.keyEncryptionAlgorithm.algorithmId,!0,"keyEncryptionAlgorithm"),N=E.prf?r.getAlgorithmByOID(E.prf.algorithmId,!0,"prfAlgorithm").hash.name:"SHA-1",x=new Uint8Array(E.salt.valueBlock.valueHex),I=E.iterationCount,D=await r.deriveKey({name:"PBKDF2",hash:{name:N},salt:x,iterations:I},y,S,!0,["unwrapKey"]),V=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,k=r.getAlgorithmByOID(V,!0,"contentEncryptionAlgorithm");return r.unwrapKey("raw",p.encryptedKey.valueBlock.valueHexView,D,S,k,!0,["decrypt"])};let c;switch(this.recipientInfos[e].variant){case 1:c=await o(e);break;case 2:c=await n(e);break;case 3:c=await i(e);break;case 4:c=await u(e);break;default:throw new Error("Unknown recipient type in array with index ".concat(e))}const l=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId,m=r.getAlgorithmByOID(l,!0,"contentEncryptionAlgorithm"),h=this.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams.valueBlock.valueHex,g=new Uint8Array(h);if(!this.encryptedContentInfo.encryptedContent)throw new Error("Required property `encryptedContent` is empty");const w=this.encryptedContentInfo.getEncryptedContent();return r.decrypt({name:m.name,iv:g},c,w)}}is.CLASS_NAME="EnvelopedData";const qn="safeContents",Zo="parsedValue",Zp="contentInfos";class Ln extends ${constructor(e={}){super(),this.safeContents=f(e,qn,Ln.defaultValues(qn)),Zo in e&&(this.parsedValue=f(e,Zo,Ln.defaultValues(Zo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qn:return[];case Zo:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qn:return t.length===0;case Zo:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new se({name:t.contentInfos||b,value:ve.schema()})]})}fromSchema(e){K(e,[Zp]);const t=H(e,e,Ln.schema({names:{contentInfos:Zp}}));U.assertSchema(t,this.className),this.safeContents=Array.from(t.result.contentInfos,r=>new ve({schema:r}))}toSchema(){return new C({value:Array.from(this.safeContents,e=>e.toSchema())})}toJSON(){return{safeContents:Array.from(this.safeContents,e=>e.toJSON())}}async parseInternalValues(e,t=ne(!0)){if(he.assert(e,qn),ge.assert(e.safeContents,qn,"Array"),e.safeContents.length!==this.safeContents.length)throw new ge('Length of "parameters.safeContents" must be equal to "this.safeContents.length"');this.parsedValue={safeContents:[]};for(const[r,a]of this.safeContents.entries()){const n=e.safeContents[r],o="parameters.safeContents[".concat(r,"]");switch(a.contentType){case vd:{ge.assert(a.content,"this.safeContents[j].content",J);const i=a.content.getValue();this.parsedValue.safeContents.push({privacyMode:0,value:qs.fromBER(i)})}break;case pw:{const i=new is({schema:a.content});he.assert(o,n,"recipientCertificate","recipientKey");const u=n,c=u.recipientCertificate,l=u.recipientKey,m=await i.decrypt(0,{recipientCertificate:c,recipientPrivateKey:l},t);this.parsedValue.safeContents.push({privacyMode:2,value:qs.fromBER(m)})}break;case gw:{const i=new bs({schema:a.content});he.assert(o,n,"password");const u=n.password,c=await i.decrypt({password:u},t);this.parsedValue.safeContents.push({privacyMode:1,value:qs.fromBER(c)})}break;default:throw new Error('Unknown "contentType" for AuthenticatedSafe: " '.concat(a.contentType))}}}async makeInternalValues(e,t=ne(!0)){if(!this.parsedValue)throw new Error('Please run "parseValues" first or add "parsedValue" manually');if(ge.assert(this.parsedValue,"this.parsedValue","object"),ge.assert(this.parsedValue.safeContents,"this.parsedValue.safeContents","Array"),ge.assert(e,"parameters","object"),he.assert(e,"safeContents"),ge.assert(e.safeContents,"parameters.safeContents","Array"),e.safeContents.length!==this.parsedValue.safeContents.length)throw new ge('Length of "parameters.safeContents" must be equal to "this.parsedValue.safeContents"');this.safeContents=[];for(const[r,a]of this.parsedValue.safeContents.entries())switch(he.assert("content",a,"privacyMode","value"),ge.assert(a.value,"content.value",qs),a.privacyMode){case 0:{const n=a.value.toSchema().toBER(!1);this.safeContents.push(new ve({contentType:"1.2.840.113549.1.7.1",content:new J({valueHex:n})}))}break;case 1:{const n=new bs,o=e.safeContents[r];o.contentToEncrypt=a.value.toSchema().toBER(!1),await n.encrypt(o,t),this.safeContents.push(new ve({contentType:"1.2.840.113549.1.7.6",content:n.toSchema()}))}break;case 2:{const n=new is,o=a.value.toSchema().toBER(!1),i=e.safeContents[r];switch(he.assert("parameters.safeContents[".concat(r,"]"),i,"encryptingCertificate","encryptionAlgorithm"),!0){case i.encryptionAlgorithm.name.toLowerCase()==="aes-cbc":case i.encryptionAlgorithm.name.toLowerCase()==="aes-gcm":break;default:throw new Error('Incorrect parameter "encryptionAlgorithm" in "parameters.safeContents[i]": '.concat(i.encryptionAlgorithm))}switch(!0){case i.encryptionAlgorithm.length===128:case i.encryptionAlgorithm.length===192:case i.encryptionAlgorithm.length===256:break;default:throw new Error('Incorrect parameter "encryptionAlgorithm.length" in "parameters.safeContents[i]": '.concat(i.encryptionAlgorithm.length))}const u=i.encryptionAlgorithm;n.addRecipientByCertificate(i.encryptingCertificate,{},void 0,t),await n.encrypt(u,o,t),this.safeContents.push(new ve({contentType:"1.2.840.113549.1.7.3",content:n.toSchema()}))}break;default:throw new Error('Incorrect value for "content.privacyMode": '.concat(a.privacyMode))}return this}}Ln.CLASS_NAME="AuthenticatedSafe";const an="hashAlgorithm",$i="issuerNameHash",Ki="issuerKeyHash",nn="serialNumber",wA=[an,$i,Ki,nn];class Ue extends ${static async create(e,t,r=ne(!0)){const a=new Ue;return await a.createForCertificate(e,t,r),a}constructor(e={}){super(),this.hashAlgorithm=f(e,an,Ue.defaultValues(an)),this.issuerNameHash=f(e,$i,Ue.defaultValues($i)),this.issuerKeyHash=f(e,Ki,Ue.defaultValues(Ki)),this.serialNumber=f(e,nn,Ue.defaultValues(nn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case an:return new R;case $i:case Ki:return new J;case nn:return new L;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case an:return t.algorithmId===b&&!("algorithmParams"in t);case $i:case Ki:case nn:return t.isEqual(Ue.defaultValues(nn));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.hashAlgorithmObject||{names:{blockName:t.hashAlgorithm||b}}),new J({name:t.issuerNameHash||b}),new J({name:t.issuerKeyHash||b}),new L({name:t.serialNumber||b})]})}fromSchema(e){K(e,wA);const t=H(e,e,Ue.schema({names:{hashAlgorithm:an,issuerNameHash:$i,issuerKeyHash:Ki,serialNumber:nn}}));U.assertSchema(t,this.className),this.hashAlgorithm=new R({schema:t.result.hashAlgorithm}),this.issuerNameHash=t.result.issuerNameHash,this.issuerKeyHash=t.result.issuerKeyHash,this.serialNumber=t.result.serialNumber}toSchema(){return new C({value:[this.hashAlgorithm.toSchema(),this.issuerNameHash,this.issuerKeyHash,this.serialNumber]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),issuerNameHash:this.issuerNameHash.toJSON(),issuerKeyHash:this.issuerKeyHash.toJSON(),serialNumber:this.serialNumber.toJSON()}}isEqual(e){return!(this.hashAlgorithm.algorithmId!==e.hashAlgorithm.algorithmId||!Se.isEqual(this.issuerNameHash.valueBlock.valueHexView,e.issuerNameHash.valueBlock.valueHexView)||!Se.isEqual(this.issuerKeyHash.valueBlock.valueHexView,e.issuerKeyHash.valueBlock.valueHexView)||!this.serialNumber.isEqual(e.serialNumber))}async createForCertificate(e,t,r=ne(!0)){he.assert(t,an,"issuerCertificate");const a=r.getOIDByAlgorithm({name:t.hashAlgorithm},!0,"hashAlgorithm");this.hashAlgorithm=new R({algorithmId:a,algorithmParams:new We});const n=t.issuerCertificate;this.serialNumber=e.serialNumber;const o=await r.digest({name:t.hashAlgorithm},n.subject.toSchema().toBER(!1));this.issuerNameHash=new J({valueHex:o});const i=n.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView,u=await r.digest({name:t.hashAlgorithm},i);this.issuerKeyHash=new J({valueHex:u})}}Ue.CLASS_NAME="CertID";const Hi="certID",Mi="certStatus",Fi="thisUpdate",$r="nextUpdate",on="singleExtensions",yA=[Hi,Mi,Fi,$r,on];class os extends ${constructor(e={}){super(),this.certID=f(e,Hi,os.defaultValues(Hi)),this.certStatus=f(e,Mi,os.defaultValues(Mi)),this.thisUpdate=f(e,Fi,os.defaultValues(Fi)),$r in e&&(this.nextUpdate=f(e,$r,os.defaultValues($r))),on in e&&(this.singleExtensions=f(e,on,os.defaultValues(on))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Hi:return new Ue;case Mi:return{};case Fi:case $r:return new Date(0,0,0);case on:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Hi:return Ue.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&Ue.compareWithDefault("issuerNameHash",t.issuerNameHash)&&Ue.compareWithDefault("issuerKeyHash",t.issuerKeyHash)&&Ue.compareWithDefault("serialNumber",t.serialNumber);case Mi:return Object.keys(t).length===0;case Fi:case $r:return t===os.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[Ue.schema(t.certID||{}),new Ve({value:[new ee({name:t.certStatus||b,idBlock:{tagClass:3,tagNumber:0}}),new P({name:t.certStatus||b,idBlock:{tagClass:3,tagNumber:1},value:[new xe,new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new nc]})]}),new ee({name:t.certStatus||b,idBlock:{tagClass:3,tagNumber:2},lenBlock:{length:1}})]}),new xe({name:t.thisUpdate||b}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new xe({name:t.nextUpdate||b})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[He.schema(t.singleExtensions||{})]})]})}fromSchema(e){K(e,yA);const t=H(e,e,os.schema({names:{certID:{names:{blockName:Hi}},certStatus:Mi,thisUpdate:Fi,nextUpdate:$r,singleExtensions:{names:{blockName:on}}}}));U.assertSchema(t,this.className),this.certID=new Ue({schema:t.result.certID}),this.certStatus=t.result.certStatus,this.thisUpdate=t.result.thisUpdate.toDate(),$r in t.result&&(this.nextUpdate=t.result.nextUpdate.toDate()),on in t.result&&(this.singleExtensions=Array.from(t.result.singleExtensions.valueBlock.value,r=>new Le({schema:r})))}toSchema(){const e=[];return e.push(this.certID.toSchema()),e.push(this.certStatus),e.push(new xe({valueDate:this.thisUpdate})),this.nextUpdate&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[new xe({valueDate:this.nextUpdate})]})),this.singleExtensions&&e.push(new C({value:Array.from(this.singleExtensions,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={certID:this.certID.toJSON(),certStatus:this.certStatus.toJSON(),thisUpdate:this.thisUpdate};return this.nextUpdate&&(e.nextUpdate=this.nextUpdate),this.singleExtensions&&(e.singleExtensions=Array.from(this.singleExtensions,t=>t.toJSON())),e}}os.CLASS_NAME="SingleResponse";const Jc="tbs",ln="version",Du="responderID",Tu="producedAt",Ru="responses",Ji="responseExtensions",$n="ResponseData",ih="".concat($n,".").concat(ln),qi="".concat($n,".").concat(Du),Of="".concat($n,".").concat(Tu),Df="".concat($n,".").concat(Ru),oh="".concat($n,".").concat(Ji),vA=[$n,ih,qi,Of,Df,oh];class Ye extends ${get tbs(){return Se.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(f(e,Jc,Ye.defaultValues(Jc))),ln in e&&(this.version=f(e,ln,Ye.defaultValues(ln))),this.responderID=f(e,Du,Ye.defaultValues(Du)),this.producedAt=f(e,Tu,Ye.defaultValues(Tu)),this.responses=f(e,Ru,Ye.defaultValues(Ru)),Ji in e&&(this.responseExtensions=f(e,Ji,Ye.defaultValues(Ji))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case ln:return 0;case Jc:return Ke;case Du:return{};case Tu:return new Date(0,0,0);case Ru:case Ji:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Jc:return t.byteLength===0;case Du:return Object.keys(t).length===0;case Tu:return t===Ye.defaultValues(e);case Ru:case Ji:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||$n,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new L({name:t.version||ih})]}),new Ve({value:[new P({name:t.responderID||qi,idBlock:{tagClass:3,tagNumber:1},value:[we.schema(t.ResponseDataByName||{names:{blockName:"ResponseData.byName"}})]}),new P({name:t.responderID||qi,idBlock:{tagClass:3,tagNumber:2},value:[new J({name:t.ResponseDataByKey||"ResponseData.byKey"})]})]}),new xe({name:t.producedAt||Of}),new C({value:[new se({name:Df,value:os.schema(t.response||{})})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[He.schema(t.extensions||{names:{blockName:oh}})]})]})}fromSchema(e){K(e,vA);const t=H(e,e,Ye.schema());U.assertSchema(t,this.className),this.tbsView=t.result.ResponseData.valueBeforeDecodeView,ih in t.result&&(this.version=t.result[ih].valueBlock.valueDec),t.result[qi].idBlock.tagNumber===1?this.responderID=new we({schema:t.result[qi].valueBlock.value[0]}):this.responderID=t.result[qi].valueBlock.value[0],this.producedAt=t.result[Of].toDate(),this.responses=Array.from(t.result[Df],r=>new os({schema:r})),oh in t.result&&(this.responseExtensions=Array.from(t.result[oh].valueBlock.value,r=>new Le({schema:r})))}toSchema(e=!1){let t;if(e===!1){if(!this.tbsView.byteLength)return Ye.schema();const r=$e(this.tbsView);U.assert(r,"TBS Response Data"),t=r.result}else{const r=[];ln in this&&r.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[new L({value:this.version})]})),this.responderID instanceof we?r.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[this.responderID.toSchema()]})):r.push(new P({idBlock:{tagClass:3,tagNumber:2},value:[this.responderID]})),r.push(new xe({valueDate:this.producedAt})),r.push(new C({value:Array.from(this.responses,a=>a.toSchema())})),this.responseExtensions&&r.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[new C({value:Array.from(this.responseExtensions,a=>a.toSchema())})]})),t=new C({value:r})}return t}toJSON(){const e={};return ln in this&&(e.version=this.version),this.responderID&&(e.responderID=this.responderID),this.producedAt&&(e.producedAt=this.producedAt),this.responses&&(e.responses=Array.from(this.responses,t=>t.toJSON())),this.responseExtensions&&(e.responseExtensions=Array.from(this.responseExtensions,t=>t.toJSON())),e}}Ye.CLASS_NAME="ResponseData";const zm="trustedCerts",Ym="certs",Zm="crls",Qm="ocsps",ef="checkDate",tf="findOrigin",sf="findIssuer";var yn;(function(s){s[s.unknown=-1]="unknown",s[s.success=0]="success",s[s.noRevocation=11]="noRevocation",s[s.noPath=60]="noPath",s[s.noValidPath=97]="noValidPath"})(yn||(yn={}));class zr extends Error{constructor(e,t){super(t),this.name=zr.NAME,this.code=e,this.message=t}}zr.NAME="ChainValidationError";function bA(s,e){for(let t=0;t<e.length;t++)if(Se.isEqual(s.tbsView,e[t].tbsView))return!0;return!1}class am{constructor(e={}){this.trustedCerts=f(e,zm,this.defaultValues(zm)),this.certs=f(e,Ym,this.defaultValues(Ym)),this.crls=f(e,Zm,this.defaultValues(Zm)),this.ocsps=f(e,Qm,this.defaultValues(Qm)),this.checkDate=f(e,ef,this.defaultValues(ef)),this.findOrigin=f(e,tf,this.defaultValues(tf)),this.findIssuer=f(e,sf,this.defaultValues(sf))}static defaultFindOrigin(e,t){e.tbsView.byteLength===0&&(e.tbsView=new Uint8Array(e.encodeTBS().toBER()));for(const r of t.certs)if(r.tbsView.byteLength===0&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER())),Se.isEqual(e.tbsView,r.tbsView))return"Intermediate Certificates";for(const r of t.trustedCerts)if(r.tbsView.byteLength===0&&(r.tbsView=new Uint8Array(r.encodeTBS().toBER())),Se.isEqual(e.tbsView,r.tbsView))return"Trusted Certificates";return"Unknown"}async defaultFindIssuer(e,t,r=ne(!0)){const a=[];let n=null,o=null,i=null;if(e.subject.isEqual(e.issuer))try{if(await e.verify(void 0,r))return[e]}catch(c){}if(e.extensions){for(const c of e.extensions)if(c.extnID===wd&&c.parsedValue instanceof ta){c.parsedValue.keyIdentifier?n=c.parsedValue.keyIdentifier:(c.parsedValue.authorityCertIssuer&&(o=c.parsedValue.authorityCertIssuer),c.parsedValue.authorityCertSerialNumber&&(i=c.parsedValue.authorityCertSerialNumber));break}}function u(c){if(n!==null&&c.extensions){let m=!1;for(const h of c.extensions)if(h.extnID===kb&&h.parsedValue){m=!0,Se.isEqual(h.parsedValue.valueBlock.valueHex,n.valueBlock.valueHexView)&&a.push(c);break}if(m)return}let l=!1;i!==null&&(l=c.serialNumber.isEqual(i)),o!==null?c.subject.isEqual(o)&&l&&a.push(c):e.issuer.isEqual(c.subject)&&a.push(c)}for(const c of t.trustedCerts)u(c);for(const c of t.certs)u(c);for(let c=a.length-1;c>=0;c--)try{await e.verify(a[c],r)===!1&&a.splice(c,1)}catch(l){a.splice(c,1)}return a}defaultValues(e){switch(e){case zm:return[];case Ym:return[];case Zm:return[];case Qm:return[];case ef:return new Date;case tf:return am.defaultFindOrigin;case sf:return this.defaultFindIssuer;default:throw new Error("Invalid member name for CertificateChainValidationEngine class: ".concat(e))}}async sort(e=!1,t=ne(!0)){const r=[],a=async(w,d)=>{const p=[];function E(S){let N=!0;for(let x=0;x<S.length;x++){for(let I=0;I<S.length;I++)if(I!==x&&S[x]===S[I]){N=!1;break}if(!N)break}return N}if(bA(w,this.trustedCerts))return[[w]];const y=await this.findIssuer(w,this,d);if(y.length===0)throw new Error("No valid certificate paths found");for(let S=0;S<y.length;S++){if(Se.isEqual(y[S].tbsView,w.tbsView)){p.push([y[S]]);continue}const N=await a(y[S],d);for(let x=0;x<N.length;x++){const I=N[x].slice();I.splice(0,0,y[S]),E(I)?p.push(I):p.push(N[x])}}return p},n=async w=>{const d=[],p=[],E=[];if(d.push(...r.filter(y=>w.issuer.isEqual(y.subject))),d.length===0)return{status:1,statusMessage:"No certificate's issuers"};if(p.push(...this.crls.filter(y=>y.issuer.isEqual(w.issuer))),p.length===0)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let y=0;y<p.length;y++){const S=p[y];if(!(S.nextUpdate&&S.nextUpdate.value<this.checkDate))for(let N=0;N<d.length;N++)try{if(await p[y].verify({issuerCertificate:d[N]},t)){E.push({crl:p[y],certificate:d[N]});break}}catch(x){}}return E.length?{status:0,statusMessage:b,result:E}:{status:3,statusMessage:"No valid CRLs found"}},o=async(w,d)=>{const p=t.getAlgorithmByOID(w.signatureAlgorithm.algorithmId);if(!p.name||!p.hash)return 1;for(let E=0;E<this.ocsps.length;E++){const y=await this.ocsps[E].getCertificateStatus(w,d,t);if(y.isForCertificate)return y.status===0?0:1}return 2};async function i(w,d=!1){let p=!1,E=!1,y=!1,S=!1;if(w.extensions){for(let N=0;N<w.extensions.length;N++){const x=w.extensions[N];if(x.critical&&!x.parsedValue)return{result:!1,resultCode:6,resultMessage:"Unable to parse critical certificate extension: ".concat(x.extnID)};if(x.extnID===Eb){y=!0;const I=new Uint8Array(x.parsedValue.valueBlock.valueHex);(I[0]&4)===4&&(E=!0),(I[0]&2)===2&&(S=!0)}x.extnID===pd&&"cA"in x.parsedValue&&x.parsedValue.cA===!0&&(p=!0)}if(E===!0&&p===!1)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstraints'};if(y===!0&&p===!0&&E===!1)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(p===!0&&y===!0&&d&&S===!1)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return p===!1?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:b}}const u=async(w,d)=>{for(let p=0;p<w.length;p++)if(w[p].notBefore.value>d||w[p].notAfter.value<d)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(w.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let p=w.length-2;p>=0;p--)if(w[p].issuer.isEqual(w[p].subject)===!1&&w[p].issuer.isEqual(w[p+1].subject)===!1)return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(this.crls.length!==0||this.ocsps.length!==0)for(let p=0;p<w.length-1;p++){let E=2,y={status:0,statusMessage:b};if(this.ocsps.length!==0)switch(E=await o(w[p],w[p+1]),E){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(this.crls.length!==0){if(y=await n(w[p]),y.status===0&&y.result)for(let S=0;S<y.result.length;S++){if(y.result[S].crl.isCertificateRevoked(w[p]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if((await i(y.result[S].certificate,!0)).result===!1)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(e===!1)throw new zr(yn.noRevocation,"No revocation values found for one of certificates: ".concat(y.statusMessage))}else if(E===2)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(E===2&&y.status===2&&e){const S=w[p+1];let N=!1;if(S.extensions)for(const x of S.extensions)switch(x.extnID){case cw:case gd:case yd:N=!0;break}if(N)throw new zr(yn.noRevocation,"No revocation values found for one of certificates: ".concat(y.statusMessage))}}for(const[p,E]of w.entries())if(p&&!(await i(E)).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"};return{result:!0}};r.push(...this.trustedCerts),r.push(...this.certs);for(let w=0;w<r.length;w++)for(let d=0;d<r.length;d++)if(w!==d&&Se.isEqual(r[w].tbsView,r[d].tbsView)){r.splice(d,1),w=0;break}const c=r[r.length-1];let l;const m=[c];if(l=await a(c,t),l.length===0)throw new zr(yn.noPath,"Unable to find certificate path");for(let w=l.length-1;w>=0;w--){let d=!1;for(let p=0;p<l[w].length;p++){const E=l[w][p];for(let y=0;y<this.trustedCerts.length;y++)if(Se.isEqual(E.tbsView,this.trustedCerts[y].tbsView)){d=!0;break}if(d)break}d||l.splice(w,1)}if(l.length===0)throw new zr(yn.noValidPath,"No valid certificate paths found");let h=l[0].length,g=0;for(let w=0;w<l.length;w++)l[w].length<h&&(h=l[w].length,g=w);for(let w=0;w<l[g].length;w++)m.push(l[g][w]);if(l=await u(m,this.checkDate),l.result===!1)throw l;return m}async verify(e={},t=ne(!0)){function r(u,c){const l=Wr(u),m=Wr(c),h=l.split("."),g=m.split("."),w=h.length,d=g.length;if(w===0||d===0||w<d)return!1;for(let p=0;p<w;p++)if(h[p].length===0)return!1;for(let p=0;p<d;p++)if(g[p].length===0){if(p===0){if(d===1)return!1;continue}return!1}for(let p=0;p<d;p++)if(g[d-1-p].length!==0&&h[w-1-p].localeCompare(g[d-1-p])!==0)return!1;return!0}function a(u,c){const l=Wr(u),m=Wr(c),h=l.split("@"),g=m.split("@");if(h.length===0||g.length===0||h.length<g.length)return!1;if(g.length===1){if(r(h[1],g[0])){const w=h[1].split("."),d=g[0].split(".");return d[0].length===0?!0:w.length===d.length}return!1}return l.localeCompare(m)===0}function n(u,c){let l=Wr(u);const m=Wr(c),h=l.split("/");if(m.split("/").length>1)return!1;if(h.length>1){for(let g=0;g<h.length;g++)if(h[g].length>0&&h[g].charAt(h[g].length-1)!==":"){l=h[g].split(":")[0];break}}if(r(l,m)){const g=l.split("."),w=m.split(".");return w[0].length===0?!0:g.length===w.length}return!1}function o(u,c){const l=u.valueBlock.valueHexView,m=c.valueBlock.valueHexView;if(l.length===4&&m.length===8){for(let h=0;h<4;h++)if((l[h]^m[h])&m[h+4])return!1;return!0}if(l.length===16&&m.length===32){for(let h=0;h<16;h++)if((l[h]^m[h])&m[h+16])return!1;return!0}return!1}function i(u,c){if(u.typesAndValues.length===0||c.typesAndValues.length===0)return!0;if(u.typesAndValues.length<c.typesAndValues.length)return!1;let l=!0,m=0;for(let h=0;h<c.typesAndValues.length;h++){let g=!1;for(let w=m;w<u.typesAndValues.length;w++)if(g=u.typesAndValues[w].isEqual(c.typesAndValues[h]),u.typesAndValues[w].type===c.typesAndValues[h].type&&(l=l&&g),g===!0)if(m===0||m===w){m=w+1;break}else return!1;if(g===!1)return!1}return m===0?!1:l}try{if(this.certs.length===0)throw new Error("Empty certificate array");const u=e.passedWhenNotRevValues||!1,c=e.initialPolicySet||[Wt],l=e.initialExplicitPolicy||!1,m=e.initialPolicyMappingInhibit||!1,h=e.initialInhibitPolicy||!1,g=e.initialPermittedSubtreesSet||[],w=e.initialExcludedSubtreesSet||[],d=e.initialRequiredNameForms||[];let p=l,E=m,y=h;const S=[!1,!1,!1];let N=0,x=0,I=0,D=g,V=w;const k=d;let M=1;this.certs=await this.sort(u,t);const j=[];j.push(Wt);const F=[],T=new Array(this.certs.length-1);for(let X=0;X<this.certs.length-1;X++)T[X]=!0;F.push(T);const Y=new Array(this.certs.length-1),_=new Array(this.certs.length-1);let ie=p?this.certs.length-1:-1;for(let X=this.certs.length-2;X>=0;X--,M++){const G=this.certs[X];if(G.extensions){for(let W=0;W<G.extensions.length;W++){const re=G.extensions[W];if(re.extnID===hw){_[X]=re.parsedValue;for(let le=0;le<j.length;le++)if(j[le]===Wt){delete F[le][X];break}for(let le=0;le<re.parsedValue.certificatePolicies.length;le++){let Ne=-1;const Lt=re.parsedValue.certificatePolicies[le].policyIdentifier;for(let A=0;A<j.length;A++)if(Lt===j[A]){Ne=A;break}if(Ne===-1){j.push(Lt);const A=new Array(this.certs.length-1);A[X]=!0,F.push(A)}else F[Ne][X]=!0}}if(re.extnID===mw){if(E)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};Y[X]=re.parsedValue}re.extnID===fw&&p===!1&&(re.parsedValue.requireExplicitPolicy===0?(p=!0,ie=X):S[0]===!1?(S[0]=!0,N=re.parsedValue.requireExplicitPolicy):N=N>re.parsedValue.requireExplicitPolicy?re.parsedValue.requireExplicitPolicy:N,re.parsedValue.inhibitPolicyMapping===0?E=!0:S[1]===!1?(S[1]=!0,x=re.parsedValue.inhibitPolicyMapping+1):x=x>re.parsedValue.inhibitPolicyMapping+1?re.parsedValue.inhibitPolicyMapping+1:x),re.extnID===Db&&y===!1&&(re.parsedValue.valueBlock.valueDec===0?y=!0:S[2]===!1?(S[2]=!0,I=re.parsedValue.valueBlock.valueDec):I=I>re.parsedValue.valueBlock.valueDec?re.parsedValue.valueBlock.valueDec:I)}if(y===!0){let W=-1;for(let re=0;re<j.length;re++)if(j[re]===Wt){W=re;break}W!==-1&&delete F[0][X]}p===!1&&S[0]===!0&&(N--,N===0&&(p=!0,ie=X,S[0]=!1)),E===!1&&S[1]===!0&&(x--,x===0&&(E=!0,S[1]=!1)),y===!1&&S[2]===!0&&(I--,I===0&&(y=!0,S[2]=!1))}}for(let X=0;X<this.certs.length-1;X++)if(X<this.certs.length-2&&typeof Y[X+1]<"u")for(let G=0;G<Y[X+1].mappings.length;G++){if(Y[X+1].mappings[G].issuerDomainPolicy===Wt||Y[X+1].mappings[G].subjectDomainPolicy===Wt)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let W=-1,re=-1;for(let le=0;le<j.length;le++)j[le]===Y[X+1].mappings[G].issuerDomainPolicy&&(W=le),j[le]===Y[X+1].mappings[G].subjectDomainPolicy&&(re=le);typeof F[W][X]<"u"&&delete F[W][X];for(let le=0;le<_[X].certificatePolicies.length;le++)if(Y[X+1].mappings[G].subjectDomainPolicy===_[X].certificatePolicies[le].policyIdentifier&&W!==-1&&re!==-1)for(let Ne=0;Ne<=X;Ne++)typeof F[re][Ne]<"u"&&(F[W][Ne]=!0,delete F[re][Ne])}for(let X=0;X<j.length;X++)if(j[X]===Wt)for(let G=0;G<ie;G++)delete F[X][G];const Z=[];for(let X=0;X<F.length;X++){let G=!0;for(let W=0;W<this.certs.length-1;W++){let re=!1;if(W<ie&&j[X]===Wt&&j.length>1){G=!1;break}if(typeof F[X][W]>"u"){if(W>=ie){for(let le=0;le<j.length;le++)if(j[le]===Wt){F[le][W]===!0&&(re=!0);break}}if(!re){G=!1;break}}}G===!0&&Z.push(j[X])}let me=[];if(c.length===1&&c[0]===Wt&&p===!1)me=c;else if(Z.length===1&&Z[0]===Wt)me=c;else for(let X=0;X<Z.length;X++)for(let G=0;G<c.length;G++)if(c[G]===Z[X]||c[G]===Wt){me.push(Z[X]);break}const Q={result:me.length>0,resultCode:0,resultMessage:me.length>0?b:'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:Z,userConstrPolicies:me,explicitPolicyIndicator:p,policyMappings:Y,certificatePath:this.certs};if(me.length===0||Q.result===!1)return Q;M=1;for(let X=this.certs.length-2;X>=0;X--,M++){const G=this.certs[X];let W=[],re=[],le=[];if(G.extensions)for(let v=0;v<G.extensions.length;v++){const O=G.extensions[v];O.extnID===uw&&("permittedSubtrees"in O.parsedValue&&(re=re.concat(O.parsedValue.permittedSubtrees)),"excludedSubtrees"in O.parsedValue&&(le=le.concat(O.parsedValue.excludedSubtrees))),O.extnID===nw&&(W=W.concat(O.parsedValue.altNames))}let Ne=k.length<=0;for(let v=0;v<k.length;v++)switch(k[v].base.type){case 4:{if(k[v].base.value.typesAndValues.length!==G.subject.typesAndValues.length)continue;Ne=!0;for(let O=0;O<G.subject.typesAndValues.length;O++)if(G.subject.typesAndValues[O].type!==k[v].base.value.typesAndValues[O].type){Ne=!1;break}if(Ne===!0)break}break;default:}if(Ne===!1)throw Q.result=!1,Q.resultCode=21,Q.resultMessage="No necessary name form found",Q;const Lt=[[],[],[],[],[]];for(let v=0;v<D.length;v++)switch(D[v].base.type){case 1:Lt[0].push(D[v]);break;case 2:Lt[1].push(D[v]);break;case 4:Lt[2].push(D[v]);break;case 6:Lt[3].push(D[v]);break;case 7:Lt[4].push(D[v]);break;default:}for(let v=0;v<5;v++){let O=!1,B=!1;const ue=Lt[v];for(let ye=0;ye<ue.length;ye++){switch(v){case 0:if(W.length>0)for(let ae=0;ae<W.length;ae++)W[ae].type===1&&(B=!0,O=O||a(W[ae].value,ue[ye].base.value));else for(let ae=0;ae<G.subject.typesAndValues.length;ae++)(G.subject.typesAndValues[ae].type==="1.2.840.113549.1.9.1"||G.subject.typesAndValues[ae].type==="0.9.2342.19200300.100.1.3")&&(B=!0,O=O||a(G.subject.typesAndValues[ae].value.valueBlock.value,ue[ye].base.value));break;case 1:if(W.length>0)for(let ae=0;ae<W.length;ae++)W[ae].type===2&&(B=!0,O=O||r(W[ae].value,ue[ye].base.value));break;case 2:B=!0,O=i(G.subject,ue[ye].base.value);break;case 3:if(W.length>0)for(let ae=0;ae<W.length;ae++)W[ae].type===6&&(B=!0,O=O||n(W[ae].value,ue[ye].base.value));break;case 4:if(W.length>0)for(let ae=0;ae<W.length;ae++)W[ae].type===7&&(B=!0,O=O||o(W[ae].value,ue[ye].base.value));break;default:}if(O)break}if(O===!1&&ue.length>0&&B)throw Q.result=!1,Q.resultCode=41,Q.resultMessage='Failed to meet "permitted sub-trees" name constraint',Q}let A=!1;for(let v=0;v<V.length;v++){switch(V[v].base.type){case 1:if(W.length>=0)for(let O=0;O<W.length;O++)W[O].type===1&&(A=A||a(W[O].value,V[v].base.value));else for(let O=0;O<G.subject.typesAndValues.length;O++)(G.subject.typesAndValues[O].type==="1.2.840.113549.1.9.1"||G.subject.typesAndValues[O].type==="0.9.2342.19200300.100.1.3")&&(A=A||a(G.subject.typesAndValues[O].value.valueBlock.value,V[v].base.value));break;case 2:if(W.length>0)for(let O=0;O<W.length;O++)W[O].type===2&&(A=A||r(W[O].value,V[v].base.value));break;case 4:A=A||i(G.subject,V[v].base.value);break;case 6:if(W.length>0)for(let O=0;O<W.length;O++)W[O].type===6&&(A=A||n(W[O].value,V[v].base.value));break;case 7:if(W.length>0)for(let O=0;O<W.length;O++)W[O].type===7&&(A=A||o(W[O].value,V[v].base.value));break;default:}if(A)break}if(A===!0)throw Q.result=!1,Q.resultCode=42,Q.resultMessage='Failed to meet "excluded sub-trees" name constraint',Q;D=D.concat(re),V=V.concat(le)}return Q}catch(u){return u instanceof Error?u instanceof zr?{result:!1,resultCode:u.code,resultMessage:u.message,error:u}:{result:!1,resultCode:yn.unknown,resultMessage:u.message,error:u}:u&&typeof u=="object"&&"resultMessage"in u?u:{result:!1,resultCode:-1,resultMessage:"".concat(u)}}}}const lh="tbsResponseData",Lu="signatureAlgorithm",Uu="signature",Wi="certs",gc="BasicOCSPResponse",Tf="".concat(gc,".").concat(lh),Rf="".concat(gc,".").concat(Lu),Lf="".concat(gc,".").concat(Uu),uh="".concat(gc,".").concat(Wi),SA=[Tf,Rf,Lf,uh];class Zt extends ${constructor(e={}){super(),this.tbsResponseData=f(e,lh,Zt.defaultValues(lh)),this.signatureAlgorithm=f(e,Lu,Zt.defaultValues(Lu)),this.signature=f(e,Uu,Zt.defaultValues(Uu)),Wi in e&&(this.certs=f(e,Wi,Zt.defaultValues(Wi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case lh:return new Ye;case Lu:return new R;case Uu:return new ce;case Wi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case"type":{let r=Ye.compareWithDefault("tbs",t.tbs)&&Ye.compareWithDefault("responderID",t.responderID)&&Ye.compareWithDefault("producedAt",t.producedAt)&&Ye.compareWithDefault("responses",t.responses);return"responseExtensions"in t&&(r=r&&Ye.compareWithDefault("responseExtensions",t.responseExtensions)),r}case Lu:return t.algorithmId===b&&!("algorithmParams"in t);case Uu:return t.isEqual(Zt.defaultValues(e));case Wi:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||gc,value:[Ye.schema(t.tbsResponseData||{names:{blockName:Tf}}),R.schema(t.signatureAlgorithm||{names:{blockName:Rf}}),new ce({name:t.signature||Lf}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new C({value:[new se({name:uh,value:fe.schema(t.certs||{})})]})]})]})}fromSchema(e){K(e,SA);const t=H(e,e,Zt.schema());U.assertSchema(t,this.className),this.tbsResponseData=new Ye({schema:t.result[Tf]}),this.signatureAlgorithm=new R({schema:t.result[Rf]}),this.signature=t.result[Lf],uh in t.result&&(this.certs=Array.from(t.result[uh],r=>new fe({schema:r})))}toSchema(){const e=[];return e.push(this.tbsResponseData.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[new C({value:Array.from(this.certs,t=>t.toSchema())})]})),new C({value:e})}toJSON(){const e={tbsResponseData:this.tbsResponseData.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}async getCertificateStatus(e,t,r=ne(!0)){const a={isForCertificate:!1,status:2},n={},o=[];for(const i of this.tbsResponseData.responses){const u=r.getAlgorithmByOID(i.certID.hashAlgorithm.algorithmId,!0,"CertID.hashAlgorithm");if(!n[u.name]){n[u.name]=1;const c=new Ue;o.push(c),await c.createForCertificate(e,{hashAlgorithm:u.name,issuerCertificate:t},r)}}for(const i of this.tbsResponseData.responses)for(const u of o)if(i.certID.isEqual(u)){a.isForCertificate=!0;try{switch(i.certStatus.idBlock.isConstructed){case!0:i.certStatus.idBlock.tagNumber===1&&(a.status=1);break;case!1:switch(i.certStatus.idBlock.tagNumber){case 0:a.status=0;break;case 2:a.status=2;break;default:}break;default:}}catch(c){}return a}return a}async sign(e,t="SHA-1",r=ne(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters.algorithm;if(!("name"in n))throw new Error("Empty algorithm");this.signatureAlgorithm=a.signatureAlgorithm,this.tbsResponseData.tbsView=new Uint8Array(this.tbsResponseData.toSchema(!0).toBER());const o=await r.signWithPrivateKey(this.tbsResponseData.tbsView,e,{algorithm:n});this.signature=new ce({valueHex:o})}async verify(e={},t=ne(!0)){let r=null,a=-1;const n=e.trustedCerts||[];if(!this.certs)throw new Error("No certificates attached to the BasicOCSPResponse");switch(!0){case this.tbsResponseData.responderID instanceof we:for(const[i,u]of this.certs.entries())if(u.subject.isEqual(this.tbsResponseData.responderID)){a=i;break}break;case this.tbsResponseData.responderID instanceof J:for(const[i,u]of this.certs.entries()){const c=await t.digest({name:"sha-1"},u.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(rc(c,this.tbsResponseData.responderID.valueBlock.valueHex)){a=i;break}}break;default:throw new Error("Wrong value for responderID")}if(a===-1)throw new Error("Correct certificate was not found in OCSP response");r=this.certs[a];const o=[r];for(const i of this.certs){const u=await Aw(i,r);u&&o.push(u)}if(!(await new am({certs:o,trustedCerts:n}).verify({},t)).result)throw new Error("Validation of signer's certificate failed");return t.verifyWithPublicKey(this.tbsResponseData.tbsView,this.signature,this.certs[a].subjectPublicKeyInfo,this.signatureAlgorithm)}}Zt.CLASS_NAME="BasicOCSPResponse";const rf="tbs",af="version",nf="subject",of="subjectPublicKeyInfo",Wn="attributes",ju="signatureAlgorithm",$u="signatureValue",To="CertificationRequestInfo",Id="".concat(To,".version"),Vd="".concat(To,".subject"),xd="".concat(To,".subjectPublicKeyInfo"),Xh="".concat(To,".attributes"),AA=[To,Id,Vd,xd,Xh,ju,$u];function NA(s={}){const e=f(s,"names",{});return new C({name:e.CertificationRequestInfo||To,value:[new L({name:e.CertificationRequestInfoVersion||Id}),we.schema(e.subject||{names:{blockName:Vd}}),xt.schema({names:{blockName:xd}}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new se({optional:!0,name:e.CertificationRequestInfoAttributes||Xh,value:Ae.schema(e.attributes||{})})]})]})}class ns extends ${get tbs(){return Se.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(f(e,rf,ns.defaultValues(rf))),this.version=f(e,af,ns.defaultValues(af)),this.subject=f(e,nf,ns.defaultValues(nf)),this.subjectPublicKeyInfo=f(e,of,ns.defaultValues(of)),Wn in e&&(this.attributes=f(e,Wn,ns.defaultValues(Wn))),this.signatureAlgorithm=f(e,ju,ns.defaultValues(ju)),this.signatureValue=f(e,$u,ns.defaultValues($u)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case rf:return Ke;case af:return 0;case nf:return new we;case of:return new xt;case Wn:return[];case ju:return new R;case $u:return new ce;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({value:[NA(t.certificationRequestInfo||{}),new C({name:t.signatureAlgorithm||ju,value:[new z,new te({optional:!0})]}),new ce({name:t.signatureValue||$u})]})}fromSchema(e){K(e,AA);const t=H(e,e,ns.schema());U.assertSchema(t,this.className),this.tbsView=t.result.CertificationRequestInfo.valueBeforeDecodeView,this.version=t.result[Id].valueBlock.valueDec,this.subject=new we({schema:t.result[Vd]}),this.subjectPublicKeyInfo=new xt({schema:t.result[xd]}),Xh in t.result&&(this.attributes=Array.from(t.result[Xh],r=>new Ae({schema:r}))),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[new L({value:this.version}),this.subject.toSchema(),this.subjectPublicKeyInfo.toSchema()];return Wn in this&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes||[],t=>t.toSchema())})),new C({value:e})}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return ns.schema();const r=$e(this.tbsView);U.assert(r,"PKCS#10 Certificate Request"),t=r.result}else t=this.encodeTBS();return new C({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:pe.ToHex(this.tbsView),version:this.version,subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return Wn in this&&(e.attributes=Array.from(this.attributes||[],t=>t.toJSON())),e}async sign(e,t="SHA-1",r=ne(!0)){if(!e)throw new Error("Need to provide a private key for signing");const a=await r.getSignatureParameters(e,t),n=a.parameters;this.signatureAlgorithm=a.signatureAlgorithm,this.tbsView=new Uint8Array(this.encodeTBS().toBER());const o=await r.signWithPrivateKey(this.tbsView,e,n);this.signatureValue=new ce({valueHex:o})}async verify(e=ne(!0)){return e.verifyWithPublicKey(this.tbsView,this.signatureValue,this.subjectPublicKeyInfo,this.signatureAlgorithm)}async getPublicKey(e,t=ne(!0)){return t.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}}ns.CLASS_NAME="CertificationRequest";const un="digestAlgorithm",cn="digest",kA=[un,cn];class es extends ${constructor(e={}){super(),this.digestAlgorithm=f(e,un,es.defaultValues(un)),this.digest=f(e,cn,es.defaultValues(cn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case un:return new R;case cn:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case un:return R.compareWithDefault("algorithmId",t.algorithmId)&&!("algorithmParams"in t);case cn:return t.isEqual(es.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.digestAlgorithm||{names:{blockName:un}}),new J({name:t.digest||cn})]})}fromSchema(e){K(e,kA);const t=H(e,e,es.schema({names:{digestAlgorithm:{names:{blockName:un}},digest:cn}}));U.assertSchema(t,this.className),this.digestAlgorithm=new R({schema:t.result.digestAlgorithm}),this.digest=t.result.digest}toSchema(){return new C({value:[this.digestAlgorithm.toSchema(),this.digest]})}toJSON(){return{digestAlgorithm:this.digestAlgorithm.toJSON(),digest:this.digest.toJSON()}}}es.CLASS_NAME="DigestInfo";const _i="eContentType",as="eContent",EA=[_i,as];class Rt extends ${constructor(e={}){if(super(),this.eContentType=f(e,_i,Rt.defaultValues(_i)),as in e&&(this.eContent=f(e,as,Rt.defaultValues(as)),this.eContent.idBlock.tagClass===1&&this.eContent.idBlock.tagNumber===4&&this.eContent.idBlock.isConstructed===!1)){const t=new J({idBlock:{isConstructed:!0},isConstructed:!0});let r=0;const a=this.eContent.valueBlock.valueHexView.slice().buffer;let n=a.byteLength;for(;n>0;){const o=new Uint8Array(a,r,r+65536>a.byteLength?a.byteLength-r:65536),i=new ArrayBuffer(o.length),u=new Uint8Array(i);for(let c=0;c<u.length;c++)u[c]=o[c];t.valueBlock.value.push(new J({valueHex:i})),n-=o.length,r+=o.length}this.eContent=t}e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _i:return b;case as:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _i:return t===b;case as:return t.idBlock.tagClass===1&&t.idBlock.tagNumber===4?t.isEqual(Rt.defaultValues(as)):!1;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.eContentType||b}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new te({name:t.eContent||b})]})]})}fromSchema(e){K(e,EA);const t=H(e,e,Rt.schema({names:{eContentType:_i,eContent:as}}));U.assertSchema(t,this.className),this.eContentType=t.result.eContentType.valueBlock.toString(),as in t.result&&(this.eContent=t.result.eContent)}toSchema(){const e=[];return e.push(new z({value:this.eContentType})),this.eContent&&Rt.compareWithDefault(as,this.eContent)===!1&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.eContent]})),new C({value:e})}toJSON(){const e={eContentType:this.eContentType};return this.eContent&&Rt.compareWithDefault(as,this.eContent)===!1&&(e.eContent=this.eContent.toJSON()),e}}Rt.CLASS_NAME="EncapsulatedContentInfo";const hn="mac",mn="macSalt",Ts="iterations",CA=[hn,mn,Ts];class Nt extends ${constructor(e={}){super(),this.mac=f(e,hn,Nt.defaultValues(hn)),this.macSalt=f(e,mn,Nt.defaultValues(mn)),Ts in e&&(this.iterations=f(e,Ts,Nt.defaultValues(Ts))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case hn:return new es;case mn:return new J;case Ts:return 1;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case hn:return es.compareWithDefault("digestAlgorithm",t.digestAlgorithm)&&es.compareWithDefault("digest",t.digest);case mn:return t.isEqual(Nt.defaultValues(e));case Ts:return t===Nt.defaultValues(e);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,optional:t.optional||!0,value:[es.schema(t.mac||{names:{blockName:hn}}),new J({name:t.macSalt||mn}),new L({optional:!0,name:t.iterations||Ts})]})}fromSchema(e){K(e,CA);const t=H(e,e,Nt.schema({names:{mac:{names:{blockName:hn}},macSalt:mn,iterations:Ts}}));U.assertSchema(t,this.className),this.mac=new es({schema:t.result.mac}),this.macSalt=t.result.macSalt,Ts in t.result&&(this.iterations=t.result.iterations.valueBlock.valueDec)}toSchema(){const e=[this.mac.toSchema(),this.macSalt];return this.iterations!==void 0&&e.push(new L({value:this.iterations})),new C({value:e})}toJSON(){const e={mac:this.mac.toJSON(),macSalt:this.macSalt.toJSON()};return this.iterations!==void 0&&(e.iterations=this.iterations),e}}Nt.CLASS_NAME="MacData";const vn="hashAlgorithm",bn="hashedMessage",IA=[vn,bn];class ut extends ${static async create(e,t,r=ne(!0)){const a=r.getOIDByAlgorithm({name:e},!0,"hashAlgorithm"),n=await r.digest(e,t);return new ut({hashAlgorithm:new R({algorithmId:a,algorithmParams:new We}),hashedMessage:new J({valueHex:n})})}constructor(e={}){super(),this.hashAlgorithm=f(e,vn,ut.defaultValues(vn)),this.hashedMessage=f(e,bn,ut.defaultValues(bn)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case vn:return new R;case bn:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case vn:return t.algorithmId===b&&!("algorithmParams"in t);case bn:return t.isEqual(ut.defaultValues(e))===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.hashAlgorithm||{}),new J({name:t.hashedMessage||b})]})}fromSchema(e){K(e,IA);const t=H(e,e,ut.schema({names:{hashAlgorithm:{names:{blockName:vn}},hashedMessage:bn}}));U.assertSchema(t,this.className),this.hashAlgorithm=new R({schema:t.result.hashAlgorithm}),this.hashedMessage=t.result.hashedMessage}toSchema(){return new C({value:[this.hashAlgorithm.toSchema(),this.hashedMessage]})}toJSON(){return{hashAlgorithm:this.hashAlgorithm.toJSON(),hashedMessage:this.hashedMessage.toJSON()}}}ut.CLASS_NAME="MessageImprint";const Gi="reqCert",Kr="singleRequestExtensions",VA=[Gi,Kr];let zh=class Ku extends ${constructor(e={}){super(),this.reqCert=f(e,Gi,Ku.defaultValues(Gi)),Kr in e&&(this.singleRequestExtensions=f(e,Kr,Ku.defaultValues(Kr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Gi:return new Ue;case Kr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Gi:return t.isEqual(Ku.defaultValues(e));case Kr:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[Ue.schema(t.reqCert||{}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Le.schema(t.extensions||{names:{blockName:t.singleRequestExtensions||b}})]})]})}fromSchema(e){K(e,VA);const t=H(e,e,Ku.schema({names:{reqCert:{names:{blockName:Gi}},extensions:{names:{blockName:Kr}}}}));U.assertSchema(t,this.className),this.reqCert=new Ue({schema:t.result.reqCert}),Kr in t.result&&(this.singleRequestExtensions=Array.from(t.result.singleRequestExtensions.valueBlock.value,r=>new Le({schema:r})))}toSchema(){const e=[];return e.push(this.reqCert.toSchema()),this.singleRequestExtensions&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new C({value:Array.from(this.singleRequestExtensions,t=>t.toSchema())})]})),new C({value:e})}toJSON(){const e={reqCert:this.reqCert.toJSON()};return this.singleRequestExtensions&&(e.singleRequestExtensions=Array.from(this.singleRequestExtensions,t=>t.toJSON())),e}};zh.CLASS_NAME="Request";const qc="tbs",Xi="version",zi="requestorName",Wc="requestList",Yi="requestExtensions",Ro="TBSRequest",ch="".concat(Ro,".").concat(Xi),hh="".concat(Ro,".").concat(zi),Uf="".concat(Ro,".requests"),mh="".concat(Ro,".").concat(Yi),xA=[Ro,ch,hh,Uf,mh];class it extends ${get tbs(){return Se.toArrayBuffer(this.tbsView)}set tbs(e){this.tbsView=new Uint8Array(e)}constructor(e={}){super(),this.tbsView=new Uint8Array(f(e,qc,it.defaultValues(qc))),Xi in e&&(this.version=f(e,Xi,it.defaultValues(Xi))),zi in e&&(this.requestorName=f(e,zi,it.defaultValues(zi))),this.requestList=f(e,Wc,it.defaultValues(Wc)),Yi in e&&(this.requestExtensions=f(e,Yi,it.defaultValues(Yi))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case qc:return Ke;case Xi:return 0;case zi:return new de;case Wc:case Yi:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case qc:return t.byteLength===0;case Xi:return t===it.defaultValues(e);case zi:return t.type===de.defaultValues("type")&&Object.keys(t.value).length===0;case Wc:case Yi:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||Ro,value:[new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new L({name:t.TBSRequestVersion||ch})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[de.schema(t.requestorName||{names:{blockName:hh}})]}),new C({name:t.requestList||"TBSRequest.requestList",value:[new se({name:t.requests||Uf,value:zh.schema(t.requestNames||{})})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[He.schema(t.extensions||{names:{blockName:t.requestExtensions||mh}})]})]})}fromSchema(e){K(e,xA);const t=H(e,e,it.schema());U.assertSchema(t,this.className),this.tbsView=t.result.TBSRequest.valueBeforeDecodeView,ch in t.result&&(this.version=t.result[ch].valueBlock.valueDec),hh in t.result&&(this.requestorName=new de({schema:t.result[hh]})),this.requestList=Array.from(t.result[Uf],r=>new zh({schema:r})),mh in t.result&&(this.requestExtensions=Array.from(t.result[mh].valueBlock.value,r=>new Le({schema:r})))}toSchema(e=!1){let t;if(e===!1){if(this.tbsView.byteLength===0)return it.schema();const r=$e(this.tbsView);if(U.assert(r,"TBS Request"),!(r.result instanceof C))throw new Error("ASN.1 result should be SEQUENCE");t=r.result}else{const r=[];this.version!==void 0&&r.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[new L({value:this.version})]})),this.requestorName&&r.push(new P({idBlock:{tagClass:3,tagNumber:1},value:[this.requestorName.toSchema()]})),r.push(new C({value:Array.from(this.requestList,a=>a.toSchema())})),this.requestExtensions&&r.push(new P({idBlock:{tagClass:3,tagNumber:2},value:[new C({value:Array.from(this.requestExtensions,a=>a.toSchema())})]})),t=new C({value:r})}return t}toJSON(){const e={};return this.version!=null&&(e.version=this.version),this.requestorName&&(e.requestorName=this.requestorName.toJSON()),e.requestList=Array.from(this.requestList,t=>t.toJSON()),this.requestExtensions&&(e.requestExtensions=Array.from(this.requestExtensions,t=>t.toJSON())),e}}it.CLASS_NAME="TBSRequest";const _n="signatureAlgorithm",Gn="signature",nr="certs";class Ht extends ${constructor(e={}){super(),this.signatureAlgorithm=f(e,_n,Ht.defaultValues(_n)),this.signature=f(e,Gn,Ht.defaultValues(Gn)),nr in e&&(this.certs=f(e,nr,Ht.defaultValues(nr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case _n:return new R;case Gn:return new ce;case nr:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case _n:return t.algorithmId===b&&!("algorithmParams"in t);case Gn:return t.isEqual(Ht.defaultValues(e));case nr:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[R.schema(t.signatureAlgorithm||{}),new ce({name:t.signature||b}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new C({value:[new se({name:t.certs||b,value:fe.schema({})})]})]})]})}fromSchema(e){K(e,[_n,Gn,nr]);const t=H(e,e,Ht.schema({names:{signatureAlgorithm:{names:{blockName:_n}},signature:Gn,certs:nr}}));U.assertSchema(t,this.className),this.signatureAlgorithm=new R({schema:t.result.signatureAlgorithm}),this.signature=t.result.signature,nr in t.result&&(this.certs=Array.from(t.result.certs,r=>new fe({schema:r})))}toSchema(){const e=[];return e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.certs&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new C({value:Array.from(this.certs,t=>t.toSchema())})]})),new C({value:e})}toJSON(){const e={signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.certs&&(e.certs=Array.from(this.certs,t=>t.toJSON())),e}}Ht.CLASS_NAME="Signature";const Zi="tbsRequest",Hr="optionalSignature",BA=[Zi,Hr];class tc extends ${constructor(e={}){super(),this.tbsRequest=f(e,Zi,tc.defaultValues(Zi)),Hr in e&&(this.optionalSignature=f(e,Hr,tc.defaultValues(Hr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Zi:return new it;case Hr:return new Ht;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Zi:return it.compareWithDefault("tbs",t.tbs)&&it.compareWithDefault("version",t.version)&&it.compareWithDefault("requestorName",t.requestorName)&&it.compareWithDefault("requestList",t.requestList)&&it.compareWithDefault("requestExtensions",t.requestExtensions);case Hr:return Ht.compareWithDefault("signatureAlgorithm",t.signatureAlgorithm)&&Ht.compareWithDefault("signature",t.signature)&&Ht.compareWithDefault("certs",t.certs);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||"OCSPRequest",value:[it.schema(t.tbsRequest||{names:{blockName:Zi}}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[Ht.schema(t.optionalSignature||{names:{blockName:Hr}})]})]})}fromSchema(e){K(e,BA);const t=H(e,e,tc.schema());U.assertSchema(t,this.className),this.tbsRequest=new it({schema:t.result.tbsRequest}),Hr in t.result&&(this.optionalSignature=new Ht({schema:t.result.optionalSignature}))}toSchema(e=!1){const t=[];return t.push(this.tbsRequest.toSchema(e)),this.optionalSignature&&t.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.optionalSignature.toSchema()]})),new C({value:t})}toJSON(){const e={tbsRequest:this.tbsRequest.toJSON()};return this.optionalSignature&&(e.optionalSignature=this.optionalSignature.toJSON()),e}async createForCertificate(e,t,r=ne(!0)){const a=new Ue;await a.createForCertificate(e,t,r),this.tbsRequest.requestList.push(new zh({reqCert:a}))}async sign(e,t="SHA-1",r=ne(!0)){if(he.assertEmpty(e,"privateKey","OCSPRequest.sign method"),!this.optionalSignature)throw new Error('Need to create "optionalSignature" field before signing');const a=await r.getSignatureParameters(e,t),n=a.parameters;this.optionalSignature.signatureAlgorithm=a.signatureAlgorithm;const o=this.tbsRequest.toSchema(!0).toBER(!1),i=await r.signWithPrivateKey(o,e,n);this.optionalSignature.signature=new ce({valueHex:i})}verify(){}}tc.CLASS_NAME="OCSPRequest";const Qi="responseType",eo="response",PA=[Qi,eo];class us extends ${constructor(e={}){super(),this.responseType=f(e,Qi,us.defaultValues(Qi)),this.response=f(e,eo,us.defaultValues(eo)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Qi:return b;case eo:return new J;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Qi:return t===b;case eo:return t.isEqual(us.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new z({name:t.responseType||b}),new J({name:t.response||b})]})}fromSchema(e){K(e,PA);const t=H(e,e,us.schema({names:{responseType:Qi,response:eo}}));U.assertSchema(t,this.className),this.responseType=t.result.responseType.valueBlock.toString(),this.response=t.result.response}toSchema(){return new C({value:[new z({value:this.responseType}),this.response]})}toJSON(){return{responseType:this.responseType,response:this.response.toJSON()}}}us.CLASS_NAME="ResponseBytes";const Xn="responseStatus",Es="responseBytes";class bo extends ${constructor(e={}){super(),this.responseStatus=f(e,Xn,bo.defaultValues(Xn)),Es in e&&(this.responseBytes=f(e,Es,bo.defaultValues(Es))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Xn:return new nc;case Es:return new us;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Xn:return t.isEqual(bo.defaultValues(e));case Es:return us.compareWithDefault("responseType",t.responseType)&&us.compareWithDefault("response",t.response);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||"OCSPResponse",value:[new nc({name:t.responseStatus||Xn}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[us.schema(t.responseBytes||{names:{blockName:Es}})]})]})}fromSchema(e){K(e,[Xn,Es]);const t=H(e,e,bo.schema());U.assertSchema(t,this.className),this.responseStatus=t.result.responseStatus,Es in t.result&&(this.responseBytes=new us({schema:t.result.responseBytes}))}toSchema(){const e=[];return e.push(this.responseStatus),this.responseBytes&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:[this.responseBytes.toSchema()]})),new C({value:e})}toJSON(){const e={responseStatus:this.responseStatus.toJSON()};return this.responseBytes&&(e.responseBytes=this.responseBytes.toJSON()),e}async getCertificateStatus(e,t,r=ne(!0)){let a;const n={isForCertificate:!1,status:2};if(!this.responseBytes||this.responseBytes.responseType!==Zc)return n;try{const o=$e(this.responseBytes.response.valueBlock.valueHexView);U.assert(o,"Basic OCSP response"),a=new Zt({schema:o.result})}catch(o){return n}return a.getCertificateStatus(e,t,r)}async sign(e,t,r=ne(!0)){var a;if(this.responseBytes&&this.responseBytes.responseType===Zc)return Zt.fromBER(this.responseBytes.response.valueBlock.valueHexView).sign(e,t,r);throw new Error("Unknown ResponseBytes type: ".concat(((a=this.responseBytes)===null||a===void 0?void 0:a.responseType)||"Unknown"))}async verify(e=null,t=ne(!0)){var r;if(!(Es in this))throw new Error("Empty ResponseBytes field");if(this.responseBytes&&this.responseBytes.responseType===Zc){const a=Zt.fromBER(this.responseBytes.response.valueBlock.valueHexView);return e!==null&&(a.certs||(a.certs=[]),a.certs.push(e)),a.verify({},t)}throw new Error("Unknown ResponseBytes type: ".concat(((r=this.responseBytes)===null||r===void 0?void 0:r.responseType)||"Unknown"))}}bo.CLASS_NAME="OCSPResponse";const wa="type",Rs="attributes",_c="encodedValue",OA=[Rs];class Ce extends ${constructor(e={}){super(),this.type=f(e,wa,Ce.defaultValues(wa)),this.attributes=f(e,Rs,Ce.defaultValues(Rs)),this.encodedValue=f(e,_c,Ce.defaultValues(_c)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case wa:return-1;case Rs:return[];case _c:return Ke;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case wa:return t===Ce.defaultValues(wa);case Rs:return t.length===0;case _c:return t.byteLength===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new P({name:t.blockName||b,optional:!0,idBlock:{tagClass:3,tagNumber:t.tagNumber||0},value:[new se({name:t.attributes||b,value:Ae.schema()})]})}fromSchema(e){K(e,OA);const t=H(e,e,Ce.schema({names:{tagNumber:this.type,attributes:Rs}}));U.assertSchema(t,this.className),this.type=t.result.idBlock.tagNumber,this.encodedValue=Se.toArrayBuffer(t.result.valueBeforeDecodeView);const r=new Uint8Array(this.encodedValue);if(r[0]=49,!(Rs in t.result)){if(this.type===0)throw new Error("Wrong structure of SignedUnsignedAttributes");return}this.attributes=Array.from(t.result.attributes,a=>new Ae({schema:a}))}toSchema(){if(Ce.compareWithDefault(wa,this.type)||Ce.compareWithDefault(Rs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return new P({optional:!0,idBlock:{tagClass:3,tagNumber:this.type},value:Array.from(this.attributes,e=>e.toSchema())})}toJSON(){if(Ce.compareWithDefault(wa,this.type)||Ce.compareWithDefault(Rs,this.attributes))throw new Error('Incorrectly initialized "SignedAndUnsignedAttributes" class');return{type:this.type,attributes:Array.from(this.attributes,e=>e.toJSON())}}}Ce.CLASS_NAME="SignedAndUnsignedAttributes";const to="version",fn="sid",so="digestAlgorithm",Mr="signedAttrs",ro="signatureAlgorithm",Hu="signature",Fr="unsignedAttrs",ma="SignerInfo",jf="".concat(ma,".").concat(to),Mu="".concat(ma,".").concat(fn),$f="".concat(ma,".").concat(so),fh="".concat(ma,".").concat(Mr),Kf="".concat(ma,".").concat(ro),Hf="".concat(ma,".").concat(Hu),dh="".concat(ma,".").concat(Fr),DA=[jf,Mu,$f,fh,Kf,Hf,dh];class Oe extends ${constructor(e={}){super(),this.version=f(e,to,Oe.defaultValues(to)),this.sid=f(e,fn,Oe.defaultValues(fn)),this.digestAlgorithm=f(e,so,Oe.defaultValues(so)),Mr in e&&(this.signedAttrs=f(e,Mr,Oe.defaultValues(Mr))),this.signatureAlgorithm=f(e,ro,Oe.defaultValues(ro)),this.signature=f(e,Hu,Oe.defaultValues(Hu)),Fr in e&&(this.unsignedAttrs=f(e,Fr,Oe.defaultValues(Fr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case to:return 0;case fn:return new te;case so:return new R;case Mr:return new Ce({type:0});case ro:return new R;case Hu:return new J;case Fr:return new Ce({type:1});default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case to:return Oe.defaultValues(to)===t;case fn:return t instanceof te;case so:return t instanceof R?t.isEqual(Oe.defaultValues(so)):!1;case Mr:return Ce.compareWithDefault("type",t.type)&&Ce.compareWithDefault("attributes",t.attributes)&&Ce.compareWithDefault("encodedValue",t.encodedValue);case ro:return t instanceof R?t.isEqual(Oe.defaultValues(ro)):!1;case Hu:case Fr:return Ce.compareWithDefault("type",t.type)&&Ce.compareWithDefault("attributes",t.attributes)&&Ce.compareWithDefault("encodedValue",t.encodedValue);default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:ma,value:[new L({name:t.version||jf}),new Ve({value:[Me.schema(t.sidSchema||{names:{blockName:Mu}}),new Ve({value:[new P({optional:!0,name:t.sid||Mu,idBlock:{tagClass:3,tagNumber:0},value:[new J]}),new ee({optional:!0,name:t.sid||Mu,idBlock:{tagClass:3,tagNumber:0}})]})]}),R.schema(t.digestAlgorithm||{names:{blockName:$f}}),Ce.schema(t.signedAttrs||{names:{blockName:fh,tagNumber:0}}),R.schema(t.signatureAlgorithm||{names:{blockName:Kf}}),new J({name:t.signature||Hf}),Ce.schema(t.unsignedAttrs||{names:{blockName:dh,tagNumber:1}})]})}fromSchema(e){K(e,DA);const t=H(e,e,Oe.schema());U.assertSchema(t,this.className),this.version=t.result[jf].valueBlock.valueDec;const r=t.result[Mu];r.idBlock.tagClass===1?this.sid=new Me({schema:r}):this.sid=r,this.digestAlgorithm=new R({schema:t.result[$f]}),fh in t.result&&(this.signedAttrs=new Ce({type:0,schema:t.result[fh]})),this.signatureAlgorithm=new R({schema:t.result[Kf]}),this.signature=t.result[Hf],dh in t.result&&(this.unsignedAttrs=new Ce({type:1,schema:t.result[dh]}))}toSchema(){if(Oe.compareWithDefault(fn,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e=[];return e.push(new L({value:this.version})),this.sid instanceof Me?e.push(this.sid.toSchema()):e.push(this.sid),e.push(this.digestAlgorithm.toSchema()),this.signedAttrs&&Oe.compareWithDefault(Mr,this.signedAttrs)===!1&&e.push(this.signedAttrs.toSchema()),e.push(this.signatureAlgorithm.toSchema()),e.push(this.signature),this.unsignedAttrs&&Oe.compareWithDefault(Fr,this.unsignedAttrs)===!1&&e.push(this.unsignedAttrs.toSchema()),new C({value:e})}toJSON(){if(Oe.compareWithDefault(fn,this.sid))throw new Error('Incorrectly initialized "SignerInfo" class');const e={version:this.version,digestAlgorithm:this.digestAlgorithm.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signature:this.signature.toJSON()};return this.sid instanceof te||(e.sid=this.sid.toJSON()),this.signedAttrs&&Oe.compareWithDefault(Mr,this.signedAttrs)===!1&&(e.signedAttrs=this.signedAttrs.toJSON()),this.unsignedAttrs&&Oe.compareWithDefault(Fr,this.unsignedAttrs)===!1&&(e.unsignedAttrs=this.unsignedAttrs.toJSON()),e}}Oe.CLASS_NAME="SignerInfo";const Fu="version",Ju="policy",qu="messageImprint",Wu="serialNumber",_u="genTime",dn="ordering",pn="nonce",ao="accuracy",no="tsa",io="extensions",ms="TSTInfo",Mf="".concat(ms,".").concat(Fu),Ff="".concat(ms,".").concat(Ju),Jf="".concat(ms,".").concat(qu),qf="".concat(ms,".").concat(Wu),Wf="".concat(ms,".").concat(_u),ph="".concat(ms,".").concat(ao),gh="".concat(ms,".").concat(dn),wh="".concat(ms,".").concat(pn),yh="".concat(ms,".").concat(no),vh="".concat(ms,".").concat(io),TA=[Mf,Ff,Jf,qf,Wf,ph,gh,wh,yh,vh];class ft extends ${constructor(e={}){super(),this.version=f(e,Fu,ft.defaultValues(Fu)),this.policy=f(e,Ju,ft.defaultValues(Ju)),this.messageImprint=f(e,qu,ft.defaultValues(qu)),this.serialNumber=f(e,Wu,ft.defaultValues(Wu)),this.genTime=f(e,_u,ft.defaultValues(_u)),ao in e&&(this.accuracy=f(e,ao,ft.defaultValues(ao))),dn in e&&(this.ordering=f(e,dn,ft.defaultValues(dn))),pn in e&&(this.nonce=f(e,pn,ft.defaultValues(pn))),no in e&&(this.tsa=f(e,no,ft.defaultValues(no))),io in e&&(this.extensions=f(e,io,ft.defaultValues(io))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Fu:return 0;case Ju:return b;case qu:return new ut;case Wu:return new L;case _u:return new Date(0,0,0);case ao:return new Kt;case dn:return!1;case pn:return new L;case no:return new de;case io:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Fu:case Ju:case _u:case dn:return t===ft.defaultValues(dn);case qu:return ut.compareWithDefault(vn,t.hashAlgorithm)&&ut.compareWithDefault(bn,t.hashedMessage);case Wu:case pn:return t.isEqual(ft.defaultValues(pn));case ao:return Kt.compareWithDefault(lr,t.seconds)&&Kt.compareWithDefault(ur,t.millis)&&Kt.compareWithDefault(cr,t.micros);case no:return de.compareWithDefault(rl,t.type)&&de.compareWithDefault(al,t.value);case io:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||ms,value:[new L({name:t.version||Mf}),new z({name:t.policy||Ff}),ut.schema(t.messageImprint||{names:{blockName:Jf}}),new L({name:t.serialNumber||qf}),new xe({name:t.genTime||Wf}),Kt.schema(t.accuracy||{names:{blockName:ph}}),new ha({name:t.ordering||gh,optional:!0}),new L({name:t.nonce||wh,optional:!0}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[de.schema(t.tsa||{names:{blockName:yh}})]}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new se({name:t.extensions||vh,value:Le.schema(t.extension||{})})]})]})}fromSchema(e){K(e,TA);const t=H(e,e,ft.schema());U.assertSchema(t,this.className),this.version=t.result[Mf].valueBlock.valueDec,this.policy=t.result[Ff].valueBlock.toString(),this.messageImprint=new ut({schema:t.result[Jf]}),this.serialNumber=t.result[qf],this.genTime=t.result[Wf].toDate(),ph in t.result&&(this.accuracy=new Kt({schema:t.result[ph]})),gh in t.result&&(this.ordering=t.result[gh].valueBlock.value),wh in t.result&&(this.nonce=t.result[wh]),yh in t.result&&(this.tsa=new de({schema:t.result[yh]})),vh in t.result&&(this.extensions=Array.from(t.result[vh],r=>new Le({schema:r})))}toSchema(){const e=[];return e.push(new L({value:this.version})),e.push(new z({value:this.policy})),e.push(this.messageImprint.toSchema()),e.push(this.serialNumber),e.push(new xe({valueDate:this.genTime})),this.accuracy&&e.push(this.accuracy.toSchema()),this.ordering!==void 0&&e.push(new ha({value:this.ordering})),this.nonce&&e.push(this.nonce),this.tsa&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[this.tsa.toSchema()]})),this.extensions&&e.push(new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.extensions,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={version:this.version,policy:this.policy,messageImprint:this.messageImprint.toJSON(),serialNumber:this.serialNumber.toJSON(),genTime:this.genTime};return this.accuracy&&(e.accuracy=this.accuracy.toJSON()),this.ordering!==void 0&&(e.ordering=this.ordering),this.nonce&&(e.nonce=this.nonce.toJSON()),this.tsa&&(e.tsa=this.tsa.toJSON()),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}async verify(e,t=ne(!0)){if(!e.data)throw new Error('"data" is a mandatory attribute for TST_INFO verification');const r=e.data;if(e.notBefore&&this.genTime<e.notBefore)throw new Error("Generation time for TSTInfo object is less than notBefore value");if(e.notAfter&&this.genTime>e.notAfter)throw new Error("Generation time for TSTInfo object is more than notAfter value");const a=t.getAlgorithmByOID(this.messageImprint.hashAlgorithm.algorithmId,!0,"MessageImprint.hashAlgorithm"),n=await t.digest(a.name,new Uint8Array(r));return Se.isEqual(n,this.messageImprint.hashedMessage.valueBlock.valueHexView)}}ft.CLASS_NAME="TSTInfo";const oo="version",Gu="digestAlgorithms",Xu="encapContentInfo",lo="certificates",uo="crls",zu="signerInfos",Qo="ocsps",Kn="SignedData",_f="".concat(Kn,".").concat(oo),bh="".concat(Kn,".").concat(Gu),Gf="".concat(Kn,".").concat(Xu),Sh="".concat(Kn,".").concat(lo),Ah="".concat(Kn,".").concat(uo),Nh="".concat(Kn,".").concat(zu),RA=[_f,bh,Gf,Sh,Ah,Nh];class mt extends Error{constructor({message:e,code:t=0,date:r=new Date,signatureVerified:a=null,signerCertificate:n=null,signerCertificateVerified:o=null,timestampSerial:i=null,certificatePath:u=[]}){super(e),this.name="SignedDataVerifyError",this.date=r,this.code=t,this.timestampSerial=i,this.signatureVerified=a,this.signerCertificate=n,this.signerCertificateVerified=o,this.certificatePath=u}}class nt extends ${constructor(e={}){super(),this.version=f(e,oo,nt.defaultValues(oo)),this.digestAlgorithms=f(e,Gu,nt.defaultValues(Gu)),this.encapContentInfo=f(e,Xu,nt.defaultValues(Xu)),lo in e&&(this.certificates=f(e,lo,nt.defaultValues(lo))),uo in e&&(this.crls=f(e,uo,nt.defaultValues(uo))),Qo in e&&(this.ocsps=f(e,Qo,nt.defaultValues(Qo))),this.signerInfos=f(e,zu,nt.defaultValues(zu)),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case oo:return 0;case Gu:return[];case Xu:return new Rt;case lo:return[];case uo:return[];case Qo:return[];case zu:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case oo:return t===nt.defaultValues(oo);case Xu:return Rt.compareWithDefault("eContentType",t.eContentType)&&Rt.compareWithDefault("eContent",t.eContent);case Gu:case lo:case uo:case Qo:case zu:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return t.optional===void 0&&(t.optional=!1),new C({name:t.blockName||Kn,optional:t.optional,value:[new L({name:t.version||_f}),new _e({value:[new se({name:t.digestAlgorithms||bh,value:R.schema()})]}),Rt.schema(t.encapContentInfo||{names:{blockName:Gf}}),new P({name:t.certificates||Sh,optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Ss.schema().valueBlock.value}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:Xs.schema(t.crls||{names:{crls:Ah}}).valueBlock.value}),new _e({value:[new se({name:t.signerInfos||Nh,value:Oe.schema()})]})]})}fromSchema(e){K(e,RA);const t=H(e,e,nt.schema());if(U.assertSchema(t,this.className),this.version=t.result[_f].valueBlock.valueDec,bh in t.result&&(this.digestAlgorithms=Array.from(t.result[bh],r=>new R({schema:r}))),this.encapContentInfo=new Rt({schema:t.result[Gf]}),Sh in t.result){const r=new Ss({schema:new _e({value:t.result[Sh].valueBlock.value})});this.certificates=r.certificates.slice(0)}Ah in t.result&&(this.crls=Array.from(t.result[Ah],r=>r.idBlock.tagClass===1?new qe({schema:r}):(r.idBlock.tagClass=1,r.idBlock.tagNumber=16,new Gs({schema:r})))),Nh in t.result&&(this.signerInfos=Array.from(t.result[Nh],r=>new Oe({schema:r})))}toSchema(e=!1){const t=[];if(this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof la)||this.crls&&this.crls.length&&this.crls.some(r=>r instanceof Gs)?this.version=5:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof Ft)?this.version=4:this.certificates&&this.certificates.length&&this.certificates.some(r=>r instanceof Fs)||this.signerInfos.some(r=>r.version===3)||this.encapContentInfo.eContentType!==nt.ID_DATA?this.version=3:this.version=1,t.push(new L({value:this.version})),t.push(new _e({value:Array.from(this.digestAlgorithms,r=>r.toSchema())})),t.push(this.encapContentInfo.toSchema()),this.certificates){const r=new Ss({certificates:this.certificates}).toSchema();t.push(new P({idBlock:{tagClass:3,tagNumber:0},value:r.valueBlock.value}))}return this.crls&&t.push(new P({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.crls,r=>{if(r instanceof Gs){const a=r.toSchema();return a.idBlock.tagClass=3,a.idBlock.tagNumber=1,a}return r.toSchema(e)})})),t.push(new _e({value:Array.from(this.signerInfos,r=>r.toSchema())})),new C({value:t})}toJSON(){const e={version:this.version,digestAlgorithms:Array.from(this.digestAlgorithms,t=>t.toJSON()),encapContentInfo:this.encapContentInfo.toJSON(),signerInfos:Array.from(this.signerInfos,t=>t.toJSON())};return this.certificates&&(e.certificates=Array.from(this.certificates,t=>t.toJSON())),this.crls&&(e.crls=Array.from(this.crls,t=>t.toJSON())),e}async verify({signer:e=-1,data:t=Ke,trustedCerts:r=[],checkDate:a=new Date,checkChain:n=!1,passedWhenNotRevValues:o=!1,extendedMode:i=!1,findOrigin:u=null,findIssuer:c=null}={},l=ne(!0)){let m=null,h=null;try{let g=Ke,w=b,d=[];const p=this.signerInfos[e];if(!p)throw new mt({date:a,code:1,message:"Unable to get signer by supplied index"});if(!this.certificates)throw new mt({date:a,code:2,message:"No certificates attached to this signed data"});if(p.sid instanceof Me){for(const N of this.certificates)if(N instanceof fe&&N.issuer.isEqual(p.sid.issuer)&&N.serialNumber.isEqual(p.sid.serialNumber)){m=N;break}}else{const N=p.sid,x=N.idBlock.isConstructed?N.valueBlock.value[0].valueBlock.valueHex:N.valueBlock.valueHex;for(const I of this.certificates){if(!(I instanceof fe))continue;const D=await l.digest({name:"sha-1"},I.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHexView);if(rc(D,x)){m=I;break}}}if(!m)throw new mt({date:a,code:3,message:"Unable to find signer certificate"});if(this.encapContentInfo.eContentType===$b){if(!this.encapContentInfo.eContent)throw new mt({date:a,code:15,message:"Error during verification: TSTInfo eContent is empty",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0});let N;try{N=ft.fromBER(this.encapContentInfo.eContent.valueBlock.valueHexView)}catch(x){throw new mt({date:a,code:15,message:"Error during verification: TSTInfo wrong ASN.1 schema ",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}if(a=N.genTime,h=N.serialNumber.valueBlock.valueHexView.slice(),t.byteLength===0)throw new mt({date:a,code:4,message:"Missed detached data input array"});if(!await N.verify({data:t},l))throw new mt({date:a,code:15,message:"Error during verification: TSTInfo verification is failed",signatureVerified:!1,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}if(n){const N=this.certificates.filter(V=>V instanceof fe&&!!Aw(V,m)),x={checkDate:a,certs:N,trustedCerts:r};c&&(x.findIssuer=c),u&&(x.findOrigin=u);const I=new am(x);if(I.certs.push(m),this.crls)for(const V of this.crls)"thisUpdate"in V?I.crls.push(V):V.otherRevInfoFormat===Zc&&I.ocsps.push(new Zt({schema:V.otherRevInfo}));this.ocsps&&I.ocsps.push(...this.ocsps);const D=await I.verify({passedWhenNotRevValues:o},l).catch(V=>{throw new mt({date:a,code:5,message:"Validation of signer's certificate failed with error: ".concat(V instanceof Object?V.resultMessage:V),signerCertificate:m,signerCertificateVerified:!1})});if(D.certificatePath&&(d=D.certificatePath),!D.result)throw new mt({date:a,code:5,message:"Validation of signer's certificate failed: ".concat(D.resultMessage),signerCertificate:m,signerCertificateVerified:!1})}const E=l.getAlgorithmByOID(p.digestAlgorithm.algorithmId);if(!("name"in E))throw new mt({date:a,code:7,message:"Unsupported signature algorithm: ".concat(p.digestAlgorithm.algorithmId),signerCertificate:m,signerCertificateVerified:!0});w=E.name;const y=this.encapContentInfo.eContent;if(y)y.idBlock.tagClass===1&&y.idBlock.tagNumber===4?t=y.getValue():t=y.valueBlock.valueBeforeDecodeView;else if(t.byteLength===0)throw new mt({date:a,code:8,message:"Missed detached data input array",signerCertificate:m,signerCertificateVerified:!0});if(p.signedAttrs){let N=!1,x=!1;for(const I of p.signedAttrs.attributes)if(I.type==="1.2.840.113549.1.9.3"&&(N=!0),I.type==="1.2.840.113549.1.9.4"&&(x=!0,g=I.values[0].valueBlock.valueHex),N&&x)break;if(N===!1)throw new mt({date:a,code:9,message:'Attribute "content-type" is a mandatory attribute for "signed attributes"',signerCertificate:m,signerCertificateVerified:!0});if(x===!1)throw new mt({date:a,code:10,message:'Attribute "message-digest" is a mandatory attribute for "signed attributes"',signatureVerified:null,signerCertificate:m,signerCertificateVerified:!0})}if(p.signedAttrs){const N=await l.digest(w,new Uint8Array(t));if(!rc(N,g))throw new mt({date:a,code:15,message:"Error during verification: Message digest doesn't match",signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0});t=p.signedAttrs.encodedValue}const S=p.signatureAlgorithm.algorithmId==="1.2.840.113549.1.1.1"?await l.verifyWithPublicKey(t,p.signature,m.subjectPublicKeyInfo,p.signatureAlgorithm,w):await l.verifyWithPublicKey(t,p.signature,m.subjectPublicKeyInfo,p.signatureAlgorithm);return i?{date:a,code:14,message:b,signatureVerified:S,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0,certificatePath:d}:S}catch(g){throw g instanceof mt?g:new mt({date:a,code:15,message:"Error during verification: ".concat(g instanceof Error?g.message:g),signatureVerified:null,signerCertificate:m,timestampSerial:h,signerCertificateVerified:!0})}}async sign(e,t,r="SHA-1",a=Ke,n=ne(!0)){var o;if(!e)throw new Error("Need to provide a private key for signing");const i=this.signerInfos[t];if(!i)throw new RangeError("SignerInfo index is out of range");!(!((o=i.signedAttrs)===null||o===void 0)&&o.attributes.length)&&"hash"in e.algorithm&&"hash"in e.algorithm&&e.algorithm.hash&&(r=e.algorithm.hash.name);const u=n.getOIDByAlgorithm({name:r},!0,"hashAlgorithm");this.digestAlgorithms.filter(h=>h.algorithmId===u).length===0&&this.digestAlgorithms.push(new R({algorithmId:u,algorithmParams:new We})),i.digestAlgorithm=new R({algorithmId:u,algorithmParams:new We});const c=await n.getSignatureParameters(e,r),l=c.parameters;if(i.signatureAlgorithm=c.signatureAlgorithm,i.signedAttrs)if(i.signedAttrs.encodedValue.byteLength!==0)a=i.signedAttrs.encodedValue;else{a=i.signedAttrs.toSchema().toBER();const h=Se.toUint8Array(a);h[0]=49}else{const h=this.encapContentInfo.eContent;if(h)h.idBlock.tagClass===1&&h.idBlock.tagNumber===4?a=h.getValue():a=h.valueBlock.valueBeforeDecodeView;else if(a.byteLength===0)throw new Error("Missed detached data input array")}const m=await n.signWithPrivateKey(a,e,l);i.signature=new J({valueHex:m})}}nt.CLASS_NAME="SignedData",nt.ID_DATA=vd;const gn="version",wn="authSafe",Ls="macData",el="parsedValue",LA=[gn,wn,Ls];class Gr extends ${constructor(e={}){super(),this.version=f(e,gn,Gr.defaultValues(gn)),this.authSafe=f(e,wn,Gr.defaultValues(wn)),Ls in e&&(this.macData=f(e,Ls,Gr.defaultValues(Ls))),el in e&&(this.parsedValue=f(e,el,Gr.defaultValues(el))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case gn:return 3;case wn:return new ve;case Ls:return new Nt;case el:return{};default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case gn:return t===Gr.defaultValues(e);case wn:return ve.compareWithDefault("contentType",t.contentType)&&ve.compareWithDefault("content",t.content);case Ls:return Nt.compareWithDefault("mac",t.mac)&&Nt.compareWithDefault("macSalt",t.macSalt)&&Nt.compareWithDefault("iterations",t.iterations);case el:return t instanceof Object&&Object.keys(t).length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.version||gn}),ve.schema(t.authSafe||{names:{blockName:wn}}),Nt.schema(t.macData||{names:{blockName:Ls,optional:!0}})]})}fromSchema(e){K(e,LA);const t=H(e,e,Gr.schema({names:{version:gn,authSafe:{names:{blockName:wn}},macData:{names:{blockName:Ls}}}}));U.assertSchema(t,this.className),this.version=t.result.version.valueBlock.valueDec,this.authSafe=new ve({schema:t.result.authSafe}),Ls in t.result&&(this.macData=new Nt({schema:t.result.macData}))}toSchema(){const e=[new L({value:this.version}),this.authSafe.toSchema()];return this.macData&&e.push(this.macData.toSchema()),new C({value:e})}toJSON(){const e={version:this.version,authSafe:this.authSafe.toJSON()};return this.macData&&(e.macData=this.macData.toJSON()),e}async makeInternalValues(e={},t=ne(!0)){if(ge.assert(e,"parameters","object"),!this.parsedValue)throw new Error('Please call "parseValues" function first in order to make "parsedValue" data');switch(he.assertEmpty(this.parsedValue.integrityMode,"integrityMode","parsedValue"),he.assertEmpty(this.parsedValue.authenticatedSafe,"authenticatedSafe","parsedValue"),this.parsedValue.integrityMode){case 0:{if(!("iterations"in e))throw new he("iterations");he.assertEmpty(e.pbkdf2HashAlgorithm,"pbkdf2HashAlgorithm"),he.assertEmpty(e.hmacHashAlgorithm,"hmacHashAlgorithm"),he.assertEmpty(e.password,"password");const r=new ArrayBuffer(64),a=new Uint8Array(r);t.getRandomValues(a);const n=this.parsedValue.authenticatedSafe.toSchema().toBER(!1);this.authSafe=new ve({contentType:ve.DATA,content:new J({valueHex:n})});const o=await t.stampDataWithPassword({password:e.password,hashAlgorithm:e.hmacHashAlgorithm,salt:r,iterationCount:e.iterations,contentToStamp:n});this.macData=new Nt({mac:new es({digestAlgorithm:new R({algorithmId:t.getOIDByAlgorithm({name:e.hmacHashAlgorithm},!0,"hmacHashAlgorithm")}),digest:new J({valueHex:o})}),macSalt:new J({valueHex:r}),iterations:e.iterations})}break;case 1:{if(!("signingCertificate"in e))throw new he("signingCertificate");he.assertEmpty(e.privateKey,"privateKey"),he.assertEmpty(e.hashAlgorithm,"hashAlgorithm");const r=this.parsedValue.authenticatedSafe.toSchema().toBER(!1),a=new nt({version:1,encapContentInfo:new Rt({eContentType:"1.2.840.113549.1.7.1",eContent:new J({valueHex:r})}),certificates:[e.signingCertificate]}),n=await t.digest({name:e.hashAlgorithm},new Uint8Array(r)),o=[];o.push(new Ae({type:"1.2.840.113549.1.9.3",values:[new z({value:"1.2.840.113549.1.7.1"})]})),o.push(new Ae({type:"1.2.840.113549.1.9.5",values:[new df({valueDate:new Date})]})),o.push(new Ae({type:"1.2.840.113549.1.9.4",values:[new J({valueHex:n})]})),a.signerInfos.push(new Oe({version:1,sid:new Me({issuer:e.signingCertificate.issuer,serialNumber:e.signingCertificate.serialNumber}),signedAttrs:new Ce({type:0,attributes:o})})),await a.sign(e.privateKey,0,e.hashAlgorithm,void 0,t),this.authSafe=new ve({contentType:"1.2.840.113549.1.7.2",content:a.toSchema(!0)})}break;default:throw new Error('Parameter "integrityMode" has unknown value: '.concat(this.parsedValue.integrityMode))}}async parseInternalValues(e,t=ne(!0)){switch(ge.assert(e,"parameters","object"),e.checkIntegrity===void 0&&(e.checkIntegrity=!0),this.parsedValue={},this.authSafe.contentType){case ve.DATA:{he.assertEmpty(e.password,"password"),this.parsedValue.integrityMode=0,ge.assert(this.authSafe.content,"authSafe.content",J);const r=this.authSafe.content.getValue();if(this.parsedValue.authenticatedSafe=Ln.fromBER(r),e.checkIntegrity){if(!this.macData)throw new Error('Absent "macData" value, can not check PKCS#12 data integrity');const a=t.getAlgorithmByOID(this.macData.mac.digestAlgorithm.algorithmId,!0,"digestAlgorithm");if(!await t.verifyDataStampedWithPassword({password:e.password,hashAlgorithm:a.name,salt:Se.toArrayBuffer(this.macData.macSalt.valueBlock.valueHexView),iterationCount:this.macData.iterations||1,contentToVerify:r,signatureToVerify:Se.toArrayBuffer(this.macData.mac.digest.valueBlock.valueHexView)}))throw new Error("Integrity for the PKCS#12 data is broken!")}}break;case ve.SIGNED_DATA:{this.parsedValue.integrityMode=1;const r=new nt({schema:this.authSafe.content}),a=r.encapContentInfo.eContent;he.assert(a,"eContent","cmsSigned.encapContentInfo"),ge.assert(a,"eContent",J);const n=a.getValue();if(this.parsedValue.authenticatedSafe=Ln.fromBER(n),!await r.verify({signer:0,checkChain:!1},t))throw new Error("Integrity for the PKCS#12 data is broken!")}break;default:throw new Error('Incorrect value for "this.authSafe.contentType": '.concat(this.authSafe.contentType))}}}Gr.CLASS_NAME="PFX";const co="status",Jr="statusStrings",qr="failInfo",UA=[co,Jr,qr];var Qp;(function(s){s[s.granted=0]="granted",s[s.grantedWithMods=1]="grantedWithMods",s[s.rejection=2]="rejection",s[s.waiting=3]="waiting",s[s.revocationWarning=4]="revocationWarning",s[s.revocationNotification=5]="revocationNotification"})(Qp||(Qp={}));class Qt extends ${constructor(e={}){super(),this.status=f(e,co,Qt.defaultValues(co)),Jr in e&&(this.statusStrings=f(e,Jr,Qt.defaultValues(Jr))),qr in e&&(this.failInfo=f(e,qr,Qt.defaultValues(qr))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case co:return 2;case Jr:return[];case qr:return new ce;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case co:return t===Qt.defaultValues(e);case Jr:return t.length===0;case qr:return t.isEqual(Qt.defaultValues(e));default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||b,value:[new L({name:t.status||b}),new C({optional:!0,value:[new se({name:t.statusStrings||b,value:new Ph})]}),new ce({name:t.failInfo||b,optional:!0})]})}fromSchema(e){K(e,UA);const t=H(e,e,Qt.schema({names:{status:co,statusStrings:Jr,failInfo:qr}}));U.assertSchema(t,this.className);const r=t.result.status;if(r.valueBlock.isHexOnly===!0||r.valueBlock.valueDec<0||r.valueBlock.valueDec>5)throw new Error('PKIStatusInfo "status" has invalid value');this.status=r.valueBlock.valueDec,Jr in t.result&&(this.statusStrings=t.result.statusStrings),qr in t.result&&(this.failInfo=t.result.failInfo)}toSchema(){const e=[];return e.push(new L({value:this.status})),this.statusStrings&&e.push(new C({optional:!0,value:this.statusStrings})),this.failInfo&&e.push(this.failInfo),new C({value:e})}toJSON(){const e={status:this.status};return this.statusStrings&&(e.statusStrings=Array.from(this.statusStrings,t=>t.toJSON())),this.failInfo&&(e.failInfo=this.failInfo.toJSON()),e}}Qt.CLASS_NAME="PKIStatusInfo";const Yu="version",Zu="messageImprint",ho="reqPolicy",mo="nonce",Us="certReq",fo="extensions",Hn="TimeStampReq",Xf="".concat(Hn,".").concat(Yu),zf="".concat(Hn,".").concat(Zu),kh="".concat(Hn,".").concat(ho),Eh="".concat(Hn,".").concat(mo),Ch="".concat(Hn,".").concat(Us),Ih="".concat(Hn,".").concat(fo),jA=[Xf,zf,kh,Eh,Ch,Ih];class Ut extends ${constructor(e={}){super(),this.version=f(e,Yu,Ut.defaultValues(Yu)),this.messageImprint=f(e,Zu,Ut.defaultValues(Zu)),ho in e&&(this.reqPolicy=f(e,ho,Ut.defaultValues(ho))),mo in e&&(this.nonce=f(e,mo,Ut.defaultValues(mo))),Us in e&&(this.certReq=f(e,Us,Ut.defaultValues(Us))),fo in e&&(this.extensions=f(e,fo,Ut.defaultValues(fo))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case Yu:return 0;case Zu:return new ut;case ho:return b;case mo:return new L;case Us:return!1;case fo:return[];default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case Yu:case ho:case Us:return t===Ut.defaultValues(e);case Zu:return ut.compareWithDefault("hashAlgorithm",t.hashAlgorithm)&&ut.compareWithDefault("hashedMessage",t.hashedMessage);case mo:return t.isEqual(Ut.defaultValues(e));case fo:return t.length===0;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||Hn,value:[new L({name:t.version||Xf}),ut.schema(t.messageImprint||{names:{blockName:zf}}),new z({name:t.reqPolicy||kh,optional:!0}),new L({name:t.nonce||Eh,optional:!0}),new ha({name:t.certReq||Ch,optional:!0}),new P({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new se({name:t.extensions||Ih,value:Le.schema()})]})]})}fromSchema(e){K(e,jA);const t=H(e,e,Ut.schema());U.assertSchema(t,this.className),this.version=t.result[Xf].valueBlock.valueDec,this.messageImprint=new ut({schema:t.result[zf]}),kh in t.result&&(this.reqPolicy=t.result[kh].valueBlock.toString()),Eh in t.result&&(this.nonce=t.result[Eh]),Ch in t.result&&(this.certReq=t.result[Ch].valueBlock.value),Ih in t.result&&(this.extensions=Array.from(t.result[Ih],r=>new Le({schema:r})))}toSchema(){const e=[];return e.push(new L({value:this.version})),e.push(this.messageImprint.toSchema()),this.reqPolicy&&e.push(new z({value:this.reqPolicy})),this.nonce&&e.push(this.nonce),Us in this&&Ut.compareWithDefault(Us,this.certReq)===!1&&e.push(new ha({value:this.certReq})),this.extensions&&e.push(new P({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.extensions,t=>t.toSchema())})),new C({value:e})}toJSON(){const e={version:this.version,messageImprint:this.messageImprint.toJSON()};return this.reqPolicy!==void 0&&(e.reqPolicy=this.reqPolicy),this.nonce!==void 0&&(e.nonce=this.nonce.toJSON()),this.certReq!==void 0&&Ut.compareWithDefault(Us,this.certReq)===!1&&(e.certReq=this.certReq),this.extensions&&(e.extensions=Array.from(this.extensions,t=>t.toJSON())),e}}Ut.CLASS_NAME="TimeStampReq";const po="status",go="timeStampToken",Bd="TimeStampResp",Yf="".concat(Bd,".").concat(po),Vh="".concat(Bd,".").concat(go),$A=[Yf,Vh];class sc extends ${constructor(e={}){super(),this.status=f(e,po,sc.defaultValues(po)),go in e&&(this.timeStampToken=f(e,go,sc.defaultValues(go))),e.schema&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case po:return new Qt;case go:return new ve;default:return super.defaultValues(e)}}static compareWithDefault(e,t){switch(e){case po:return Qt.compareWithDefault(po,t.status)&&!("statusStrings"in t)&&!("failInfo"in t);case go:return t.contentType===b&&t.content instanceof te;default:return super.defaultValues(e)}}static schema(e={}){const t=f(e,"names",{});return new C({name:t.blockName||Bd,value:[Qt.schema(t.status||{names:{blockName:Yf}}),ve.schema(t.timeStampToken||{names:{blockName:Vh,optional:!0}})]})}fromSchema(e){K(e,$A);const t=H(e,e,sc.schema());U.assertSchema(t,this.className),this.status=new Qt({schema:t.result[Yf]}),Vh in t.result&&(this.timeStampToken=new ve({schema:t.result[Vh]}))}toSchema(){const e=[];return e.push(this.status.toSchema()),this.timeStampToken&&e.push(this.timeStampToken.toSchema()),new C({value:e})}toJSON(){const e={status:this.status.toJSON()};return this.timeStampToken&&(e.timeStampToken=this.timeStampToken.toJSON()),e}async sign(e,t,r=ne(!0)){return this.assertContentType(),new nt({schema:this.timeStampToken.content}).sign(e,0,t,void 0,r)}async verify(e={signer:0,trustedCerts:[],data:Ke},t=ne(!0)){return this.assertContentType(),new nt({schema:this.timeStampToken.content}).verify(e,t)}assertContentType(){if(!this.timeStampToken)throw new Error("timeStampToken is absent in TSP response");if(this.timeStampToken.contentType!==dw)throw new Error("Wrong format of timeStampToken: ".concat(this.timeStampToken.contentType))}}sc.CLASS_NAME="TimeStampResp";function KA(){if(typeof self<"u"){if("crypto"in self){let s="webcrypto";"webkitSubtle"in self.crypto&&(s="safari"),Up(s,new hc({name:s,crypto}))}}else if(typeof crypto<"u"&&"webcrypto"in crypto){const s="NodeJS ^15",e=crypto.webcrypto;Up(s,new hc({name:s,crypto:e}))}}KA();function HA(s){return String.fromCharCode(...s)}function kw(s){return Uint8Array.from(s,e=>e.charCodeAt(0))}function MA(s){return Array.from(s).map(e=>e.toString(16).padStart(2,"0")).join("")}function Ns(s){return kw(atob(s))}function Pd(s){const e=s.replace(/-----BEGIN ((PRIVATE KEY)|(PUBLIC KEY)|(CERTIFICATE))-----/,"").replace(/-----END ((PRIVATE KEY)|(PUBLIC KEY)|(CERTIFICATE))-----/,"").replace(/\n/g,"");return Ns(e)}var FA=Object.defineProperty,JA=Object.defineProperties,qA=Object.getOwnPropertyDescriptors,eg=Object.getOwnPropertySymbols,WA=Object.prototype.hasOwnProperty,_A=Object.prototype.propertyIsEnumerable,tg=(s,e,t)=>e in s?FA(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Zf=(s,e)=>{for(var t in e||(e={}))WA.call(e,t)&&tg(s,t,e[t]);if(eg)for(var t of eg(e))_A.call(e,t)&&tg(s,t,e[t]);return s},sg=(s,e)=>JA(s,qA(e));async function Od(s,e,t={}){return await self.crypto.subtle.decrypt(Zf({name:"AES-GCM"},t),e,s)}async function GA(s,e){return await self.crypto.subtle.decrypt({name:"RSA-OAEP"},e,s)}async function Ew(s){return await self.crypto.subtle.importKey("raw",s,{name:"AES-GCM",length:128},!0,["decrypt","encrypt"])}async function XA(s,e){return await self.crypto.subtle.importKey("spki",s,{name:"RSASSA-PKCS1-v1_5",hash:e},!0,["verify"])}async function zA(s){return await self.crypto.subtle.importKey("pkcs8",s,{name:"RSA-OAEP",hash:"SHA-256"},!0,["decrypt"])}async function YA(s){return new Uint8Array(await self.crypto.subtle.exportKey("raw",s))}async function ZA(s){const e=await self.crypto.subtle.digest("SHA-256",s);return MA(new Uint8Array(e))}async function QA(s,e){const t=new ay(s),r=await XA(Pd(e),t.signatureAlgorithm.hash.name);return t.verify({publicKey:r},eN())}function eN(){return sg(Zf({},self.crypto),{subtle:sg(Zf({},self.crypto.subtle),{async verify(s,e,t,r){return self.crypto.subtle.verify(s,e,new Uint8Array(t),new Uint8Array(r))}})})}async function tN(s,e,t){const r=ve.fromBER(e),a=new nt({schema:r.content}),n=a.signerInfos[0].sid.issuer.typesAndValues.find(({type:u})=>u==="2.5.4.3").value.valueBlock.value,o=t.find(({userId:u})=>u===n);if(o===void 0)throw new Error("Signer not found in the users array");const i=fe.fromBER(Pd(o.certificate));return await a.verify({signer:0,trustedCerts:[i],data:s,checkChain:!0},rN())}class sN extends hc{verify(e,t,r,a){return super.verify(e,t,r,new Uint8Array(a))}}function rN(){return new sN({crypto:self.crypto})}var aN=Object.defineProperty,rg=Object.getOwnPropertySymbols,nN=Object.prototype.hasOwnProperty,iN=Object.prototype.propertyIsEnumerable,ag=(s,e,t)=>e in s?aN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,oN=(s,e)=>{for(var t in e||(e={}))nN.call(e,t)&&ag(s,t,e[t]);if(rg)for(var t of rg(e))iN.call(e,t)&&ag(s,t,e[t]);return s};async function lN(s,e){Ze.debug("Decrypting private key",{privateKeyInfo:s,mnemonic:e});const t=await Promise.all([await lf(e,s.salt,{hash:"SHA-256",iterations:6e5}),await lf(e,s.salt,{hash:"SHA-1",iterations:1024}),await lf(e,s.salt,{hash:"SHA-1",iterations:6e5})]);for(const r of t)try{const a=await Od(s.encryptedPrivateKey,r,{iv:s.iv,tagLength:128}),n=atob(HA(new Uint8Array(a)));return zA(Pd(n))}catch(a){}throw new Error("Failed to decrypt private key")}async function lf(s,e,t){const r=await crypto.subtle.importKey("raw",new TextEncoder().encode(s.replaceAll(" ","")),{name:"PBKDF2"},!1,["deriveKey"]);return await crypto.subtle.deriveKey(oN({name:"PBKDF2",salt:e},t),r,{name:"AES-GCM",length:256},!0,["decrypt","encrypt"])}const uf="apps/end_to_end_encryption/api/v2",Cw={PrivateKey:uf+"/private-key",Metadata:uf+"/meta-data/{fileId}",ServerKey:uf+"/server-key"};async function uN(){const s=(await ug.get(cg(Cw.PrivateKey),{headers:{"X-E2EE-SUPPORTED":"true"}})).data.ocs.data["private-key"],[e,t,r]=s.split("|");return{encryptedPrivateKey:Ns(e),iv:Ns(t),salt:Ns(r)}}async function cN(){return await(await ug.get(cg(Cw.ServerKey),{headers:{"X-E2EE-SUPPORTED":"true"}})).data.ocs.data["public-key"]}const hN={name:"AlertCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var mN=function(){var s=this,e=s._self._c;return e("span",s._b({staticClass:"material-design-icon alert-circle-outline-icon",attrs:{"aria-hidden":s.title?null:"true","aria-label":s.title,role:"img"},on:{click:function(t){return s.$emit("click",t)}}},"span",s.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:s.fillColor,width:s.size,height:s.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"}},[s.title?e("title",[s._v(s._s(s.title))]):s._e()])])])},fN=[],dN=Zh(hN,mN,fN,!1,null,null);const pN=dN.exports,gN={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var wN=function(){var s=this,e=s._self._c;return e("span",s._b({staticClass:"material-design-icon check-icon",attrs:{"aria-hidden":s.title?null:"true","aria-label":s.title,role:"img"},on:{click:function(t){return s.$emit("click",t)}}},"span",s.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:s.fillColor,width:s.size,height:s.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}},[s.title?e("title",[s._v(s._s(s.title))]):s._e()])])])},yN=[],vN=Zh(gN,wN,yN,!1,null,null);const bN=vN.exports,SN={name:"NcInputField",components:{NcButton:jw,AlertCircle:pN,Check:bN},inheritAttrs:!1,model:{prop:"modelValue",event:"update:modelValue"},props:{value:{type:[String,Number],default:void 0},modelValue:{type:[String,Number],default:void 0},type:{type:String,default:"text",validator:s=>["text","password","email","tel","url","search","number"].includes(s)},label:{type:String,default:void 0},labelOutside:{type:Boolean,default:!1},placeholder:{type:String,default:void 0},showTrailingButton:{type:Boolean,default:!1},trailingButtonLabel:{type:String,default:""},success:{type:Boolean,default:!1},error:{type:Boolean,default:!1},helperText:{type:String,default:""},disabled:{type:Boolean,default:!1},pill:{type:Boolean,default:!1},inputClass:{type:[Object,String],default:""}},emits:["update:value","update:modelValue","update:model-value","trailing-button-click"],setup(){const s=mg("value","update:value",!0);return{isLegacy32:Ud,model:s}},computed:{computedId(){return this.$attrs.id&&this.$attrs.id!==""?this.$attrs.id:this.inputName},inputName(){return"input"+$w()},hasTrailingIcon(){return this.success},computedPlaceholder(){if(this.placeholder)return this.placeholder;if(this.label)return Ud?this.label:""},isValidLabel(){const s=this.label||this.labelOutside;return s||Kw.warn("You need to add a label to the NcInputField component. Either use the prop label or use an external one, as per the example in the documentation."),s},ariaDescribedby(){const s=[];return this.helperText.length>0&&s.push("".concat(this.inputName,"-helper-text")),this.$attrs["aria-describedby"]&&s.push(this.$attrs["aria-describedby"]),s.join(" ")||null}},methods:{focus(){this.$refs.input.focus()},select(){this.$refs.input.select()},handleInput(s){const e=this.type==="number"&&typeof this.model=="number"?parseFloat(s.target.value,10):s.target.value;this.model=e},handleTrailingButtonClick(s){this.$emit("trailing-button-click",s)}}};var AN=function(){var t;var s=this,e=s._self._c;return e("div",{staticClass:"input-field",class:{"input-field--disabled":s.disabled,"input-field--error":s.error,"input-field--label-outside":s.labelOutside||!s.isValidLabel,"input-field--leading-icon":!!s.$scopedSlots.icon||!!s.$scopedSlots.default||!!s.$slots.default,"input-field--success":s.success,"input-field--trailing-icon":s.showTrailingButton||s.hasTrailingIcon,"input-field--pill":s.pill,"input-field--legacy":s.isLegacy32}},[e("div",{staticClass:"input-field__main-wrapper"},[e("input",s._g(s._b({ref:"input",staticClass:"input-field__input",class:[s.inputClass,{"input-field__input--success":s.success,"input-field__input--error":s.error}],attrs:{id:s.computedId,type:s.type,disabled:s.disabled,placeholder:s.computedPlaceholder,"aria-describedby":s.ariaDescribedby,"aria-live":"polite"},domProps:{value:(t=s.model)==null?void 0:t.toString()},on:{input:s.handleInput}},"input",s.$attrs,!1),s.$listeners)),!s.labelOutside&&s.isValidLabel?e("label",{staticClass:"input-field__label",attrs:{for:s.computedId}},[s._v(" "+s._s(s.label)+" ")]):s._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!!s.$scopedSlots.icon||!!s.$scopedSlots.default||!!s.$slots.default,expression:"!!$scopedSlots.icon || !!$scopedSlots.default || !!$slots.default"}],staticClass:"input-field__icon input-field__icon--leading"},[s._t("icon",function(){return[s._t("default")]})],2),s.showTrailingButton?e("NcButton",{staticClass:"input-field__trailing-button",attrs:{"aria-label":s.trailingButtonLabel,disabled:s.disabled,variant:"tertiary-no-background"},on:{click:s.handleTrailingButtonClick},scopedSlots:s._u([{key:"icon",fn:function(){return[s._t("trailing-button-icon")]},proxy:!0}],null,!0)}):s.success||s.error?e("div",{staticClass:"input-field__icon input-field__icon--trailing"},[s.success?e("Check",{staticStyle:{color:"var(--color-success-text)"},attrs:{size:20}}):s.error?e("AlertCircle",{staticStyle:{color:"var(--color-error-text)"},attrs:{size:20}}):s._e()],1):s._e()],1),s.helperText.length>0?e("p",{staticClass:"input-field__helper-text-message",class:{"input-field__helper-text-message--error":s.error,"input-field__helper-text-message--success":s.success},attrs:{id:"".concat(s.inputName,"-helper-text")}},[s.success?e("Check",{staticClass:"input-field__helper-text-message__icon",attrs:{size:18}}):s.error?e("AlertCircle",{staticClass:"input-field__helper-text-message__icon",attrs:{size:18}}):s._e(),s._v(" "+s._s(s.helperText)+" ")],1):s._e()])},NN=[],kN=Zh(SN,AN,NN,!1,null,"ab8d7671");const Qf=kN.exports;Hw(_w,Ww);const EN=new Set(Object.keys(Qf.props)),CN={name:"NcTextField",components:{NcIconSvgWrapper:Mw,NcInputField:Qf},inheritAttrs:!1,model:{prop:"modelValue",event:"update:modelValue"},props:fs(ct({" ":{}},Qf.props),{trailingButtonLabel:{type:String,default:""},trailingButtonIcon:{type:String,default:"close",validator:s=>["close","arrowEnd","arrowRight","undo"].includes(s)}}),emits:["update:value","update:modelValue","update:model-value"],setup(){return{model:mg("value","update:value"),mdiArrowRight:Fw,mdiClose:Jw,mdiUndo:qw}},computed:{isArrow(){return this.trailingButtonIcon==="arrowEnd"||this.trailingButtonIcon==="arrowRight"},propsAndAttrsToForward(){const s={arrowEnd:wc("Save changes"),arrowRight:wc("Save changes"),close:wc("Clear text"),undo:wc("Undo changes")};return fs(ct(ct({},this.$attrs),Object.fromEntries(Object.entries(this.$props).filter(([e])=>EN.has(e)))),{trailingButtonLabel:this.trailingButtonLabel||s[this.trailingButtonIcon]})}},methods:{focus(){this.$refs.inputField.focus()},select(){this.$refs.inputField.select()}}};var IN=function(){var s=this,e=s._self._c;return e("NcInputField",s._g(s._b({ref:"inputField",scopedSlots:s._u([s.$scopedSlots.icon||s.$slots.default||s.$scopedSlots.default?{key:"icon",fn:function(){return[s._t("icon",function(){return[s._t("default")]})]},proxy:!0}:null,s.type!=="search"?{key:"trailing-button-icon",fn:function(){return[s.isArrow?e("NcIconSvgWrapper",{attrs:{directional:"",path:s.mdiArrowRight}}):e("NcIconSvgWrapper",{attrs:{path:s.trailingButtonIcon==="undo"?s.mdiUndo:s.mdiClose}})]},proxy:!0}:null],null,!0)},"NcInputField",s.propsAndAttrsToForward,!1),s.$listeners))},VN=[],xN=Zh(CN,IN,VN,!1,null,null);const BN=xN.exports,PN=Gw({__name:"MnemonicPromptDialog",emits:["close"],setup(s,{emit:e}){const t=um(),r=um(""),a=um(!1),n=jd(()=>a.value===!0&&r.value.trim().split(/\s+/g).length===12);function o(){e("close",r.value)}const i=jd(()=>[{label:mf("end_to_en_encryption","Submit"),nativeType:"submit",type:"primary",disabled:!n.value,callback:o}]);return{__sfc:!0,emit:e,dialogRef:t,mnemonic:r,confirmToggle:a,isFormValid:n,submit:o,buttons:i,t:mf,NcDialog:ny,NcTextField:BN,NcNoteCard:iy,NcCheckboxRadioSwitch:oy}}});var ON=function(){var s=this,e=s._self._c,t=s._self._setupProxy;return e(t.NcDialog,{ref:"dialogRef",attrs:{name:t.t("end_to_end_encryption","Enter your 12 words mnemonic"),buttons:t.buttons,"is-form":!0},on:{submit:t.submit}},[e(t.NcNoteCard,{attrs:{type:"warning","show-alert":!0,heading:t.t("end_to_end_encryption","Decrypting your files in the browser can weaken security")}},[s._v(" "+s._s(t.t("end_to_end_encryption","The server could serve malicious source code to extract the secret that protects your files."))+" "),e(t.NcCheckboxRadioSwitch,{attrs:{required:!0,"data-cy-e2ee-mnemonic-prompt":"i_understand_the_risks",type:"switch"},model:{value:t.confirmToggle,callback:function(r){t.confirmToggle=r},expression:"confirmToggle"}},[s._v(" "+s._s(t.t("end_to_end_encryption","I understand the risks"))+" ")])],1),e(t.NcTextField,{attrs:{value:t.mnemonic,required:"true",pattern:"^(\\w+\\s+){11}\\w+$",label:t.t("end_to_end_encryption","Mnemonic"),autofocus:!0},on:{"update:value":function(r){t.mnemonic=r}}})],1)},DN=[],TN=Xw(PN,ON,DN,!1,null,null);const RN=TN.exports;async function LN(){const s=Promise.withResolvers();return ly(RN,void 0,e=>{e!==void 0?s.resolve(e):s.reject()}),s.promise}async function UN(s,e){Ze.debug("Decrypting metadata info",{metadata:s});const[t,r]=s.metadata.ciphertext.split("|"),a=await Od(Ns(t),e,{iv:Ns(r)}),n=JSON.parse(await KN(a));return jN(n,s),await $N(n,e),n}function jN(s,e){var t,r;if(((t=s.keyChecksums)==null?void 0:t.length)!==((r=e.users)==null?void 0:r.length))throw new Error("Key checksums length does not match users length")}async function $N(s,e){if(s.keyChecksums===void 0)return;const t=await YA(e),r=await ZA(t);if(!s.keyChecksums.includes(r))throw new Error("Key checksum is not in keyChecksums")}async function KN(s){const e=new ReadableStream({start(t){t.enqueue(new Uint8Array(s)),t.close()}}).pipeThrough(new DecompressionStream("gzip"));return await new Response(e).text()}async function HN(s,e,t){var r;Ze.debug("Getting metadata private key",{metadata:s,userId:e});const a=(r=s.users)==null?void 0:r.find(i=>i.userId===e);if(!a)throw new Error("User not found in metadata");const n=Ns(a.encryptedMetadataKey),o=await GA(n,t);return await Ew(new Uint8Array(o))}async function ng(s,e,t){const r=JSON.stringify(s,(n,o)=>{if(n!=="filedrop")return o}),a=await tN(kw(btoa(r)),Ns(e),t.users);if(!a)throw new Error("Metadata signature verification failed");return a}async function MN(s,e){const t=s.users.map(async({userId:r,certificate:a})=>{const n=await QA(a,e);if(!n)throw new Error("Certificate verification failed for user ".concat(r));return n});return await Promise.all(t)}const FN=H0(),pt={_userPrivateKey:void 0,_serverPublicKey:void 0,_metadataCache:{},async getUserPrivateKey(){var s;return(s=this._userPrivateKey)!=null||(this._userPrivateKey=await lN(await uN(),await LN())),this._userPrivateKey},async getServerPublicKeyPEM(){var s;return(s=this._serverPublicKey)!=null||(this._serverPublicKey=await cN()),this._serverPublicKey},async getMetadata(s){if(this._metadataCache[s])return Ze.debug("Found metadata in cache",{path:s,state:pt}),this._metadataCache[s];if(Ze.debug("Fetching PROPFIND for metadata",{path:s,state:pt}),await FN.stat(decodeURI(s).replace("remote.php/dav/",""),{details:!0,data:U0()}),this._metadataCache[s])return Ze.debug("Found metadata in cache after PROPFIND",{path:s,state:pt}),this._metadataCache[s];throw new Error("Could not find metadata for ".concat(s))},async setMetadata(s,e,t){const r=JSON.parse(e);Yc(r)?(await ng(r,t,r),await MN(r,await this.getServerPublicKeyPEM())):await ng(r,t,await this.getRootMetadata(xo.dirname(s))),this._metadataCache[s]=r,Ze.debug("Added metadata in cache",{path:s,state:pt})},async getMetadataInfo(s){const e=await this.getMetadata(s),t=await this.getRootMetadata(s),r=ed();if(r===null)throw new Error("No user logged in");return UN(e,await HN(t,r.uid,await pt.getUserPrivateKey()))},async getRootMetadata(s){const e=Object.entries(pt._metadataCache).filter(([t])=>s.startsWith(t)).map(([,t])=>t).find(t=>Yc(t));if(e)return Ze.debug("Found root metadata in cache",{path:s,state:pt}),e;for(Ze.debug("Looking for root metadata",{path:s,state:pt});s!=="/";){const t=await pt.getMetadata(s);if(Yc(t))return Ze.debug("Fetched root metadata",{path:s,state:pt}),t;s=xo.dirname(s)}throw new Error("Found no root metadata for ".concat(s))}};var JN=Object.defineProperty,qN=Object.defineProperties,WN=Object.getOwnPropertyDescriptors,ig=Object.getOwnPropertySymbols,_N=Object.prototype.hasOwnProperty,GN=Object.prototype.propertyIsEnumerable,og=(s,e,t)=>e in s?JN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,XN=(s,e)=>{for(var t in e||(e={}))_N.call(e,t)&&og(s,t,e[t]);if(ig)for(var t of ig(e))GN.call(e,t)&&og(s,t,e[t]);return s},zN=(s,e)=>qN(s,WN(e));let Yh;function YN(){Yh=window.fetch,Ze.debug("Setting up WebDAV decryption proxy"),window.fetch=async(s,e={})=>{let t=new Request(s,e);if(!(t.url.includes("/remote.php/dav/files/")&&(t.method==="GET"||t.method==="PROPFIND")))return Yh(t);Ze.debug("Proxying ".concat(t.method," ").concat(t.url),{request:t});const r=new Headers(t.headers);switch(r.set("X-E2EE-SUPPORTED","true"),t=new Request(t,{headers:r}),t.method){case"PROPFIND":return QN(t);case"GET":default:return ZN(t)}}}async function ZN(s){const e=new URL(s.url).pathname,t=Yh(s);try{const r=await pt.getMetadataInfo(xo.dirname(e)),a=r.files[xo.basename(s.url)];if(a===void 0)throw Ze.debug("Could not find file in metadata",{path:e,metadataInfo:r}),new Error("Could not find file in metadata");return await ek(await t,a)}catch(r){return await t}}async function QN(s){var e;Ze.debug("Fetching raw PROPFIND",{request:s});const t=await Yh(s),r=new URL(s.url).pathname,a=await t.text(),n=await T0(a),o=D0(n,r,!0);if(((e=o.props)==null?void 0:e["e2ee-is-encrypted"])!==1)return Ze.debug("Node is not e2ee",{xml:n}),new Response(a,t);if(o.type==="directory"){const i=o.props["e2ee-metadata"],u=o.props["e2ee-metadata-signature"];i!==void 0&&u!==void 0&&await pt.setMetadata(r,i,u);const c=await pt.getMetadata(r),l=await pt.getMetadataInfo(r);if(Yc(c))cf(n,r,l);else{const m=await pt.getMetadataInfo(xo.dirname(r));cf(n,r,l,m)}}else if(o.type==="file"){const i=await pt.getMetadataInfo(xo.dirname(r));if(i===void 0)return Ze.debug("Cannot find metadata for parent folder",{path:r}),new Response(a,t);cf(n,r,void 0,i)}return new Response(new B1.XMLBuilder().build(n),t)}function cf(s,e,t,r){Ze.debug("Updating PROPFIND info",{path:e,decryptedMetadata:t,decryptedParentMetadata:r,xml:s}),s.multistatus.response.forEach(a=>{if(a.propstat===void 0)return;const n=a.href===e?r:t,o=a.propstat.prop.displayname;let i=o;n!==void 0&&(n.files[o]?(i=n.files[o].filename,a.propstat.prop.getcontenttype=n.files[o].mimetype):n.folders[o]&&(i=n.folders[o],a.propstat.prop.getcontenttype="httpd/unix-directory")),a.propstat.prop.displayname=i,a.propstat.prop.permissions=a.propstat.prop.permissions.replace(/(R)|(D)|(N)|(V)|(W)|(CK)/g,"")})}async function ek(s,e){Ze.debug("Decrypting encrypted file",{response:s,fileEncryptionInfo:e});const t=await Od(new Uint8Array(await s.arrayBuffer()),await Ew(Ns(e.key)),{iv:Ns(e.nonce)}),r=new Headers(s.headers);return r.set("Content-Type",e.mimetype),new Response(t,zN(XN({},s),{headers:r}))}const tk='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-arrow-down" viewBox="0 0 24 24"><path d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z" /></svg>';function sk(s){if(!(s.permissions&jg.READ))return!1;if(s.attributes["share-attributes"]){const e=JSON.parse(s.attributes["share-attributes"]||"[]").find(({scope:t,key:r})=>t==="permissions"&&r==="download");if(e!==void 0)return e.value===!0}return!0}async function rk([s]){const e=await(await fetch(s.encodedSource)).arrayBuffer(),t=new Blob([e],{type:s.mime}),r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download=s.displayname,r.click()}const ak=new rv({id:"download_unencrypted",default:hd.DEFAULT,displayName:()=>mf("files","Download unencrypted"),iconSvgInline:()=>tk,enabled(s){return s.length!==1||s.some(e=>e.attributes["e2ee-is-encrypted"]!==1)||s.some(e=>!e.isDavRessource)||s.some(e=>e.type!==Ug.File)?!1:s.every(sk)},async exec(s){return rk([s]),null},order:30}),nk=zw("end_to_end_encryption","userConfig",{e2eeInBrowserEnabled:!1});nk.e2eeInBrowserEnabled&&(YN(),vm("nc:e2ee-is-encrypted",{nc:"http://nextcloud.org/ns"}),vm("nc:e2ee-metadata",{nc:"http://nextcloud.org/ns"}),vm("nc:e2ee-metadata-signature",{nc:"http://nextcloud.org/ns"}),av(ak),lg("download"),lg("move-copy"));function lg(s){Ze.debug("Inhibiting ".concat(s," actions for e2ee files"));const e=nv().find(r=>r.id===s),t=e._action.enabled;e._action.enabled=(r,a)=>r.some(n=>n.attributes["e2ee-is-encrypted"]===1)?!1:t(r,a)}
//# sourceMappingURL=end_to_end_encryption-files.mjs.map
