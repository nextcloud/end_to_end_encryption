{"version":3,"file":"end_to_end_encryption-filedrop.mjs","sources":["../node_modules/uuid/dist/stringify.js","../node_modules/uuid/dist/rng.js","../node_modules/uuid/dist/native.js","../node_modules/uuid/dist/v4.js","../node_modules/vue-material-design-icons/AlertCircle.vue","../node_modules/vue-material-design-icons/Check.vue","../src/services/filedrop.js","../src/services/crypto.js","../src/services/uploadFile.js","../src/views/FileDrop.vue","../src/main-filedrop.ts"],"sourcesContent":["import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : 'true'\"\n        :aria-label=\"title\"\n        class=\"material-design-icon alert-circle-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"AlertCircleIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : 'true'\"\n        :aria-label=\"title\"\n        class=\"material-design-icon check-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"CheckIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport axios from '@nextcloud/axios'\nimport { generateOcsUrl } from '@nextcloud/router'\nimport { encryptStringAsymmetric, encryptWithAES, getRandomEncryptionParams } from './crypto.js'\nimport logger from './logger.ts'\n\n/**\n * @typedef {object} FileMetadata\n * @property {string} filename - Original file name (ex: \"/foo/test.txt\")\n * @property {string} mimetype - Mimetype, if unknown use \"application/octet-stream\" (ex: \"plain/text\")\n * @property {string} key - Encryption key of the file (ex: \"jtboLmgGR1OQf2uneqCVHpklQLlIwWL5TXAQ0keK\")\n * @property {string} nonce - Initialisation vector\n * @property {string} authenticationTag - Authentication tag of the file (ex: \"LYRaJghbZUzBiNWb51ypWw==\")\n */\n\n/**\n * @typedef {object} UserEncryptionInformation\n * @property {string } userId\n * @property {string } encryptedFiledropKey\n */\n\n/**\n * @typedef {object} FileDropPayload\n * @property {string } ciphertext\n * @property {string } nonce\n * @property {string } authenticationTag\n * @property {UserEncryptionInformation[]} users\n */\n\n/**\n * @param {ArrayBuffer} buffer\n * @return {string}\n */\nexport function bufferToBase64(buffer) {\n\treturn btoa(String.fromCharCode(...new Uint8Array(buffer)))\n}\n\n/**\n * @param {import('./crypto.js').FileEncryptionInfo} encryptionInfo\n * @param {{[userId: string]: string}} publicKeys\n * @return {Promise<FileDropPayload>}\n */\nexport async function getFileDropEntry(encryptionInfo, publicKeys) {\n\tconst compressedEncryptionInfo = await compress(JSON.stringify(encryptionInfo))\n\tlogger.debug(`[FileDrop] Encryption info compressed (${encryptionInfo.filename})`, { encryptionInfo, compressedEncryptionInfo })\n\n\tconst encryptionParams = await getRandomEncryptionParams()\n\tconst { content, tag } = await encryptWithAES(\n\t\tencryptionParams,\n\t\tnew Uint8Array(compressedEncryptionInfo),\n\t)\n\tlogger.debug(`[FileDrop] Encryption info encrypted (${encryptionInfo.filename})`, { content, tag, encryptionParams })\n\tlogger.debug(`[FileDrop] Encryption info base64ed (${encryptionInfo.filename})`, { ciphertext: bufferToBase64(content) })\n\n\treturn {\n\t\tciphertext: bufferToBase64(content),\n\t\tnonce: bufferToBase64(encryptionParams.initializationVector),\n\t\tauthenticationTag: bufferToBase64(tag),\n\t\tusers: await encryptRandomKeyForUsers(publicKeys, encryptionParams),\n\t}\n}\n\n/**\n * @param {1|2} encryptionVersion - The encrypted version for the folder\n * @param {number} folderId\n * @param {{[uid: string]: FileDropPayload}} fileDrops\n * @param {string} shareToken\n */\nexport async function uploadFileDrop(encryptionVersion, folderId, fileDrops, shareToken) {\n\tconst ocsUrl = generateOcsUrl(\n\t\t'apps/end_to_end_encryption/api/v{encryptionVersion}/meta-data/{folderId}',\n\t\t{\n\t\t\tencryptionVersion,\n\t\t\tfolderId,\n\t\t},\n\t)\n\n\tconst { data: { ocs: { meta } } } = await axios.put(\n\t\t`${ocsUrl}/filedrop`,\n\t\t{\n\t\t\tfiledrop: JSON.stringify(fileDrops),\n\t\t},\n\t\t{\n\t\t\theaders: {\n\t\t\t\t'x-e2ee-supported': true,\n\t\t\t},\n\t\t\tparams: {\n\t\t\t\tshareToken,\n\t\t\t},\n\t\t},\n\t)\n\n\tif (meta.statuscode !== 200) {\n\t\tthrow new Error(`Failed to upload metadata: ${meta.message}`)\n\t}\n}\n\n/**\n * @param {string} str\n * @return {Promise<ArrayBuffer>}\n */\nasync function compress(str) {\n\tconst stream = new Blob([str]).stream()\n\tconst compressedStream = stream.pipeThrough(new CompressionStream('gzip'))\n\n\tconst chunks = []\n\tconst reader = compressedStream.getReader()\n\n\twhile (true) {\n\t\tconst { value } = await reader.read()\n\t\tif (value === undefined) {\n\t\t\tbreak\n\t\t}\n\t\tchunks.push(value)\n\t}\n\n\treturn new Uint8Array(await new Blob(chunks).arrayBuffer())\n}\n\n/**\n * @param {{[userId: string]: string}} usersPublicKeys\n * @param {import('./crypto.js').EncryptionParams} encryptionParams\n * @return {Promise<UserEncryptionInformation[]>}\n */\nasync function encryptRandomKeyForUsers(usersPublicKeys, encryptionParams) {\n\treturn Promise.all(Object.entries(usersPublicKeys).map(async ([userId, publicKey]) => {\n\t\tconst rawKey = await window.crypto.subtle.exportKey('raw', encryptionParams.key)\n\n\t\tconst encryptedFileDropKey = await encryptStringAsymmetric(\n\t\t\tpublicKey,\n\t\t\trawKey,\n\t\t)\n\n\t\treturn { userId, encryptedFiledropKey: bufferToBase64(encryptedFileDropKey) }\n\t}))\n}\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport * as x509 from '@peculiar/x509'\nimport { bufferToBase64 } from './filedrop.js'\nimport logger from './logger.ts'\n\n/**\n * Gets tag from encrypted data\n *\n * @param {ArrayBuffer} encrypted Encrypted data\n * @return {ArrayBuffer}\n */\nfunction getTag(encrypted) {\n\treturn encrypted.slice(encrypted.byteLength - 16)\n}\n\n/**\n * @return {Promise<CryptoKey>}\n */\nexport async function getRandomAESKey() {\n\treturn await window.crypto.subtle.generateKey(\n\t\t{\n\t\t\tname: 'AES-GCM',\n\t\t\tlength: 128,\n\t\t},\n\t\ttrue,\n\t\t['encrypt', 'decrypt'],\n\t)\n}\n\n/**\n * @typedef {object} EncryptionParams\n * @property {CryptoKey} key - Encryption key of the file (ex: \"jtboLmgGR1OQf2uneqCVHpklQLlIwWL5TXAQ0keK\")\n * @property {Uint8Array} initializationVector - Mimetype, if unknown use \"application/octet-stream\" (ex: \"plain/text\")\n */\n\n/**\n * @return {Promise<EncryptionParams>}\n */\nexport async function getRandomEncryptionParams() {\n\treturn {\n\t\tkey: await getRandomAESKey(),\n\t\tinitializationVector: window.crypto.getRandomValues(new Uint8Array(16)),\n\t}\n}\n\n/**\n * Encrypt file content\n *\n * @param {EncryptionParams} encryptionData\n * @param {Uint8Array} content\n * @return {Promise<{content: ArrayBuffer, tag: ArrayBuffer}>}\n */\nexport async function encryptWithAES({ key, initializationVector }, content) {\n\tconst encrypted = await window.crypto.subtle.encrypt(\n\t\t{ name: 'AES-GCM', iv: initializationVector },\n\t\tkey,\n\t\tcontent,\n\t)\n\n\treturn {\n\t\tcontent: encrypted,\n\t\ttag: getTag(encrypted),\n\t}\n}\n\n/**\n * @typedef {object} FileEncryptionInfo\n * @property {string} filename - Original file name (ex: \"/foo/test.txt\")\n * @property {string} mimetype - Mimetype, if unknown use \"application/octet-stream\" (ex: \"plain/text\")\n * @property {string} key - Encryption key of the file (ex: \"jtboLmgGR1OQf2uneqCVHpklQLlIwWL5TXAQ0keK\")\n * @property {string} nonce - Initialisation vector\n * @property {string} authenticationTag - Authentication tag of the file (ex: \"LYRaJghbZUzBiNWb51ypWw==\")\n */\n\n/**\n * Encrypt file content\n *\n * @param {File} file\n * @return {Promise<{encryptedFileContent: ArrayBuffer, encryptionInfo: FileEncryptionInfo}>}\n */\nexport async function encryptFile(file) {\n\tconst blob = await file.arrayBuffer()\n\tconst encryptionParams = await getRandomEncryptionParams()\n\tconst { content, tag } = await encryptWithAES(encryptionParams, new Uint8Array(blob))\n\tlogger.debug(`[FileDrop] File encrypted: ${file.name}`, { file, content, tag, encryptionParams, rawKey: bufferToBase64(await window.crypto.subtle.exportKey('raw', encryptionParams.key)) })\n\n\treturn {\n\t\tencryptedFileContent: content,\n\t\tencryptionInfo: {\n\t\t\tfilename: file.name,\n\t\t\tmimetype: file.type || 'application/octet-stream',\n\t\t\tnonce: bufferToBase64(encryptionParams.initializationVector),\n\t\t\tkey: bufferToBase64(await window.crypto.subtle.exportKey('raw', encryptionParams.key)),\n\t\t\tauthenticationTag: bufferToBase64(tag),\n\t\t},\n\t}\n}\n\n/**\n *\n * @param {string} pem\n * @return {Promise<CryptoKey>}\n */\nasync function importPublicKey(pem) {\n\t// fetch the part of the PEM string between header and footer\n\tconst cert = new x509.X509Certificate(pem)\n\n\treturn await window.crypto.subtle.importKey(\n\t\t'spki',\n\t\tcert.publicKey.rawData,\n\t\t{\n\t\t\tname: 'RSA-OAEP',\n\t\t\thash: 'SHA-256',\n\t\t},\n\t\ttrue,\n\t\t['encrypt'],\n\t)\n}\n\n/**\n * @param {string} publicKey\n * @param {BufferSource} buffer\n * @return {Promise<ArrayBuffer>}\n */\nexport async function encryptStringAsymmetric(publicKey, buffer) {\n\treturn await window.crypto.subtle.encrypt(\n\t\t{ name: 'RSA-OAEP' },\n\t\tawait importPublicKey(publicKey),\n\t\tbuffer,\n\t)\n}\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport axios from '@nextcloud/axios'\nimport { getRootUrl } from '@nextcloud/router'\nimport path from 'path'\n\n/**\n * @param {string} davEndpoint\n * @param {string} fileName\n * @param {string} content\n * @param {string} shareToken\n */\nexport async function uploadFile(davEndpoint, fileName, content, shareToken) {\n\tawait axios.put(\n\t\tpath.join(getRootUrl(), davEndpoint, fileName),\n\t\tcontent,\n\t\t{\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Basic ${btoa(`${shareToken}:`)}`,\n\t\t\t},\n\t\t},\n\t)\n}\n","<!--\n  - SPDX-FileCopyrightText: 2022 Carl Schwan <carl@carlschwan.eu>\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n  -->\n<template>\n\t<NcContent app-name=\"end_to_end_encryption\">\n\t\t<NcAppContent\n\t\t\t@drop.prevent=\"handleDrop\"\n\t\t\t@dragover.prevent=\"handleDragOver\"\n\t\t\t@dragleave=\"highlightDropZone = false\">\n\t\t\t<div\n\t\t\t\tclass=\"uploader-form\"\n\t\t\t\t:class=\"{ highlight: highlightDropZone }\">\n\t\t\t\t<div class=\"uploader-form__label\">\n\t\t\t\t\t<div class=\"uploader-form__icon icon-folder\" />\n\t\t\t\t\t{{ t(\"end_to_end_encryption\", \"Upload encrypted files to {fileName}\", { fileName }) }}\n\n\t\t\t\t\t<label\n\t\t\t\t\t\tclass=\"uploader-form__input button primary\"\n\t\t\t\t\t\t:class=\"{ loading }\">\n\t\t\t\t\t\t{{ t('end_to_end_encryption', 'Select or drop files') }}\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\t:disabled=\"loading\"\n\t\t\t\t\t\t\t@change=\"filesChange($event.target?.files)\">\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\n\t\t\t\t<ul class=\"uploader-form__file-list\">\n\t\t\t\t\t<li\n\t\t\t\t\t\tv-for=\"({ file, step, error }, index) in uploadedFiles\"\n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\tclass=\"uploader-form__file-list__item\">\n\t\t\t\t\t\t<IconAlertCircle v-if=\"error\" :size=\"20\" />\n\t\t\t\t\t\t<IconCheck v-else-if=\"step === UploadStep.DONE\" :size=\"20\" />\n\t\t\t\t\t\t<NcLoadingIcon v-else />\n\t\t\t\t\t\t<b>{{ file.name }}</b>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</NcAppContent>\n\t</NcContent>\n</template>\n\n<script>\nimport { showError } from '@nextcloud/dialogs'\nimport { loadState } from '@nextcloud/initial-state'\nimport { translate } from '@nextcloud/l10n'\nimport { v4 as uuidv4 } from 'uuid'\nimport NcAppContent from '@nextcloud/vue/components/NcAppContent'\nimport NcContent from '@nextcloud/vue/components/NcContent'\nimport NcLoadingIcon from '@nextcloud/vue/components/NcLoadingIcon'\nimport IconAlertCircle from 'vue-material-design-icons/AlertCircle.vue'\nimport IconCheck from 'vue-material-design-icons/Check.vue'\nimport { encryptFile } from '../services/crypto.js'\nimport { getFileDropEntry, uploadFileDrop } from '../services/filedrop.js'\nimport logger from '../services/logger.ts'\nimport { uploadFile } from '../services/uploadFile.js'\n\n/**\n * @readonly\n * @enum {string}\n */\nconst UploadStep = {\n\tNONE: 'none',\n\tENCRYPTING: 'encrypting',\n\tUPLOADING: 'uploading',\n\tUPLOADED: 'uploaded',\n\tUPLOADING_METADATA: 'uploading_metadata',\n\tDONE: 'done',\n}\n\n/**\n * @typedef {object} UploadProgress\n * @property {File} file\n * @property {UploadStep} step\n * @property {boolean} error\n * @property {Object<string, import('../services/filedrop.js').FileDropPayload>} fileDrop\n */\n\nexport default {\n\tname: 'FileDrop',\n\tcomponents: {\n\t\tNcContent,\n\t\tNcAppContent,\n\t\tNcLoadingIcon,\n\t\tIconCheck,\n\t\tIconAlertCircle,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\t/** @type {string} */\n\t\t\tshareToken: loadState('end_to_end_encryption', 'token'),\n\t\t\t/** @type {number} */\n\t\t\tfolderId: loadState('end_to_end_encryption', 'fileId'),\n\t\t\t/** @type {{[userId: string]: string}} */\n\t\t\tpublicKeys: loadState('end_to_end_encryption', 'publicKeys'),\n\t\t\t/** @type {string} */\n\t\t\tfileName: loadState('end_to_end_encryption', 'fileName'),\n\t\t\t/** @type {1|2} */\n\t\t\tencryptionVersion: Number.parseInt(loadState('end_to_end_encryption', 'encryptionVersion')),\n\t\t\t/** @type {{file: File, step: string, error: boolean}[]} */\n\t\t\tuploadedFiles: [],\n\t\t\tloading: false,\n\t\t\tUploadStep,\n\t\t\thighlightDropZone: false,\n\t\t}\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * @param {DragEvent} event\n\t\t */\n\t\thandleDragOver(event) {\n\t\t\tif (!event.dataTransfer?.types.includes('Files')) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tevent.dataTransfer.dropEffect = 'copy'\n\t\t\tthis.highlightDropZone = true\n\t\t},\n\n\t\t/**\n\t\t * @param {DragEvent} event\n\t\t */\n\t\thandleDrop(event) {\n\t\t\tif (!event.dataTransfer?.types.includes('Files')) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.filesChange(event.dataTransfer.files)\n\t\t\tthis.highlightDropZone = false\n\t\t},\n\n\t\t/**\n\t\t * @param {FileList?} fileList\n\t\t */\n\t\tasync filesChange(fileList) {\n\t\t\tif (!fileList?.length) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.loading) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.loading = true\n\t\t\t/** @type {UploadProgress[]} */\n\t\t\tlet progresses = []\n\n\t\t\ttry {\n\t\t\t\tprogresses = await Promise.all(Array\n\t\t\t\t\t.from(fileList)\n\t\t\t\t\t.map((file) => this.uploadFile(file)))\n\t\t\t\tlogger.debug('[FileDrop] Files uploaded', { progresses })\n\t\t\t} catch (exception) {\n\t\t\t\tlogger.error('[FileDrop] Error while uploading files', { exception })\n\t\t\t\tshowError(this.t('end_to_end_encryption', 'Error while uploading files'))\n\n\t\t\t\tfor (const progress of progresses) {\n\t\t\t\t\tprogress.error = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tprogresses\n\t\t\t\t\t.filter(({ error }) => !error)\n\t\t\t\t\t.forEach((progress) => { progress.step = UploadStep.UPLOADING_METADATA })\n\n\t\t\t\tconst fileDrops = progresses\n\t\t\t\t\t.filter(({ error }) => !error)\n\t\t\t\t\t.reduce((fileDropEntries, { fileDrop }) => ({ ...fileDropEntries, ...fileDrop }), {})\n\n\t\t\t\tlogger.debug('[FileDrop] FileDrop entries computed', { fileDrops })\n\n\t\t\t\tawait uploadFileDrop(this.encryptionVersion, this.folderId, fileDrops, this.shareToken)\n\t\t\t} catch (exception) {\n\t\t\t\tlogger.error('[FileDrop] Error while uploading metadata', { exception })\n\t\t\t\tshowError(this.t('end_to_end_encryption', 'Error while uploading metadata'))\n\n\t\t\t\tfor (const progress of progresses) {\n\t\t\t\t\tprogress.error = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprogresses\n\t\t\t\t.filter(({ error }) => !error)\n\t\t\t\t.forEach((progress) => { progress.step = UploadStep.DONE })\n\n\t\t\tthis.loading = false\n\t\t},\n\n\t\t/**\n\t\t * @param {File} unencryptedFile\n\t\t * @return {Promise<UploadProgress>}\n\t\t */\n\t\tasync uploadFile(unencryptedFile) {\n\t\t\t/** @type {UploadProgress} */\n\t\t\tconst progress = { file: unencryptedFile, step: UploadStep.NONE, error: false, fileDrop: {} }\n\t\t\tthis.uploadedFiles.push(progress)\n\n\t\t\ttry {\n\t\t\t\tprogress.step = UploadStep.ENCRYPTING\n\t\t\t\tconst { encryptedFileContent, encryptionInfo } = await encryptFile(unencryptedFile)\n\t\t\t\tconst encryptedFileName = uuidv4().replaceAll('-', '')\n\n\t\t\t\tprogress.fileDrop[encryptedFileName] = await getFileDropEntry(encryptionInfo, this.publicKeys)\n\t\t\t\tlogger.debug(`[FileDrop] Filedrop entry computed: ${unencryptedFile.name}`, { fileDropEntry: progress.fileDrop[encryptedFileName] })\n\n\t\t\t\tprogress.step = UploadStep.UPLOADING\n\t\t\t\tawait uploadFile(`/public.php/dav/files/${this.shareToken}`, encryptedFileName, encryptedFileContent, this.shareToken)\n\t\t\t\tprogress.step = UploadStep.UPLOADED\n\t\t\t\tlogger.debug(`[FileDrop] File uploaded: ${unencryptedFile.name}`, { encryptedFileContent, encryptionInfo, encryptedFileName, shareToken: this.shareToken })\n\t\t\t} catch (exception) {\n\t\t\t\tprogress.error = true\n\t\t\t\tlogger.error(`[FileDrop] Fail to upload the file (${progress.step})`, { exception })\n\t\t\t}\n\n\t\t\treturn progress\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n#app-content-vue {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\n\t.uploader-form {\n\t\twidth: 700px;\n\t\theight: 700px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tflex-direction: column;\n\n\t\t&.highlight {\n\t\t\tborder: 4px solid var(--color-primary);\n\t\t\tborder-radius: var(--border-radius-large);\n\t\t\tbackground: var(--color-primary-element-light-hover);\n\t\t}\n\n\t\t&__label {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: center;\n\t\t\tflex-direction: column;\n\t\t\tfont-weight: bold;\n\t\t\tfont-size: 20px;\n\t\t\ttext-align: center;\n\t\t\tposition: sticky;\n\t\t}\n\n\t\t&__icon {\n\t\t\tmargin-bottom: 12px;\n\t\t\theight: 48px;\n\t\t\twidth: 48px;\n\t\t\tbackground-size: 48px;\n\t\t}\n\n\t\t&__input {\n\t\t\tmargin-top: 20px;\n\n\t\t\tinput {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\n\t\t&__file-list {\n\t\t\tmargin-top: 12px;\n\t\t\theight: 100%;\n\t\t\toverflow: scroll;\n\t\t\tpadding: 0 32px;\n\n\t\t\t&__item {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\n\t\t\t\t.material-design-icon {\n\t\t\t\t\tmargin-right: 8px;\n\t\t\t\t}\n\n\t\t\t\t.loading-icon :deep(svg) {\n\t\t\t\t\tanimation: rotate var(--animation-duration, 0.8s) linear\n\t\t\t\t\t\tinfinite;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue'\nimport FileDrop from './views/FileDrop.vue'\n\nconst createAppInstance = createApp(FileDrop)\ncreateAppInstance.mount('#content')\n"],"names":["byteToHex","i","unsafeStringify","arr","offset","getRandomValues","rnds8","rng","randomUUID","native","_v4","options","buf","rnds","v4","_sfc_main","_hoisted_3","_createElementBlock","_mergeProps","_ctx","$props","_cache","$event","_createElementVNode","_openBlock","bufferToBase64","buffer","getFileDropEntry","encryptionInfo","publicKeys","compressedEncryptionInfo","compress","logger","encryptionParams","getRandomEncryptionParams","content","tag","encryptWithAES","encryptRandomKeyForUsers","uploadFileDrop","encryptionVersion","folderId","fileDrops","shareToken","ocsUrl","generateOcsUrl","meta","axios","str","compressedStream","chunks","reader","value","usersPublicKeys","userId","publicKey","rawKey","encryptedFileDropKey","encryptStringAsymmetric","getTag","encrypted","getRandomAESKey","key","initializationVector","encryptFile","file","blob","importPublicKey","pem","cert","x509.X509Certificate","uploadFile","davEndpoint","fileName","path","getRootUrl","UploadStep","NcContent","NcAppContent","NcLoadingIcon","IconCheck","IconAlertCircle","loadState","event","fileList","progresses","exception","showError","progress","error","fileDropEntries","fileDrop","unencryptedFile","encryptedFileContent","encryptedFileName","uuidv4","translate","_hoisted_1","_createBlock","_component_NcContent","_createVNode","_component_NcAppContent","$options","$data","_normalizeClass","_createTextVNode","_toDisplayString","_Fragment","_renderList","step","index","_component_IconAlertCircle","_component_IconCheck","_component_NcLoadingIcon","createAppInstance","createApp","FileDrop"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}