(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".admin-e2ee__headline[data-v-510ac2f4]{margin-block:.5em 1em}.admin-e2ee__group-select[data-v-510ac2f4]{max-width:300px}.admin-e2ee__save-button[data-v-510ac2f4]{margin-block-start:1em}")),document.head.appendChild(e)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}})();
import{a as h,e as y,v as f,M as G,F as t,i as S,j as C,w as l,z as r,k as p,m as s,l as b,t as c,x as w,K as v}from"./NcTextField.vue_vue_type_script_setup_true_lang-Dl9AQfwW-kVMkfD_F.chunk.mjs";import{d as N,_ as E,b as V,e as k,c as A}from"./index-Dh8t1o6F-CzocEM6x.chunk.mjs";const B=h().setApp("end_to_end_encryption").detectUser().build(),L={name:"AdminSection",components:{NcButton:G,NcSelect:k,NcSettingsSection:V},setup(){return{t:c}},data(){return{loading:!1,loadingGroups:!0,allowedGroups:w("end_to_end_encryption","allowed_groups").map(n=>({id:n,displayname:n})).sort(function(n,e){return n.displayname.localeCompare(e.displayname)}),groups:[]}},mounted(){this.groups=this.allowedGroups,this.searchGroup()},methods:{searchGroup:N(async function(n){this.loadingGroups=!0;try{const e=await y.get(f("cloud/groups/details"),{search:n,limit:20,offset:0});this.groups=e.data.ocs.data.groups.sort(function(i,o){return i.displayname.localeCompare(o.displayname)})}catch(e){B.error("Could not fetch groups",e)}finally{this.loadingGroups=!1}},500),saveChanges(){this.loading=!0,this.loadingGroups=!0;const n=this.allowedGroups.map(e=>e.id);OCP.AppConfig.setValue("end_to_end_encryption","allowed_groups",JSON.stringify(n),{success:function(){this.loading=!1,this.loadingGroups=!1,A(c("end_to_end_encryption","Saved groups"))}.bind(this)})}}},O={class:"settings-hint"};function U(n,e,i,o,a,d){const u=t("NcSelect"),g=t("NcButton"),_=t("NcSettingsSection");return C(),S(_,{name:o.t("end_to_end_encryption","End-to-End Encryption"),class:"admin-e2ee"},{default:l(()=>[r("h3",null,s(o.t("end_to_end_encryption","Limit to groups")),1),r("p",O,s(o.t("end_to_end_encryption","When at least one group is selected, only people of the listed groups can use the End-to-End encryption app.")),1),p(u,{modelValue:a.allowedGroups,"onUpdate:modelValue":e[0]||(e[0]=m=>a.allowedGroups=m),class:"admin-e2ee__group-select",disabled:a.loading,"input-label":o.t("end_to_end_encryption","Limit app usage to groups"),label:"displayname",loading:a.loadingGroups,options:a.groups,multiple:"",searchable:"",onSearchChange:d.searchGroup},null,8,["modelValue","disabled","input-label","loading","options","onSearchChange"]),p(g,{class:"admin-e2ee__save-button",loading:a.loading,variant:"primary",onClick:d.saveChanges},{default:l(()=>[b(s(o.t("end_to_end_encryption","Save")),1)]),_:1},8,["loading","onClick"])]),_:1},8,["name"])}const j=E(L,[["render",U],["__scopeId","data-v-510ac2f4"]]),x=v(j);x.mount("#security-admin-end-to-end");
//# sourceMappingURL=end_to_end_encryption-adminSettings.mjs.map
