import{f as w,r as f,y as E,e as C,v as O,l as T,O as P,i as S,j,w as v,A as h,k as b,n as y,u as i,t as c,P as V,m as A,L as D}from"./NcTextField.vue_vue_type_script_setup_true_lang-DVAnIMOA-DZ93Vf5U.chunk.mjs";import{b as L,c as k,d as x,_ as U}from"./index-hZPKu-D6-BMQVGFqI.chunk.mjs";function I(m,a=100,s={}){if(typeof m!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof m}\`.`);if(a<0)throw new RangeError("`wait` must not be negative.");if(typeof s=="boolean")throw new TypeError("The `options` parameter must be an object, not a boolean. Use `{immediate: true}` instead.");const{immediate:r}=s;let o,l,t,n,e;function d(){const p=o,g=l;return o=void 0,l=void 0,e=m.apply(p,g),e}function _(){const p=Date.now()-n;p<a&&p>=0?t=setTimeout(_,a-p):(t=void 0,r||(e=d()))}const u=function(...p){if(o&&this!==o&&Object.getPrototypeOf(this)===Object.getPrototypeOf(o))throw new Error("Debounced method called with different contexts of the same prototype.");o=this,l=p,n=Date.now();const g=r&&!t;if(t||(t=setTimeout(_,a)),g)return e=d(),e};return Object.defineProperty(u,"isPending",{get(){return t!==void 0}}),u.clear=()=>{t&&(clearTimeout(t),t=void 0,o=void 0,l=void 0)},u.flush=()=>{t&&u.trigger()},u.trigger=()=>{e=d(),u.clear()},u}const J={class:"settings-hint"},N=w({__name:"SettingsAdmin",setup(m){const a=f(!1),s=f(!0),r=f(E("end_to_end_encryption","allowed_groups").map(n=>({id:n,displayname:n})).sort(function(n,e){return n.displayname.localeCompare(e.displayname)})),o=f([...r.value]),l=I(async function(n){s.value=!0;try{const{data:e}=await C.get(O("cloud/groups/details"),{params:{search:n,limit:20,offset:0}});o.value=e.ocs.data.groups.sort(function(d,_){return d.displayname.localeCompare(_.displayname)})}catch(e){T.error("Could not fetch groups",{error:e})}finally{s.value=!1}},500);P(()=>l());function t(){a.value=!0,s.value=!0;const n=r.value.map(e=>e.id);globalThis.OCP.AppConfig.setValue("end_to_end_encryption","allowed_groups",JSON.stringify(n),{success(){a.value=!1,s.value=!1,x(c("end_to_end_encryption","Saved groups"))}})}return(n,e)=>(j(),S(i(k),{name:i(c)("end_to_end_encryption","End-to-End Encryption"),class:"admin-e2ee"},{default:v(()=>[h("h3",null,y(i(c)("end_to_end_encryption","Limit to groups")),1),h("p",J,y(i(c)("end_to_end_encryption","When at least one group is selected, only people of the listed groups can use the End-to-End encryption app.")),1),b(i(L),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=d=>r.value=d),class:"admin-e2ee__group-select",disabled:a.value,"input-label":i(c)("end_to_end_encryption","Limit app usage to groups"),label:"displayname",loading:s.value,options:o.value,multiple:"",searchable:"",onSearchChange:i(l)},null,8,["modelValue","disabled","input-label","loading","options","onSearchChange"]),b(i(V),{class:"admin-e2ee__save-button",loading:a.value,variant:"primary",onClick:t},{default:v(()=>[A(y(i(c)("end_to_end_encryption","Save")),1)]),_:1},8,["loading"])]),_:1},8,["name"]))}}),R=U(N,[["__scopeId","data-v-7d1edcb1"]]),B=D(R);B.mount("#security-admin-end-to-end");
//# sourceMappingURL=end_to_end_encryption-settings-admin.mjs.map
