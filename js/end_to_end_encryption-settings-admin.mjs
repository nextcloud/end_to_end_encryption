import{f as v,r as d,y as f,e as h,v as b,l as C,O as S,i as E,j as w,w as c,A as _,k as m,n as p,u as n,t as o,P as V,m as A,L}from"./NcTextField.vue_vue_type_script_setup_true_lang-DVAnIMOA-DZ93Vf5U.chunk.mjs";import{d as O,b as k,c as P,e as j,_ as I}from"./index-hZPKu-D6-Bl6c5YqR.chunk.mjs";const J={class:"settings-hint"},N=v({__name:"SettingsAdmin",setup(B){const s=d(!1),t=d(!0),l=d(f("end_to_end_encryption","allowed_groups").map(a=>({id:a,displayname:a})).sort(function(a,e){return a.displayname.localeCompare(e.displayname)})),u=d([...l.value]),r=O(async function(a){t.value=!0;try{const{data:e}=await h.get(b("cloud/groups/details"),{params:{search:a,limit:20,offset:0}});u.value=e.ocs.data.groups.sort(function(i,y){return i.displayname.localeCompare(y.displayname)})}catch(e){C.error("Could not fetch groups",{error:e})}finally{t.value=!1}},500);S(()=>r());function g(){s.value=!0,t.value=!0;const a=l.value.map(e=>e.id);globalThis.OCP.AppConfig.setValue("end_to_end_encryption","allowed_groups",JSON.stringify(a),{success(){s.value=!1,t.value=!1,j(o("end_to_end_encryption","Saved groups"))}})}return(a,e)=>(w(),E(n(P),{name:n(o)("end_to_end_encryption","End-to-End Encryption"),class:"admin-e2ee"},{default:c(()=>[_("h3",null,p(n(o)("end_to_end_encryption","Limit to groups")),1),_("p",J,p(n(o)("end_to_end_encryption","When at least one group is selected, only people of the listed groups can use the End-to-End encryption app.")),1),m(n(k),{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=i=>l.value=i),class:"admin-e2ee__group-select",disabled:s.value,"input-label":n(o)("end_to_end_encryption","Limit app usage to groups"),label:"displayname",loading:t.value,options:u.value,multiple:"",searchable:"",onSearchChange:n(r)},null,8,["modelValue","disabled","input-label","loading","options","onSearchChange"]),m(n(V),{class:"admin-e2ee__save-button",loading:s.value,variant:"primary",onClick:g},{default:c(()=>[A(p(n(o)("end_to_end_encryption","Save")),1)]),_:1},8,["loading"])]),_:1},8,["name"]))}}),T=I(N,[["__scopeId","data-v-7d1edcb1"]]),x=L(T);x.mount("#security-admin-end-to-end");
//# sourceMappingURL=end_to_end_encryption-settings-admin.mjs.map
