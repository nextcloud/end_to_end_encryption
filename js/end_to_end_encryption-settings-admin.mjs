import{f as v,A as d,$ as h,a9 as f,n as b,v as C,s as S,z as E,E as V,j as w,I as c,O as _,J as m,m as u,u as n,t as o,aa as A,S as O,l as I,ab as J,ac as L,Q as j,a7 as k}from"./logger-B4anbVAK.chunk.mjs";const z={class:"settings-hint"},N=v({__name:"SettingsAdmin",setup(B){const t=d(!1),s=d(!0),l=d(h("end_to_end_encryption","allowed_groups").map(a=>({id:a,displayname:a})).sort(function(a,e){return a.displayname.localeCompare(e.displayname)})),p=d([...l.value]),r=f(async function(a){s.value=!0;try{const{data:e}=await b.get(C("cloud/groups/details"),{params:{search:a,limit:20,offset:0}});p.value=e.ocs.data.groups.sort(function(i,y){return i.displayname.localeCompare(y.displayname)})}catch(e){S.error("Could not fetch groups",{error:e})}finally{s.value=!1}},500);E(()=>r());function g(){t.value=!0,s.value=!0;const a=l.value.map(e=>e.id);globalThis.OCP.AppConfig.setValue("end_to_end_encryption","allowed_groups",JSON.stringify(a),{success(){t.value=!1,s.value=!1,L(o("end_to_end_encryption","Saved groups"))}})}return(a,e)=>(w(),V(n(J),{name:n(o)("end_to_end_encryption","End-to-End Encryption"),class:"admin-e2ee"},{default:c(()=>[_("h3",null,u(n(o)("end_to_end_encryption","Limit to groups")),1),_("p",z,u(n(o)("end_to_end_encryption","When at least one group is selected, only people of the listed groups can use the End-to-End encryption app.")),1),m(n(A),{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=i=>l.value=i),class:"admin-e2ee__group-select",disabled:t.value,"input-label":n(o)("end_to_end_encryption","Limit app usage to groups"),label:"displayname",loading:s.value,options:p.value,multiple:"",searchable:"",onSearchChange:n(r)},null,8,["modelValue","disabled","input-label","loading","options","onSearchChange"]),m(n(O),{class:"admin-e2ee__save-button",loading:t.value,variant:"primary",onClick:g},{default:c(()=>[I(u(n(o)("end_to_end_encryption","Save")),1)]),_:1},8,["loading"])]),_:1},8,["name"]))}}),T=j(N,[["__scopeId","data-v-7d1edcb1"]]),x=k(T);x.mount("#security-admin-end-to-end");
//# sourceMappingURL=end_to_end_encryption-settings-admin.mjs.map
