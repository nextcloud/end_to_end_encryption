var rh=Object.defineProperty,nh=Object.defineProperties;var ih=Object.getOwnPropertyDescriptors;var Fr=Object.getOwnPropertySymbols;var aa=Object.prototype.hasOwnProperty,ca=Object.prototype.propertyIsEnumerable;var sa=(r,t,e)=>t in r?rh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,M=(r,t)=>{for(var e in t||(t={}))aa.call(t,e)&&sa(r,e,t[e]);if(Fr)for(var e of Fr(t))ca.call(t,e)&&sa(r,e,t[e]);return r},X=(r,t)=>nh(r,ih(t));var Y=(r,t)=>{var e={};for(var n in r)aa.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&Fr)for(var n of Fr(r))t.indexOf(n)<0&&ca.call(r,n)&&(e[n]=r[n]);return e};import{p as oh,a7 as sh,U as ro,B as ua,g as zr}from"./_plugin-vue2_normalizer-CZfMKWEi.chunk.mjs";function Ut(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function la(r,t){for(var e="",n=0,i=-1,o=0,a,c=0;c<=r.length;++c){if(c<r.length)a=r.charCodeAt(c);else{if(a===47)break;a=47}if(a===47){if(!(i===c-1||o===1))if(i!==c-1&&o===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",n=0):(e=e.slice(0,l),n=e.length-1-e.lastIndexOf("/")),i=c,o=0;continue}}else if(e.length===2||e.length===1){e="",n=0,i=c,o=0;continue}}t&&(e.length>0?e+="/..":e="..",n=2)}else e.length>0?e+="/"+r.slice(i+1,c):e=r.slice(i+1,c),n=c-i-1;i=c,o=0}else a===46&&o!==-1?++o:o=-1}return e}function ah(r,t){var e=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return e?e===t.root?e+n:e+r+n:n}var ze={resolve:function(){for(var r="",t=!1,e,n=arguments.length-1;n>=-1&&!t;n--){var i;n>=0?i=arguments[n]:(e===void 0&&(e=oh.cwd()),i=e),Ut(i),i.length!==0&&(r=i+"/"+r,t=i.charCodeAt(0)===47)}return r=la(r,!t),t?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(r){if(Ut(r),r.length===0)return".";var t=r.charCodeAt(0)===47,e=r.charCodeAt(r.length-1)===47;return r=la(r,!t),r.length===0&&!t&&(r="."),r.length>0&&e&&(r+="/"),t?"/"+r:r},isAbsolute:function(r){return Ut(r),r.length>0&&r.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var r,t=0;t<arguments.length;++t){var e=arguments[t];Ut(e),e.length>0&&(r===void 0?r=e:r+="/"+e)}return r===void 0?".":ze.normalize(r)},relative:function(r,t){if(Ut(r),Ut(t),r===t||(r=ze.resolve(r),t=ze.resolve(t),r===t))return"";for(var e=1;e<r.length&&r.charCodeAt(e)===47;++e);for(var n=r.length,i=n-e,o=1;o<t.length&&t.charCodeAt(o)===47;++o);for(var a=t.length,c=a-o,l=i<c?i:c,f=-1,v=0;v<=l;++v){if(v===l){if(c>l){if(t.charCodeAt(o+v)===47)return t.slice(o+v+1);if(v===0)return t.slice(o+v)}else i>l&&(r.charCodeAt(e+v)===47?f=v:v===0&&(f=0));break}var m=r.charCodeAt(e+v),$=t.charCodeAt(o+v);if(m!==$)break;m===47&&(f=v)}var x="";for(v=e+f+1;v<=n;++v)(v===n||r.charCodeAt(v)===47)&&(x.length===0?x+="..":x+="/..");return x.length>0?x+t.slice(o+f):(o+=f,t.charCodeAt(o)===47&&++o,t.slice(o))},_makeLong:function(r){return r},dirname:function(r){if(Ut(r),r.length===0)return".";for(var t=r.charCodeAt(0),e=t===47,n=-1,i=!0,o=r.length-1;o>=1;--o)if(t=r.charCodeAt(o),t===47){if(!i){n=o;break}}else i=!1;return n===-1?e?"/":".":e&&n===1?"//":r.slice(0,n)},basename:function(r,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ut(r);var e=0,n=-1,i=!0,o;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";var a=t.length-1,c=-1;for(o=r.length-1;o>=0;--o){var l=r.charCodeAt(o);if(l===47){if(!i){e=o+1;break}}else c===-1&&(i=!1,c=o+1),a>=0&&(l===t.charCodeAt(a)?--a===-1&&(n=o):(a=-1,n=c))}return e===n?n=c:n===-1&&(n=r.length),r.slice(e,n)}else{for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===47){if(!i){e=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(e,n)}},extname:function(r){Ut(r);for(var t=-1,e=0,n=-1,i=!0,o=0,a=r.length-1;a>=0;--a){var c=r.charCodeAt(a);if(c===47){if(!i){e=a+1;break}continue}n===-1&&(i=!1,n=a+1),c===46?t===-1?t=a:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===e+1?"":r.slice(t,n)},format:function(r){if(r===null||typeof r!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof r);return ah("/",r)},parse:function(r){Ut(r);var t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;var e=r.charCodeAt(0),n=e===47,i;n?(t.root="/",i=1):i=0;for(var o=-1,a=0,c=-1,l=!0,f=r.length-1,v=0;f>=i;--f){if(e=r.charCodeAt(f),e===47){if(!l){a=f+1;break}continue}c===-1&&(l=!1,c=f+1),e===46?o===-1?o=f:v!==1&&(v=1):o!==-1&&(v=-1)}return o===-1||c===-1||v===0||v===1&&o===c-1&&o===a+1?c!==-1&&(a===0&&n?t.base=t.name=r.slice(1,c):t.base=t.name=r.slice(a,c)):(a===0&&n?(t.name=r.slice(1,o),t.base=r.slice(1,c)):(t.name=r.slice(a,o),t.base=r.slice(a,c)),t.ext=r.slice(o,c)),a>0?t.dir=r.slice(0,a-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};ze.posix=ze;var ch=ze;const af=sh(ch);var ha;(function(r){(function(t){var e=typeof globalThis=="object"?globalThis:typeof ro=="object"?ro:typeof self=="object"?self:typeof this=="object"?this:c(),n=i(r);typeof e.Reflect<"u"&&(n=i(e.Reflect,n)),t(n,e),typeof e.Reflect>"u"&&(e.Reflect=r);function i(l,f){return function(v,m){Object.defineProperty(l,v,{configurable:!0,writable:!0,value:m}),f&&f(v,m)}}function o(){try{return Function("return this;")()}catch(l){}}function a(){try{return(0,eval)("(function() { return this; })()")}catch(l){}}function c(){return o()||a()}})(function(t,e){var n=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,f=!c&&!l,v={create:c?function(){return Oi(Object.create(null))}:l?function(){return Oi({__proto__:null})}:function(){return Oi({})},has:f?function(y,g){return n.call(y,g)}:function(y,g){return g in y},get:f?function(y,g){return n.call(y,g)?y[g]:void 0}:function(y,g){return y[g]}},m=Object.getPrototypeOf(Function),$=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Yl(),x=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Xl(),h=typeof WeakMap=="function"?WeakMap:Ql(),d=i?Symbol.for("@reflect-metadata:registry"):void 0,S=Gl(),w=Jl(S);function O(y,g,b,k){if(L(b)){if(!Xs(y))throw new TypeError;if(!Qs(g))throw new TypeError;return $l(y,g)}else{if(!Xs(y))throw new TypeError;if(!tt(g))throw new TypeError;if(!tt(k)&&!L(k)&&!Ee(k))throw new TypeError;return Ee(k)&&(k=void 0),b=Rt(b),Ml(y,g,b,k)}}t("decorate",O);function C(y,g){function b(k,D){if(!tt(k))throw new TypeError;if(!L(D)&&!Wl(D))throw new TypeError;_s(y,g,k,D)}return b}t("metadata",C);function _(y,g,b,k){if(!tt(b))throw new TypeError;return L(k)||(k=Rt(k)),_s(y,g,b,k)}t("defineMetadata",_);function Hr(y,g,b){if(!tt(g))throw new TypeError;return L(b)||(b=Rt(b)),Ks(y,g,b)}t("hasMetadata",Hr);function $r(y,g,b){if(!tt(g))throw new TypeError;return L(b)||(b=Rt(b)),xi(y,g,b)}t("hasOwnMetadata",$r);function or(y,g,b){if(!tt(g))throw new TypeError;return L(b)||(b=Rt(b)),qs(y,g,b)}t("getMetadata",or);function Vl(y,g,b){if(!tt(g))throw new TypeError;return L(b)||(b=Rt(b)),Ws(y,g,b)}t("getOwnMetadata",Vl);function Dl(y,g){if(!tt(y))throw new TypeError;return L(g)||(g=Rt(g)),Gs(y,g)}t("getMetadataKeys",Dl);function Ll(y,g){if(!tt(y))throw new TypeError;return L(g)||(g=Rt(g)),Js(y,g)}t("getOwnMetadataKeys",Ll);function Hl(y,g,b){if(!tt(g))throw new TypeError;if(L(b)||(b=Rt(b)),!tt(g))throw new TypeError;L(b)||(b=Rt(b));var k=sr(g,b,!1);return L(k)?!1:k.OrdinaryDeleteMetadata(y,g,b)}t("deleteMetadata",Hl);function $l(y,g){for(var b=y.length-1;b>=0;--b){var k=y[b],D=k(g);if(!L(D)&&!Ee(D)){if(!Qs(D))throw new TypeError;g=D}}return g}function Ml(y,g,b,k){for(var D=y.length-1;D>=0;--D){var it=y[D],et=it(g,b,k);if(!L(et)&&!Ee(et)){if(!tt(et))throw new TypeError;k=et}}return k}function Ks(y,g,b){var k=xi(y,g,b);if(k)return!0;var D=Ci(g);return Ee(D)?!1:Ks(y,D,b)}function xi(y,g,b){var k=sr(g,b,!1);return L(k)?!1:Ys(k.OrdinaryHasOwnMetadata(y,g,b))}function qs(y,g,b){var k=xi(y,g,b);if(k)return Ws(y,g,b);var D=Ci(g);if(!Ee(D))return qs(y,D,b)}function Ws(y,g,b){var k=sr(g,b,!1);if(!L(k))return k.OrdinaryGetOwnMetadata(y,g,b)}function _s(y,g,b,k){var D=sr(b,k,!0);D.OrdinaryDefineOwnMetadata(y,g,b,k)}function Gs(y,g){var b=Js(y,g),k=Ci(y);if(k===null)return b;var D=Gs(k,g);if(D.length<=0)return b;if(b.length<=0)return D;for(var it=new x,et=[],F=0,N=b;F<N.length;F++){var P=N[F],R=it.has(P);R||(it.add(P),et.push(P))}for(var V=0,z=D;V<z.length;V++){var P=z[V],R=it.has(P);R||(it.add(P),et.push(P))}return et}function Js(y,g){var b=sr(y,g,!1);return b?b.OrdinaryOwnMetadataKeys(y,g):[]}function Zs(y){if(y===null)return 1;switch(typeof y){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return y===null?1:6;default:return 6}}function L(y){return y===void 0}function Ee(y){return y===null}function Fl(y){return typeof y=="symbol"}function tt(y){return typeof y=="object"?y!==null:typeof y=="function"}function zl(y,g){switch(Zs(y)){case 0:return y;case 1:return y;case 2:return y;case 3:return y;case 4:return y;case 5:return y}var b="string",k=ta(y,o);if(k!==void 0){var D=k.call(y,b);if(tt(D))throw new TypeError;return D}return Kl(y)}function Kl(y,g){var b,k;{var D=y.toString;if(Mr(D)){var k=D.call(y);if(!tt(k))return k}var b=y.valueOf;if(Mr(b)){var k=b.call(y);if(!tt(k))return k}}throw new TypeError}function Ys(y){return!!y}function ql(y){return""+y}function Rt(y){var g=zl(y);return Fl(g)?g:ql(g)}function Xs(y){return Array.isArray?Array.isArray(y):y instanceof Object?y instanceof Array:Object.prototype.toString.call(y)==="[object Array]"}function Mr(y){return typeof y=="function"}function Qs(y){return typeof y=="function"}function Wl(y){switch(Zs(y)){case 3:return!0;case 4:return!0;default:return!1}}function ki(y,g){return y===g||y!==y&&g!==g}function ta(y,g){var b=y[g];if(b!=null){if(!Mr(b))throw new TypeError;return b}}function ea(y){var g=ta(y,a);if(!Mr(g))throw new TypeError;var b=g.call(y);if(!tt(b))throw new TypeError;return b}function ra(y){return y.value}function na(y){var g=y.next();return g.done?!1:g}function ia(y){var g=y.return;g&&g.call(y)}function Ci(y){var g=Object.getPrototypeOf(y);if(typeof y!="function"||y===m||g!==m)return g;var b=y.prototype,k=b&&Object.getPrototypeOf(b);if(k==null||k===Object.prototype)return g;var D=k.constructor;return typeof D!="function"||D===y?g:D}function _l(){var y;!L(d)&&typeof e.Reflect<"u"&&!(d in e.Reflect)&&typeof e.Reflect.defineMetadata=="function"&&(y=Zl(e.Reflect));var g,b,k,D=new h,it={registerProvider:et,getProvider:N,setProvider:R};return it;function et(V){if(!Object.isExtensible(it))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case y===V:break;case L(g):g=V;break;case g===V:break;case L(b):b=V;break;case b===V:break;default:k===void 0&&(k=new x),k.add(V);break}}function F(V,z){if(!L(g)){if(g.isProviderFor(V,z))return g;if(!L(b)){if(b.isProviderFor(V,z))return g;if(!L(k))for(var G=ea(k);;){var Q=na(G);if(!Q)return;var It=ra(Q);if(It.isProviderFor(V,z))return ia(G),It}}}if(!L(y)&&y.isProviderFor(V,z))return y}function N(V,z){var G=D.get(V),Q;return L(G)||(Q=G.get(z)),L(Q)&&(Q=F(V,z),L(Q)||(L(G)&&(G=new $,D.set(V,G)),G.set(z,Q))),Q}function P(V){if(L(V))throw new TypeError;return g===V||b===V||!L(k)&&k.has(V)}function R(V,z,G){if(!P(G))throw new Error("Metadata provider not registered.");var Q=N(V,z);if(Q!==G){if(!L(Q))return!1;var It=D.get(V);L(It)&&(It=new $,D.set(V,It)),It.set(z,G)}return!0}}function Gl(){var y;return!L(d)&&tt(e.Reflect)&&Object.isExtensible(e.Reflect)&&(y=e.Reflect[d]),L(y)&&(y=_l()),!L(d)&&tt(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,d,{enumerable:!1,configurable:!1,writable:!1,value:y}),y}function Jl(y){var g=new h,b={isProviderFor:function(P,R){var V=g.get(P);return L(V)?!1:V.has(R)},OrdinaryDefineOwnMetadata:et,OrdinaryHasOwnMetadata:D,OrdinaryGetOwnMetadata:it,OrdinaryOwnMetadataKeys:F,OrdinaryDeleteMetadata:N};return S.registerProvider(b),b;function k(P,R,V){var z=g.get(P),G=!1;if(L(z)){if(!V)return;z=new $,g.set(P,z),G=!0}var Q=z.get(R);if(L(Q)){if(!V)return;if(Q=new $,z.set(R,Q),!y.setProvider(P,R,b))throw z.delete(R),G&&g.delete(P),new Error("Wrong provider for target.")}return Q}function D(P,R,V){var z=k(R,V,!1);return L(z)?!1:Ys(z.has(P))}function it(P,R,V){var z=k(R,V,!1);if(!L(z))return z.get(P)}function et(P,R,V,z){var G=k(V,z,!0);G.set(P,R)}function F(P,R){var V=[],z=k(P,R,!1);if(L(z))return V;for(var G=z.keys(),Q=ea(G),It=0;;){var oa=na(Q);if(!oa)return V.length=It,V;var th=ra(oa);try{V[It]=th}catch(eh){try{ia(Q)}finally{throw eh}}It++}}function N(P,R,V){var z=k(R,V,!1);if(L(z)||!z.delete(P))return!1;if(z.size===0){var G=g.get(R);L(G)||(G.delete(V),G.size===0&&g.delete(G))}return!0}}function Zl(y){var g=y.defineMetadata,b=y.hasOwnMetadata,k=y.getOwnMetadata,D=y.getOwnMetadataKeys,it=y.deleteMetadata,et=new h,F={isProviderFor:function(N,P){var R=et.get(N);return!L(R)&&R.has(P)?!0:D(N,P).length?(L(R)&&(R=new x,et.set(N,R)),R.add(P),!0):!1},OrdinaryDefineOwnMetadata:g,OrdinaryHasOwnMetadata:b,OrdinaryGetOwnMetadata:k,OrdinaryOwnMetadataKeys:D,OrdinaryDeleteMetadata:it};return F}function sr(y,g,b){var k=S.getProvider(y,g);if(!L(k))return k;if(b){if(S.setProvider(y,g,w))return w;throw new Error("Illegal state.")}}function Yl(){var y={},g=[],b=function(){function F(N,P,R){this._index=0,this._keys=N,this._values=P,this._selector=R}return F.prototype["@@iterator"]=function(){return this},F.prototype[a]=function(){return this},F.prototype.next=function(){var N=this._index;if(N>=0&&N<this._keys.length){var P=this._selector(this._keys[N],this._values[N]);return N+1>=this._keys.length?(this._index=-1,this._keys=g,this._values=g):this._index++,{value:P,done:!1}}return{value:void 0,done:!0}},F.prototype.throw=function(N){throw this._index>=0&&(this._index=-1,this._keys=g,this._values=g),N},F.prototype.return=function(N){return this._index>=0&&(this._index=-1,this._keys=g,this._values=g),{value:N,done:!0}},F}(),k=function(){function F(){this._keys=[],this._values=[],this._cacheKey=y,this._cacheIndex=-2}return Object.defineProperty(F.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),F.prototype.has=function(N){return this._find(N,!1)>=0},F.prototype.get=function(N){var P=this._find(N,!1);return P>=0?this._values[P]:void 0},F.prototype.set=function(N,P){var R=this._find(N,!0);return this._values[R]=P,this},F.prototype.delete=function(N){var P=this._find(N,!1);if(P>=0){for(var R=this._keys.length,V=P+1;V<R;V++)this._keys[V-1]=this._keys[V],this._values[V-1]=this._values[V];return this._keys.length--,this._values.length--,ki(N,this._cacheKey)&&(this._cacheKey=y,this._cacheIndex=-2),!0}return!1},F.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=y,this._cacheIndex=-2},F.prototype.keys=function(){return new b(this._keys,this._values,D)},F.prototype.values=function(){return new b(this._keys,this._values,it)},F.prototype.entries=function(){return new b(this._keys,this._values,et)},F.prototype["@@iterator"]=function(){return this.entries()},F.prototype[a]=function(){return this.entries()},F.prototype._find=function(N,P){if(!ki(this._cacheKey,N)){this._cacheIndex=-1;for(var R=0;R<this._keys.length;R++)if(ki(this._keys[R],N)){this._cacheIndex=R;break}}return this._cacheIndex<0&&P&&(this._cacheIndex=this._keys.length,this._keys.push(N),this._values.push(void 0)),this._cacheIndex},F}();return k;function D(F,N){return F}function it(F,N){return N}function et(F,N){return[F,N]}}function Xl(){var y=function(){function g(){this._map=new $}return Object.defineProperty(g.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),g.prototype.has=function(b){return this._map.has(b)},g.prototype.add=function(b){return this._map.set(b,b),this},g.prototype.delete=function(b){return this._map.delete(b)},g.prototype.clear=function(){this._map.clear()},g.prototype.keys=function(){return this._map.keys()},g.prototype.values=function(){return this._map.keys()},g.prototype.entries=function(){return this._map.entries()},g.prototype["@@iterator"]=function(){return this.keys()},g.prototype[a]=function(){return this.keys()},g}();return y}function Ql(){var y=16,g=v.create(),b=k();return function(){function N(){this._key=k()}return N.prototype.has=function(P){var R=D(P,!1);return R!==void 0?v.has(R,this._key):!1},N.prototype.get=function(P){var R=D(P,!1);return R!==void 0?v.get(R,this._key):void 0},N.prototype.set=function(P,R){var V=D(P,!0);return V[this._key]=R,this},N.prototype.delete=function(P){var R=D(P,!1);return R!==void 0?delete R[this._key]:!1},N.prototype.clear=function(){this._key=k()},N}();function k(){var N;do N="@@WeakMap@@"+F();while(v.has(g,N));return g[N]=!0,N}function D(N,P){if(!n.call(N,b)){if(!P)return;Object.defineProperty(N,b,{value:v.create()})}return N[b]}function it(N,P){for(var R=0;R<P;++R)N[R]=Math.random()*255|0;return N}function et(N){if(typeof Uint8Array=="function"){var P=new Uint8Array(N);return typeof crypto<"u"?crypto.getRandomValues(P):typeof msCrypto<"u"?msCrypto.getRandomValues(P):it(P,N),P}return it(new Array(N),N)}function F(){var N=et(y);N[6]=N[6]&79|64,N[8]=N[8]&191|128;for(var P="",R=0;R<y;++R){var V=N[R];(R===4||R===6||R===8)&&(P+="-"),V<16&&(P+="0"),P+=V.toString(16).toLowerCase()}return P}}function Oi(y){return y.__=void 0,delete y.__,y}})})(ha||(ha={}));const uh="[object ArrayBuffer]";class I{static isArrayBuffer(t){return Object.prototype.toString.call(t)===uh}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e)return t;if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const n=I.toUint8Array(t),i=I.toUint8Array(e);if(n.length!==i.byteLength)return!1;for(let o=0;o<n.length;o++)if(n[o]!==i[o])return!1;return!0}static concat(...t){let e;Array.isArray(t[0])&&!(t[1]instanceof Function)||Array.isArray(t[0])&&t[1]instanceof Function?e=t[0]:t[t.length-1]instanceof Function?e=t.slice(0,t.length-1):e=t;let n=0;for(const a of e)n+=a.byteLength;const i=new Uint8Array(n);let o=0;for(const a of e){const c=this.toUint8Array(a);i.set(c,o),o+=c.length}return t[t.length-1]instanceof Function?this.toView(i,t[t.length-1]):i.buffer}}const Ii="string",lh=/^[0-9a-f]+$/i,hh=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,ph=/^[a-zA-Z0-9-_]+$/;class pa{static fromString(t){const e=unescape(encodeURIComponent(t)),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n.buffer}static toString(t){const e=I.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return decodeURIComponent(escape(n))}}class Vt{static toString(t,e=!1){const n=I.toArrayBuffer(t),i=new DataView(n);let o="";for(let a=0;a<n.byteLength;a+=2){const c=i.getUint16(a,e);o+=String.fromCharCode(c)}return o}static fromString(t,e=!1){const n=new ArrayBuffer(t.length*2),i=new DataView(n);for(let o=0;o<t.length;o++)i.setUint16(o*2,t.charCodeAt(o),e);return n}}class U{static isHex(t){return typeof t===Ii&&lh.test(t)}static isBase64(t){return typeof t===Ii&&hh.test(t)}static isBase64Url(t){return typeof t===Ii&&ph.test(t)}static ToString(t,e="utf8"){const n=I.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return Vt.toString(n,!0);case"utf16":case"utf16be":return Vt.toString(n);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return Vt.fromString(t,!0);case"utf16":case"utf16be":return Vt.fromString(t);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToBase64(t){const e=I.toUint8Array(t);if(typeof btoa<"u"){const n=this.ToString(e,"binary");return btoa(n)}else return ua.from(e).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!U.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(e)):new Uint8Array(ua.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!U.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=U.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return pa.fromString(t);case"utf16":case"utf16be":return Vt.fromString(t);case"utf16le":case"usc2":return Vt.fromString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToUtf8String(t,e=U.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return pa.toString(t);case"utf16":case"utf16be":return Vt.toString(t);case"utf16le":case"usc2":return Vt.toString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromBinary(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n.buffer}static ToBinary(t){const e=I.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return n}static ToHex(t){const e=I.toUint8Array(t);let n="";const i=e.length;for(let o=0;o<i;o++){const a=e[o];a<16&&(n+="0"),n+=a.toString(16)}return n}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!U.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e="0".concat(e));const n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i=i+2){const o=e.slice(i,i+2);n[i/2]=parseInt(o,16)}return n.buffer}static ToUtf16String(t,e=!1){return Vt.toString(t,e)}static FromUtf16String(t,e=!1){return Vt.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let n=0;n<e;n++)t+="=";return t}static formatString(t){return(t==null?void 0:t.replace(/[\n\r\t ]/g,""))||""}}U.DEFAULT_UTF8_ENCODING="utf8";function fh(...r){const t=r.map(i=>i.byteLength).reduce((i,o)=>i+o),e=new Uint8Array(t);let n=0;return r.map(i=>new Uint8Array(i)).forEach(i=>{for(const o of i)e[n++]=o}),e.buffer}function ju(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}function cf(r,t,e){var n;return r instanceof Object&&(n=r[t])!==null&&n!==void 0?n:e}function uf(r,t=0,e=r.byteLength-t,n=!1){let i="";for(const o of new Uint8Array(r,t,e)){const a=o.toString(16).toUpperCase();a.length===1&&(i+="0"),i+=a,n&&(i+=" ")}return i.trim()}function Ge(r,t){let e=0;if(r.length===1)return r[0];for(let n=r.length-1;n>=0;n--)e+=r[r.length-1-n]*Math.pow(2,t*n);return e}function Ae(r,t,e=-1){const n=e;let i=r,o=0,a=Math.pow(2,t);for(let c=1;c<8;c++){if(r<a){let l;if(n<0)l=new ArrayBuffer(c),o=c;else{if(n<c)return new ArrayBuffer(0);l=new ArrayBuffer(n),o=n}const f=new Uint8Array(l);for(let v=c-1;v>=0;v--){const m=Math.pow(2,v*t);f[o-v-1]=Math.floor(i/m),i-=f[o-v-1]*m}return l}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function lf(...r){let t=0,e=0;for(const o of r)t+=o.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const o of r)i.set(new Uint8Array(o),e),e+=o.byteLength;return n}function no(...r){let t=0,e=0;for(const o of r)t+=o.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const o of r)i.set(o,e),e+=o.length;return i}function Pu(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const a=r[0]===255&&r[1]&128,c=r[0]===0&&(r[1]&128)===0;(a||c)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(t);for(let a=0;a<this.valueHex.byteLength;a++)e[a]=0;e[0]=r[0]&128;const n=Ge(e,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let a=0;a<this.valueHex.byteLength;a++)o[a]=r[a];return o[0]&=127,Ge(o,8)-n}function yh(r){const t=r<0?r*-1:r;let e=128;for(let n=1;n<8;n++){if(t<=e){if(r<0){const a=e-t,c=Ae(a,8,n),l=new Uint8Array(c);return l[0]|=128,c}let i=Ae(t,8,n),o=new Uint8Array(i);if(o[0]&128){const a=i.slice(0),c=new Uint8Array(a);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let l=0;l<a.byteLength;l++)o[l+1]=c[l];o[0]=0}return i}e*=Math.pow(2,8)}return new ArrayBuffer(0)}function dh(r,t){if(r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}function bt(r,t){const e=r.toString(10);if(t<e.length)return"";const n=t-e.length,i=new Array(n);for(let o=0;o<n;o++)i[o]="0";return i.join("").concat(e)}const Ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Uu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function hf(r,t=!1,e=!1,n=!1){let i=0,o=0,a=0,c="";const l=t?Uu:Ru;if(n){let f=0;for(let v=0;v<r.length;v++)if(r.charCodeAt(v)!==0){f=v;break}r=r.slice(f)}for(;i<r.length;){const f=r.charCodeAt(i++);i>=r.length&&(o=1);const v=r.charCodeAt(i++);i>=r.length&&(a=1);const m=r.charCodeAt(i++),$=f>>2,x=(f&3)<<4|v>>4;let h=(v&15)<<2|m>>6,d=m&63;o===1?h=d=64:a===1&&(d=64),e?h===64?c+="".concat(l.charAt($)).concat(l.charAt(x)):d===64?c+="".concat(l.charAt($)).concat(l.charAt(x)).concat(l.charAt(h)):c+="".concat(l.charAt($)).concat(l.charAt(x)).concat(l.charAt(h)).concat(l.charAt(d)):c+="".concat(l.charAt($)).concat(l.charAt(x)).concat(l.charAt(h)).concat(l.charAt(d))}return c}function pf(r,t=!1,e=!1){const n=t?Uu:Ru;function i(l){for(let f=0;f<64;f++)if(n.charAt(f)===l)return f;return 64}function o(l){return l===64?0:l}let a=0,c="";for(;a<r.length;){const l=i(r.charAt(a++)),f=a>=r.length?0:i(r.charAt(a++)),v=a>=r.length?0:i(r.charAt(a++)),m=a>=r.length?0:i(r.charAt(a++)),$=o(l)<<2|o(f)>>4,x=(o(f)&15)<<4|o(v)>>2,h=(o(v)&3)<<6|o(m);c+=String.fromCharCode($),v!==64&&(c+=String.fromCharCode(x)),m!==64&&(c+=String.fromCharCode(h))}if(e){const l=c.length;let f=-1;for(let v=l-1;v>=0;v--)if(c.charCodeAt(v)!==0){f=v;break}f!==-1?c=c.slice(0,f+1):c=""}return c}function ff(r){let t="";const e=new Uint8Array(r);for(const n of e)t+=String.fromCharCode(n);return t}function yf(r){const t=r.length,e=new ArrayBuffer(t),n=new Uint8Array(e);for(let i=0;i<t;i++)n[i]=r.charCodeAt(i);return e}const gh=Math.log(2);function df(r){const t=Math.log(r)/gh,e=Math.floor(t),n=Math.round(t);return e===n?e:n}function gf(r,t){for(const e of t)delete r[e]}function vn(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Es(r){let t=0,e=0;for(let i=0;i<r.length;i++){const o=r[i];t+=o.byteLength}const n=new Uint8Array(t);for(let i=0;i<r.length;i++){const o=r[i];n.set(new Uint8Array(o),e),e+=o.byteLength}return n.buffer}function te(r,t,e,n){return t instanceof Uint8Array?t.byteLength?e<0?(r.error="Wrong parameter: inputOffset less than zero",!1):n<0?(r.error="Wrong parameter: inputLength less than zero",!1):t.byteLength-e-n<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class vi{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return Es(this.items)}}const ar=[new Uint8Array([1])],fa="0123456789",Ei="name",ya="valueHexView",vh="isHexOnly",mh="idBlock",bh="tagClass",wh="tagNumber",Ah="isConstructed",Sh="fromBER",Bh="toBER",xh="local",dt="",Pt=new ArrayBuffer(0),mi=new Uint8Array(0),Cr="EndOfContent",Vu="OCTET STRING",Du="BIT STRING";function zt(r){var t;return t=class extends r{constructor(...e){var n;super(...e);const i=e[0]||{};this.isHexOnly=(n=i.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=i.valueHex?I.toUint8Array(i.valueHex):mi}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,n,i){const o=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!te(this,o,n,i))return-1;const a=n+i;return this.valueHexView=o.subarray(n,a),this.valueHexView.length?(this.blockLength=i,a):(this.warnings.push("Zero buffer length"),n)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Pt)}toJSON(){return X(M({},super.toJSON()),{isHexOnly:this.isHexOnly,valueHex:U.ToHex(this.valueHexView)})}},t.NAME="hexBlock",t}class Ie{constructor({blockLength:t=0,error:e=dt,warnings:n=[],valueBeforeDecode:i=mi}={}){this.blockLength=t,this.error=e,this.warnings=n,this.valueBeforeDecodeView=I.toUint8Array(i)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:U.ToHex(this.valueBeforeDecodeView)}}}Ie.NAME="baseBlock";class pt extends Ie{fromBER(t,e,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}pt.NAME="valueBlock";class Lu extends zt(Ie){constructor({idBlock:t={}}={}){var e,n,i,o;super(),t?(this.isHexOnly=(e=t.isHexOnly)!==null&&e!==void 0?e:!1,this.valueHexView=t.valueHex?I.toUint8Array(t.valueHex):mi,this.tagClass=(n=t.tagClass)!==null&&n!==void 0?n:-1,this.tagNumber=(i=t.tagNumber)!==null&&i!==void 0?i:-1,this.isConstructed=(o=t.isConstructed)!==null&&o!==void 0?o:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",Pt}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const i=new Uint8Array(1);if(!t){let o=this.tagNumber;o&=31,e|=o,i[0]=e}return i.buffer}if(!this.isHexOnly){const i=Ae(this.tagNumber,7),o=new Uint8Array(i),a=i.byteLength,c=new Uint8Array(a+1);if(c[0]=e|31,!t){for(let l=0;l<a-1;l++)c[l+1]=o[l]|128;c[a]=o[a-1]}return c.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=e|31,!t){const i=this.valueHexView;for(let o=0;o<i.length-1;o++)n[o+1]=i[o]|128;n[this.valueHexView.byteLength]=i[i.length-1]}return n.buffer}fromBER(t,e,n){const i=I.toUint8Array(t);if(!te(this,i,e,n))return-1;const o=i.subarray(e,e+n);if(o.length===0)return this.error="Zero buffer length",-1;switch(o[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(o[0]&32)===32,this.isHexOnly=!1;const a=o[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let c=1,l=this.valueHexView=new Uint8Array(255),f=255;for(;o[c]&128;){if(l[c-1]=o[c]&127,c++,c>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(c===f){f+=255;const m=new Uint8Array(f);for(let $=0;$<l.length;$++)m[$]=l[$];l=this.valueHexView=new Uint8Array(f)}}this.blockLength=c+1,l[c-1]=o[c]&127;const v=new Uint8Array(c);for(let m=0;m<c;m++)v[m]=l[m];l=this.valueHexView=new Uint8Array(c),l.set(v),this.blockLength<=9?this.tagNumber=Ge(l,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return X(M({},super.toJSON()),{tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed})}}Lu.NAME="identificationBlock";class Hu extends Ie{constructor({lenBlock:t={}}={}){var e,n,i;super(),this.isIndefiniteForm=(e=t.isIndefiniteForm)!==null&&e!==void 0?e:!1,this.longFormUsed=(n=t.longFormUsed)!==null&&n!==void 0?n:!1,this.length=(i=t.length)!==null&&i!==void 0?i:0}fromBER(t,e,n){const i=I.toUint8Array(t);if(!te(this,i,e,n))return-1;const o=i.subarray(e,e+n);if(o.length===0)return this.error="Zero buffer length",-1;if(o[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=o[0]===128,this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(o[0]&128),this.longFormUsed===!1)return this.length=o[0],this.blockLength=1,e+this.blockLength;const a=o[0]&127;if(a>8)return this.error="Too big integer",-1;if(a+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const c=e+1,l=i.subarray(c,c+a);return l[a-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=Ge(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=a+1,e+this.blockLength}toBER(t=!1){let e,n;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=128),e;if(this.longFormUsed){const i=Ae(this.length,8);if(i.byteLength>127)return this.error="Too big length",Pt;if(e=new ArrayBuffer(i.byteLength+1),t)return e;const o=new Uint8Array(i);n=new Uint8Array(e),n[0]=i.byteLength|128;for(let a=0;a<i.byteLength;a++)n[a+1]=o[a];return e}return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=this.length),e}toJSON(){return X(M({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length})}}Hu.NAME="lengthBlock";const j={};class at extends Ie{constructor(a={},o){var c=a,{name:t=dt,optional:e=!1,primitiveSchema:n}=c,i=Y(c,["name","optional","primitiveSchema"]);super(i),this.name=t,this.optional=e,n&&(this.primitiveSchema=n),this.idBlock=new Lu(i),this.lenBlock=new Hu(i),this.valueBlock=o?new o(i):new pt(i)}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}toBER(t,e){const n=e||new vi;e||$u(this);const i=this.idBlock.toBER(t);if(n.write(i),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,n),n.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(t);this.lenBlock.length=o.byteLength;const a=this.lenBlock.toBER(t);n.write(a),n.write(o)}return e?Pt:n.final()}toJSON(){const t=X(M({},super.toJSON()),{idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional});return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return t==="ascii"?this.onAsciiEncoding():U.ToHex(this.toBER())}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(U.ToHex(this.valueBlock.valueBeforeDecodeView))}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;const e=this.toBER(),n=t.toBER();return dh(e,n)}}at.NAME="BaseBlock";function $u(r){if(r instanceof j.Constructed)for(const t of r.valueBlock.value)$u(t)&&(r.lenBlock.isIndefiniteForm=!0);return!!r.lenBlock.isIndefiniteForm}class Ns extends at{constructor(i={},n){var o=i,{value:t=dt}=o,e=Y(o,["value"]);super(e,n),t&&this.fromString(t)}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : '").concat(this.valueBlock.value,"'")}}Ns.NAME="BaseStringBlock";class Mu extends zt(pt){constructor(n={}){var i=n,{isHexOnly:t=!0}=i,e=Y(i,["isHexOnly"]);super(e),this.isHexOnly=t}}Mu.NAME="PrimitiveValueBlock";var da;class Or extends at{constructor(t={}){super(t,Mu),this.idBlock.isConstructed=!1}}da=Or,j.Primitive=da,Or.NAME="PRIMITIVE";function kh(r,t){if(r instanceof t)return r;const e=new t;return e.idBlock=r.idBlock,e.lenBlock=r.lenBlock,e.warnings=r.warnings,e.valueBeforeDecodeView=r.valueBeforeDecodeView,e}function rr(r,t=0,e=r.length){const n=t;let i=new at({},pt);const o=new Ie;if(!te(o,r,t,e))return i.error=o.error,{offset:-1,result:i};if(!r.subarray(t,t+e).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(r,t,e);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),a===-1)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=a,e-=i.idBlock.blockLength,a=i.lenBlock.fromBER(r,t,e),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),a===-1)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=a,e-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let c=at;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&i.idBlock.isHexOnly===!1)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=j.EndOfContent;break;case 1:c=j.Boolean;break;case 2:c=j.Integer;break;case 3:c=j.BitString;break;case 4:c=j.OctetString;break;case 5:c=j.Null;break;case 6:c=j.ObjectIdentifier;break;case 10:c=j.Enumerated;break;case 12:c=j.Utf8String;break;case 13:c=j.RelativeObjectIdentifier;break;case 14:c=j.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=j.Sequence;break;case 17:c=j.Set;break;case 18:c=j.NumericString;break;case 19:c=j.PrintableString;break;case 20:c=j.TeletexString;break;case 21:c=j.VideotexString;break;case 22:c=j.IA5String;break;case 23:c=j.UTCTime;break;case 24:c=j.GeneralizedTime;break;case 25:c=j.GraphicString;break;case 26:c=j.VisibleString;break;case 27:c=j.GeneralString;break;case 28:c=j.UniversalString;break;case 29:c=j.CharacterString;break;case 30:c=j.BmpString;break;case 31:c=j.DATE;break;case 32:c=j.TimeOfDay;break;case 33:c=j.DateTime;break;case 34:c=j.Duration;break;default:{const l=i.idBlock.isConstructed?new j.Constructed:new j.Primitive;l.idBlock=i.idBlock,l.lenBlock=i.lenBlock,l.warnings=i.warnings,i=l}}break;case 2:case 3:case 4:default:c=i.idBlock.isConstructed?j.Constructed:j.Primitive}return i=kh(i,c),a=i.fromBER(r,t,i.lenBlock.isIndefiniteForm?e:i.lenBlock.length),i.valueBeforeDecodeView=r.subarray(n,n+i.blockLength),{offset:a,result:i}}function Ke(r){if(!r.byteLength){const t=new at({},pt);return t.error="Input buffer has zero length",{offset:-1,result:t}}return rr(I.toUint8Array(r).slice(),0,r.byteLength)}function Ch(r,t){return r?1:t}class oe extends pt{constructor(i={}){var o=i,{value:t=[],isIndefiniteForm:e=!1}=o,n=Y(o,["value","isIndefiniteForm"]);super(n),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,n){const i=I.toUint8Array(t);if(!te(this,i,e,n))return-1;if(this.valueBeforeDecodeView=i.subarray(e,e+n),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),e;let o=e;for(;Ch(this.isIndefiniteForm,n)>0;){const a=rr(i,o,n);if(a.offset===-1)return this.error=a.result.error,this.warnings.concat(a.result.warnings),-1;if(o=a.offset,this.blockLength+=a.result.blockLength,n-=a.result.blockLength,this.value.push(a.result),this.isIndefiniteForm&&a.result.constructor.NAME===Cr)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Cr?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(t,e){const n=e||new vi;for(let i=0;i<this.value.length;i++)this.value[i].toBER(t,n);return e?Pt:n.final()}toJSON(){const t=X(M({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,value:[]});for(const e of this.value)t.value.push(e.toJSON());return t}}oe.NAME="ConstructedValueBlock";var ga;class gt extends at{constructor(t={}){super(t,oe),this.idBlock.isConstructed=!0}fromBER(t,e,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const t=[];for(const n of this.valueBlock.value)t.push(n.toString("ascii").split("\n").map(i=>"  ".concat(i)).join("\n"));const e=this.idBlock.tagClass===3?"[".concat(this.idBlock.tagNumber,"]"):this.constructor.NAME;return t.length?"".concat(e," :\n").concat(t.join("\n")):"".concat(e," :")}}ga=gt,j.Constructed=ga,gt.NAME="CONSTRUCTED";class Fu extends pt{fromBER(t,e,n){return e}toBER(t){return Pt}}Fu.override="EndOfContentValueBlock";var va;class io extends at{constructor(t={}){super(t,Fu),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}va=io,j.EndOfContent=va,io.NAME=Cr;var ma;class Se extends at{constructor(t={}){super(t,pt),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,e+n>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+n}toBER(t,e){const n=new ArrayBuffer(2);if(!t){const i=new Uint8Array(n);i[0]=5,i[1]=0}return e&&e.write(n),n}onAsciiEncoding(){return"".concat(this.constructor.NAME)}}ma=Se,j.Null=ma,Se.NAME="NULL";class zu extends zt(pt){constructor(n={}){var i=n,{value:t}=i,e=Y(i,["value"]);super(e),e.valueHex?this.valueHexView=I.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}fromBER(t,e,n){const i=I.toUint8Array(t);return te(this,i,e,n)?(this.valueHexView=i.subarray(e,e+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Pu.call(this),this.blockLength=n,e+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return X(M({},super.toJSON()),{value:this.value})}}zu.NAME="BooleanValueBlock";var ba;class mn extends at{constructor(t={}){super(t,zu),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.getValue)}}ba=mn,j.Boolean=ba,mn.NAME="BOOLEAN";class Ku extends zt(oe){constructor(n={}){var i=n,{isConstructed:t=!1}=i,e=Y(i,["isConstructed"]);super(e),this.isConstructed=t}fromBER(t,e,n){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,i=oe.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(let o=0;o<this.value.length;o++){const a=this.value[o].constructor.NAME;if(a===Cr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(a!==Vu)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(t,e,n),this.blockLength=n;return i}toBER(t,e){return this.isConstructed?oe.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return X(M({},super.toJSON()),{isConstructed:this.isConstructed})}}Ku.NAME="OctetStringValueBlock";var wa;let me=class qu extends at{constructor(i={}){var o=i,{idBlock:t={},lenBlock:e={}}=o,n=Y(o,["idBlock","lenBlock"]);var a,c;(a=n.isConstructed)!==null&&a!==void 0||(n.isConstructed=!!(!((c=n.value)===null||c===void 0)&&c.length)),super(M({idBlock:M({isConstructed:n.isConstructed},t),lenBlock:X(M({},e),{isIndefiniteForm:!!n.isIndefiniteForm})},n),Ku),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(t,e,n){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,n===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const i=(t instanceof ArrayBuffer?new Uint8Array(t):t).subarray(e,e+n);try{if(i.byteLength){const o=rr(i,0,i.byteLength);o.offset!==-1&&o.offset===n&&(this.valueBlock.value=[o.result])}}catch(o){}}return super.fromBER(t,e,n)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?gt.prototype.onAsciiEncoding.call(this):"".concat(this.constructor.NAME," : ").concat(U.ToHex(this.valueBlock.valueHexView))}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const t=[];for(const e of this.valueBlock.value)e instanceof qu&&t.push(e.valueBlock.valueHexView);return I.concat(t)}};wa=me,j.OctetString=wa,me.NAME=Vu;class Wu extends zt(oe){constructor(i={}){var o=i,{unusedBits:t=0,isConstructed:e=!1}=o,n=Y(o,["unusedBits","isConstructed"]);super(n),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,n){if(!n)return e;let i=-1;if(this.isConstructed){if(i=oe.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(const c of this.value){const l=c.constructor.NAME;if(l===Cr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==Du)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const f=c.valueBlock;if(this.unusedBits>0&&f.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=f.unusedBits}return i}const o=I.toUint8Array(t);if(!te(this,o,e,n))return-1;const a=o.subarray(e,e+n);if(this.unusedBits=a[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const c=a.subarray(1);try{if(c.byteLength){const l=rr(c,0,c.byteLength);l.offset!==-1&&l.offset===n-1&&(this.value=[l.result])}}catch(l){}}return this.valueHexView=a.subarray(1),this.blockLength=a.length,e+n}toBER(t,e){if(this.isConstructed)return oe.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Pt;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return X(M({},super.toJSON()),{unusedBits:this.unusedBits,isConstructed:this.isConstructed})}}Wu.NAME="BitStringValueBlock";var Aa;let be=class extends at{constructor(n={}){var i=n,{idBlock:r={},lenBlock:t={}}=i,e=Y(i,["idBlock","lenBlock"]);var o,a;(o=e.isConstructed)!==null&&o!==void 0||(e.isConstructed=!!(!((a=e.value)===null||a===void 0)&&a.length)),super(M({idBlock:M({isConstructed:e.isConstructed},r),lenBlock:X(M({},t),{isIndefiniteForm:!!e.isIndefiniteForm})},e),Wu),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,t,e){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return gt.prototype.onAsciiEncoding.call(this);{const r=[],t=this.valueBlock.valueHexView;for(const n of t)r.push(n.toString(2).padStart(8,"0"));const e=r.join("");return"".concat(this.constructor.NAME," : ").concat(e.substring(0,e.length-this.valueBlock.unusedBits))}}};Aa=be,j.BitString=Aa,be.NAME=Du;var Sa;function Oh(r,t){const e=new Uint8Array([0]),n=new Uint8Array(r),i=new Uint8Array(t);let o=n.slice(0);const a=o.length-1,c=i.slice(0),l=c.length-1;let f=0;const v=l<a?a:l;let m=0;for(let $=v;$>=0;$--,m++){switch(!0){case m<c.length:f=o[a-m]+c[l-m]+e[0];break;default:f=o[a-m]+e[0]}switch(e[0]=f/10,!0){case m>=o.length:o=no(new Uint8Array([f%10]),o);break;default:o[a-m]=f%10}}return e[0]>0&&(o=no(e,o)),o}function Ba(r){if(r>=ar.length)for(let t=ar.length;t<=r;t++){const e=new Uint8Array([0]);let n=ar[t-1].slice(0);for(let i=n.length-1;i>=0;i--){const o=new Uint8Array([(n[i]<<1)+e[0]]);e[0]=o[0]/10,n[i]=o[0]%10}e[0]>0&&(n=no(e,n)),ar.push(n)}return ar[r]}function Ih(r,t){let e=0;const n=new Uint8Array(r),i=new Uint8Array(t),o=n.slice(0),a=o.length-1,c=i.slice(0),l=c.length-1;let f,v=0;for(let m=l;m>=0;m--,v++)switch(f=o[a-v]-c[l-v]-e,!0){case f<0:e=1,o[a-v]=f+10;break;default:e=0,o[a-v]=f}if(e>0)for(let m=a-l+1;m>=0;m--,v++)if(f=o[a-v]-e,f<0)e=1,o[a-v]=f+10;else{e=0,o[a-v]=f;break}return o.slice()}class oo extends zt(pt){constructor(n={}){var i=n,{value:t}=i,e=Y(i,["value"]);super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),t!==void 0&&(this.valueDec=t)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Pu.call(this)))}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(yh(t))}get valueDec(){return this._valueDec}fromDER(t,e,n,i=0){const o=this.fromBER(t,e,n);if(o===-1)return o;const a=this.valueHexView;return a[0]===0&&a[1]&128?this.valueHexView=a.subarray(1):i!==0&&a.length<i&&(i-a.length>1&&(i=a.length+1),this.valueHexView=a.subarray(i-a.length)),o}toDER(t=!1){const e=this.valueHexView;switch(!0){case(e[0]&128)!==0:{const n=new Uint8Array(this.valueHexView.length+1);n[0]=0,n.set(e,1),this.valueHexView=n}break;case(e[0]===0&&(e[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(t)}fromBER(t,e,n){const i=super.fromBER(t,e,n);return i===-1||this.setValueHex(),i}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return X(M({},super.toJSON()),{valueDec:this.valueDec})}toString(){const t=this.valueHexView.length*8-1;let e=new Uint8Array(this.valueHexView.length*8/3),n=0,i;const o=this.valueHexView;let a="",c=!1;for(let l=o.byteLength-1;l>=0;l--){i=o[l];for(let f=0;f<8;f++){if((i&1)===1)switch(n){case t:e=Ih(Ba(n),e),a="-";break;default:e=Oh(e,Ba(n))}n++,i>>=1}}for(let l=0;l<e.length;l++)e[l]&&(c=!0),c&&(a+=fa.charAt(e[l]));return c===!1&&(a+=fa.charAt(0)),a}}Sa=oo,oo.NAME="IntegerValueBlock",Object.defineProperty(Sa.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var xa;class $t extends at{constructor(t={}){super(t,oo),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return vn(),BigInt(this.valueBlock.toString())}static fromBigInt(t){vn();const e=BigInt(t),n=new vi,i=e.toString(16).replace(/^-/,""),o=new Uint8Array(U.FromHex(i));if(e<0){const a=new Uint8Array(o.length+(o[0]&128?1:0));a[0]|=128;const c=BigInt("0x".concat(U.ToHex(a)))+e,l=I.toUint8Array(U.FromHex(c.toString(16)));l[0]|=128,n.write(l)}else o[0]&128&&n.write(new Uint8Array([0])),n.write(o);return new $t({valueHex:n.final()})}convertToDER(){const t=new $t({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new $t({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString())}}xa=$t,j.Integer=xa,$t.NAME="INTEGER";var ka;class bn extends $t{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}ka=bn,j.Enumerated=ka,bn.NAME="ENUMERATED";class so extends zt(pt){constructor(i={}){var o=i,{valueDec:t=-1,isFirstSid:e=!1}=o,n=Y(o,["valueDec","isFirstSid"]);super(n),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,n){if(!n)return e;const i=I.toUint8Array(t);if(!te(this,i,e,n))return-1;const o=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=o[c]&127,this.blockLength++,(o[c]&128)!==0);c++);const a=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)a[c]=this.valueHexView[c];return this.valueHexView=a,o[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Ge(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){vn();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const n=new Uint8Array(e.length/7);for(let i=0;i<n.length;i++)n[i]=parseInt(e.slice(i*7,i*7+7),2)+(i+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)o[a]=i[a]|128;return o[this.blockLength-1]=i[this.blockLength-1],o.buffer}const e=Ae(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",Pt;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),o=e.byteLength-1;for(let a=0;a<o;a++)n[a]=i[a]|128;n[o]=i[o]}return n}toString(){let t="";if(this.isHexOnly)t=U.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return X(M({},super.toJSON()),{valueDec:this.valueDec,isFirstSid:this.isFirstSid})}}so.NAME="sidBlock";class _u extends pt{constructor(n={}){var i=n,{value:t=dt}=i,e=Y(i,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const o=new so;if(i=o.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=o.error,i;this.value.length===0&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,n-=o.blockLength,this.value.push(o)}return i}toBER(t){const e=[];for(let n=0;n<this.value.length;n++){const i=this.value[n].toBER(t);if(i.byteLength===0)return this.error=this.value[n].error,Pt;e.push(i)}return Es(e)}fromString(t){this.value=[];let e=0,n=0,i="",o=!1;do if(n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1,o){const a=this.value[0];let c=0;switch(a.valueDec){case 0:break;case 1:c=40;break;case 2:c=80;break;default:this.value=[];return}const l=parseInt(i,10);if(isNaN(l))return;a.valueDec=l+c,o=!1}else{const a=new so;if(i>Number.MAX_SAFE_INTEGER){vn();const c=BigInt(i);a.valueBigInt=c}else if(a.valueDec=parseInt(i,10),isNaN(a.valueDec))return;this.value.length||(a.isFirstSid=!0,o=!0),this.value.push(a)}while(n!==-1)}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t="".concat(t,".")),e?(i="{".concat(i,"}"),this.value[n].isFirstSid?t="2.{".concat(i," - 80}"):t+=i):t+=i}return t}toJSON(){const t=X(M({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}_u.NAME="ObjectIdentifierValueBlock";var Ca;class wn extends at{constructor(t={}){super(t,_u),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return X(M({},super.toJSON()),{value:this.getValue()})}}Ca=wn,j.ObjectIdentifier=Ca,wn.NAME="OBJECT IDENTIFIER";class ao extends zt(Ie){constructor(n={}){var i=n,{valueDec:t=0}=i,e=Y(i,["valueDec"]);super(e),this.valueDec=t}fromBER(t,e,n){if(n===0)return e;const i=I.toUint8Array(t);if(!te(this,i,e,n))return-1;const o=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=o[c]&127,this.blockLength++,(o[c]&128)!==0);c++);const a=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)a[c]=this.valueHexView[c];return this.valueHexView=a,o[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Ge(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength-1;a++)o[a]=i[a]|128;return o[this.blockLength-1]=i[this.blockLength-1],o.buffer}const e=Ae(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",Pt;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),o=e.byteLength-1;for(let a=0;a<o;a++)n[a]=i[a]|128;n[o]=i[o]}return n.buffer}toString(){let t="";return this.isHexOnly?t=U.ToHex(this.valueHexView):t=this.valueDec.toString(),t}toJSON(){return X(M({},super.toJSON()),{valueDec:this.valueDec})}}ao.NAME="relativeSidBlock";class Gu extends pt{constructor(n={}){var i=n,{value:t=dt}=i,e=Y(i,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const o=new ao;if(i=o.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=o.error,i;this.blockLength+=o.blockLength,n-=o.blockLength,this.value.push(o)}return i}toBER(t,e){const n=[];for(let i=0;i<this.value.length;i++){const o=this.value[i].toBER(t);if(o.byteLength===0)return this.error=this.value[i].error,Pt;n.push(o)}return Es(n)}fromString(t){this.value=[];let e=0,n=0,i="";do{n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1;const o=new ao;if(o.valueDec=parseInt(i,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(n!==-1);return!0}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t="".concat(t,".")),e&&(i="{".concat(i,"}")),t+=i}return t}toJSON(){const t=X(M({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Gu.NAME="RelativeObjectIdentifierValueBlock";var Oa;class co extends at{constructor(t={}){super(t,Gu),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return X(M({},super.toJSON()),{value:this.getValue()})}}Oa=co,j.RelativeObjectIdentifier=Oa,co.NAME="RelativeObjectIdentifier";var Ia;class Gt extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Ia=Gt,j.Sequence=Ia,Gt.NAME="SEQUENCE";var Ea;let Jt=class extends gt{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};Ea=Jt,j.Set=Ea,Jt.NAME="SET";class Ju extends zt(pt){constructor(e={}){var t=Y(e,[]);super(t),this.isHexOnly=!0,this.value=dt}toJSON(){return X(M({},super.toJSON()),{value:this.value})}}Ju.NAME="StringValueBlock";class Zu extends Ju{}Zu.NAME="SimpleStringValueBlock";class At extends Ns{constructor(e={}){var t=Y(e,[]);super(t,Zu)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,I.toUint8Array(t))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);this.valueBlock.value=t}}At.NAME="SIMPLE STRING";class Yu extends At{fromBuffer(t){this.valueBlock.valueHexView=I.toUint8Array(t);try{this.valueBlock.value=U.ToUtf8String(t)}catch(e){this.warnings.push('Error during "decodeURIComponent": '.concat(e,", using raw string")),this.valueBlock.value=U.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(U.FromUtf8String(t)),this.valueBlock.value=t}}Yu.NAME="Utf8StringValueBlock";var Na;class Zt extends Yu{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Na=Zt,j.Utf8String=Na,Zt.NAME="UTF8String";class Xu extends At{fromBuffer(t){this.valueBlock.value=U.ToUtf16String(t),this.valueBlock.valueHexView=I.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(U.FromUtf16String(t))}}Xu.NAME="BmpStringValueBlock";var Ta;class An extends Xu{constructor(e={}){var t=Y(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Ta=An,j.BmpString=Ta,An.NAME="BMPString";class Qu extends At{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),n=new Uint8Array(e);for(let i=0;i<n.length;i+=4)n[i]=n[i+3],n[i+1]=n[i+2],n[i+2]=0,n[i+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e*4);for(let i=0;i<e;i++){const o=Ae(t.charCodeAt(i),8),a=new Uint8Array(o);if(a.length>4)continue;const c=4-a.length;for(let l=a.length-1;l>=0;l--)n[i*4+l+c]=a[l]}this.valueBlock.value=t}}Qu.NAME="UniversalStringValueBlock";var ja;class Sn extends Qu{constructor(e={}){var t=Y(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}ja=Sn,j.UniversalString=ja,Sn.NAME="UniversalString";var Pa;class Bn extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Pa=Bn,j.NumericString=Pa,Bn.NAME="NumericString";var Ra;class xn extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Ra=xn,j.PrintableString=Ra,xn.NAME="PrintableString";var Ua;class kn extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Ua=kn,j.TeletexString=Ua,kn.NAME="TeletexString";var Va;class Cn extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Va=Cn,j.VideotexString=Va,Cn.NAME="VideotexString";var Da;class On extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Da=On,j.IA5String=Da,On.NAME="IA5String";var La;class In extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}La=In,j.GraphicString=La,In.NAME="GraphicString";var Ha;class Ir extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Ha=Ir,j.VisibleString=Ha,Ir.NAME="VisibleString";var $a;class En extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}$a=En,j.GeneralString=$a,En.NAME="GeneralString";var Ma;class Nn extends At{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}Ma=Nn,j.CharacterString=Ma,Nn.NAME="CharacterString";var Fa;class Er extends Ir{constructor(i={}){var o=i,{value:t,valueDate:e}=o,n=Y(o,["value","valueDate"]);if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let a=0;a<t.length;a++)this.valueBlock.valueHexView[a]=t.charCodeAt(a)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,I.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(t);if(e===null){this.error="Wrong input string for conversion";return}const n=parseInt(e[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(t="iso"){if(t==="iso"){const e=new Array(7);return e[0]=bt(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=bt(this.month,2),e[2]=bt(this.day,2),e[3]=bt(this.hour,2),e[4]=bt(this.minute,2),e[5]=bt(this.second,2),e[6]="Z",e.join("")}return super.toString(t)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.toDate().toISOString())}toJSON(){return X(M({},super.toJSON()),{year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second})}}Fa=Er,j.UTCTime=Fa,Er.NAME="UTCTime";var za;class Tn extends Er{constructor(t={}){var e;super(t),(e=this.millisecond)!==null&&e!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let e=!1,n="",i="",o=0,a,c=0,l=0;if(t[t.length-1]==="Z")n=t.substring(0,t.length-1),e=!0;else{const m=new Number(t[t.length-1]);if(isNaN(m.valueOf()))throw new Error("Wrong input string for conversion");n=t}if(e){if(n.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(n.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let m=1,$=n.indexOf("+"),x="";if($===-1&&($=n.indexOf("-"),m=-1),$!==-1){if(x=n.substring($+1),n=n.substring(0,$),x.length!==2&&x.length!==4)throw new Error("Wrong input string for conversion");let h=parseInt(x.substring(0,2),10);if(isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");if(c=m*h,x.length===4){if(h=parseInt(x.substring(2,4),10),isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");l=m*h}}}let f=n.indexOf(".");if(f===-1&&(f=n.indexOf(",")),f!==-1){const m=new Number("0".concat(n.substring(f)));if(isNaN(m.valueOf()))throw new Error("Wrong input string for conversion");o=m.valueOf(),i=n.substring(0,f)}else i=n;switch(!0){case i.length===8:if(a=/(\d{4})(\d{2})(\d{2})/ig,f!==-1)throw new Error("Wrong input string for conversion");break;case i.length===10:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,f!==-1){let m=60*o;this.minute=Math.floor(m),m=60*(m-this.minute),this.second=Math.floor(m),m=1e3*(m-this.second),this.millisecond=Math.floor(m)}break;case i.length===12:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,f!==-1){let m=60*o;this.second=Math.floor(m),m=1e3*(m-this.second),this.millisecond=Math.floor(m)}break;case i.length===14:if(a=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,f!==-1){const m=1e3*o;this.millisecond=Math.floor(m)}break;default:throw new Error("Wrong input string for conversion")}const v=a.exec(i);if(v===null)throw new Error("Wrong input string for conversion");for(let m=1;m<v.length;m++)switch(m){case 1:this.year=parseInt(v[m],10);break;case 2:this.month=parseInt(v[m],10);break;case 3:this.day=parseInt(v[m],10);break;case 4:this.hour=parseInt(v[m],10)+c;break;case 5:this.minute=parseInt(v[m],10)+l;break;case 6:this.second=parseInt(v[m],10);break;default:throw new Error("Wrong input string for conversion")}if(e===!1){const m=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=m.getUTCFullYear(),this.month=m.getUTCMonth(),this.day=m.getUTCDay(),this.hour=m.getUTCHours(),this.minute=m.getUTCMinutes(),this.second=m.getUTCSeconds(),this.millisecond=m.getUTCMilliseconds()}}toString(t="iso"){if(t==="iso"){const e=[];return e.push(bt(this.year,4)),e.push(bt(this.month,2)),e.push(bt(this.day,2)),e.push(bt(this.hour,2)),e.push(bt(this.minute,2)),e.push(bt(this.second,2)),this.millisecond!==0&&(e.push("."),e.push(bt(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(t)}toJSON(){return X(M({},super.toJSON()),{millisecond:this.millisecond})}}za=Tn,j.GeneralizedTime=za,Tn.NAME="GeneralizedTime";var Ka;class uo extends Zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Ka=uo,j.DATE=Ka,uo.NAME="DATE";var qa;class lo extends Zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}qa=lo,j.TimeOfDay=qa,lo.NAME="TimeOfDay";var Wa;class ho extends Zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Wa=ho,j.DateTime=Wa,ho.NAME="DateTime";var _a;class po extends Zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}_a=po,j.Duration=_a,po.NAME="Duration";var Ga;class fo extends Zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Ga=fo,j.TIME=Ga,fo.NAME="TIME";class Be{constructor({name:t=dt,optional:e=!1}={}){this.name=t,this.optional=e}}class Ts extends Be{constructor(n={}){var i=n,{value:t=[]}=i,e=Y(i,["value"]);super(e),this.value=t}}class jn extends Be{constructor(i={}){var o=i,{value:t=new Be,local:e=!1}=o,n=Y(o,["value","local"]);super(n),this.value=t,this.local=e}}class Eh{constructor({data:t=mi}={}){this.dataView=I.toUint8Array(t)}get data(){return this.dataView.slice().buffer}set data(t){this.dataView=I.toUint8Array(t)}fromBER(t,e,n){const i=e+n;return this.dataView=I.toUint8Array(t).subarray(e,i),i}toBER(t){return this.dataView.slice().buffer}}function ye(r,t,e){if(e instanceof Ts){for(let i=0;i<e.value.length;i++)if(ye(r,t,e.value[i]).verified)return{verified:!0,result:r};{const i={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(Ei)&&(i.name=e.name),i}}if(e instanceof Be)return e.hasOwnProperty(Ei)&&(r[e.name]=t),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(mh in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Sh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Bh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=e.idBlock.toBER(!1);if(n.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(e.idBlock.fromBER(n,0,n.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(e.idBlock.hasOwnProperty(bh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(wh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(Ah)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:r};if(!(vh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:r};if(e.idBlock.isHexOnly){if(!(ya in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=e.idBlock.valueHexView,o=t.idBlock.valueHexView;if(i.length!==o.length)return{verified:!1,result:r};for(let a=0;a<i.length;a++)if(i[a]!==o[1])return{verified:!1,result:r}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&(r[e.name]=t)),e instanceof j.Constructed){let i=0,o={verified:!1,result:{error:"Unknown error"}},a=e.valueBlock.value.length;if(a>0&&e.valueBlock.value[0]instanceof jn&&(a=t.valueBlock.value.length),a===0)return{verified:!0,result:r};if(t.valueBlock.value.length===0&&e.valueBlock.value.length!==0){let c=!0;for(let l=0;l<e.valueBlock.value.length;l++)c=c&&(e.valueBlock.value[l].optional||!1);return c?{verified:!0,result:r}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&delete r[e.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let c=0;c<a;c++)if(c-i>=t.valueBlock.value.length){if(e.valueBlock.value[c].optional===!1){const l={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&(delete r[e.name],l.name=e.name)),l}}else if(e.valueBlock.value[0]instanceof jn){if(o=ye(r,t.valueBlock.value[c],e.valueBlock.value[0].value),o.verified===!1)if(e.valueBlock.value[0].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&delete r[e.name]),o;if(Ei in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let l={};xh in e.valueBlock.value[0]&&e.valueBlock.value[0].local?l=t:l=r,typeof l[e.valueBlock.value[0].name]>"u"&&(l[e.valueBlock.value[0].name]=[]),l[e.valueBlock.value[0].name].push(t.valueBlock.value[c])}}else if(o=ye(r,t.valueBlock.value[c-i],e.valueBlock.value[c]),o.verified===!1)if(e.valueBlock.value[c].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&delete r[e.name]),o;if(o.verified===!1){const c={verified:!1,result:r};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&(delete r[e.name],c.name=e.name)),c}return{verified:!0,result:r}}if(e.primitiveSchema&&ya in t.valueBlock){const i=rr(t.valueBlock.valueHexView);if(i.offset===-1){const o={verified:!1,result:i.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,dt),e.name&&(delete r[e.name],o.name=e.name)),o}return ye(r,i.result,e.primitiveSchema)}return{verified:!0,result:r}}function Nh(r,t){if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const e=rr(I.toUint8Array(r));return e.offset===-1?{verified:!1,result:e.result}:ye(e.result,e.result,t)}const tl=Object.freeze(Object.defineProperty({__proto__:null,Any:Be,BaseBlock:at,BaseStringBlock:Ns,BitString:be,BmpString:An,Boolean:mn,CharacterString:Nn,Choice:Ts,Constructed:gt,DATE:uo,DateTime:ho,Duration:po,EndOfContent:io,Enumerated:bn,GeneralString:En,GeneralizedTime:Tn,GraphicString:In,HexBlock:zt,IA5String:On,Integer:$t,Null:Se,NumericString:Bn,ObjectIdentifier:wn,OctetString:me,Primitive:Or,PrintableString:xn,RawData:Eh,RelativeObjectIdentifier:co,Repeated:jn,Sequence:Gt,Set:Jt,TIME:fo,TeletexString:kn,TimeOfDay:lo,UTCTime:Er,UniversalString:Sn,Utf8String:Zt,ValueBlock:pt,VideotexString:Cn,ViewWriter:vi,VisibleString:Ir,compareSchema:ye,fromBER:Ke,verifySchema:Nh},Symbol.toStringTag,{value:"Module"}));var A;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(A||(A={}));var p;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(p||(p={}));class bi{constructor(t,e=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),t)if(typeof t=="number")this.fromNumber(t);else if(I.isBufferSource(t))this.unusedBits=e,this.value=I.toArrayBuffer(t);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(t){if(!(t instanceof be))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=t.valueBlock.unusedBits,this.value=t.valueBlock.valueHex,this}toASN(){return new be({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new be({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const n of e)t+=n.toString(2).padStart(8,"0");return t=t.split("").reverse().join(""),this.unusedBits&&(t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(t,2)}fromNumber(t){let e=t.toString(2);const n=e.length+7>>3;this.unusedBits=(n<<3)-e.length;const i=new Uint8Array(n);e=e.padStart(n<<3,"0").split("").reverse().join("");let o=0;for(;o<n;)i[o]=parseInt(e.slice(o<<3,(o<<3)+8),2),o++;this.value=i.buffer}}class K{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(t){typeof t=="number"?this.buffer=new ArrayBuffer(t):I.isBufferSource(t)?this.buffer=I.toArrayBuffer(t):Array.isArray(t)?this.buffer=new Uint8Array(t):this.buffer=new ArrayBuffer(0)}fromASN(t){if(!(t instanceof me))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=t.valueBlock.valueHex,this}toASN(){return new me({valueHex:this.buffer})}toSchema(t){return new me({name:t})}}const Th={fromASN:r=>r instanceof Se?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new Se;const t=Ke(r);if(t.result.error)throw new Error(t.result.error);return t.result}},jh={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new $t({value:+r})},Ph={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new bn({value:r})},J={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new $t({valueHex:r})},Rh={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new be({valueHex:r})},Uh={fromASN:r=>r.valueBlock.toString(),toASN:r=>new wn({value:r})},Vh={fromASN:r=>r.valueBlock.value,toASN:r=>new mn({value:r})},Pn={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new me({valueHex:r})},Dh={fromASN:r=>new K(r.getValue()),toASN:r=>r.toASN()};function Ct(r){return{fromASN:t=>t.valueBlock.value,toASN:t=>new r({value:t})}}const el=Ct(Zt),Lh=Ct(An),Hh=Ct(Sn),$h=Ct(Bn),Mh=Ct(xn),Fh=Ct(kn),zh=Ct(Cn),Kh=Ct(On),qh=Ct(In),Wh=Ct(Ir),_h=Ct(En),Gh=Ct(Nn),Jh={fromASN:r=>r.toDate(),toASN:r=>new Er({valueDate:r})},Zh={fromASN:r=>r.toDate(),toASN:r=>new Tn({valueDate:r})},Yh={fromASN:()=>null,toASN:()=>new Se};function js(r){switch(r){case p.Any:return Th;case p.BitString:return Rh;case p.BmpString:return Lh;case p.Boolean:return Vh;case p.CharacterString:return Gh;case p.Enumerated:return Ph;case p.GeneralString:return _h;case p.GeneralizedTime:return Zh;case p.GraphicString:return qh;case p.IA5String:return Kh;case p.Integer:return jh;case p.Null:return Yh;case p.NumericString:return $h;case p.ObjectIdentifier:return Uh;case p.OctetString:return Pn;case p.PrintableString:return Mh;case p.TeletexString:return Fh;case p.UTCTime:return Jh;case p.UniversalString:return Hh;case p.Utf8String:return el;case p.VideotexString:return zh;case p.VisibleString:return Wh;default:return null}}function _t(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:_t(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function rl(r){var t;if(r){const e=Object.getPrototypeOf(r);return((t=e==null?void 0:e.prototype)===null||t===void 0?void 0:t.constructor)===Array?!0:rl(e)}return!1}function Xh(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}class Qh{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,e=!1){const n=this.items.get(t);if(!n)throw new Error("Cannot get schema for '".concat(t.prototype.constructor.name,"' target"));if(e&&!n.schema)throw new Error("Schema '".concat(t.prototype.constructor.name,"' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'."));return n}cache(t){const e=this.get(t);e.schema||(e.schema=this.create(t,!0))}createDefault(t){const e={type:A.Sequence,items:{}},n=this.findParentSchema(t);return n&&(Object.assign(e,n),e.items=Object.assign({},e.items,n.items)),e}create(t,e){const n=this.items.get(t)||this.createDefault(t),i=[];for(const o in n.items){const a=n.items[o],c=e?o:"";let l;if(typeof a.type=="number"){const v=p[a.type],m=tl[v];if(!m)throw new Error("Cannot get ASN1 class by name '".concat(v,"'"));l=new m({name:c})}else _t(a.type)?l=new a.type().toSchema(c):a.optional?this.get(a.type).type===A.Choice?l=new Be({name:c}):(l=this.create(a.type,!1),l.name=c):l=new Be({name:c});const f=!!a.optional||a.defaultValue!==void 0;if(a.repeated){l.name="";const v=a.repeated==="set"?Jt:Gt;l=new v({name:"",value:[new jn({name:c,value:l})]})}if(a.context!==null&&a.context!==void 0)if(a.implicit)if(typeof a.type=="number"||_t(a.type)){const v=a.repeated?gt:Or;i.push(new v({name:c,optional:f,idBlock:{tagClass:3,tagNumber:a.context}}))}else{this.cache(a.type);const v=!!a.repeated;let m=v?l:this.get(a.type,!0).schema;m="valueBlock"in m?m.valueBlock.value:m.value,i.push(new gt({name:v?"":c,optional:f,idBlock:{tagClass:3,tagNumber:a.context},value:m}))}else i.push(new gt({optional:f,idBlock:{tagClass:3,tagNumber:a.context},value:[l]}));else l.optional=f,i.push(l)}switch(n.type){case A.Sequence:return new Gt({value:i,name:""});case A.Set:return new Jt({value:i,name:""});case A.Choice:return new Ts({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(t,e){return this.items.set(t,e),this}findParentSchema(t){const e=Object.getPrototypeOf(t);return e?this.items.get(e)||this.findParentSchema(e):null}}const kt=new Qh,B=r=>t=>{let e;kt.has(t)?e=kt.get(t):(e=kt.createDefault(t),kt.set(t,e)),Object.assign(e,r)},u=r=>(t,e)=>{let n;kt.has(t.constructor)?n=kt.get(t.constructor):(n=kt.createDefault(t.constructor),kt.set(t.constructor,n));const i=Object.assign({},r);if(typeof i.type=="number"&&!i.converter){const o=js(r.type);if(!o)throw new Error("Cannot get default converter for property '".concat(e,"' of ").concat(t.constructor.name));i.converter=o}n.items[e]=i};class Ja extends Error{constructor(){super(...arguments),this.schemas=[]}}class tp{static parse(t,e){const n=Ke(t);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,e)}static fromASN(t,e){var n;try{if(_t(e))return new e().fromASN(t);const i=kt.get(e);kt.cache(e);let o=i.schema;if(t.constructor===gt&&i.type!==A.Choice){o=new gt({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:i.schema.valueBlock.value});for(const l in i.items)delete t[l]}const a=ye({},t,o);if(!a.verified)throw new Ja("Data does not match to ".concat(e.name," ASN1 schema. ").concat(a.result.error));const c=new e;if(rl(e)){if(!("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const l=i.itemType;if(typeof l=="number"){const f=js(l);if(!f)throw new Error("Cannot get default converter for array item of ".concat(e.name," ASN1 schema"));return e.from(t.valueBlock.value,v=>f.fromASN(v))}else return e.from(t.valueBlock.value,f=>this.fromASN(f,l))}for(const l in i.items){const f=a.result[l];if(!f)continue;const v=i.items[l],m=v.type;if(typeof m=="number"||_t(m)){const $=(n=v.converter)!==null&&n!==void 0?n:_t(m)?new m:null;if(!$)throw new Error("Converter is empty");if(v.repeated)if(v.implicit){const x=v.repeated==="sequence"?Gt:Jt,h=new x;h.valueBlock=f.valueBlock;const d=Ke(h.toBER(!1));if(d.offset===-1)throw new Error("Cannot parse the child item. ".concat(d.result.error));if(!("value"in d.result.valueBlock&&Array.isArray(d.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const S=d.result.valueBlock.value;c[l]=Array.from(S,w=>$.fromASN(w))}else c[l]=Array.from(f,x=>$.fromASN(x));else{let x=f;if(v.implicit){let h;if(_t(m))h=new m().toSchema("");else{const d=p[m],S=tl[d];if(!S)throw new Error("Cannot get '".concat(d,"' class from asn1js module"));h=new S}h.valueBlock=x.valueBlock,x=Ke(h.toBER(!1)).result}c[l]=$.fromASN(x)}}else if(v.repeated){if(!Array.isArray(f))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");c[l]=Array.from(f,$=>this.fromASN($,m))}else c[l]=this.fromASN(f,m)}return c}catch(i){throw i instanceof Ja&&i.schemas.push(e.name),i}}}class Ps{static serialize(t){return t instanceof at?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){if(t&&typeof t=="object"&&_t(t))return t.toASN();if(!(t&&typeof t=="object"))throw new TypeError("Parameter 1 should be type of Object.");const e=t.constructor,n=kt.get(e);kt.cache(e);let i=[];if(n.itemType){if(!Array.isArray(t))throw new TypeError("Parameter 1 should be type of Array.");if(typeof n.itemType=="number"){const a=js(n.itemType);if(!a)throw new Error("Cannot get default converter for array item of ".concat(e.name," ASN1 schema"));i=t.map(c=>a.toASN(c))}else i=t.map(a=>this.toAsnItem({type:n.itemType},"[]",e,a))}else for(const a in n.items){const c=n.items[a],l=t[a];if(l===void 0||c.defaultValue===l||typeof c.defaultValue=="object"&&typeof l=="object"&&Xh(this.serialize(c.defaultValue),this.serialize(l)))continue;const f=Ps.toAsnItem(c,a,e,l);if(typeof c.context=="number")if(c.implicit)if(!c.repeated&&(typeof c.type=="number"||_t(c.type))){const v={};v.valueHex=f instanceof Se?f.valueBeforeDecodeView:f.valueBlock.toBER(),i.push(new Or(M({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context}},v)))}else i.push(new gt({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:f.valueBlock.value}));else i.push(new gt({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:[f]}));else c.repeated?i=i.concat(f):i.push(f)}let o;switch(n.type){case A.Sequence:o=new Gt({value:i});break;case A.Set:o=new Jt({value:i});break;case A.Choice:if(!i[0])throw new Error("Schema '".concat(e.name,"' has wrong data. Choice cannot be empty."));o=i[0];break}return o}static toAsnItem(t,e,n,i){let o;if(typeof t.type=="number"){const a=t.converter;if(!a)throw new Error("Property '".concat(e,"' doesn't have converter for type ").concat(p[t.type]," in schema '").concat(n.name,"'"));if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const c=Array.from(i,f=>a.toASN(f)),l=t.repeated==="sequence"?Gt:Jt;o=new l({value:c})}else o=a.toASN(i)}else if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const a=Array.from(i,l=>this.toASN(l)),c=t.repeated==="sequence"?Gt:Jt;o=new c({value:a})}else o=this.toASN(i);return o}}class W extends Array{constructor(t=[]){if(typeof t=="number")super(t);else{super();for(const e of t)this.push(e)}}}class E{static serialize(t){return Ps.serialize(t)}static parse(t,e){return tp.parse(t,e)}static toString(t){const e=I.isBufferSource(t)?I.toArrayBuffer(t):E.serialize(t),n=Ke(e);if(n.offset===-1)throw new Error("Cannot decode ASN.1 data. ".concat(n.result.error));return n.result.toString()}}function s(r,t,e,n){var i=arguments.length,o=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,t,e,n);else for(var c=r.length-1;c>=0;c--)(a=r[c])&&(o=(i<3?a(o):i>3?a(t,e,o):a(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}var nl={exports:{}};(function(r){(function(t){const e="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp("^".concat(e,"\\.").concat(e,"\\.").concat(e,"\\.").concat(e,"$"),"i"),threeOctet:new RegExp("^".concat(e,"\\.").concat(e,"\\.").concat(e,"$"),"i"),twoOctet:new RegExp("^".concat(e,"\\.").concat(e,"$"),"i"),longValue:new RegExp("^".concat(e,"$"),"i")},i=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),a="%[0-9a-z]{1,}",c="(?:[0-9a-f]+::?)+",l={zoneIndex:new RegExp(a,"i"),native:new RegExp("^(::)?(".concat(c,")?([0-9a-f]+)?(::)?(").concat(a,")?$"),"i"),deprecatedTransitional:new RegExp("^(?:::)(".concat(e,"\\.").concat(e,"\\.").concat(e,"\\.").concat(e,"(").concat(a,")?)$"),"i"),transitional:new RegExp("^((?:".concat(c,")|(?:::)(?:").concat(c,")?)").concat(e,"\\.").concat(e,"\\.").concat(e,"\\.").concat(e,"(").concat(a,")?$"),"i")};function f(h,d){if(h.indexOf("::")!==h.lastIndexOf("::"))return null;let S=0,w=-1,O=(h.match(l.zoneIndex)||[])[0],C,_;for(O&&(O=O.substring(1),h=h.replace(/%.+$/,""));(w=h.indexOf(":",w+1))>=0;)S++;if(h.substr(0,2)==="::"&&S--,h.substr(-2,2)==="::"&&S--,S>d)return null;for(_=d-S,C=":";_--;)C+="0:";return h=h.replace("::",C),h[0]===":"&&(h=h.slice(1)),h[h.length-1]===":"&&(h=h.slice(0,-1)),d=function(){const Hr=h.split(":"),$r=[];for(let or=0;or<Hr.length;or++)$r.push(parseInt(Hr[or],16));return $r}(),{parts:d,zoneId:O}}function v(h,d,S,w){if(h.length!==d.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let O=0,C;for(;w>0;){if(C=S-w,C<0&&(C=0),h[O]>>C!==d[O]>>C)return!1;w-=S,O+=1}return!0}function m(h){if(o.test(h))return parseInt(h,16);if(h[0]==="0"&&!isNaN(parseInt(h[1],10))){if(i.test(h))return parseInt(h,8);throw new Error("ipaddr: cannot parse ".concat(h," as octal"))}return parseInt(h,10)}function $(h,d){for(;h.length<d;)h="0".concat(h);return h}const x={};x.IPv4=function(){function h(d){if(d.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let S,w;for(S=0;S<d.length;S++)if(w=d[S],!(0<=w&&w<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=d}return h.prototype.SpecialRanges={unspecified:[[new h([0,0,0,0]),8]],broadcast:[[new h([255,255,255,255]),32]],multicast:[[new h([224,0,0,0]),4]],linkLocal:[[new h([169,254,0,0]),16]],loopback:[[new h([127,0,0,0]),8]],carrierGradeNat:[[new h([100,64,0,0]),10]],private:[[new h([10,0,0,0]),8],[new h([172,16,0,0]),12],[new h([192,168,0,0]),16]],reserved:[[new h([192,0,0,0]),24],[new h([192,0,2,0]),24],[new h([192,88,99,0]),24],[new h([198,18,0,0]),15],[new h([198,51,100,0]),24],[new h([203,0,113,0]),24],[new h([240,0,0,0]),4]],as112:[[new h([192,175,48,0]),24],[new h([192,31,196,0]),24]],amt:[[new h([192,52,193,0]),24]]},h.prototype.kind=function(){return"ipv4"},h.prototype.match=function(d,S){let w;if(S===void 0&&(w=d,d=w[0],S=w[1]),d.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return v(this.octets,d.octets,8,S)},h.prototype.prefixLengthFromSubnetMask=function(){let d=0,S=!1;const w={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let O,C,_;for(O=3;O>=0;O-=1)if(C=this.octets[O],C in w){if(_=w[C],S&&_!==0)return null;_!==8&&(S=!0),d+=_}else return null;return 32-d},h.prototype.range=function(){return x.subnetMatch(this,this.SpecialRanges)},h.prototype.toByteArray=function(){return this.octets.slice(0)},h.prototype.toIPv4MappedAddress=function(){return x.IPv6.parse("::ffff:".concat(this.toString()))},h.prototype.toNormalizedString=function(){return this.toString()},h.prototype.toString=function(){return this.octets.join(".")},h}(),x.IPv4.broadcastAddressFromCIDR=function(h){try{const d=this.parseCIDR(h),S=d[0].toByteArray(),w=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),O=[];let C=0;for(;C<4;)O.push(parseInt(S[C],10)|parseInt(w[C],10)^255),C++;return new this(O)}catch(d){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},x.IPv4.isIPv4=function(h){return this.parser(h)!==null},x.IPv4.isValid=function(h){try{return new this(this.parser(h)),!0}catch(d){return!1}},x.IPv4.isValidCIDR=function(h){try{return this.parseCIDR(h),!0}catch(d){return!1}},x.IPv4.isValidFourPartDecimal=function(h){return!!(x.IPv4.isValid(h)&&h.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},x.IPv4.networkAddressFromCIDR=function(h){let d,S,w,O,C;try{for(d=this.parseCIDR(h),w=d[0].toByteArray(),C=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),O=[],S=0;S<4;)O.push(parseInt(w[S],10)&parseInt(C[S],10)),S++;return new this(O)}catch(_){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},x.IPv4.parse=function(h){const d=this.parser(h);if(d===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(d)},x.IPv4.parseCIDR=function(h){let d;if(d=h.match(/^(.+)\/(\d+)$/)){const S=parseInt(d[2]);if(S>=0&&S<=32){const w=[this.parse(d[1]),S];return Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},x.IPv4.parser=function(h){let d,S,w;if(d=h.match(n.fourOctet))return function(){const O=d.slice(1,6),C=[];for(let _=0;_<O.length;_++)S=O[_],C.push(m(S));return C}();if(d=h.match(n.longValue)){if(w=m(d[1]),w>4294967295||w<0)throw new Error("ipaddr: address outside defined range");return function(){const O=[];let C;for(C=0;C<=24;C+=8)O.push(w>>C&255);return O}().reverse()}else return(d=h.match(n.twoOctet))?function(){const O=d.slice(1,4),C=[];if(w=m(O[1]),w>16777215||w<0)throw new Error("ipaddr: address outside defined range");return C.push(m(O[0])),C.push(w>>16&255),C.push(w>>8&255),C.push(w&255),C}():(d=h.match(n.threeOctet))?function(){const O=d.slice(1,5),C=[];if(w=m(O[2]),w>65535||w<0)throw new Error("ipaddr: address outside defined range");return C.push(m(O[0])),C.push(m(O[1])),C.push(w>>8&255),C.push(w&255),C}():null},x.IPv4.subnetMaskFromPrefixLength=function(h){if(h=parseInt(h),h<0||h>32)throw new Error("ipaddr: invalid IPv4 prefix length");const d=[0,0,0,0];let S=0;const w=Math.floor(h/8);for(;S<w;)d[S]=255,S++;return w<4&&(d[w]=Math.pow(2,h%8)-1<<8-h%8),new this(d)},x.IPv6=function(){function h(d,S){let w,O;if(d.length===16)for(this.parts=[],w=0;w<=14;w+=2)this.parts.push(d[w]<<8|d[w+1]);else if(d.length===8)this.parts=d;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(w=0;w<this.parts.length;w++)if(O=this.parts[w],!(0<=O&&O<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");S&&(this.zoneId=S)}return h.prototype.SpecialRanges={unspecified:[new h([0,0,0,0,0,0,0,0]),128],linkLocal:[new h([65152,0,0,0,0,0,0,0]),10],multicast:[new h([65280,0,0,0,0,0,0,0]),8],loopback:[new h([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new h([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new h([0,0,0,0,0,65535,0,0]),96],discard:[new h([256,0,0,0,0,0,0,0]),64],rfc6145:[new h([0,0,0,0,65535,0,0,0]),96],rfc6052:[new h([100,65435,0,0,0,0,0,0]),96],"6to4":[new h([8194,0,0,0,0,0,0,0]),16],teredo:[new h([8193,0,0,0,0,0,0,0]),32],benchmarking:[new h([8193,2,0,0,0,0,0,0]),48],amt:[new h([8193,3,0,0,0,0,0,0]),32],as112v6:[[new h([8193,4,274,0,0,0,0,0]),48],[new h([9760,79,32768,0,0,0,0,0]),48]],deprecated:[new h([8193,16,0,0,0,0,0,0]),28],orchid2:[new h([8193,32,0,0,0,0,0,0]),28],droneRemoteIdProtocolEntityTags:[new h([8193,48,0,0,0,0,0,0]),28],reserved:[[new h([8193,0,0,0,0,0,0,0]),23],[new h([8193,3512,0,0,0,0,0,0]),32]]},h.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},h.prototype.kind=function(){return"ipv6"},h.prototype.match=function(d,S){let w;if(S===void 0&&(w=d,d=w[0],S=w[1]),d.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return v(this.parts,d.parts,16,S)},h.prototype.prefixLengthFromSubnetMask=function(){let d=0,S=!1;const w={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let O,C;for(let _=7;_>=0;_-=1)if(O=this.parts[_],O in w){if(C=w[O],S&&C!==0)return null;C!==16&&(S=!0),d+=C}else return null;return 128-d},h.prototype.range=function(){return x.subnetMatch(this,this.SpecialRanges)},h.prototype.toByteArray=function(){let d;const S=[],w=this.parts;for(let O=0;O<w.length;O++)d=w[O],S.push(d>>8),S.push(d&255);return S},h.prototype.toFixedLengthString=function(){const d=function(){const w=[];for(let O=0;O<this.parts.length;O++)w.push($(this.parts[O].toString(16),4));return w}.call(this).join(":");let S="";return this.zoneId&&(S="%".concat(this.zoneId)),d+S},h.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const d=this.parts.slice(-2),S=d[0],w=d[1];return new x.IPv4([S>>8,S&255,w>>8,w&255])},h.prototype.toNormalizedString=function(){const d=function(){const w=[];for(let O=0;O<this.parts.length;O++)w.push(this.parts[O].toString(16));return w}.call(this).join(":");let S="";return this.zoneId&&(S="%".concat(this.zoneId)),d+S},h.prototype.toRFC5952String=function(){const d=/((^|:)(0(:|$)){2,})/g,S=this.toNormalizedString();let w=0,O=-1,C;for(;C=d.exec(S);)C[0].length>O&&(w=C.index,O=C[0].length);return O<0?S:"".concat(S.substring(0,w),"::").concat(S.substring(w+O))},h.prototype.toString=function(){return this.toRFC5952String()},h}(),x.IPv6.broadcastAddressFromCIDR=function(h){try{const d=this.parseCIDR(h),S=d[0].toByteArray(),w=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),O=[];let C=0;for(;C<16;)O.push(parseInt(S[C],10)|parseInt(w[C],10)^255),C++;return new this(O)}catch(d){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(d,")"))}},x.IPv6.isIPv6=function(h){return this.parser(h)!==null},x.IPv6.isValid=function(h){if(typeof h=="string"&&h.indexOf(":")===-1)return!1;try{const d=this.parser(h);return new this(d.parts,d.zoneId),!0}catch(d){return!1}},x.IPv6.isValidCIDR=function(h){if(typeof h=="string"&&h.indexOf(":")===-1)return!1;try{return this.parseCIDR(h),!0}catch(d){return!1}},x.IPv6.networkAddressFromCIDR=function(h){let d,S,w,O,C;try{for(d=this.parseCIDR(h),w=d[0].toByteArray(),C=this.subnetMaskFromPrefixLength(d[1]).toByteArray(),O=[],S=0;S<16;)O.push(parseInt(w[S],10)&parseInt(C[S],10)),S++;return new this(O)}catch(_){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(_,")"))}},x.IPv6.parse=function(h){const d=this.parser(h);if(d.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(d.parts,d.zoneId)},x.IPv6.parseCIDR=function(h){let d,S,w;if((S=h.match(/^(.+)\/(\d+)$/))&&(d=parseInt(S[2]),d>=0&&d<=128))return w=[this.parse(S[1]),d],Object.defineProperty(w,"toString",{value:function(){return this.join("/")}}),w;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},x.IPv6.parser=function(h){let d,S,w,O,C,_;if(w=h.match(l.deprecatedTransitional))return this.parser("::ffff:".concat(w[1]));if(l.native.test(h))return f(h,8);if((w=h.match(l.transitional))&&(_=w[6]||"",d=w[1],w[1].endsWith("::")||(d=d.slice(0,-1)),d=f(d+_,6),d.parts)){for(C=[parseInt(w[2]),parseInt(w[3]),parseInt(w[4]),parseInt(w[5])],S=0;S<C.length;S++)if(O=C[S],!(0<=O&&O<=255))return null;return d.parts.push(C[0]<<8|C[1]),d.parts.push(C[2]<<8|C[3]),{parts:d.parts,zoneId:d.zoneId}}return null},x.IPv6.subnetMaskFromPrefixLength=function(h){if(h=parseInt(h),h<0||h>128)throw new Error("ipaddr: invalid IPv6 prefix length");const d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let S=0;const w=Math.floor(h/8);for(;S<w;)d[S]=255,S++;return w<16&&(d[w]=Math.pow(2,h%8)-1<<8-h%8),new this(d)},x.fromByteArray=function(h){const d=h.length;if(d===4)return new x.IPv4(h);if(d===16)return new x.IPv6(h);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},x.isValid=function(h){return x.IPv6.isValid(h)||x.IPv4.isValid(h)},x.isValidCIDR=function(h){return x.IPv6.isValidCIDR(h)||x.IPv4.isValidCIDR(h)},x.parse=function(h){if(x.IPv6.isValid(h))return x.IPv6.parse(h);if(x.IPv4.isValid(h))return x.IPv4.parse(h);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},x.parseCIDR=function(h){try{return x.IPv6.parseCIDR(h)}catch(d){try{return x.IPv4.parseCIDR(h)}catch(S){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},x.process=function(h){const d=this.parse(h);return d.kind()==="ipv6"&&d.isIPv4MappedAddress()?d.toIPv4Address():d},x.subnetMatch=function(h,d,S){let w,O,C,_;S==null&&(S="unicast");for(O in d)if(Object.prototype.hasOwnProperty.call(d,O)){for(C=d[O],C[0]&&!(C[0]instanceof Array)&&(C=[C]),w=0;w<C.length;w++)if(_=C[w],h.kind()===_[0].kind()&&h.match.apply(h,_))return O}return S},r.exports?r.exports=x:t.ipaddr=x})(ro)})(nl);var Za=nl.exports;class Ya{static decodeIP(t){if(t.length===64&&parseInt(t,16)===0)return"::/0";if(t.length!==16)return t;const e=parseInt(t.slice(8),16).toString(2).split("").reduce((i,o)=>i+ +o,0);let n=t.slice(0,8).replace(/(.{2})/g,i=>"".concat(parseInt(i,16),"."));return n=n.slice(0,-1),"".concat(n,"/").concat(e)}static toString(t){if(t.byteLength===4||t.byteLength===16){const e=new Uint8Array(t);return Za.fromByteArray(Array.from(e)).toString()}return this.decodeIP(U.ToHex(t))}static fromString(t){const e=Za.parse(t);return new Uint8Array(e.toByteArray()).buffer}}var yo,go,vo;let ot=class{constructor(r={}){Object.assign(this,r)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};s([u({type:p.TeletexString})],ot.prototype,"teletexString",void 0),s([u({type:p.PrintableString})],ot.prototype,"printableString",void 0),s([u({type:p.UniversalString})],ot.prototype,"universalString",void 0),s([u({type:p.Utf8String})],ot.prototype,"utf8String",void 0),s([u({type:p.BmpString})],ot.prototype,"bmpString",void 0),ot=s([B({type:A.Choice})],ot);let Ve=class extends ot{constructor(r={}){super(r),Object.assign(this,r)}toString(){return this.ia5String||(this.anyValue?U.ToHex(this.anyValue):super.toString())}};s([u({type:p.IA5String})],Ve.prototype,"ia5String",void 0),s([u({type:p.Any})],Ve.prototype,"anyValue",void 0),Ve=s([B({type:A.Choice})],Ve);class Rn{constructor(t={}){this.type="",this.value=new Ve,Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Rn.prototype,"type",void 0),s([u({type:Ve})],Rn.prototype,"value",void 0);let Je=yo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,yo.prototype)}};Je=yo=s([B({type:A.Set,itemType:Rn})],Je);let mo=go=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,go.prototype)}};mo=go=s([B({type:A.Sequence,itemType:Je})],mo);let nt=vo=class extends mo{constructor(r){super(r),Object.setPrototypeOf(this,vo.prototype)}};nt=vo=s([B({type:A.Sequence})],nt);const ep={fromASN:r=>Ya.toString(Pn.fromASN(r)),toASN:r=>Pn.toASN(Ya.fromString(r))};class Nr{constructor(t={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Nr.prototype,"typeId",void 0),s([u({type:p.Any,context:0})],Nr.prototype,"value",void 0);class bo{constructor(t={}){this.partyName=new ot,Object.assign(this,t)}}s([u({type:ot,optional:!0,context:0,implicit:!0})],bo.prototype,"nameAssigner",void 0),s([u({type:ot,context:1,implicit:!0})],bo.prototype,"partyName",void 0);let H=class{constructor(r={}){Object.assign(this,r)}};s([u({type:Nr,context:0,implicit:!0})],H.prototype,"otherName",void 0),s([u({type:p.IA5String,context:1,implicit:!0})],H.prototype,"rfc822Name",void 0),s([u({type:p.IA5String,context:2,implicit:!0})],H.prototype,"dNSName",void 0),s([u({type:p.Any,context:3,implicit:!0})],H.prototype,"x400Address",void 0),s([u({type:nt,context:4,implicit:!1})],H.prototype,"directoryName",void 0),s([u({type:bo,context:5})],H.prototype,"ediPartyName",void 0),s([u({type:p.IA5String,context:6,implicit:!0})],H.prototype,"uniformResourceIdentifier",void 0),s([u({type:p.OctetString,context:7,implicit:!0,converter:ep})],H.prototype,"iPAddress",void 0),s([u({type:p.ObjectIdentifier,context:8,implicit:!0})],H.prototype,"registeredID",void 0),H=s([B({type:A.Choice})],H);const Rs="1.3.6.1.5.5.7",rp="".concat(Rs,".1"),nr="".concat(Rs,".3"),wi="".concat(Rs,".48"),Xa="".concat(wi,".1"),Qa="".concat(wi,".2"),tc="".concat(wi,".3"),ec="".concat(wi,".5"),ce="2.5.29";var wo;const Ao="".concat(rp,".1");class Tr{constructor(t={}){this.accessMethod="",this.accessLocation=new H,Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Tr.prototype,"accessMethod",void 0),s([u({type:H})],Tr.prototype,"accessLocation",void 0);let De=wo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,wo.prototype)}};De=wo=s([B({type:A.Sequence,itemType:Tr})],De);const So="".concat(ce,".35");class Us extends K{}class de{constructor(t={}){t&&Object.assign(this,t)}}s([u({type:Us,context:0,optional:!0,implicit:!0})],de.prototype,"keyIdentifier",void 0),s([u({type:H,context:1,optional:!0,implicit:!0,repeated:"sequence"})],de.prototype,"authorityCertIssuer",void 0),s([u({type:p.Integer,context:2,optional:!0,implicit:!0,converter:J})],de.prototype,"authorityCertSerialNumber",void 0);const il="".concat(ce,".19");class Un{constructor(t={}){this.cA=!1,Object.assign(this,t)}}s([u({type:p.Boolean,defaultValue:!1})],Un.prototype,"cA",void 0),s([u({type:p.Integer,optional:!0})],Un.prototype,"pathLenConstraint",void 0);var Bo;let lt=Bo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Bo.prototype)}};lt=Bo=s([B({type:A.Sequence,itemType:H})],lt);var xo;let rc=xo=class extends lt{constructor(r){super(r),Object.setPrototypeOf(this,xo.prototype)}};rc=xo=s([B({type:A.Sequence})],rc);var ko;const ol="".concat(ce,".32");let Wt=class{constructor(r={}){Object.assign(this,r)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};s([u({type:p.IA5String})],Wt.prototype,"ia5String",void 0),s([u({type:p.VisibleString})],Wt.prototype,"visibleString",void 0),s([u({type:p.BmpString})],Wt.prototype,"bmpString",void 0),s([u({type:p.Utf8String})],Wt.prototype,"utf8String",void 0),Wt=s([B({type:A.Choice})],Wt);class Co{constructor(t={}){this.organization=new Wt,this.noticeNumbers=[],Object.assign(this,t)}}s([u({type:Wt})],Co.prototype,"organization",void 0),s([u({type:p.Integer,repeated:"sequence"})],Co.prototype,"noticeNumbers",void 0);class Oo{constructor(t={}){Object.assign(this,t)}}s([u({type:Co,optional:!0})],Oo.prototype,"noticeRef",void 0),s([u({type:Wt,optional:!0})],Oo.prototype,"explicitText",void 0);let Kr=class{constructor(r={}){Object.assign(this,r)}};s([u({type:p.IA5String})],Kr.prototype,"cPSuri",void 0),s([u({type:Oo})],Kr.prototype,"userNotice",void 0),Kr=s([B({type:A.Choice})],Kr);class Io{constructor(t={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Io.prototype,"policyQualifierId",void 0),s([u({type:p.Any})],Io.prototype,"qualifier",void 0);class Vn{constructor(t={}){this.policyIdentifier="",Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Vn.prototype,"policyIdentifier",void 0),s([u({type:Io,repeated:"sequence",optional:!0})],Vn.prototype,"policyQualifiers",void 0);let Dn=ko=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ko.prototype)}};Dn=ko=s([B({type:A.Sequence,itemType:Vn})],Dn);let Xr=class{constructor(r=0){this.value=r}};s([u({type:p.Integer})],Xr.prototype,"value",void 0),Xr=s([B({type:A.Choice})],Xr);let nc=class extends Xr{};nc=s([B({type:A.Choice})],nc);var Eo;const No="".concat(ce,".31");var Et;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(Et||(Et={}));class sl extends bi{toJSON(){const t=[],e=this.toNumber();return e&Et.aACompromise&&t.push("aACompromise"),e&Et.affiliationChanged&&t.push("affiliationChanged"),e&Et.cACompromise&&t.push("cACompromise"),e&Et.certificateHold&&t.push("certificateHold"),e&Et.cessationOfOperation&&t.push("cessationOfOperation"),e&Et.keyCompromise&&t.push("keyCompromise"),e&Et.privilegeWithdrawn&&t.push("privilegeWithdrawn"),e&Et.superseded&&t.push("superseded"),e&Et.unused&&t.push("unused"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}let ge=class{constructor(r={}){Object.assign(this,r)}};s([u({type:H,context:0,repeated:"sequence",implicit:!0})],ge.prototype,"fullName",void 0),s([u({type:Je,context:1,implicit:!0})],ge.prototype,"nameRelativeToCRLIssuer",void 0),ge=s([B({type:A.Choice})],ge);class qe{constructor(t={}){Object.assign(this,t)}}s([u({type:ge,context:0,optional:!0})],qe.prototype,"distributionPoint",void 0),s([u({type:sl,context:1,optional:!0,implicit:!0})],qe.prototype,"reasons",void 0),s([u({type:H,context:2,optional:!0,repeated:"sequence",implicit:!0})],qe.prototype,"cRLIssuer",void 0);let We=Eo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Eo.prototype)}};We=Eo=s([B({type:A.Sequence,itemType:qe})],We);var To;let ic=To=class extends We{constructor(r){super(r),Object.setPrototypeOf(this,To.prototype)}};ic=To=s([B({type:A.Sequence,itemType:qe})],ic);class ct{constructor(t={}){this.onlyContainsUserCerts=ct.ONLY,this.onlyContainsCACerts=ct.ONLY,this.indirectCRL=ct.ONLY,this.onlyContainsAttributeCerts=ct.ONLY,Object.assign(this,t)}}ct.ONLY=!1,s([u({type:ge,context:0,optional:!0})],ct.prototype,"distributionPoint",void 0),s([u({type:p.Boolean,context:1,defaultValue:ct.ONLY,implicit:!0})],ct.prototype,"onlyContainsUserCerts",void 0),s([u({type:p.Boolean,context:2,defaultValue:ct.ONLY,implicit:!0})],ct.prototype,"onlyContainsCACerts",void 0),s([u({type:sl,context:3,optional:!0,implicit:!0})],ct.prototype,"onlySomeReasons",void 0),s([u({type:p.Boolean,context:4,defaultValue:ct.ONLY,implicit:!0})],ct.prototype,"indirectCRL",void 0),s([u({type:p.Boolean,context:5,defaultValue:ct.ONLY,implicit:!0})],ct.prototype,"onlyContainsAttributeCerts",void 0);var vr;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(vr||(vr={}));let Ni=class{constructor(r=vr.unspecified){this.reason=vr.unspecified,this.reason=r}toJSON(){return vr[this.reason]}toString(){return this.toJSON()}};s([u({type:p.Enumerated})],Ni.prototype,"reason",void 0),Ni=s([B({type:A.Choice})],Ni);var jo;const al="".concat(ce,".37");let Ln=jo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,jo.prototype)}};Ln=jo=s([B({type:A.Sequence,itemType:p.ObjectIdentifier})],Ln);const np="".concat(nr,".1"),ip="".concat(nr,".2"),op="".concat(nr,".3"),sp="".concat(nr,".4"),ap="".concat(nr,".8"),cp="".concat(nr,".9");let Ti=class{constructor(r=new ArrayBuffer(0)){this.value=r}};s([u({type:p.Integer,converter:J})],Ti.prototype,"value",void 0),Ti=s([B({type:A.Choice})],Ti);let ji=class{constructor(r){this.value=new Date,r&&(this.value=r)}};s([u({type:p.GeneralizedTime})],ji.prototype,"value",void 0),ji=s([B({type:A.Choice})],ji);var Po;let oc=Po=class extends lt{constructor(r){super(r),Object.setPrototypeOf(this,Po.prototype)}};oc=Po=s([B({type:A.Sequence})],oc);const cl="".concat(ce,".15");var Nt;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Nt||(Nt={}));class Pi extends bi{toJSON(){const t=this.toNumber(),e=[];return t&Nt.cRLSign&&e.push("crlSign"),t&Nt.dataEncipherment&&e.push("dataEncipherment"),t&Nt.decipherOnly&&e.push("decipherOnly"),t&Nt.digitalSignature&&e.push("digitalSignature"),t&Nt.encipherOnly&&e.push("encipherOnly"),t&Nt.keyAgreement&&e.push("keyAgreement"),t&Nt.keyCertSign&&e.push("keyCertSign"),t&Nt.keyEncipherment&&e.push("keyEncipherment"),t&Nt.nonRepudiation&&e.push("nonRepudiation"),e}toString(){return"[".concat(this.toJSON().join(", "),"]")}}var Ro;class Qr{constructor(t={}){this.base=new H,this.minimum=0,Object.assign(this,t)}}s([u({type:H})],Qr.prototype,"base",void 0),s([u({type:p.Integer,context:0,defaultValue:0,implicit:!0})],Qr.prototype,"minimum",void 0),s([u({type:p.Integer,context:1,optional:!0,implicit:!0})],Qr.prototype,"maximum",void 0);let Hn=Ro=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Ro.prototype)}};Hn=Ro=s([B({type:A.Sequence,itemType:Qr})],Hn);class sc{constructor(t={}){Object.assign(this,t)}}s([u({type:Hn,context:0,optional:!0,implicit:!0})],sc.prototype,"permittedSubtrees",void 0),s([u({type:Hn,context:1,optional:!0,implicit:!0})],sc.prototype,"excludedSubtrees",void 0);class ac{constructor(t={}){Object.assign(this,t)}}s([u({type:p.Integer,context:0,implicit:!0,optional:!0,converter:J})],ac.prototype,"requireExplicitPolicy",void 0),s([u({type:p.Integer,context:1,implicit:!0,optional:!0,converter:J})],ac.prototype,"inhibitPolicyMapping",void 0);var Uo;class Vo{constructor(t={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Vo.prototype,"issuerDomainPolicy",void 0),s([u({type:p.ObjectIdentifier})],Vo.prototype,"subjectDomainPolicy",void 0);let cc=Uo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Uo.prototype)}};cc=Uo=s([B({type:A.Sequence,itemType:Vo})],cc);var Do;const ul="".concat(ce,".17");let Lo=Do=class extends lt{constructor(r){super(r),Object.setPrototypeOf(this,Do.prototype)}};Lo=Do=s([B({type:A.Sequence})],Lo);let Yt=class{constructor(r={}){this.type="",this.values=[],Object.assign(this,r)}};s([u({type:p.ObjectIdentifier})],Yt.prototype,"type",void 0),s([u({type:p.Any,repeated:"set"})],Yt.prototype,"values",void 0);var Ho;let uc=Ho=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Ho.prototype)}};uc=Ho=s([B({type:A.Sequence,itemType:Yt})],uc);const ll="".concat(ce,".14");class se extends Us{}class lc{constructor(t={}){Object.assign(this,t)}}s([u({type:p.GeneralizedTime,context:0,implicit:!0,optional:!0})],lc.prototype,"notBefore",void 0),s([u({type:p.GeneralizedTime,context:1,implicit:!0,optional:!0})],lc.prototype,"notAfter",void 0);var mr;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(mr||(mr={}));class hl extends bi{toJSON(){const t=[],e=this.toNumber();return e&mr.pKIXCertificate&&t.push("pKIXCertificate"),e&mr.newExtensions&&t.push("newExtensions"),e&mr.keyUpdateAllowed&&t.push("keyUpdateAllowed"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}class hc{constructor(t={}){this.entrustVers="",this.entrustInfoFlags=new hl,Object.assign(this,t)}}s([u({type:p.GeneralString})],hc.prototype,"entrustVers",void 0),s([u({type:hl})],hc.prototype,"entrustInfoFlags",void 0);var $o;let pc=$o=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,$o.prototype)}};pc=$o=s([B({type:A.Sequence,itemType:Tr})],pc);class T{constructor(t={}){this.algorithm="",Object.assign(this,t)}isEqual(t){return t instanceof T&&t.algorithm==this.algorithm&&(t.parameters&&this.parameters&&ju(t.parameters,this.parameters)||t.parameters===this.parameters)}}s([u({type:p.ObjectIdentifier})],T.prototype,"algorithm",void 0),s([u({type:p.Any,optional:!0})],T.prototype,"parameters",void 0);class Ht{constructor(t={}){this.algorithm=new T,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:T})],Ht.prototype,"algorithm",void 0),s([u({type:p.BitString})],Ht.prototype,"subjectPublicKey",void 0);let st=class{constructor(r){if(r)if(typeof r=="string"||typeof r=="number"||r instanceof Date){const t=new Date(r);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,r)}getTime(){const r=this.utcTime||this.generalTime;if(!r)throw new Error("Cannot get time from CHOICE object");return r}};s([u({type:p.UTCTime})],st.prototype,"utcTime",void 0),s([u({type:p.GeneralizedTime})],st.prototype,"generalTime",void 0),st=s([B({type:A.Choice})],st);class $n{constructor(t){this.notBefore=new st(new Date),this.notAfter=new st(new Date),t&&(this.notBefore=new st(t.notBefore),this.notAfter=new st(t.notAfter))}}s([u({type:st})],$n.prototype,"notBefore",void 0),s([u({type:st})],$n.prototype,"notAfter",void 0);var Mo;let jt=class pl{constructor(t={}){this.extnID="",this.critical=pl.CRITICAL,this.extnValue=new K,Object.assign(this,t)}};jt.CRITICAL=!1,s([u({type:p.ObjectIdentifier})],jt.prototype,"extnID",void 0),s([u({type:p.Boolean,defaultValue:jt.CRITICAL})],jt.prototype,"critical",void 0),s([u({type:K})],jt.prototype,"extnValue",void 0);let xe=Mo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Mo.prototype)}};xe=Mo=s([B({type:A.Sequence,itemType:jt})],xe);var Ze;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(Ze||(Ze={}));class St{constructor(t={}){this.version=Ze.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new T,this.issuer=new nt,this.validity=new $n,this.subject=new nt,this.subjectPublicKeyInfo=new Ht,Object.assign(this,t)}}s([u({type:p.Integer,context:0,defaultValue:Ze.v1})],St.prototype,"version",void 0),s([u({type:p.Integer,converter:J})],St.prototype,"serialNumber",void 0),s([u({type:T})],St.prototype,"signature",void 0),s([u({type:nt})],St.prototype,"issuer",void 0),s([u({type:$n})],St.prototype,"validity",void 0),s([u({type:nt})],St.prototype,"subject",void 0),s([u({type:Ht})],St.prototype,"subjectPublicKeyInfo",void 0),s([u({type:p.BitString,context:1,implicit:!0,optional:!0})],St.prototype,"issuerUniqueID",void 0),s([u({type:p.BitString,context:2,implicit:!0,optional:!0})],St.prototype,"subjectUniqueID",void 0),s([u({type:xe,context:3,optional:!0})],St.prototype,"extensions",void 0);class _e{constructor(t={}){this.tbsCertificate=new St,this.signatureAlgorithm=new T,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:St})],_e.prototype,"tbsCertificate",void 0),s([u({type:T})],_e.prototype,"signatureAlgorithm",void 0),s([u({type:p.BitString})],_e.prototype,"signatureValue",void 0);class tn{constructor(t={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new st,Object.assign(this,t)}}s([u({type:p.Integer,converter:J})],tn.prototype,"userCertificate",void 0),s([u({type:st})],tn.prototype,"revocationDate",void 0),s([u({type:jt,optional:!0,repeated:"sequence"})],tn.prototype,"crlEntryExtensions",void 0);class qt{constructor(t={}){this.signature=new T,this.issuer=new nt,this.thisUpdate=new st,Object.assign(this,t)}}s([u({type:p.Integer,optional:!0})],qt.prototype,"version",void 0),s([u({type:T})],qt.prototype,"signature",void 0),s([u({type:nt})],qt.prototype,"issuer",void 0),s([u({type:st})],qt.prototype,"thisUpdate",void 0),s([u({type:st,optional:!0})],qt.prototype,"nextUpdate",void 0),s([u({type:tn,repeated:"sequence",optional:!0})],qt.prototype,"revokedCertificates",void 0),s([u({type:jt,optional:!0,context:0,repeated:"sequence"})],qt.prototype,"crlExtensions",void 0);class Ri{constructor(t={}){this.tbsCertList=new qt,this.signatureAlgorithm=new T,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:qt})],Ri.prototype,"tbsCertList",void 0),s([u({type:T})],Ri.prototype,"signatureAlgorithm",void 0),s([u({type:p.BitString})],Ri.prototype,"signature",void 0);class Ye{constructor(t={}){this.issuer=new nt,this.serialNumber=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:nt})],Ye.prototype,"issuer",void 0),s([u({type:p.Integer,converter:J})],Ye.prototype,"serialNumber",void 0);let Le=class{constructor(r={}){Object.assign(this,r)}};s([u({type:se,context:0,implicit:!0})],Le.prototype,"subjectKeyIdentifier",void 0),s([u({type:Ye})],Le.prototype,"issuerAndSerialNumber",void 0),Le=s([B({type:A.Choice})],Le);var Xt;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(Xt||(Xt={}));let jr=class extends T{};jr=s([B({type:A.Sequence})],jr);let Mn=class extends T{};Mn=s([B({type:A.Sequence})],Mn);let Ft=class extends T{};Ft=s([B({type:A.Sequence})],Ft);let Fn=class extends T{};Fn=s([B({type:A.Sequence})],Fn);let fc=class extends T{};fc=s([B({type:A.Sequence})],fc);let Fo=class extends T{};Fo=s([B({type:A.Sequence})],Fo);let Xe=class{constructor(r={}){this.attrType="",this.attrValues=[],Object.assign(this,r)}};s([u({type:p.ObjectIdentifier})],Xe.prototype,"attrType",void 0),s([u({type:p.Any,repeated:"set"})],Xe.prototype,"attrValues",void 0);var zo;class Lt{constructor(t={}){this.version=Xt.v0,this.sid=new Le,this.digestAlgorithm=new jr,this.signatureAlgorithm=new Mn,this.signature=new K,Object.assign(this,t)}}s([u({type:p.Integer})],Lt.prototype,"version",void 0),s([u({type:Le})],Lt.prototype,"sid",void 0),s([u({type:jr})],Lt.prototype,"digestAlgorithm",void 0),s([u({type:Xe,repeated:"set",context:0,implicit:!0,optional:!0})],Lt.prototype,"signedAttrs",void 0),s([u({type:Mn})],Lt.prototype,"signatureAlgorithm",void 0),s([u({type:K})],Lt.prototype,"signature",void 0),s([u({type:Xe,repeated:"set",context:1,implicit:!0,optional:!0})],Lt.prototype,"unsignedAttrs",void 0);let zn=zo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,zo.prototype)}};zn=zo=s([B({type:A.Set,itemType:Lt})],zn);let yc=class extends st{};yc=s([B({type:A.Choice})],yc);let dc=class extends Lt{};dc=s([B({type:A.Sequence})],dc);class Ui{constructor(t={}){this.acIssuer=new H,this.acSerial=0,this.attrs=[],Object.assign(this,t)}}s([u({type:H})],Ui.prototype,"acIssuer",void 0),s([u({type:p.Integer})],Ui.prototype,"acSerial",void 0),s([u({type:Yt,repeated:"sequence"})],Ui.prototype,"attrs",void 0);var Ko;let Kn=Ko=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Ko.prototype)}};Kn=Ko=s([B({type:A.Sequence,itemType:p.ObjectIdentifier})],Kn);class qr{constructor(t={}){this.permitUnSpecified=!0,Object.assign(this,t)}}s([u({type:p.Integer,optional:!0})],qr.prototype,"pathLenConstraint",void 0),s([u({type:Kn,implicit:!0,context:0,optional:!0})],qr.prototype,"permittedAttrs",void 0),s([u({type:Kn,implicit:!0,context:1,optional:!0})],qr.prototype,"excludedAttrs",void 0),s([u({type:p.Boolean,defaultValue:!0})],qr.prototype,"permitUnSpecified",void 0);class we{constructor(t={}){this.issuer=new lt,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:lt})],we.prototype,"issuer",void 0),s([u({type:p.Integer,converter:J})],we.prototype,"serial",void 0),s([u({type:p.BitString,optional:!0})],we.prototype,"issuerUID",void 0);var qo;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(qo||(qo={}));class ve{constructor(t={}){this.digestedObjectType=qo.publicKey,this.digestAlgorithm=new T,this.objectDigest=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.Enumerated})],ve.prototype,"digestedObjectType",void 0),s([u({type:p.ObjectIdentifier,optional:!0})],ve.prototype,"otherObjectTypeID",void 0),s([u({type:T})],ve.prototype,"digestAlgorithm",void 0),s([u({type:p.BitString})],ve.prototype,"objectDigest",void 0);class en{constructor(t={}){Object.assign(this,t)}}s([u({type:lt,optional:!0})],en.prototype,"issuerName",void 0),s([u({type:we,context:0,implicit:!0,optional:!0})],en.prototype,"baseCertificateID",void 0),s([u({type:ve,context:1,implicit:!0,optional:!0})],en.prototype,"objectDigestInfo",void 0);let He=class{constructor(r={}){Object.assign(this,r)}};s([u({type:H,repeated:"sequence"})],He.prototype,"v1Form",void 0),s([u({type:en,context:0,implicit:!0})],He.prototype,"v2Form",void 0),He=s([B({type:A.Choice})],He);class qn{constructor(t={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,t)}}s([u({type:p.GeneralizedTime})],qn.prototype,"notBeforeTime",void 0),s([u({type:p.GeneralizedTime})],qn.prototype,"notAfterTime",void 0);class br{constructor(t={}){Object.assign(this,t)}}s([u({type:we,implicit:!0,context:0,optional:!0})],br.prototype,"baseCertificateID",void 0),s([u({type:lt,implicit:!0,context:1,optional:!0})],br.prototype,"entityName",void 0),s([u({type:ve,implicit:!0,context:2,optional:!0})],br.prototype,"objectDigestInfo",void 0);var Wo;(function(r){r[r.v2=1]="v2"})(Wo||(Wo={}));class Tt{constructor(t={}){this.version=Wo.v2,this.holder=new br,this.issuer=new He,this.signature=new T,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new qn,this.attributes=[],Object.assign(this,t)}}s([u({type:p.Integer})],Tt.prototype,"version",void 0),s([u({type:br})],Tt.prototype,"holder",void 0),s([u({type:He})],Tt.prototype,"issuer",void 0),s([u({type:T})],Tt.prototype,"signature",void 0),s([u({type:p.Integer,converter:J})],Tt.prototype,"serialNumber",void 0),s([u({type:qn})],Tt.prototype,"attrCertValidityPeriod",void 0),s([u({type:Yt,repeated:"sequence"})],Tt.prototype,"attributes",void 0),s([u({type:p.BitString,optional:!0})],Tt.prototype,"issuerUniqueID",void 0),s([u({type:xe,optional:!0})],Tt.prototype,"extensions",void 0);class rn{constructor(t={}){this.acinfo=new Tt,this.signatureAlgorithm=new T,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:Tt})],rn.prototype,"acinfo",void 0),s([u({type:T})],rn.prototype,"signatureAlgorithm",void 0),s([u({type:p.BitString})],rn.prototype,"signatureValue",void 0);var Wn;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})(Wn||(Wn={}));class _o extends bi{}class Go{constructor(t={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier,implicit:!0,context:0})],Go.prototype,"type",void 0),s([u({type:p.Any,implicit:!0,context:1})],Go.prototype,"value",void 0);class Vi{constructor(t={}){this.policyId="",this.classList=new _o(Wn.unclassified),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Vi.prototype,"policyId",void 0),s([u({type:_o,defaultValue:new _o(Wn.unclassified)})],Vi.prototype,"classList",void 0),s([u({type:Go,repeated:"set"})],Vi.prototype,"securityCategories",void 0);class nn{constructor(t={}){Object.assign(this,t)}}s([u({type:K})],nn.prototype,"cotets",void 0),s([u({type:p.ObjectIdentifier})],nn.prototype,"oid",void 0),s([u({type:p.Utf8String})],nn.prototype,"string",void 0);class gc{constructor(t={}){this.values=[],Object.assign(this,t)}}s([u({type:lt,implicit:!0,context:0,optional:!0})],gc.prototype,"policyAuthority",void 0),s([u({type:nn,repeated:"sequence"})],gc.prototype,"values",void 0);var Jo;class on{constructor(t={}){this.targetCertificate=new we,Object.assign(this,t)}}s([u({type:we})],on.prototype,"targetCertificate",void 0),s([u({type:H,optional:!0})],on.prototype,"targetName",void 0),s([u({type:ve,optional:!0})],on.prototype,"certDigestInfo",void 0);let je=class{constructor(r={}){Object.assign(this,r)}};s([u({type:H,context:0,implicit:!0})],je.prototype,"targetName",void 0),s([u({type:H,context:1,implicit:!0})],je.prototype,"targetGroup",void 0),s([u({type:on,context:2,implicit:!0})],je.prototype,"targetCert",void 0),je=s([B({type:A.Choice})],je);let Zo=Jo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Jo.prototype)}};Zo=Jo=s([B({type:A.Sequence,itemType:je})],Zo);var Yo;let vc=Yo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Yo.prototype)}};vc=Yo=s([B({type:A.Sequence,itemType:Zo})],vc);class mc{constructor(t={}){Object.assign(this,t)}}s([u({type:lt,implicit:!0,context:0,optional:!0})],mc.prototype,"roleAuthority",void 0),s([u({type:H,implicit:!0,context:1})],mc.prototype,"roleName",void 0);class Di{constructor(t={}){this.service=new H,this.ident=new H,Object.assign(this,t)}}s([u({type:H})],Di.prototype,"service",void 0),s([u({type:H})],Di.prototype,"ident",void 0),s([u({type:K,optional:!0})],Di.prototype,"authInfo",void 0);var Xo;class Qo{constructor(t={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Qo.prototype,"otherCertFormat",void 0),s([u({type:p.Any})],Qo.prototype,"otherCert",void 0);let Pe=class{constructor(r={}){Object.assign(this,r)}};s([u({type:_e})],Pe.prototype,"certificate",void 0),s([u({type:rn,context:2,implicit:!0})],Pe.prototype,"v2AttrCert",void 0),s([u({type:Qo,context:3,implicit:!0})],Pe.prototype,"other",void 0),Pe=s([B({type:A.Choice})],Pe);let _n=Xo=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Xo.prototype)}};_n=Xo=s([B({type:A.Set,itemType:Pe})],_n);class Qe{constructor(t={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Qe.prototype,"contentType",void 0),s([u({type:p.Any,context:0})],Qe.prototype,"content",void 0);let ur=class{constructor(r={}){Object.assign(this,r)}};s([u({type:K})],ur.prototype,"single",void 0),s([u({type:p.Any})],ur.prototype,"any",void 0),ur=s([B({type:A.Choice})],ur);class Gn{constructor(t={}){this.eContentType="",Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Gn.prototype,"eContentType",void 0),s([u({type:ur,context:0,optional:!0})],Gn.prototype,"eContent",void 0);let lr=class{constructor(r={}){Object.assign(this,r)}};s([u({type:K,context:0,implicit:!0,optional:!0})],lr.prototype,"value",void 0),s([u({type:K,converter:Dh,context:0,implicit:!0,optional:!0,repeated:"sequence"})],lr.prototype,"constructedValue",void 0),lr=s([B({type:A.Choice})],lr);class wr{constructor(t={}){this.contentType="",this.contentEncryptionAlgorithm=new Fn,Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],wr.prototype,"contentType",void 0),s([u({type:Fn})],wr.prototype,"contentEncryptionAlgorithm",void 0),s([u({type:lr,optional:!0})],wr.prototype,"encryptedContent",void 0);class Jn{constructor(t={}){this.keyAttrId="",Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Jn.prototype,"keyAttrId",void 0),s([u({type:p.Any,optional:!0})],Jn.prototype,"keyAttr",void 0);var ts;class sn{constructor(t={}){this.subjectKeyIdentifier=new se,Object.assign(this,t)}}s([u({type:se})],sn.prototype,"subjectKeyIdentifier",void 0),s([u({type:p.GeneralizedTime,optional:!0})],sn.prototype,"date",void 0),s([u({type:Jn,optional:!0})],sn.prototype,"other",void 0);let $e=class{constructor(r={}){Object.assign(this,r)}};s([u({type:sn,context:0,implicit:!0,optional:!0})],$e.prototype,"rKeyId",void 0),s([u({type:Ye,optional:!0})],$e.prototype,"issuerAndSerialNumber",void 0),$e=s([B({type:A.Choice})],$e);class es{constructor(t={}){this.rid=new $e,this.encryptedKey=new K,Object.assign(this,t)}}s([u({type:$e})],es.prototype,"rid",void 0),s([u({type:K})],es.prototype,"encryptedKey",void 0);let Zn=ts=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ts.prototype)}};Zn=ts=s([B({type:A.Sequence,itemType:es})],Zn);class rs{constructor(t={}){this.algorithm=new T,this.publicKey=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:T})],rs.prototype,"algorithm",void 0),s([u({type:p.BitString})],rs.prototype,"publicKey",void 0);let he=class{constructor(r={}){Object.assign(this,r)}};s([u({type:se,context:0,implicit:!0,optional:!0})],he.prototype,"subjectKeyIdentifier",void 0),s([u({type:rs,context:1,implicit:!0,optional:!0})],he.prototype,"originatorKey",void 0),s([u({type:Ye,optional:!0})],he.prototype,"issuerAndSerialNumber",void 0),he=s([B({type:A.Choice})],he);class Re{constructor(t={}){this.version=Xt.v3,this.originator=new he,this.keyEncryptionAlgorithm=new Ft,this.recipientEncryptedKeys=new Zn,Object.assign(this,t)}}s([u({type:p.Integer})],Re.prototype,"version",void 0),s([u({type:he,context:0})],Re.prototype,"originator",void 0),s([u({type:K,context:1,optional:!0})],Re.prototype,"ukm",void 0),s([u({type:Ft})],Re.prototype,"keyEncryptionAlgorithm",void 0),s([u({type:Zn})],Re.prototype,"recipientEncryptedKeys",void 0);let Me=class{constructor(r={}){Object.assign(this,r)}};s([u({type:se,context:0,implicit:!0})],Me.prototype,"subjectKeyIdentifier",void 0),s([u({type:Ye})],Me.prototype,"issuerAndSerialNumber",void 0),Me=s([B({type:A.Choice})],Me);class hr{constructor(t={}){this.version=Xt.v0,this.rid=new Me,this.keyEncryptionAlgorithm=new Ft,this.encryptedKey=new K,Object.assign(this,t)}}s([u({type:p.Integer})],hr.prototype,"version",void 0),s([u({type:Me})],hr.prototype,"rid",void 0),s([u({type:Ft})],hr.prototype,"keyEncryptionAlgorithm",void 0),s([u({type:K})],hr.prototype,"encryptedKey",void 0);class Ar{constructor(t={}){this.keyIdentifier=new K,Object.assign(this,t)}}s([u({type:K})],Ar.prototype,"keyIdentifier",void 0),s([u({type:p.GeneralizedTime,optional:!0})],Ar.prototype,"date",void 0),s([u({type:Jn,optional:!0})],Ar.prototype,"other",void 0);class pr{constructor(t={}){this.version=Xt.v4,this.kekid=new Ar,this.keyEncryptionAlgorithm=new Ft,this.encryptedKey=new K,Object.assign(this,t)}}s([u({type:p.Integer})],pr.prototype,"version",void 0),s([u({type:Ar})],pr.prototype,"kekid",void 0),s([u({type:Ft})],pr.prototype,"keyEncryptionAlgorithm",void 0),s([u({type:K})],pr.prototype,"encryptedKey",void 0);class fr{constructor(t={}){this.version=Xt.v0,this.keyEncryptionAlgorithm=new Ft,this.encryptedKey=new K,Object.assign(this,t)}}s([u({type:p.Integer})],fr.prototype,"version",void 0),s([u({type:Fo,context:0,optional:!0})],fr.prototype,"keyDerivationAlgorithm",void 0),s([u({type:Ft})],fr.prototype,"keyEncryptionAlgorithm",void 0),s([u({type:K})],fr.prototype,"encryptedKey",void 0);class ns{constructor(t={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],ns.prototype,"oriType",void 0),s([u({type:p.Any})],ns.prototype,"oriValue",void 0);let ee=class{constructor(r={}){Object.assign(this,r)}};s([u({type:hr,optional:!0})],ee.prototype,"ktri",void 0),s([u({type:Re,context:1,implicit:!0,optional:!0})],ee.prototype,"kari",void 0),s([u({type:pr,context:2,implicit:!0,optional:!0})],ee.prototype,"kekri",void 0),s([u({type:fr,context:3,implicit:!0,optional:!0})],ee.prototype,"pwri",void 0),s([u({type:ns,context:4,implicit:!0,optional:!0})],ee.prototype,"ori",void 0),ee=s([B({type:A.Choice})],ee);var is;let Yn=is=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,is.prototype)}};Yn=is=s([B({type:A.Set,itemType:ee})],Yn);var os;class Xn{constructor(t={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Xn.prototype,"otherRevInfoFormat",void 0),s([u({type:p.Any})],Xn.prototype,"otherRevInfo",void 0);let an=class{constructor(r={}){this.other=new Xn,Object.assign(this,r)}};s([u({type:Xn,context:1,implicit:!0})],an.prototype,"other",void 0),an=s([B({type:A.Choice})],an);let Qn=os=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,os.prototype)}};Qn=os=s([B({type:A.Set,itemType:an})],Qn);class ss{constructor(t={}){Object.assign(this,t)}}s([u({type:_n,context:0,implicit:!0,optional:!0})],ss.prototype,"certs",void 0),s([u({type:Qn,context:1,implicit:!0,optional:!0})],ss.prototype,"crls",void 0);var as;let cs=as=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,as.prototype)}};cs=as=s([B({type:A.Set,itemType:Xe})],cs);class cr{constructor(t={}){this.version=Xt.v0,this.recipientInfos=new Yn,this.encryptedContentInfo=new wr,Object.assign(this,t)}}s([u({type:p.Integer})],cr.prototype,"version",void 0),s([u({type:ss,context:0,implicit:!0,optional:!0})],cr.prototype,"originatorInfo",void 0),s([u({type:Yn})],cr.prototype,"recipientInfos",void 0),s([u({type:wr})],cr.prototype,"encryptedContentInfo",void 0),s([u({type:cs,context:1,implicit:!0,optional:!0})],cr.prototype,"unprotectedAttrs",void 0);const up="1.2.840.113549.1.7.2";var us;let ti=us=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,us.prototype)}};ti=us=s([B({type:A.Set,itemType:jr})],ti);class Ne{constructor(t={}){this.version=Xt.v0,this.digestAlgorithms=new ti,this.encapContentInfo=new Gn,this.signerInfos=new zn,Object.assign(this,t)}}s([u({type:p.Integer})],Ne.prototype,"version",void 0),s([u({type:ti})],Ne.prototype,"digestAlgorithms",void 0),s([u({type:Gn})],Ne.prototype,"encapContentInfo",void 0),s([u({type:_n,context:0,implicit:!0,optional:!0})],Ne.prototype,"certificates",void 0),s([u({type:Qn,context:1,implicit:!0,optional:!0})],Ne.prototype,"crls",void 0),s([u({type:zn})],Ne.prototype,"signerInfos",void 0);const Pr="1.2.840.10045.2.1",Vs="1.2.840.10045.4.1",fl="1.2.840.10045.4.3.1",Ds="1.2.840.10045.4.3.2",Ls="1.2.840.10045.4.3.3",Hs="1.2.840.10045.4.3.4",bc="1.2.840.10045.3.1.7",wc="1.3.132.0.34",Ac="1.3.132.0.35";function Dr(r){return new T({algorithm:r})}const lp=Dr(Vs);Dr(fl);const hp=Dr(Ds),pp=Dr(Ls),fp=Dr(Hs);let yr=class{constructor(r={}){Object.assign(this,r)}};s([u({type:p.ObjectIdentifier})],yr.prototype,"fieldType",void 0),s([u({type:p.Any})],yr.prototype,"parameters",void 0),yr=s([B({type:A.Sequence})],yr);class yp extends K{}let Ue=class{constructor(r={}){Object.assign(this,r)}};s([u({type:p.OctetString})],Ue.prototype,"a",void 0),s([u({type:p.OctetString})],Ue.prototype,"b",void 0),s([u({type:p.BitString,optional:!0})],Ue.prototype,"seed",void 0),Ue=s([B({type:A.Sequence})],Ue);var ls;(function(r){r[r.ecpVer1=1]="ecpVer1"})(ls||(ls={}));let Kt=class{constructor(r={}){this.version=ls.ecpVer1,Object.assign(this,r)}};s([u({type:p.Integer})],Kt.prototype,"version",void 0),s([u({type:yr})],Kt.prototype,"fieldID",void 0),s([u({type:Ue})],Kt.prototype,"curve",void 0),s([u({type:yp})],Kt.prototype,"base",void 0),s([u({type:p.Integer,converter:J})],Kt.prototype,"order",void 0),s([u({type:p.Integer,optional:!0})],Kt.prototype,"cofactor",void 0),Kt=s([B({type:A.Sequence})],Kt);let re=class{constructor(r={}){Object.assign(this,r)}};s([u({type:p.ObjectIdentifier})],re.prototype,"namedCurve",void 0),s([u({type:p.Null})],re.prototype,"implicitCurve",void 0),s([u({type:Kt})],re.prototype,"specifiedCurve",void 0),re=s([B({type:A.Choice})],re);class Wr{constructor(t={}){this.version=1,this.privateKey=new K,Object.assign(this,t)}}s([u({type:p.Integer})],Wr.prototype,"version",void 0),s([u({type:K})],Wr.prototype,"privateKey",void 0),s([u({type:re,context:0,optional:!0})],Wr.prototype,"parameters",void 0),s([u({type:p.BitString,context:1,optional:!0})],Wr.prototype,"publicKey",void 0);class ei{constructor(t={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.Integer,converter:J})],ei.prototype,"r",void 0),s([u({type:p.Integer,converter:J})],ei.prototype,"s",void 0);const vt="1.2.840.113549.1.1",ke="".concat(vt,".1"),dp="".concat(vt,".7"),gp="".concat(vt,".9"),Sr="".concat(vt,".10"),vp="".concat(vt,".2"),mp="".concat(vt,".4"),ri="".concat(vt,".5"),bp="".concat(vt,".14"),hs="".concat(vt,".11"),ni="".concat(vt,".12"),ii="".concat(vt,".13"),Sc="".concat(vt,".15"),Bc="".concat(vt,".16"),oi="1.3.14.3.2.26",yl="2.16.840.1.101.3.4.2.4",si="2.16.840.1.101.3.4.2.1",ai="2.16.840.1.101.3.4.2.2",ci="2.16.840.1.101.3.4.2.3",wp="2.16.840.1.101.3.4.2.5",Ap="2.16.840.1.101.3.4.2.6",Sp="1.2.840.113549.2.2",Bp="1.2.840.113549.2.5",Ai="".concat(vt,".8");function rt(r){return new T({algorithm:r,parameters:null})}rt(Sp),rt(Bp);const Ce=rt(oi);rt(yl),rt(si),rt(ai),rt(ci),rt(wp),rt(Ap);const dl=new T({algorithm:Ai,parameters:E.serialize(Ce)}),gl=new T({algorithm:gp,parameters:E.serialize(Pn.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});rt(ke),rt(vp),rt(mp),rt(ri),rt(Sc),rt(Bc),rt(ni),rt(ii),rt(Sc),rt(Bc);class _r{constructor(t={}){this.hashAlgorithm=new T(Ce),this.maskGenAlgorithm=new T({algorithm:Ai,parameters:E.serialize(Ce)}),this.pSourceAlgorithm=new T(gl),Object.assign(this,t)}}s([u({type:T,context:0,defaultValue:Ce})],_r.prototype,"hashAlgorithm",void 0),s([u({type:T,context:1,defaultValue:dl})],_r.prototype,"maskGenAlgorithm",void 0),s([u({type:T,context:2,defaultValue:gl})],_r.prototype,"pSourceAlgorithm",void 0),new T({algorithm:dp,parameters:E.serialize(new _r)});class pe{constructor(t={}){this.hashAlgorithm=new T(Ce),this.maskGenAlgorithm=new T({algorithm:Ai,parameters:E.serialize(Ce)}),this.saltLength=20,this.trailerField=1,Object.assign(this,t)}}s([u({type:T,context:0,defaultValue:Ce})],pe.prototype,"hashAlgorithm",void 0),s([u({type:T,context:1,defaultValue:dl})],pe.prototype,"maskGenAlgorithm",void 0),s([u({type:p.Integer,context:2,defaultValue:20})],pe.prototype,"saltLength",void 0),s([u({type:p.Integer,context:3,defaultValue:1})],pe.prototype,"trailerField",void 0),new T({algorithm:Sr,parameters:E.serialize(new pe)});class ui{constructor(t={}){this.digestAlgorithm=new T,this.digest=new K,Object.assign(this,t)}}s([u({type:T})],ui.prototype,"digestAlgorithm",void 0),s([u({type:K})],ui.prototype,"digest",void 0);var ps;class cn{constructor(t={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.Integer,converter:J})],cn.prototype,"prime",void 0),s([u({type:p.Integer,converter:J})],cn.prototype,"exponent",void 0),s([u({type:p.Integer,converter:J})],cn.prototype,"coefficient",void 0);let fs=ps=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ps.prototype)}};fs=ps=s([B({type:A.Sequence,itemType:cn})],fs);class Dt{constructor(t={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.Integer})],Dt.prototype,"version",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"modulus",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"publicExponent",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"privateExponent",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"prime1",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"prime2",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"exponent1",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"exponent2",void 0),s([u({type:p.Integer,converter:J})],Dt.prototype,"coefficient",void 0),s([u({type:fs,optional:!0})],Dt.prototype,"otherPrimeInfos",void 0);class ys{constructor(t={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.Integer,converter:J})],ys.prototype,"modulus",void 0),s([u({type:p.Integer,converter:J})],ys.prototype,"publicExponent",void 0);var ds;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(ds||(ds={}));const ft=ds;var gs=function(r,t){return gs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},gs(r,t)};function $s(r,t){gs(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function xp(r,t,e,n){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function c(v){try{f(n.next(v))}catch(m){a(m)}}function l(v){try{f(n.throw(v))}catch(m){a(m)}}function f(v){v.done?o(v.value):i(v.value).then(c,l)}f((n=n.apply(r,[])).next())})}function kp(r,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(v){return l([f,v])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(o=f[0]&2?i.return:f[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,f[1])).done)return o;switch(i=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,i=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){e.label=f[1];break}if(f[0]===6&&e.label<o[1]){e.label=o[1],o=f;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(f);break}o[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(r,e)}catch(v){f=[6,v],i=0}finally{n=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Gr(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function li(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return o}function fe(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(li(arguments[t]));return r}var Cp="injectionTokens";function Op(r){var t=Reflect.getMetadata("design:paramtypes",r)||[],e=Reflect.getOwnMetadata(Cp,r)||{};return Object.keys(e).forEach(function(n){t[+n]=e[n]}),t}function vl(r){return!!r.useClass}function vs(r){return!!r.useFactory}var ml=function(){function r(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(t){var e=this,n={},i=!1,o,a=function(){return i||(o=t(e.wrap()),i=!0),o};return new Proxy(n,this.createHandler(a))},r.prototype.createHandler=function(t){var e={},n=function(i){e[i]=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];o[0]=t();var c=Reflect[i];return c.apply(void 0,fe(o))}};return this.reflectMethods.forEach(n),e},r}();function Te(r){return typeof r=="string"||typeof r=="symbol"}function Ip(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function xc(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Ep(r){return typeof r=="function"||r instanceof ml}function un(r){return!!r.useToken}function ln(r){return r.useValue!=null}function Np(r){return vl(r)||ln(r)||un(r)||vs(r)}var Ms=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},r.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},r.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},r.prototype.setAll=function(t,e){this._registryMap.set(t,e)},r.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},r}(),Tp=function(r){$s(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ms),kc=function(){function r(){this.scopedResolutions=new Map}return r}();function jp(r,t){if(r===null)return"at position #"+t;var e=r.split(",")[t].trim();return'"'+e+'" at position #'+t}function Pp(r,t,e){return e===void 0&&(e="    "),fe([r],t.message.split("\n").map(function(n){return e+n})).join("\n")}function Rp(r,t,e){var n=li(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),i=n[1],o=i===void 0?null:i,a=jp(o,t);return Pp("Cannot inject the dependency "+a+' of "'+r.name+'" constructor. Reason:',e)}function Up(r){if(typeof r.dispose!="function")return!1;var t=r.dispose;return!(t.length>0)}var Vp=function(r){$s(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ms),Dp=function(r){$s(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ms),Lp=function(){function r(){this.preResolution=new Vp,this.postResolution=new Dp}return r}(),bl=new Map,Hp=function(){function r(t){this.parent=t,this._registry=new Tp,this.interceptors=new Lp,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(t,e,n){n===void 0&&(n={lifecycle:ft.Transient}),this.ensureNotDisposed();var i;if(Np(e)?i=e:i={useClass:e},un(i))for(var o=[t],a=i;a!=null;){var c=a.useToken;if(o.includes(c))throw new Error("Token registration cycle detected! "+fe(o,[c]).join(" -> "));o.push(c);var l=this._registry.get(c);l&&un(l.provider)?a=l.provider:a=null}if((n.lifecycle===ft.Singleton||n.lifecycle==ft.ContainerScoped||n.lifecycle==ft.ResolutionScoped)&&(ln(i)||vs(i)))throw new Error('Cannot use lifecycle "'+ft[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},r.prototype.registerType=function(t,e){return this.ensureNotDisposed(),Te(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},r.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},r.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),Te(t)){if(Te(e))return this.register(t,{useToken:e},{lifecycle:ft.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:ft.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!Te(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:ft.Singleton})},r.prototype.resolve=function(t,e){e===void 0&&(e=new kc),this.ensureNotDisposed();var n=this.getRegistration(t);if(!n&&Te(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),n){var i=this.resolveRegistration(n,e);return this.executePostResolutionInterceptor(t,i,"Single"),i}if(Ep(t)){var i=this.construct(t,e);return this.executePostResolutionInterceptor(t,i,"Single"),i}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var a=Gr(this.interceptors.preResolution.getAll(t)),c=a.next();!c.done;c=a.next()){var l=c.value;l.options.frequency!="Once"&&o.push(l),l.callback(t,e)}}catch(f){n={error:f}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,o)}},r.prototype.executePostResolutionInterceptor=function(t,e,n){var i,o;if(this.interceptors.postResolution.has(t)){var a=[];try{for(var c=Gr(this.interceptors.postResolution.getAll(t)),l=c.next();!l.done;l=c.next()){var f=l.value;f.options.frequency!="Once"&&a.push(f),f.callback(t,e,n)}}catch(v){i={error:v}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,a)}},r.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===ft.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n=t.options.lifecycle===ft.Singleton,i=t.options.lifecycle===ft.ContainerScoped,o=n||i,a;return ln(t.provider)?a=t.provider.useValue:un(t.provider)?a=o?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):vl(t.provider)?a=o?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):vs(t.provider)?a=t.provider.useFactory(this):a=this.construct(t.provider,e),t.options.lifecycle===ft.ResolutionScoped&&e.scopedResolutions.set(t,a),a},r.prototype.resolveAll=function(t,e){var n=this;e===void 0&&(e=new kc),this.ensureNotDisposed();var i=this.getAllRegistrations(t);if(!i&&Te(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),i){var o=i.map(function(c){return n.resolveRegistration(c,e)});return this.executePostResolutionInterceptor(t,o,"All"),o}var a=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,a,"All"),a},r.prototype.isRegistered=function(t,e){return e===void 0&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=Gr(this._registry.entries()),i=n.next();!i.done;i=n.next()){var o=li(i.value,2),a=o[0],c=o[1];this._registry.setAll(a,c.filter(function(l){return!ln(l.provider)}).map(function(l){return l.instance=void 0,l}))}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},r.prototype.createChildContainer=function(){var t,e;this.ensureNotDisposed();var n=new r(this);try{for(var i=Gr(this._registry.entries()),o=i.next();!o.done;o=i.next()){var a=li(o.value,2),c=a[0],l=a[1];l.some(function(f){var v=f.options;return v.lifecycle===ft.ContainerScoped})&&n._registry.setAll(c,l.map(function(f){return f.options.lifecycle===ft.ContainerScoped?{provider:f.provider,options:f.options}:f}))}}catch(f){t={error:f}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},r.prototype.beforeResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},r.prototype.afterResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},r.prototype.dispose=function(){return xp(this,void 0,void 0,function(){var t;return kp(this,function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach(function(n){var i=n.dispose();i&&t.push(i)}),[4,Promise.all(t)];case 1:return e.sent(),[2]}})})},r.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},r.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},r.prototype.construct=function(t,e){var n=this;if(t instanceof ml)return t.createProxy(function(o){return n.resolve(o,e)});var i=function(){var o=bl.get(t);if(!o||o.length===0){if(t.length===0)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var a=o.map(n.resolveParams(e,t));return new(t.bind.apply(t,fe([void 0],a)))}();return Up(i)&&this.disposables.add(i),i},r.prototype.resolveParams=function(t,e){var n=this;return function(i,o){var a,c,l;try{return Ip(i)?xc(i)?i.multiple?(a=n.resolve(i.transform)).transform.apply(a,fe([n.resolveAll(i.token)],i.transformArgs)):(c=n.resolve(i.transform)).transform.apply(c,fe([n.resolve(i.token,t)],i.transformArgs)):i.multiple?n.resolveAll(i.token):n.resolve(i.token,t):xc(i)?(l=n.resolve(i.transform,t)).transform.apply(l,fe([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(f){throw new Error(Rp(e,o,f))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),ht=new Hp;function Si(){return function(r){bl.set(r,Op(r))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var ms;class hi{constructor(t={}){this.attrId="",this.attrValues=[],Object.assign(t)}}s([u({type:p.ObjectIdentifier})],hi.prototype,"attrId",void 0),s([u({type:p.Any,repeated:"set"})],hi.prototype,"attrValues",void 0);let Cc=ms=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ms.prototype)}};Cc=ms=s([B({type:A.Sequence,itemType:hi})],Cc);var bs;let Oc=bs=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,bs.prototype)}};Oc=bs=s([B({type:A.Sequence,itemType:Qe})],Oc);class Ic{constructor(t={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Ic.prototype,"certId",void 0),s([u({type:p.Any,context:0})],Ic.prototype,"certValue",void 0);class Ec{constructor(t={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],Ec.prototype,"crlId",void 0),s([u({type:p.Any,context:0})],Ec.prototype,"crltValue",void 0);class wl extends K{}let pi=class{constructor(r={}){this.encryptionAlgorithm=new T,this.encryptedData=new wl,Object.assign(this,r)}};s([u({type:T})],pi.prototype,"encryptionAlgorithm",void 0),s([u({type:wl})],pi.prototype,"encryptedData",void 0);var ws,As;(function(r){r[r.v1=0]="v1"})(As||(As={}));class Al extends K{}let Ss=ws=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ws.prototype)}};Ss=ws=s([B({type:A.Sequence,itemType:Yt})],Ss);class dr{constructor(t={}){this.version=As.v1,this.privateKeyAlgorithm=new T,this.privateKey=new Al,Object.assign(this,t)}}s([u({type:p.Integer})],dr.prototype,"version",void 0),s([u({type:T})],dr.prototype,"privateKeyAlgorithm",void 0),s([u({type:Al})],dr.prototype,"privateKey",void 0),s([u({type:Ss,implicit:!0,context:0,optional:!0})],dr.prototype,"attributes",void 0);let Nc=class extends dr{};Nc=s([B({type:A.Sequence})],Nc);let Tc=class extends pi{};Tc=s([B({type:A.Sequence})],Tc);class jc{constructor(t={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],jc.prototype,"secretTypeId",void 0),s([u({type:p.Any,context:0})],jc.prototype,"secretValue",void 0);class Br{constructor(t={}){this.mac=new ui,this.macSalt=new K,this.iterations=1,Object.assign(this,t)}}s([u({type:ui})],Br.prototype,"mac",void 0),s([u({type:K})],Br.prototype,"macSalt",void 0),s([u({type:p.Integer,defaultValue:1})],Br.prototype,"iterations",void 0);class hn{constructor(t={}){this.version=3,this.authSafe=new Qe,this.macData=new Br,Object.assign(this,t)}}s([u({type:p.Integer})],hn.prototype,"version",void 0),s([u({type:Qe})],hn.prototype,"authSafe",void 0),s([u({type:Br,optional:!0})],hn.prototype,"macData",void 0);var Bs;class pn{constructor(t={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:p.ObjectIdentifier})],pn.prototype,"bagId",void 0),s([u({type:p.Any,context:0})],pn.prototype,"bagValue",void 0),s([u({type:hi,repeated:"set",optional:!0})],pn.prototype,"bagAttributes",void 0);let Pc=Bs=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Bs.prototype)}};Pc=Bs=s([B({type:A.Sequence,itemType:pn})],Pc);var xs,ks,Cs;const Sl="1.2.840.113549.1.9",Bl="".concat(Sl,".7"),Fs="".concat(Sl,".14");let fn=class extends ot{constructor(r={}){super(r)}toString(){return this.ia5String||super.toString()}};s([u({type:p.IA5String})],fn.prototype,"ia5String",void 0),fn=s([B({type:A.Choice})],fn);let Rc=class extends Qe{};Rc=s([B({type:A.Sequence})],Rc);let Uc=class extends hn{};Uc=s([B({type:A.Sequence})],Uc);let Vc=class extends pi{};Vc=s([B({type:A.Sequence})],Vc);let Li=class{constructor(r=""){this.value=r}toString(){return this.value}};s([u({type:p.IA5String})],Li.prototype,"value",void 0),Li=s([B({type:A.Choice})],Li);let Dc=class extends fn{};Dc=s([B({type:A.Choice})],Dc);let Lc=class extends ot{};Lc=s([B({type:A.Choice})],Lc);let Hi=class{constructor(r=new Date){this.value=r}};s([u({type:p.GeneralizedTime})],Hi.prototype,"value",void 0),Hi=s([B({type:A.Choice})],Hi);let Hc=class extends ot{};Hc=s([B({type:A.Choice})],Hc);let $i=class{constructor(r="M"){this.value=r}toString(){return this.value}};s([u({type:p.PrintableString})],$i.prototype,"value",void 0),$i=s([B({type:A.Choice})],$i);let yn=class{constructor(r=""){this.value=r}toString(){return this.value}};s([u({type:p.PrintableString})],yn.prototype,"value",void 0),yn=s([B({type:A.Choice})],yn);let $c=class extends yn{};$c=s([B({type:A.Choice})],$c);let Mc=class extends ot{};Mc=s([B({type:A.Choice})],Mc);let Mi=class{constructor(r=""){this.value=r}toString(){return this.value}};s([u({type:p.ObjectIdentifier})],Mi.prototype,"value",void 0),Mi=s([B({type:A.Choice})],Mi);let Fc=class extends st{};Fc=s([B({type:A.Choice})],Fc);let Fi=class{constructor(r=0){this.value=r}toString(){return this.value.toString()}};s([u({type:p.Integer})],Fi.prototype,"value",void 0),Fi=s([B({type:A.Choice})],Fi);let zc=class extends Lt{};zc=s([B({type:A.Sequence})],zc);let fi=class extends ot{};fi=s([B({type:A.Choice})],fi);let Kc=xs=class extends xe{constructor(r){super(r),Object.setPrototypeOf(this,xs.prototype)}};Kc=xs=s([B({type:A.Sequence})],Kc);let qc=ks=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,ks.prototype)}};qc=ks=s([B({type:A.Set,itemType:Xe})],qc);let zi=class{constructor(r=""){this.value=r}toString(){return this.value}};s([u({type:p.BmpString})],zi.prototype,"value",void 0),zi=s([B({type:A.Choice})],zi);let Os=class extends T{};Os=s([B({type:A.Sequence})],Os);let Wc=Cs=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Cs.prototype)}};Wc=Cs=s([B({type:A.Sequence,itemType:Os})],Wc);var Is;let yi=Is=class extends W{constructor(r){super(r),Object.setPrototypeOf(this,Is.prototype)}};yi=Is=s([B({type:A.Sequence,itemType:Yt})],yi);class Fe{constructor(t={}){this.version=0,this.subject=new nt,this.subjectPKInfo=new Ht,this.attributes=new yi,Object.assign(this,t)}}s([u({type:p.Integer})],Fe.prototype,"version",void 0),s([u({type:nt})],Fe.prototype,"subject",void 0),s([u({type:Ht})],Fe.prototype,"subjectPKInfo",void 0),s([u({type:yi,implicit:!0,context:0})],Fe.prototype,"attributes",void 0);class xr{constructor(t={}){this.certificationRequestInfo=new Fe,this.signatureAlgorithm=new T,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}s([u({type:Fe})],xr.prototype,"certificationRequestInfo",void 0),s([u({type:T})],xr.prototype,"signatureAlgorithm",void 0),s([u({type:p.BitString})],xr.prototype,"signature",void 0);const Lr="crypto.algorithm";class $p{getAlgorithms(){return ht.resolveAll(Lr)}toAsnAlgorithm(t){M({},t);for(const e of this.getAlgorithms()){const n=e.toAsnAlgorithm(t);if(n)return n}if(/^[0-9.]+$/.test(t.name)){const e=new T({algorithm:t.name});if("parameters"in t){const n=t;e.parameters=n.parameters}return e}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(t){for(const e of this.getAlgorithms()){const n=e.toWebAlgorithm(t);if(n)return n}return{name:t.algorithm,parameters:t.parameters}}}const tr="crypto.algorithmProvider";ht.registerSingleton(tr,$p);var dn;const mt="1.3.36.3.3.2.8.1.1",_c="".concat(mt,".1"),Gc="".concat(mt,".2"),Jc="".concat(mt,".3"),Zc="".concat(mt,".4"),Yc="".concat(mt,".5"),Xc="".concat(mt,".6"),Qc="".concat(mt,".7"),tu="".concat(mt,".8"),eu="".concat(mt,".9"),ru="".concat(mt,".10"),nu="".concat(mt,".11"),iu="".concat(mt,".12"),ou="".concat(mt,".13"),su="".concat(mt,".14"),au="brainpoolP160r1",cu="brainpoolP160t1",uu="brainpoolP192r1",lu="brainpoolP192t1",hu="brainpoolP224r1",pu="brainpoolP224t1",fu="brainpoolP256r1",yu="brainpoolP256t1",du="brainpoolP320r1",gu="brainpoolP320t1",vu="brainpoolP384r1",mu="brainpoolP384t1",bu="brainpoolP512r1",wu="brainpoolP512t1",Z="ECDSA";let gr=dn=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case Z.toLowerCase():if("hash"in r)switch((typeof r.hash=="string"?r.hash:r.hash.name).toLowerCase()){case"sha-1":return lp;case"sha-256":return hp;case"sha-384":return pp;case"sha-512":return fp}else if("namedCurve"in r){let t="";switch(r.namedCurve){case"P-256":t=bc;break;case"K-256":t=dn.SECP256K1;break;case"P-384":t=wc;break;case"P-521":t=Ac;break;case au:t=_c;break;case cu:t=Gc;break;case uu:t=Jc;break;case lu:t=Zc;break;case hu:t=Yc;break;case pu:t=Xc;break;case fu:t=Qc;break;case yu:t=tu;break;case du:t=eu;break;case gu:t=ru;break;case vu:t=nu;break;case mu:t=iu;break;case bu:t=ou;break;case wu:t=su;break}if(t)return new T({algorithm:Pr,parameters:E.serialize(new re({namedCurve:t}))})}}return null}toWebAlgorithm(r){switch(r.algorithm){case Vs:return{name:Z,hash:{name:"SHA-1"}};case Ds:return{name:Z,hash:{name:"SHA-256"}};case Ls:return{name:Z,hash:{name:"SHA-384"}};case Hs:return{name:Z,hash:{name:"SHA-512"}};case Pr:{if(!r.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(E.parse(r.parameters,re).namedCurve){case bc:return{name:Z,namedCurve:"P-256"};case dn.SECP256K1:return{name:Z,namedCurve:"K-256"};case wc:return{name:Z,namedCurve:"P-384"};case Ac:return{name:Z,namedCurve:"P-521"};case _c:return{name:Z,namedCurve:au};case Gc:return{name:Z,namedCurve:cu};case Jc:return{name:Z,namedCurve:uu};case Zc:return{name:Z,namedCurve:lu};case Yc:return{name:Z,namedCurve:hu};case Xc:return{name:Z,namedCurve:pu};case Qc:return{name:Z,namedCurve:fu};case tu:return{name:Z,namedCurve:yu};case eu:return{name:Z,namedCurve:du};case ru:return{name:Z,namedCurve:gu};case nu:return{name:Z,namedCurve:vu};case iu:return{name:Z,namedCurve:mu};case ou:return{name:Z,namedCurve:bu};case su:return{name:Z,namedCurve:wu}}}}return null}};gr.SECP256K1="1.3.132.0.10",gr=dn=s([Si()],gr),ht.registerSingleton(Lr,gr);const xl=Symbol("name"),kl=Symbol("value");class q{constructor(t,e={},n=""){this[xl]=t,this[kl]=n;for(const i in e)this[i]=e[i]}}q.NAME=xl,q.VALUE=kl;class Mp{static toTextObject(t){const e=new q("Algorithm Identifier",{},ue.toString(t.algorithm));if(t.parameters)switch(t.algorithm){case Pr:{const n=new gr().toWebAlgorithm(t);n&&"namedCurve"in n?e["Named Curve"]=n.namedCurve:e.Parameters=t.parameters;break}default:e.Parameters=t.parameters}return e}}class ue{static toString(t){return this.items[t]||t}}ue.items={[oi]:"sha1",[yl]:"sha224",[si]:"sha256",[ai]:"sha384",[ci]:"sha512",[ke]:"rsaEncryption",[ri]:"sha1WithRSAEncryption",[bp]:"sha224WithRSAEncryption",[hs]:"sha256WithRSAEncryption",[ni]:"sha384WithRSAEncryption",[ii]:"sha512WithRSAEncryption",[Pr]:"ecPublicKey",[Vs]:"ecdsaWithSHA1",[fl]:"ecdsaWithSHA224",[Ds]:"ecdsaWithSHA256",[Ls]:"ecdsaWithSHA384",[Hs]:"ecdsaWithSHA512",[np]:"TLS WWW server authentication",[ip]:"TLS WWW client authentication",[op]:"Code Signing",[sp]:"E-mail Protection",[ap]:"Time Stamping",[cp]:"OCSP Signing",[up]:"Signed Data"};class Oe{static serialize(t){return this.serializeObj(t).join("\n")}static pad(t=0){return"".padStart(2*t," ")}static serializeObj(t,e=0){const n=[];let i=this.pad(e++),o="";const a=t[q.VALUE];a&&(o=" ".concat(a)),n.push("".concat(i).concat(t[q.NAME],":").concat(o)),i=this.pad(e);for(const c in t){if(typeof c=="symbol")continue;const l=t[c],f=c?"".concat(c,": "):"";if(typeof l=="string"||typeof l=="number"||typeof l=="boolean")n.push("".concat(i).concat(f).concat(l));else if(l instanceof Date)n.push("".concat(i).concat(f).concat(l.toUTCString()));else if(Array.isArray(l))for(const v of l)v[q.NAME]=c,n.push(...this.serializeObj(v,e));else if(l instanceof q)l[q.NAME]=c,n.push(...this.serializeObj(l,e));else if(I.isBufferSource(l))c?(n.push("".concat(i).concat(f)),n.push(...this.serializeBufferSource(l,e+1))):n.push(...this.serializeBufferSource(l,e));else if("toTextObject"in l){const v=l.toTextObject();v[q.NAME]=c,n.push(...this.serializeObj(v,e))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return n}static serializeBufferSource(t,e=0){const n=this.pad(e),i=I.toUint8Array(t),o=[];for(let a=0;a<i.length;){const c=[];for(let l=0;l<16&&a<i.length;l++){l===8&&c.push("");const f=i[a++].toString(16).padStart(2,"0");c.push(f)}o.push("".concat(n).concat(c.join(" ")))}return o}static serializeAlgorithm(t){return this.algorithmSerializer.toTextObject(t)}}Oe.oidSerializer=ue,Oe.algorithmSerializer=Mp;class le{constructor(...t){if(t.length===1){const e=t[0];this.rawData=E.serialize(e),this.onInit(e)}else{const e=E.parse(t[0],t[1]);this.rawData=I.toArrayBuffer(t[0]),this.onInit(e)}}equal(t){return t instanceof le?ju(t.rawData,this.rawData):!1}toString(t="text"){switch(t){case"asn":return E.toString(this.rawData);case"text":return Oe.serialize(this.toTextObject());case"hex":return U.ToHex(this.rawData);case"base64":return U.ToBase64(this.rawData);case"base64url":return U.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const t=this.toTextObjectEmpty();return t[""]=this.rawData,t}toTextObjectEmpty(t){return new q(this.getTextName(),{},t)}}le.NAME="ASN";class Ot extends le{constructor(...t){let e;I.isBufferSource(t[0])?e=I.toArrayBuffer(t[0]):e=E.serialize(new jt({extnID:t[0],critical:t[1],extnValue:new K(I.toArrayBuffer(t[2]))})),super(e,jt)}onInit(t){this.type=t.extnID,this.critical=t.critical,this.value=t.extnValue.buffer}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.value,t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty(this.critical?"critical":void 0);return t[q.NAME]===Ot.NAME&&(t[q.NAME]=ue.toString(this.type)),t}}var Cl;class ne{static isCryptoKeyPair(t){return t&&t.privateKey&&t.publicKey}static isCryptoKey(t){return t&&t.usages&&t.type&&t.algorithm&&t.extractable!==void 0}constructor(){this.items=new Map,this[Cl]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(ne.DEFAULT,crypto):typeof zr<"u"&&zr.crypto&&zr.crypto.subtle&&this.set(ne.DEFAULT,zr.crypto)}clear(){this.items.clear()}delete(t){return this.items.delete(t)}forEach(t,e){return this.items.forEach(t,e)}has(t){return this.items.has(t)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(t=ne.DEFAULT){const e=this.items.get(t.toLowerCase());if(!e)throw new Error("Cannot get Crypto by name '".concat(t,"'"));return e}set(t,e){if(typeof t=="string"){if(!e)throw new TypeError("Argument 'value' is required");this.items.set(t.toLowerCase(),e)}else this.items.set(ne.DEFAULT,t);return this}}Cl=Symbol.toStringTag,ne.DEFAULT="default";const ut=new ne,Fp=/^[0-2](?:\.[1-9][0-9]*)+$/;function zp(r){return new RegExp(Fp).test(r)}class Ol{constructor(t={}){this.items={};for(const e in t)this.register(e,t[e])}get(t){return this.items[t]||null}findId(t){return zp(t)?t:this.get(t)}register(t,e){this.items[t]=e,this.items[e]=t}}const yt=new Ol;yt.register("CN","2.5.4.3"),yt.register("L","2.5.4.7"),yt.register("ST","2.5.4.8"),yt.register("O","2.5.4.10"),yt.register("OU","2.5.4.11"),yt.register("C","2.5.4.6"),yt.register("DC","0.9.2342.19200300.100.1.25"),yt.register("E","1.2.840.113549.1.9.1"),yt.register("G","2.5.4.42"),yt.register("I","2.5.4.43"),yt.register("SN","2.5.4.4"),yt.register("T","2.5.4.12");function Kp(r,t){return"\\".concat(U.ToHex(U.FromUtf8String(t)).toUpperCase())}function qp(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,Kp)}class ae{static isASCII(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!1;return!0}static isPrintableString(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(t)}constructor(t,e={}){this.extraNames=new Ol,this.asn=new nt;for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];this.extraNames.register(n,i)}typeof t=="string"?this.asn=this.fromString(t):t instanceof nt?this.asn=t:I.isBufferSource(t)?this.asn=E.parse(t,nt):this.asn=this.fromJSON(t)}getField(t){const e=this.extraNames.findId(t)||yt.findId(t),n=[];for(const i of this.asn)for(const o of i)o.type===e&&n.push(o.value.toString());return n}getName(t){return this.extraNames.get(t)||yt.get(t)}toString(){return this.asn.map(t=>t.map(e=>{const n=this.getName(e.type)||e.type,i=e.value.anyValue?"#".concat(U.ToHex(e.value.anyValue)):qp(e.value.toString());return"".concat(n,"=").concat(i)}).join("+")).join(", ")}toJSON(){var t;const e=[];for(const n of this.asn){const i={};for(const o of n){const a=this.getName(o.type)||o.type;(t=i[a])!==null&&t!==void 0||(i[a]=[]),i[a].push(o.value.anyValue?"#".concat(U.ToHex(o.value.anyValue)):o.value.toString())}e.push(i)}return e}fromString(t){const e=new nt,n=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let i=null,o=",";for(;i=n.exec("".concat(t,","));){let[,a,c]=i;const l=c[c.length-1];(l===","||l==="+")&&(c=c.slice(0,c.length-1),i[3]=l);const f=i[3];a=this.getTypeOid(a);const v=this.createAttribute(a,c);o==="+"?e[e.length-1].push(v):e.push(new Je([v])),o=f}return e}fromJSON(t){const e=new nt;for(const n of t){const i=new Je;for(const o in n){const a=this.getTypeOid(o),c=n[o];for(const l of c){const f=this.createAttribute(a,l);i.push(f)}}e.push(i)}return e}getTypeOid(t){if(/[\d.]+/.test(t)||(t=this.getName(t)||""),!t)throw new Error("Cannot get OID for name type '".concat(t,"'"));return t}createAttribute(t,e){const n=new Rn({type:t});if(typeof e=="object")for(const i in e)switch(i){case"ia5String":n.value.ia5String=e[i];break;case"utf8String":n.value.utf8String=e[i];break;case"universalString":n.value.universalString=e[i];break;case"bmpString":n.value.bmpString=e[i];break;case"printableString":n.value.printableString=e[i];break}else if(e[0]==="#")n.value.anyValue=U.FromHex(e.slice(1));else{const i=this.processStringValue(e);t===this.getName("E")||t===this.getName("DC")?n.value.ia5String=i:ae.isPrintableString(i)?n.value.printableString=i:n.value.utf8String=i}return n}processStringValue(t){const e=/"(.*?[^\\])?"/.exec(t);return e&&(t=e[1]),t.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return E.serialize(this.asn)}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||ut.get()):n=t[0]||ut.get(),await n.subtle.digest(i,this.toArrayBuffer())}}const Il="Cannot initialize GeneralName from ASN.1 data.",Au="".concat(Il," Unsupported string format in use."),Wp="".concat(Il," Value doesn't match to GUID regular expression."),Su=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,Bu="1.3.6.1.4.1.311.25.1",xu="1.3.6.1.4.1.311.20.2.3",Ki="dns",qi="dn",Wi="email",_i="ip",Gi="url",Ji="guid",Zi="upn",Jr="id";class ie extends le{constructor(...t){let e;if(t.length===2)switch(t[0]){case qi:{const n=new ae(t[1]).toArrayBuffer(),i=E.parse(n,nt);e=new H({directoryName:i});break}case Ki:e=new H({dNSName:t[1]});break;case Wi:e=new H({rfc822Name:t[1]});break;case Ji:{const n=new RegExp(Su,"i").exec(t[1]);if(!n)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=n.slice(1).map((o,a)=>a<3?U.ToHex(new Uint8Array(U.FromHex(o)).reverse()):o).join("");e=new H({otherName:new Nr({typeId:Bu,value:E.serialize(new K(U.FromHex(i)))})});break}case _i:e=new H({iPAddress:t[1]});break;case Jr:e=new H({registeredID:t[1]});break;case Zi:{e=new H({otherName:new Nr({typeId:xu,value:E.serialize(el.toASN(t[1]))})});break}case Gi:e=new H({uniformResourceIdentifier:t[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else I.isBufferSource(t[0])?e=E.parse(t[0],H):e=t[0];super(e)}onInit(t){if(t.dNSName!=null)this.type=Ki,this.value=t.dNSName;else if(t.rfc822Name!=null)this.type=Wi,this.value=t.rfc822Name;else if(t.iPAddress!=null)this.type=_i,this.value=t.iPAddress;else if(t.uniformResourceIdentifier!=null)this.type=Gi,this.value=t.uniformResourceIdentifier;else if(t.registeredID!=null)this.type=Jr,this.value=t.registeredID;else if(t.directoryName!=null)this.type=qi,this.value=new ae(t.directoryName).toString();else if(t.otherName!=null)if(t.otherName.typeId===Bu){this.type=Ji;const e=E.parse(t.otherName.value,K),n=new RegExp(Su,"i").exec(U.ToHex(e));if(!n)throw new Error(Wp);this.value=n.slice(1).map((i,o)=>o<3?U.ToHex(new Uint8Array(U.FromHex(i)).reverse()):i).join("-")}else if(t.otherName.typeId===xu)this.type=Zi,this.value=E.parse(t.otherName.value,ot).toString();else throw new Error(Au);else throw new Error(Au)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let t;switch(this.type){case qi:case Ki:case Ji:case _i:case Jr:case Zi:case Gi:t=this.type.toUpperCase();break;case Wi:t="Email";break;default:throw new Error("Unsupported GeneralName type")}let e=this.value;return this.type===Jr&&(e=ue.toString(e)),new q(t,void 0,e)}}class Rr extends le{constructor(t){let e;if(t instanceof lt)e=t;else if(Array.isArray(t)){const n=[];for(const i of t)if(i instanceof H)n.push(i);else{const o=E.parse(new ie(i.type,i.value).rawData,H);n.push(o)}e=new lt(n)}else if(I.isBufferSource(t))e=E.parse(t,lt);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(e)}onInit(t){const e=[];for(const n of t){let i=null;try{i=new ie(n)}catch(o){continue}e.push(i)}this.items=e}toJSON(){return this.items.map(t=>t.toJSON())}toTextObject(){const t=super.toTextObjectEmpty();for(const e of this.items){const n=e.toTextObject();let i=t[n[q.NAME]];Array.isArray(i)||(i=[],t[n[q.NAME]]=i),i.push(n)}return t}}Rr.NAME="GeneralNames";const kr="-{5}",Ur="\\n",_p="[^".concat(Ur,"]+"),Gp="".concat(kr,"BEGIN (").concat(_p,"(?=").concat(kr,"))").concat(kr),Jp="".concat(kr,"END \\1").concat(kr),er="\\n",Zp="[^:".concat(Ur,"]+"),Yp="(?:[^".concat(Ur,"]+").concat(er,"(?: +[^").concat(Ur,"]+").concat(er,")*)"),Xp="[a-zA-Z0-9=+/]+",Qp="(?:".concat(Xp).concat(er,")+"),ku="".concat(Gp).concat(er,"(?:((?:").concat(Zp,": ").concat(Yp,")+))?").concat(er,"?(").concat(Qp,")").concat(Jp);class wt{static isPem(t){return typeof t=="string"&&new RegExp(ku,"g").test(t)}static decodeWithHeaders(t){t=t.replace(/\r/g,"");const e=new RegExp(ku,"g"),n=[];let i=null;for(;i=e.exec(t);){const o=i[3].replace(new RegExp("[".concat(Ur,"]+"),"g"),""),a={type:i[1],headers:[],rawData:U.FromBase64(o)},c=i[2];if(c){const l=c.split(new RegExp(er,"g"));let f=null;for(const v of l){const[m,$]=v.split(/:(.*)/);if($===void 0){if(!f)throw new Error("Cannot parse PEM string. Incorrect header value");f.value+=m.trim()}else f&&a.headers.push(f),f={key:m,value:$.trim()}}f&&a.headers.push(f)}n.push(a)}return n}static decode(t){return this.decodeWithHeaders(t).map(e=>e.rawData)}static decodeFirst(t){const e=this.decode(t);if(!e.length)throw new RangeError("PEM string doesn't contain any objects");return e[0]}static encode(t,e){if(Array.isArray(t)){const n=new Array;return e?t.forEach(i=>{if(!I.isBufferSource(i))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");n.push(this.encodeStruct({type:e,rawData:I.toArrayBuffer(i)}))}):t.forEach(i=>{if(!("type"in i))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");n.push(this.encodeStruct(i))}),n.join("\n")}else{if(!e)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:e,rawData:I.toArrayBuffer(t)})}}static encodeStruct(t){var e;const n=t.type.toLocaleUpperCase(),i=[];if(i.push("-----BEGIN ".concat(n,"-----")),!((e=t.headers)===null||e===void 0)&&e.length){for(const f of t.headers)i.push("".concat(f.key,": ").concat(f.value));i.push("")}const o=U.ToBase64(t.rawData);let a,c=0;const l=Array();for(;c<o.length&&(o.length-c<64?a=o.substring(c):(a=o.substring(c,c+64),c+=64),a.length!==0)&&(l.push(a),!(a.length<64)););return i.push(...l),i.push("-----END ".concat(n,"-----")),i.join("\n")}}wt.CertificateTag="CERTIFICATE",wt.CrlTag="CRL",wt.CertificateRequestTag="CERTIFICATE REQUEST",wt.PublicKeyTag="PUBLIC KEY",wt.PrivateKeyTag="PRIVATE KEY";class Qt extends le{static isAsnEncoded(t){return I.isBufferSource(t)||typeof t=="string"}static toArrayBuffer(t){if(typeof t=="string"){if(wt.isPem(t))return wt.decode(t)[0];if(U.isHex(t))return U.FromHex(t);if(U.isBase64(t))return U.FromBase64(t);if(U.isBase64Url(t))return U.FromBase64Url(t);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const e=U.ToBinary(t);return wt.isPem(e)?wt.decode(e)[0]:U.isHex(e)?U.FromHex(e):U.isBase64(e)?U.FromBase64(e):U.isBase64Url(e)?U.FromBase64Url(e):I.toArrayBuffer(t)}}constructor(...t){Qt.isAsnEncoded(t[0])?super(Qt.toArrayBuffer(t[0]),t[1]):super(t[0])}toString(t="pem"){switch(t){case"pem":return wt.encode(this.rawData,this.tag);default:return super.toString(t)}}}class Mt extends Qt{static async create(t,e=ut.get()){if(t instanceof Mt)return t;if(ne.isCryptoKey(t)){if(t.type!=="public")throw new TypeError("Public key is required");const n=await e.subtle.exportKey("spki",t);return new Mt(n)}else{if(t.publicKey)return t.publicKey;if(I.isBufferSource(t))return new Mt(t);throw new TypeError("Unsupported PublicKeyType")}}constructor(t){Qt.isAsnEncoded(t)?super(t,Ht):super(t),this.tag=wt.PublicKeyTag}async export(...t){let e,n=["verify"],i=M({hash:"SHA-256"},this.algorithm);t.length>1?(i=t[0]||i,n=t[1]||n,e=t[2]||ut.get()):e=t[0]||ut.get();let o=this.rawData;const a=E.parse(this.rawData,Ht);return a.algorithm.algorithm===Sr&&(o=tf(a,o)),e.subtle.importKey("spki",o,i,!0,n)}onInit(t){const e=ht.resolve(tr),n=this.algorithm=e.toWebAlgorithm(t.algorithm);switch(t.algorithm.algorithm){case ke:{const i=E.parse(t.subjectPublicKey,ys),o=I.toUint8Array(i.modulus);n.publicExponent=I.toUint8Array(i.publicExponent),n.modulusLength=(o[0]?o:o.slice(1)).byteLength<<3;break}}}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||ut.get()):n=t[0]||ut.get(),await n.subtle.digest(i,this.rawData)}async getKeyIdentifier(...t){let e,n="SHA-1";t.length===1?typeof t[0]=="string"?(n=t[0],e=ut.get()):e=t[0]:t.length===2?(n=t[0],e=t[1]):e=ut.get();const i=E.parse(this.rawData,Ht);return await e.subtle.digest(n,i.subjectPublicKey)}toTextObject(){const t=this.toTextObjectEmpty(),e=E.parse(this.rawData,Ht);switch(t.Algorithm=Oe.serializeAlgorithm(e.algorithm),e.algorithm.algorithm){case Pr:t["EC Point"]=e.subjectPublicKey;break;case ke:default:t["Raw Data"]=e.subjectPublicKey}return t}}function tf(r,t){return r.algorithm=new T({algorithm:ke,parameters:null}),t=E.serialize(r),t}class Vr extends Ot{static async create(t,e=!1,n=ut.get()){if("name"in t&&"serialNumber"in t)return new Vr(t,e);const i=await(await Mt.create(t,n)).getKeyIdentifier(n);return new Vr(U.ToHex(i),e)}constructor(...t){if(I.isBufferSource(t[0]))super(t[0]);else if(typeof t[0]=="string"){const e=new de({keyIdentifier:new Us(U.FromHex(t[0]))});super(So,t[1],E.serialize(e))}else{const e=t[0],n=e.name instanceof Rr?E.parse(e.name.rawData,lt):e.name,i=new de({authorityCertIssuer:n,authorityCertSerialNumber:U.FromHex(e.serialNumber)});super(So,t[1],E.serialize(i))}}onInit(t){super.onInit(t);const e=E.parse(t.extnValue,de);e.keyIdentifier&&(this.keyId=U.ToHex(e.keyIdentifier)),(e.authorityCertIssuer||e.authorityCertSerialNumber)&&(this.certId={name:e.authorityCertIssuer||[],serialNumber:e.authorityCertSerialNumber?U.ToHex(e.authorityCertSerialNumber):""})}toTextObject(){const t=this.toTextObjectWithoutValue(),e=E.parse(this.value,de);return e.authorityCertIssuer&&(t["Authority Issuer"]=new Rr(e.authorityCertIssuer).toTextObject()),e.authorityCertSerialNumber&&(t["Authority Serial Number"]=e.authorityCertSerialNumber),e.keyIdentifier&&(t[""]=e.keyIdentifier),t}}Vr.NAME="Authority Key Identifier";class El extends Ot{constructor(...t){if(I.isBufferSource(t[0])){super(t[0]);const e=E.parse(this.value,Un);this.ca=e.cA,this.pathLength=e.pathLenConstraint}else{const e=new Un({cA:t[0],pathLenConstraint:t[1]});super(il,t[2],E.serialize(e)),this.ca=t[0],this.pathLength=t[1]}}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ca&&(t.CA=this.ca),this.pathLength!==void 0&&(t["Path Length"]=this.pathLength),t}}El.NAME="Basic Constraints";var Cu;(function(r){r.serverAuth="1.3.6.1.5.5.7.3.1",r.clientAuth="1.3.6.1.5.5.7.3.2",r.codeSigning="1.3.6.1.5.5.7.3.3",r.emailProtection="1.3.6.1.5.5.7.3.4",r.timeStamping="1.3.6.1.5.5.7.3.8",r.ocspSigning="1.3.6.1.5.5.7.3.9"})(Cu||(Cu={}));class Nl extends Ot{constructor(...t){if(I.isBufferSource(t[0])){super(t[0]);const e=E.parse(this.value,Ln);this.usages=e.map(n=>n)}else{const e=new Ln(t[0]);super(al,t[1],E.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.usages.map(e=>ue.toString(e)).join(", "),t}}Nl.NAME="Extended Key Usages";var Ou;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Ou||(Ou={}));class Tl extends Ot{constructor(...t){if(I.isBufferSource(t[0])){super(t[0]);const e=E.parse(this.value,Pi);this.usages=e.toNumber()}else{const e=new Pi(t[0]);super(cl,t[1],E.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=E.parse(this.value,Pi);return t[""]=e.toJSON().join(", "),t}}Tl.NAME="Key Usages";class Bi extends Ot{static async create(t,e=!1,n=ut.get()){const i=await(await Mt.create(t,n)).getKeyIdentifier(n);return new Bi(U.ToHex(i),e)}constructor(...t){if(I.isBufferSource(t[0])){super(t[0]);const e=E.parse(this.value,se);this.keyId=U.ToHex(e)}else{const e=typeof t[0]=="string"?U.FromHex(t[0]):t[0],n=new se(e);super(ll,t[1],E.serialize(n)),this.keyId=U.ToHex(e)}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=E.parse(this.value,se);return t[""]=e,t}}Bi.NAME="Subject Key Identifier";class jl extends Ot{constructor(...t){I.isBufferSource(t[0])?super(t[0]):super(ul,t[1],new Rr(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=E.parse(t.extnValue,Lo);this.names=new Rr(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const n in e)t[n]=e[n];return t}}jl.NAME="Subject Alternative Name";class Bt{static register(t,e){this.items.set(t,e)}static create(t){const e=new Ot(t),n=this.items.get(e.type);return n?new n(t):e}}Bt.items=new Map;class Iu extends Ot{constructor(...t){var e;if(I.isBufferSource(t[0])){super(t[0]);const n=E.parse(this.value,Dn);this.policies=n.map(i=>i.policyIdentifier)}else{const n=t[0],i=(e=t[1])!==null&&e!==void 0?e:!1,o=new Dn(n.map(a=>new Vn({policyIdentifier:a})));super(ol,i,E.serialize(o)),this.policies=n}}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Policy=this.policies.map(e=>new q("",{},ue.toString(e))),t}}Iu.NAME="Certificate Policies",Bt.register(ol,Iu);class Pl extends Ot{constructor(...t){var e;if(I.isBufferSource(t[0]))super(t[0]);else if(Array.isArray(t[0])&&typeof t[0][0]=="string"){const n=t[0].map(o=>new qe({distributionPoint:new ge({fullName:[new H({uniformResourceIdentifier:o})]})})),i=new We(n);super(No,t[1],E.serialize(i))}else{const n=new We(t[0]);super(No,t[1],E.serialize(n))}(e=this.distributionPoints)!==null&&e!==void 0||(this.distributionPoints=[])}onInit(t){super.onInit(t);const e=E.parse(t.extnValue,We);this.distributionPoints=e}toTextObject(){const t=this.toTextObjectWithoutValue();return t["Distribution Point"]=this.distributionPoints.map(e=>{var n;const i={};return e.distributionPoint&&(i[""]=(n=e.distributionPoint.fullName)===null||n===void 0?void 0:n.map(o=>new ie(o).toString()).join(", ")),e.reasons&&(i.Reasons=e.reasons.toString()),e.cRLIssuer&&(i["CRL Issuer"]=e.cRLIssuer.map(o=>o.toString()).join(", ")),i}),t}}Pl.NAME="CRL Distribution Points";class Rl extends Ot{constructor(...t){var e,n,i,o;if(I.isBufferSource(t[0]))super(t[0]);else if(t[0]instanceof De){const a=new De(t[0]);super(Ao,t[1],E.serialize(a))}else{const a=t[0],c=new De;Yr(c,a,Xa,"ocsp"),Yr(c,a,Qa,"caIssuers"),Yr(c,a,tc,"timeStamping"),Yr(c,a,ec,"caRepository"),super(Ao,t[1],E.serialize(c))}(e=this.ocsp)!==null&&e!==void 0||(this.ocsp=[]),(n=this.caIssuers)!==null&&n!==void 0||(this.caIssuers=[]),(i=this.timeStamping)!==null&&i!==void 0||(this.timeStamping=[]),(o=this.caRepository)!==null&&o!==void 0||(this.caRepository=[])}onInit(t){super.onInit(t),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],E.parse(t.extnValue,De).forEach(e=>{switch(e.accessMethod){case Xa:this.ocsp.push(new ie(e.accessLocation));break;case Qa:this.caIssuers.push(new ie(e.accessLocation));break;case tc:this.timeStamping.push(new ie(e.accessLocation));break;case ec:this.caRepository.push(new ie(e.accessLocation));break}})}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ocsp.length&&Zr(t,"OCSP",this.ocsp),this.caIssuers.length&&Zr(t,"CA Issuers",this.caIssuers),this.timeStamping.length&&Zr(t,"Time Stamping",this.timeStamping),this.caRepository.length&&Zr(t,"CA Repository",this.caRepository),t}}Rl.NAME="Authority Info Access";function Zr(r,t,e){if(e.length===1)r[t]=e[0].toTextObject();else{const n=new q("");e.forEach((i,o)=>{const a=i.toTextObject(),c="".concat(a[q.NAME]," ").concat(o+1);let l=n[c];Array.isArray(l)||(l=[],n[c]=l),l.push(a)}),r[t]=n}}function Yr(r,t,e,n){const i=t[n];i&&(Array.isArray(i)?i:[i]).forEach(o=>{typeof o=="string"&&(o=new ie("url",o)),r.push(new Tr({accessMethod:e,accessLocation:E.parse(o.rawData,H)}))})}class ir extends le{constructor(...t){let e;if(I.isBufferSource(t[0]))e=I.toArrayBuffer(t[0]);else{const n=t[0],i=Array.isArray(t[1])?t[1].map(o=>I.toArrayBuffer(o)):[];e=E.serialize(new Yt({type:n,values:i}))}super(e,Yt)}onInit(t){this.type=t.type,this.values=t.values}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Value=this.values.map(e=>new q("",{"":e})),t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty();return t[q.NAME]===ir.NAME&&(t[q.NAME]=ue.toString(this.type)),t}}ir.NAME="Attribute";class Ul extends ir{constructor(...t){var e;if(I.isBufferSource(t[0]))super(t[0]);else{const n=new fi({printableString:t[0]});super(Bl,[E.serialize(n)])}(e=this.password)!==null&&e!==void 0||(this.password="")}onInit(t){if(super.onInit(t),this.values[0]){const e=E.parse(this.values[0],fi);this.password=e.toString()}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[q.VALUE]=this.password,t}}Ul.NAME="Challenge Password";class zs extends ir{constructor(...t){var e;if(I.isBufferSource(t[0]))super(t[0]);else{const n=t[0],i=new xe;for(const o of n)i.push(E.parse(o.rawData,jt));super(Fs,[E.serialize(i)])}(e=this.items)!==null&&e!==void 0||(this.items=[])}onInit(t){if(super.onInit(t),this.values[0]){const e=E.parse(this.values[0],xe);this.items=e.map(n=>Bt.create(E.serialize(n)))}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.items.map(n=>n.toTextObject());for(const n of e)t[n[q.NAME]]=n;return t}}zs.NAME="Extensions";class di{static register(t,e){this.items.set(t,e)}static create(t){const e=new ir(t),n=this.items.get(e.type);return n?new n(t):e}}di.items=new Map;const gi="crypto.signatureFormatter";class ef{toAsnSignature(t,e){return I.toArrayBuffer(e)}toWebSignature(t,e){return I.toArrayBuffer(e)}}var gn;let Yi=gn=class{static createPssParams(r,t){const e=gn.getHashAlgorithm(r);return e?new pe({hashAlgorithm:e,maskGenAlgorithm:new T({algorithm:Ai,parameters:E.serialize(e)}),saltLength:t}):null}static getHashAlgorithm(r){const t=ht.resolve(tr);return typeof r=="string"?t.toAsnAlgorithm({name:r}):typeof r=="object"&&r&&"name"in r?t.toAsnAlgorithm(r):null}toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in r){let t;if(typeof r.hash=="string")t=r.hash;else if(r.hash&&typeof r.hash=="object"&&"name"in r.hash&&typeof r.hash.name=="string")t=r.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new T({algorithm:ri,parameters:null});case"sha-256":return new T({algorithm:hs,parameters:null});case"sha-384":return new T({algorithm:ni,parameters:null});case"sha-512":return new T({algorithm:ii,parameters:null})}}else return new T({algorithm:ke,parameters:null});break;case"rsa-pss":if("hash"in r){if(!("saltLength"in r&&typeof r.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=gn.createPssParams(r.hash,r.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new T({algorithm:Sr,parameters:E.serialize(t)})}else return new T({algorithm:Sr,parameters:null})}return null}toWebAlgorithm(r){switch(r.algorithm){case ke:return{name:"RSASSA-PKCS1-v1_5"};case ri:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case hs:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case ni:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case ii:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case Sr:if(r.parameters){const t=E.parse(r.parameters,pe);return{name:"RSA-PSS",hash:ht.resolve(tr).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}else return{name:"RSA-PSS"}}return null}};Yi=gn=s([Si()],Yi),ht.registerSingleton(Lr,Yi);let Xi=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"sha-1":return new T({algorithm:oi});case"sha-256":return new T({algorithm:si});case"sha-384":return new T({algorithm:ai});case"sha-512":return new T({algorithm:ci})}return null}toWebAlgorithm(r){switch(r.algorithm){case oi:return{name:"SHA-1"};case si:return{name:"SHA-256"};case ai:return{name:"SHA-384"};case ci:return{name:"SHA-512"}}return null}};Xi=s([Si()],Xi),ht.registerSingleton(Lr,Xi);class xt{addPadding(t,e){const n=I.toUint8Array(e),i=new Uint8Array(t);return i.set(n,t-n.length),i}removePadding(t,e=!1){let n=I.toUint8Array(t);for(let i=0;i<n.length;i++)if(n[i]){n=n.slice(i);break}if(e&&n[0]>127){const i=new Uint8Array(n.length+1);return i.set(n,1),i.buffer}return n.buffer}toAsnSignature(t,e){if(t.name==="ECDSA"){const n=t.namedCurve,i=xt.namedCurveSize.get(n)||xt.defaultNamedCurveSize,o=new ei,a=I.toUint8Array(e);return o.r=this.removePadding(a.slice(0,i),!0),o.s=this.removePadding(a.slice(i,i+i),!0),E.serialize(o)}return null}toWebSignature(t,e){if(t.name==="ECDSA"){const n=E.parse(e,ei),i=t.namedCurve,o=xt.namedCurveSize.get(i)||xt.defaultNamedCurveSize,a=this.addPadding(o,this.removePadding(n.r)),c=this.addPadding(o,this.removePadding(n.s));return fh(a,c)}return null}}xt.namedCurveSize=new Map,xt.defaultNamedCurveSize=32;const Qi="1.3.101.110",Eu="1.3.101.111",to="1.3.101.112",Nu="1.3.101.113";let eo=class{toAsnAlgorithm(r){let t=null;switch(r.name.toLowerCase()){case"ed25519":t=to;break;case"x25519":t=Qi;break;case"eddsa":switch(r.namedCurve.toLowerCase()){case"ed25519":t=to;break;case"ed448":t=Nu;break}break;case"ecdh-es":switch(r.namedCurve.toLowerCase()){case"x25519":t=Qi;break;case"x448":t=Eu;break}}return t?new T({algorithm:t}):null}toWebAlgorithm(r){switch(r.algorithm){case to:return{name:"Ed25519"};case Nu:return{name:"EdDSA",namedCurve:"Ed448"};case Qi:return{name:"X25519"};case Eu:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};eo=s([Si()],eo),ht.registerSingleton(Lr,eo);class rf extends Qt{constructor(t){Qt.isAsnEncoded(t)?super(t,xr):super(t),this.tag=wt.CertificateRequestTag}onInit(t){this.tbs=E.serialize(t.certificationRequestInfo),this.publicKey=new Mt(t.certificationRequestInfo.subjectPKInfo);const e=ht.resolve(tr);this.signatureAlgorithm=e.toWebAlgorithm(t.signatureAlgorithm),this.signature=t.signature,this.attributes=t.certificationRequestInfo.attributes.map(i=>di.create(E.serialize(i)));const n=this.getAttribute(Fs);this.extensions=[],n instanceof zs&&(this.extensions=n.items),this.subjectName=new ae(t.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(t){for(const e of this.attributes)if(e.type===t)return e;return null}getAttributes(t){return this.attributes.filter(e=>e.type===t)}getExtension(t){for(const e of this.extensions)if(e.type===t)return e;return null}getExtensions(t){return this.extensions.filter(e=>e.type===t)}async verify(t=ut.get()){const e=M(M({},this.publicKey.algorithm),this.signatureAlgorithm),n=await this.publicKey.export(e,["verify"],t),i=ht.resolveAll(gi).reverse();let o=null;for(const a of i)if(o=a.toWebSignature(e,this.signature),o)break;if(!o)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await t.subtle.verify(this.signatureAlgorithm,n,o,this.tbs)}toTextObject(){const t=this.toTextObjectEmpty(),e=E.parse(this.rawData,xr),n=e.certificationRequestInfo,i=new q("",{Version:"".concat(Ze[n.version]," (").concat(n.version,")"),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const o=new q("");for(const a of this.attributes){const c=a.toTextObject();o[c[q.NAME]]=c}i.Attributes=o}return t.Data=i,t.Signature=new q("",{Algorithm:Oe.serializeAlgorithm(e.signatureAlgorithm),"":e.signature}),t}}rf.NAME="PKCS#10 Certificate Request";class nf extends Qt{constructor(t){Qt.isAsnEncoded(t)?super(t,_e):super(t),this.tag=wt.CertificateTag}onInit(t){const e=t.tbsCertificate;this.tbs=E.serialize(e),this.serialNumber=U.ToHex(e.serialNumber),this.subjectName=new ae(e.subject),this.subject=new ae(e.subject).toString(),this.issuerName=new ae(e.issuer),this.issuer=this.issuerName.toString();const n=ht.resolve(tr);this.signatureAlgorithm=n.toWebAlgorithm(t.signatureAlgorithm),this.signature=t.signatureValue;const i=e.validity.notBefore.utcTime||e.validity.notBefore.generalTime;if(!i)throw new Error("Cannot get 'notBefore' value");this.notBefore=i;const o=e.validity.notAfter.utcTime||e.validity.notAfter.generalTime;if(!o)throw new Error("Cannot get 'notAfter' value");this.notAfter=o,this.extensions=[],e.extensions&&(this.extensions=e.extensions.map(a=>Bt.create(E.serialize(a)))),this.publicKey=new Mt(e.subjectPublicKeyInfo)}getExtension(t){for(const e of this.extensions)if(typeof t=="string"){if(e.type===t)return e}else if(e instanceof t)return e;return null}getExtensions(t){return this.extensions.filter(e=>typeof t=="string"?e.type===t:e instanceof t)}async verify(t={},e=ut.get()){let n,i;const o=t.publicKey;try{if(!o)n=M(M({},this.publicKey.algorithm),this.signatureAlgorithm),i=await this.publicKey.export(n,["verify"],e);else if("publicKey"in o)n=M(M({},o.publicKey.algorithm),this.signatureAlgorithm),i=await o.publicKey.export(n,["verify"],e);else if(o instanceof Mt)n=M(M({},o.algorithm),this.signatureAlgorithm),i=await o.export(n,["verify"],e);else if(I.isBufferSource(o)){const f=new Mt(o);n=M(M({},f.algorithm),this.signatureAlgorithm),i=await f.export(n,["verify"],e)}else n=M(M({},o.algorithm),this.signatureAlgorithm),i=o}catch(f){return!1}const a=ht.resolveAll(gi).reverse();let c=null;for(const f of a)if(c=f.toWebSignature(n,this.signature),c)break;if(!c)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const l=await e.subtle.verify(this.signatureAlgorithm,i,c,this.tbs);if(t.signatureOnly)return l;{const f=(t.date||new Date).getTime();return l&&this.notBefore.getTime()<f&&f<this.notAfter.getTime()}}async getThumbprint(...t){let e,n="SHA-1";return t[0]&&(t[0].subtle?e=t[0]:(n=t[0]||n,e=t[1])),e!=null||(e=ut.get()),await e.subtle.digest(n,this.rawData)}async isSelfSigned(t=ut.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},t)}toTextObject(){const t=this.toTextObjectEmpty(),e=E.parse(this.rawData,_e),n=e.tbsCertificate,i=new q("",{Version:"".concat(Ze[n.version]," (").concat(n.version,")"),"Serial Number":n.serialNumber,"Signature Algorithm":Oe.serializeAlgorithm(n.signature),Issuer:this.issuer,Validity:new q("",{"Not Before":n.validity.notBefore.getTime(),"Not After":n.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(n.issuerUniqueID&&(i["Issuer Unique ID"]=n.issuerUniqueID),n.subjectUniqueID&&(i["Subject Unique ID"]=n.subjectUniqueID),this.extensions.length){const o=new q("");for(const a of this.extensions){const c=a.toTextObject();o[c[q.NAME]]=c}i.Extensions=o}return t.Data=i,t.Signature=new q("",{Algorithm:Oe.serializeAlgorithm(e.signatureAlgorithm),"":e.signatureValue}),t}}nf.NAME="Certificate";var Tu;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Tu||(Tu={})),Bt.register(il,El),Bt.register(al,Nl),Bt.register(cl,Tl),Bt.register(ll,Bi),Bt.register(So,Vr),Bt.register(ul,jl),Bt.register(No,Pl),Bt.register(Ao,Rl),di.register(Bl,Ul),di.register(Fs,zs),ht.registerSingleton(gi,ef),ht.registerSingleton(gi,xt),xt.namedCurveSize.set("P-256",32),xt.namedCurveSize.set("K-256",32),xt.namedCurveSize.set("P-384",48),xt.namedCurveSize.set("P-521",66);export{Be as A,I as B,gt as C,On as D,bn as E,In as F,Tn as G,Ir as H,$t as I,En as J,Nn as K,ch as L,af as M,Se as N,me as O,Or as P,jn as R,Gt as S,kn as T,Er as U,Cn as V,nf as X,ff as a,wn as b,gf as c,ye as d,be as e,Ke as f,cf as g,Ts as h,U as i,Jt as j,mn as k,dh as l,Eh as m,pf as n,df as o,Ge as p,Ae as q,uf as r,yf as s,hf as t,lf as u,Zt as v,An as w,Sn as x,Bn as y,xn as z};
//# sourceMappingURL=x509.es-F5bVKoeY.chunk.mjs.map
