import{p as wh,e as bh,a8 as Sa,B as ka,g as ni}from"./logger-DTJ2mlZO.chunk.mjs";var Kn,Ba;function Ah(){if(Ba)return Kn;Ba=1;function r(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function t(i,s){for(var o="",c=0,l=-1,h=0,g,y=0;y<=i.length;++y){if(y<i.length)g=i.charCodeAt(y);else{if(g===47)break;g=47}if(g===47){if(!(l===y-1||h===1))if(l!==y-1&&h===2){if(o.length<2||c!==2||o.charCodeAt(o.length-1)!==46||o.charCodeAt(o.length-2)!==46){if(o.length>2){var T=o.lastIndexOf("/");if(T!==o.length-1){T===-1?(o="",c=0):(o=o.slice(0,T),c=o.length-1-o.lastIndexOf("/")),l=y,h=0;continue}}else if(o.length===2||o.length===1){o="",c=0,l=y,h=0;continue}}s&&(o.length>0?o+="/..":o="..",c=2)}else o.length>0?o+="/"+i.slice(l+1,y):o=i.slice(l+1,y),c=y-l-1;l=y,h=0}else g===46&&h!==-1?++h:h=-1}return o}function e(i,s){var o=s.dir||s.root,c=s.base||(s.name||"")+(s.ext||"");return o?o===s.root?o+c:o+i+c:c}var n={resolve:function(){for(var i="",s=!1,o,c=arguments.length-1;c>=-1&&!s;c--){var l;c>=0?l=arguments[c]:(o===void 0&&(o=wh.cwd()),l=o),r(l),l.length!==0&&(i=l+"/"+i,s=l.charCodeAt(0)===47)}return i=t(i,!s),s?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(r(i),i.length===0)return".";var s=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!s),i.length===0&&!s&&(i="."),i.length>0&&o&&(i+="/"),s?"/"+i:i},isAbsolute:function(i){return r(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,s=0;s<arguments.length;++s){var o=arguments[s];r(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":n.normalize(i)},relative:function(i,s){if(r(i),r(s),i===s||(i=n.resolve(i),s=n.resolve(s),i===s))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var c=i.length,l=c-o,h=1;h<s.length&&s.charCodeAt(h)===47;++h);for(var g=s.length,y=g-h,T=l<y?l:y,H=-1,P=0;P<=T;++P){if(P===T){if(y>T){if(s.charCodeAt(h+P)===47)return s.slice(h+P+1);if(P===0)return s.slice(h+P)}else l>T&&(i.charCodeAt(o+P)===47?H=P:P===0&&(H=0));break}var mt=i.charCodeAt(o+P),Yt=s.charCodeAt(h+P);if(mt!==Yt)break;mt===47&&(H=P)}var Tt="";for(P=o+H+1;P<=c;++P)(P===c||i.charCodeAt(P)===47)&&(Tt.length===0?Tt+="..":Tt+="/..");return Tt.length>0?Tt+s.slice(h+H):(h+=H,s.charCodeAt(h)===47&&++h,s.slice(h))},_makeLong:function(i){return i},dirname:function(i){if(r(i),i.length===0)return".";for(var s=i.charCodeAt(0),o=s===47,c=-1,l=!0,h=i.length-1;h>=1;--h)if(s=i.charCodeAt(h),s===47){if(!l){c=h;break}}else l=!1;return c===-1?o?"/":".":o&&c===1?"//":i.slice(0,c)},basename:function(i,s){if(s!==void 0&&typeof s!="string")throw new TypeError('"ext" argument must be a string');r(i);var o=0,c=-1,l=!0,h;if(s!==void 0&&s.length>0&&s.length<=i.length){if(s.length===i.length&&s===i)return"";var g=s.length-1,y=-1;for(h=i.length-1;h>=0;--h){var T=i.charCodeAt(h);if(T===47){if(!l){o=h+1;break}}else y===-1&&(l=!1,y=h+1),g>=0&&(T===s.charCodeAt(g)?--g===-1&&(c=h):(g=-1,c=y))}return o===c?c=y:c===-1&&(c=i.length),i.slice(o,c)}else{for(h=i.length-1;h>=0;--h)if(i.charCodeAt(h)===47){if(!l){o=h+1;break}}else c===-1&&(l=!1,c=h+1);return c===-1?"":i.slice(o,c)}},extname:function(i){r(i);for(var s=-1,o=0,c=-1,l=!0,h=0,g=i.length-1;g>=0;--g){var y=i.charCodeAt(g);if(y===47){if(!l){o=g+1;break}continue}c===-1&&(l=!1,c=g+1),y===46?s===-1?s=g:h!==1&&(h=1):s!==-1&&(h=-1)}return s===-1||c===-1||h===0||h===1&&s===c-1&&s===o+1?"":i.slice(s,c)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return e("/",i)},parse:function(i){r(i);var s={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return s;var o=i.charCodeAt(0),c=o===47,l;c?(s.root="/",l=1):l=0;for(var h=-1,g=0,y=-1,T=!0,H=i.length-1,P=0;H>=l;--H){if(o=i.charCodeAt(H),o===47){if(!T){g=H+1;break}continue}y===-1&&(T=!1,y=H+1),o===46?h===-1?h=H:P!==1&&(P=1):h!==-1&&(P=-1)}return h===-1||y===-1||P===0||P===1&&h===y-1&&h===g+1?y!==-1&&(g===0&&c?s.base=s.name=i.slice(1,y):s.base=s.name=i.slice(g,y)):(g===0&&c?(s.name=i.slice(1,h),s.base=i.slice(1,y)):(s.name=i.slice(g,h),s.base=i.slice(g,y)),s.ext=i.slice(h,y)),g>0?s.dir=i.slice(0,g-1):c&&(s.dir="/"),s},sep:"/",delimiter:":",win32:null,posix:null};return n.posix=n,Kn=n,Kn}var Sh=Ah();const bf=bh(Sh);var xa={},Ca;function kh(){if(Ca)return xa;Ca=1;var r;return function(t){(function(e){var n=typeof globalThis=="object"?globalThis:typeof Sa=="object"?Sa:typeof self=="object"?self:typeof this=="object"?this:l(),i=s(t);typeof n.Reflect<"u"&&(i=s(n.Reflect,i)),e(i,n),typeof n.Reflect>"u"&&(n.Reflect=t);function s(h,g){return function(y,T){Object.defineProperty(h,y,{configurable:!0,writable:!0,value:T}),g&&g(y,T)}}function o(){try{return Function("return this;")()}catch{}}function c(){try{return(0,eval)("(function() { return this; })()")}catch{}}function l(){return o()||c()}})(function(e,n){var i=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",o=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",c=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",l=typeof Object.create=="function",h={__proto__:[]}instanceof Array,g=!l&&!h,y={create:l?function(){return Wn(Object.create(null))}:h?function(){return Wn({__proto__:null})}:function(){return Wn({})},has:g?function(f,d){return i.call(f,d)}:function(f,d){return d in f},get:g?function(f,d){return i.call(f,d)?f[d]:void 0}:function(f,d){return f[d]}},T=Object.getPrototypeOf(Function),H=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:yh(),P=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:dh(),mt=typeof WeakMap=="function"?WeakMap:gh(),Yt=s?Symbol.for("@reflect-metadata:registry"):void 0,Tt=hh(),sa=ph(Tt);function ql(f,d,v,A){if(j(v)){if(!ya(f))throw new TypeError;if(!da(d))throw new TypeError;return ih(f,d)}else{if(!ya(f))throw new TypeError;if(!J(d))throw new TypeError;if(!J(A)&&!j(A)&&!Ce(A))throw new TypeError;return Ce(A)&&(A=void 0),v=jt(v),nh(f,d,v,A)}}e("decorate",ql);function Gl(f,d){function v(A,I){if(!J(A))throw new TypeError;if(!j(I)&&!uh(I))throw new TypeError;ua(f,d,A,I)}return v}e("metadata",Gl);function Jl(f,d,v,A){if(!J(v))throw new TypeError;return j(A)||(A=jt(A)),ua(f,d,v,A)}e("defineMetadata",Jl);function Yl(f,d,v){if(!J(d))throw new TypeError;return j(v)||(v=jt(v)),oa(f,d,v)}e("hasMetadata",Yl);function Zl(f,d,v){if(!J(d))throw new TypeError;return j(v)||(v=jt(v)),Mn(f,d,v)}e("hasOwnMetadata",Zl);function Xl(f,d,v){if(!J(d))throw new TypeError;return j(v)||(v=jt(v)),aa(f,d,v)}e("getMetadata",Xl);function Ql(f,d,v){if(!J(d))throw new TypeError;return j(v)||(v=jt(v)),ca(f,d,v)}e("getOwnMetadata",Ql);function th(f,d){if(!J(f))throw new TypeError;return j(d)||(d=jt(d)),la(f,d)}e("getMetadataKeys",th);function eh(f,d){if(!J(f))throw new TypeError;return j(d)||(d=jt(d)),ha(f,d)}e("getOwnMetadataKeys",eh);function rh(f,d,v){if(!J(d))throw new TypeError;if(j(v)||(v=jt(v)),!J(d))throw new TypeError;j(v)||(v=jt(v));var A=nr(d,v,!1);return j(A)?!1:A.OrdinaryDeleteMetadata(f,d,v)}e("deleteMetadata",rh);function ih(f,d){for(var v=f.length-1;v>=0;--v){var A=f[v],I=A(d);if(!j(I)&&!Ce(I)){if(!da(I))throw new TypeError;d=I}}return d}function nh(f,d,v,A){for(var I=f.length-1;I>=0;--I){var _=f[I],Y=_(d,v,A);if(!j(Y)&&!Ce(Y)){if(!J(Y))throw new TypeError;A=Y}}return A}function oa(f,d,v){var A=Mn(f,d,v);if(A)return!0;var I=Fn(d);return Ce(I)?!1:oa(f,I,v)}function Mn(f,d,v){var A=nr(d,v,!1);return j(A)?!1:fa(A.OrdinaryHasOwnMetadata(f,d,v))}function aa(f,d,v){var A=Mn(f,d,v);if(A)return ca(f,d,v);var I=Fn(d);if(!Ce(I))return aa(f,I,v)}function ca(f,d,v){var A=nr(d,v,!1);if(!j(A))return A.OrdinaryGetOwnMetadata(f,d,v)}function ua(f,d,v,A){var I=nr(v,A,!0);I.OrdinaryDefineOwnMetadata(f,d,v,A)}function la(f,d){var v=ha(f,d),A=Fn(f);if(A===null)return v;var I=la(A,d);if(I.length<=0)return v;if(v.length<=0)return I;for(var _=new P,Y=[],V=0,k=v;V<k.length;V++){var C=k[V],O=_.has(C);O||(_.add(C),Y.push(C))}for(var N=0,L=I;N<L.length;N++){var C=L[N],O=_.has(C);O||(_.add(C),Y.push(C))}return Y}function ha(f,d){var v=nr(f,d,!1);return v?v.OrdinaryOwnMetadataKeys(f,d):[]}function pa(f){if(f===null)return 1;switch(typeof f){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return f===null?1:6;default:return 6}}function j(f){return f===void 0}function Ce(f){return f===null}function sh(f){return typeof f=="symbol"}function J(f){return typeof f=="object"?f!==null:typeof f=="function"}function oh(f,d){switch(pa(f)){case 0:return f;case 1:return f;case 2:return f;case 3:return f;case 4:return f;case 5:return f}var v="string",A=ga(f,o);if(A!==void 0){var I=A.call(f,v);if(J(I))throw new TypeError;return I}return ah(f)}function ah(f,d){var v,A,I;{var _=f.toString;if(ii(_)){var A=_.call(f);if(!J(A))return A}var v=f.valueOf;if(ii(v)){var A=v.call(f);if(!J(A))return A}}throw new TypeError}function fa(f){return!!f}function ch(f){return""+f}function jt(f){var d=oh(f);return sh(d)?d:ch(d)}function ya(f){return Array.isArray?Array.isArray(f):f instanceof Object?f instanceof Array:Object.prototype.toString.call(f)==="[object Array]"}function ii(f){return typeof f=="function"}function da(f){return typeof f=="function"}function uh(f){switch(pa(f)){case 3:return!0;case 4:return!0;default:return!1}}function $n(f,d){return f===d||f!==f&&d!==d}function ga(f,d){var v=f[d];if(v!=null){if(!ii(v))throw new TypeError;return v}}function va(f){var d=ga(f,c);if(!ii(d))throw new TypeError;var v=d.call(f);if(!J(v))throw new TypeError;return v}function ma(f){return f.value}function wa(f){var d=f.next();return d.done?!1:d}function ba(f){var d=f.return;d&&d.call(f)}function Fn(f){var d=Object.getPrototypeOf(f);if(typeof f!="function"||f===T||d!==T)return d;var v=f.prototype,A=v&&Object.getPrototypeOf(v);if(A==null||A===Object.prototype)return d;var I=A.constructor;return typeof I!="function"||I===f?d:I}function lh(){var f;!j(Yt)&&typeof n.Reflect<"u"&&!(Yt in n.Reflect)&&typeof n.Reflect.defineMetadata=="function"&&(f=fh(n.Reflect));var d,v,A,I=new mt,_={registerProvider:Y,getProvider:k,setProvider:O};return _;function Y(N){if(!Object.isExtensible(_))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case f===N:break;case j(d):d=N;break;case d===N:break;case j(v):v=N;break;case v===N:break;default:A===void 0&&(A=new P),A.add(N);break}}function V(N,L){if(!j(d)){if(d.isProviderFor(N,L))return d;if(!j(v)){if(v.isProviderFor(N,L))return d;if(!j(A))for(var F=va(A);;){var q=wa(F);if(!q)return;var kt=ma(q);if(kt.isProviderFor(N,L))return ba(F),kt}}}if(!j(f)&&f.isProviderFor(N,L))return f}function k(N,L){var F=I.get(N),q;return j(F)||(q=F.get(L)),j(q)&&(q=V(N,L),j(q)||(j(F)&&(F=new H,I.set(N,F)),F.set(L,q))),q}function C(N){if(j(N))throw new TypeError;return d===N||v===N||!j(A)&&A.has(N)}function O(N,L,F){if(!C(F))throw new Error("Metadata provider not registered.");var q=k(N,L);if(q!==F){if(!j(q))return!1;var kt=I.get(N);j(kt)&&(kt=new H,I.set(N,kt)),kt.set(L,F)}return!0}}function hh(){var f;return!j(Yt)&&J(n.Reflect)&&Object.isExtensible(n.Reflect)&&(f=n.Reflect[Yt]),j(f)&&(f=lh()),!j(Yt)&&J(n.Reflect)&&Object.isExtensible(n.Reflect)&&Object.defineProperty(n.Reflect,Yt,{enumerable:!1,configurable:!1,writable:!1,value:f}),f}function ph(f){var d=new mt,v={isProviderFor:function(C,O){var N=d.get(C);return j(N)?!1:N.has(O)},OrdinaryDefineOwnMetadata:Y,OrdinaryHasOwnMetadata:I,OrdinaryGetOwnMetadata:_,OrdinaryOwnMetadataKeys:V,OrdinaryDeleteMetadata:k};return Tt.registerProvider(v),v;function A(C,O,N){var L=d.get(C),F=!1;if(j(L)){if(!N)return;L=new H,d.set(C,L),F=!0}var q=L.get(O);if(j(q)){if(!N)return;if(q=new H,L.set(O,q),!f.setProvider(C,O,v))throw L.delete(O),F&&d.delete(C),new Error("Wrong provider for target.")}return q}function I(C,O,N){var L=A(O,N,!1);return j(L)?!1:fa(L.has(C))}function _(C,O,N){var L=A(O,N,!1);if(!j(L))return L.get(C)}function Y(C,O,N,L){var F=A(N,L,!0);F.set(C,O)}function V(C,O){var N=[],L=A(C,O,!1);if(j(L))return N;for(var F=L.keys(),q=va(F),kt=0;;){var Aa=wa(q);if(!Aa)return N.length=kt,N;var vh=ma(Aa);try{N[kt]=vh}catch(mh){try{ba(q)}finally{throw mh}}kt++}}function k(C,O,N){var L=A(O,N,!1);if(j(L)||!L.delete(C))return!1;if(L.size===0){var F=d.get(O);j(F)||(F.delete(N),F.size===0&&d.delete(F))}return!0}}function fh(f){var d=f.defineMetadata,v=f.hasOwnMetadata,A=f.getOwnMetadata,I=f.getOwnMetadataKeys,_=f.deleteMetadata,Y=new mt,V={isProviderFor:function(k,C){var O=Y.get(k);return!j(O)&&O.has(C)?!0:I(k,C).length?(j(O)&&(O=new P,Y.set(k,O)),O.add(C),!0):!1},OrdinaryDefineOwnMetadata:d,OrdinaryHasOwnMetadata:v,OrdinaryGetOwnMetadata:A,OrdinaryOwnMetadataKeys:I,OrdinaryDeleteMetadata:_};return V}function nr(f,d,v){var A=Tt.getProvider(f,d);if(!j(A))return A;if(v){if(Tt.setProvider(f,d,sa))return sa;throw new Error("Illegal state.")}}function yh(){var f={},d=[],v=function(){function V(k,C,O){this._index=0,this._keys=k,this._values=C,this._selector=O}return V.prototype["@@iterator"]=function(){return this},V.prototype[c]=function(){return this},V.prototype.next=function(){var k=this._index;if(k>=0&&k<this._keys.length){var C=this._selector(this._keys[k],this._values[k]);return k+1>=this._keys.length?(this._index=-1,this._keys=d,this._values=d):this._index++,{value:C,done:!1}}return{value:void 0,done:!0}},V.prototype.throw=function(k){throw this._index>=0&&(this._index=-1,this._keys=d,this._values=d),k},V.prototype.return=function(k){return this._index>=0&&(this._index=-1,this._keys=d,this._values=d),{value:k,done:!0}},V}(),A=function(){function V(){this._keys=[],this._values=[],this._cacheKey=f,this._cacheIndex=-2}return Object.defineProperty(V.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),V.prototype.has=function(k){return this._find(k,!1)>=0},V.prototype.get=function(k){var C=this._find(k,!1);return C>=0?this._values[C]:void 0},V.prototype.set=function(k,C){var O=this._find(k,!0);return this._values[O]=C,this},V.prototype.delete=function(k){var C=this._find(k,!1);if(C>=0){for(var O=this._keys.length,N=C+1;N<O;N++)this._keys[N-1]=this._keys[N],this._values[N-1]=this._values[N];return this._keys.length--,this._values.length--,$n(k,this._cacheKey)&&(this._cacheKey=f,this._cacheIndex=-2),!0}return!1},V.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=f,this._cacheIndex=-2},V.prototype.keys=function(){return new v(this._keys,this._values,I)},V.prototype.values=function(){return new v(this._keys,this._values,_)},V.prototype.entries=function(){return new v(this._keys,this._values,Y)},V.prototype["@@iterator"]=function(){return this.entries()},V.prototype[c]=function(){return this.entries()},V.prototype._find=function(k,C){if(!$n(this._cacheKey,k)){this._cacheIndex=-1;for(var O=0;O<this._keys.length;O++)if($n(this._keys[O],k)){this._cacheIndex=O;break}}return this._cacheIndex<0&&C&&(this._cacheIndex=this._keys.length,this._keys.push(k),this._values.push(void 0)),this._cacheIndex},V}();return A;function I(V,k){return V}function _(V,k){return k}function Y(V,k){return[V,k]}}function dh(){var f=function(){function d(){this._map=new H}return Object.defineProperty(d.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),d.prototype.has=function(v){return this._map.has(v)},d.prototype.add=function(v){return this._map.set(v,v),this},d.prototype.delete=function(v){return this._map.delete(v)},d.prototype.clear=function(){this._map.clear()},d.prototype.keys=function(){return this._map.keys()},d.prototype.values=function(){return this._map.keys()},d.prototype.entries=function(){return this._map.entries()},d.prototype["@@iterator"]=function(){return this.keys()},d.prototype[c]=function(){return this.keys()},d}();return f}function gh(){var f=16,d=y.create(),v=A();return function(){function k(){this._key=A()}return k.prototype.has=function(C){var O=I(C,!1);return O!==void 0?y.has(O,this._key):!1},k.prototype.get=function(C){var O=I(C,!1);return O!==void 0?y.get(O,this._key):void 0},k.prototype.set=function(C,O){var N=I(C,!0);return N[this._key]=O,this},k.prototype.delete=function(C){var O=I(C,!1);return O!==void 0?delete O[this._key]:!1},k.prototype.clear=function(){this._key=A()},k}();function A(){var k;do k="@@WeakMap@@"+V();while(y.has(d,k));return d[k]=!0,k}function I(k,C){if(!i.call(k,v)){if(!C)return;Object.defineProperty(k,v,{value:y.create()})}return k[v]}function _(k,C){for(var O=0;O<C;++O)k[O]=Math.random()*255|0;return k}function Y(k){if(typeof Uint8Array=="function"){var C=new Uint8Array(k);return typeof crypto<"u"?crypto.getRandomValues(C):typeof msCrypto<"u"?msCrypto.getRandomValues(C):_(C,k),C}return _(new Array(k),k)}function V(){var k=Y(f);k[6]=k[6]&79|64,k[8]=k[8]&191|128;for(var C="",O=0;O<f;++O){var N=k[O];(O===4||O===6||O===8)&&(C+="-"),N<16&&(C+="0"),C+=N.toString(16).toLowerCase()}return C}}function Wn(f){return f.__=void 0,delete f.__,f}})}(r||(r={})),xa}kh();const Bh="[object ArrayBuffer]";class S{static isArrayBuffer(t){return Object.prototype.toString.call(t)===Bh}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e)return t;if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const n=S.toUint8Array(t),i=S.toUint8Array(e);if(n.length!==i.byteLength)return!1;for(let s=0;s<n.length;s++)if(n[s]!==i[s])return!1;return!0}static concat(...t){let e;Array.isArray(t[0])&&!(t[1]instanceof Function)||Array.isArray(t[0])&&t[1]instanceof Function?e=t[0]:t[t.length-1]instanceof Function?e=t.slice(0,t.length-1):e=t;let n=0;for(const o of e)n+=o.byteLength;const i=new Uint8Array(n);let s=0;for(const o of e){const c=this.toUint8Array(o);i.set(c,s),s+=c.length}return t[t.length-1]instanceof Function?this.toView(i,t[t.length-1]):i.buffer}}const zn="string",xh=/^[0-9a-f\s]+$/i,Ch=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,Oh=/^[a-zA-Z0-9-_]+$/;class Oa{static fromString(t){const e=unescape(encodeURIComponent(t)),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n.buffer}static toString(t){const e=S.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return decodeURIComponent(escape(n))}}class Ut{static toString(t,e=!1){const n=S.toArrayBuffer(t),i=new DataView(n);let s="";for(let o=0;o<n.byteLength;o+=2){const c=i.getUint16(o,e);s+=String.fromCharCode(c)}return s}static fromString(t,e=!1){const n=new ArrayBuffer(t.length*2),i=new DataView(n);for(let s=0;s<t.length;s++)i.setUint16(s*2,t.charCodeAt(s),e);return n}}class E{static isHex(t){return typeof t===zn&&xh.test(t)}static isBase64(t){return typeof t===zn&&Ch.test(t)}static isBase64Url(t){return typeof t===zn&&Oh.test(t)}static ToString(t,e="utf8"){const n=S.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return Ut.toString(n,!0);case"utf16":case"utf16be":return Ut.toString(n);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return Ut.fromString(t,!0);case"utf16":case"utf16be":return Ut.fromString(t);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToBase64(t){const e=S.toUint8Array(t);if(typeof btoa<"u"){const n=this.ToString(e,"binary");return btoa(n)}else return ka.from(e).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(e)):new Uint8Array(ka.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return Oa.fromString(t);case"utf16":case"utf16be":return Ut.fromString(t);case"utf16le":case"usc2":return Ut.fromString(t,!0);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return Oa.toString(t);case"utf16":case"utf16be":return Ut.toString(t);case"utf16le":case"usc2":return Ut.toString(t,!0);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromBinary(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n.buffer}static ToBinary(t){const e=S.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return n}static ToHex(t){const e=S.toUint8Array(t);let n="";const i=e.length;for(let s=0;s<i;s++){const o=e[s];o<16&&(n+="0"),n+=o.toString(16)}return n}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e=`0${e}`);const n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i=i+2){const s=e.slice(i,i+2);n[i/2]=parseInt(s,16)}return n.buffer}static ToUtf16String(t,e=!1){return Ut.toString(t,e)}static FromUtf16String(t,e=!1){return Ut.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let n=0;n<e;n++)t+="=";return t}static formatString(t){return t?.replace(/[\n\r\t ]/g,"")||""}}E.DEFAULT_UTF8_ENCODING="utf8";function Eh(...r){const t=r.map(i=>i.byteLength).reduce((i,s)=>i+s),e=new Uint8Array(t);let n=0;return r.map(i=>new Uint8Array(i)).forEach(i=>{for(const s of i)e[n++]=s}),e.buffer}function Fu(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}function Af(r,t,e){var n;return r instanceof Object&&(n=r[t])!==null&&n!==void 0?n:e}function Sf(r,t=0,e=r.byteLength-t,n=!1){let i="";for(const s of new Uint8Array(r,t,e)){const o=s.toString(16).toUpperCase();o.length===1&&(i+="0"),i+=o,n&&(i+=" ")}return i.trim()}function qe(r,t){let e=0;if(r.length===1)return r[0];for(let n=r.length-1;n>=0;n--)e+=r[r.length-1-n]*Math.pow(2,t*n);return e}function ve(r,t,e=-1){const n=e;let i=r,s=0,o=Math.pow(2,t);for(let c=1;c<8;c++){if(r<o){let l;if(n<0)l=new ArrayBuffer(c),s=c;else{if(n<c)return new ArrayBuffer(0);l=new ArrayBuffer(n),s=n}const h=new Uint8Array(l);for(let g=c-1;g>=0;g--){const y=Math.pow(2,g*t);h[s-g-1]=Math.floor(i/y),i-=h[s-g-1]*y}return l}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function kf(...r){let t=0,e=0;for(const s of r)t+=s.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const s of r)i.set(new Uint8Array(s),e),e+=s.byteLength;return n}function ws(...r){let t=0,e=0;for(const s of r)t+=s.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const s of r)i.set(s,e),e+=s.length;return i}function Wu(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const o=r[0]===255&&r[1]&128,c=r[0]===0&&(r[1]&128)===0;(o||c)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(t);for(let o=0;o<this.valueHex.byteLength;o++)e[o]=0;e[0]=r[0]&128;const n=qe(e,8),i=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(i);for(let o=0;o<this.valueHex.byteLength;o++)s[o]=r[o];return s[0]&=127,qe(s,8)-n}function Nh(r){const t=r<0?r*-1:r;let e=128;for(let n=1;n<8;n++){if(t<=e){if(r<0){const o=e-t,c=ve(o,8,n),l=new Uint8Array(c);return l[0]|=128,c}let i=ve(t,8,n),s=new Uint8Array(i);if(s[0]&128){const o=i.slice(0),c=new Uint8Array(o);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let l=0;l<o.byteLength;l++)s[l+1]=c[l];s[0]=0}return i}e*=Math.pow(2,8)}return new ArrayBuffer(0)}function Ih(r,t){if(r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}function yt(r,t){const e=r.toString(10);if(t<e.length)return"";const n=t-e.length,i=new Array(n);for(let s=0;s<n;s++)i[s]="0";return i.join("").concat(e)}const Ku="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",zu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function Bf(r,t=!1,e=!1,n=!1){let i=0,s=0,o=0,c="";const l=t?zu:Ku;if(n){let h=0;for(let g=0;g<r.length;g++)if(r.charCodeAt(g)!==0){h=g;break}r=r.slice(h)}for(;i<r.length;){const h=r.charCodeAt(i++);i>=r.length&&(s=1);const g=r.charCodeAt(i++);i>=r.length&&(o=1);const y=r.charCodeAt(i++),T=h>>2,H=(h&3)<<4|g>>4;let P=(g&15)<<2|y>>6,mt=y&63;s===1?P=mt=64:o===1&&(mt=64),e?P===64?c+=`${l.charAt(T)}${l.charAt(H)}`:mt===64?c+=`${l.charAt(T)}${l.charAt(H)}${l.charAt(P)}`:c+=`${l.charAt(T)}${l.charAt(H)}${l.charAt(P)}${l.charAt(mt)}`:c+=`${l.charAt(T)}${l.charAt(H)}${l.charAt(P)}${l.charAt(mt)}`}return c}function xf(r,t=!1,e=!1){const n=t?zu:Ku;function i(l){for(let h=0;h<64;h++)if(n.charAt(h)===l)return h;return 64}function s(l){return l===64?0:l}let o=0,c="";for(;o<r.length;){const l=i(r.charAt(o++)),h=o>=r.length?0:i(r.charAt(o++)),g=o>=r.length?0:i(r.charAt(o++)),y=o>=r.length?0:i(r.charAt(o++)),T=s(l)<<2|s(h)>>4,H=(s(h)&15)<<4|s(g)>>2,P=(s(g)&3)<<6|s(y);c+=String.fromCharCode(T),g!==64&&(c+=String.fromCharCode(H)),y!==64&&(c+=String.fromCharCode(P))}if(e){const l=c.length;let h=-1;for(let g=l-1;g>=0;g--)if(c.charCodeAt(g)!==0){h=g;break}h!==-1?c=c.slice(0,h+1):c=""}return c}function Cf(r){let t="";const e=new Uint8Array(r);for(const n of e)t+=String.fromCharCode(n);return t}function Of(r){const t=r.length,e=new ArrayBuffer(t),n=new Uint8Array(e);for(let i=0;i<t;i++)n[i]=r.charCodeAt(i);return e}const Th=Math.log(2);function Ef(r){const t=Math.log(r)/Th,e=Math.floor(t),n=Math.round(t);return e===n?e:n}function Nf(r,t){for(const e of t)delete r[e]}function ji(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function _o(r){let t=0,e=0;for(let i=0;i<r.length;i++){const s=r[i];t+=s.byteLength}const n=new Uint8Array(t);for(let i=0;i<r.length;i++){const s=r[i];n.set(new Uint8Array(s),e),e+=s.byteLength}return n.buffer}function Gt(r,t,e,n){return t instanceof Uint8Array?t.byteLength?e<0?(r.error="Wrong parameter: inputOffset less than zero",!1):n<0?(r.error="Wrong parameter: inputLength less than zero",!1):t.byteLength-e-n<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class jn{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return _o(this.items)}}const sr=[new Uint8Array([1])],Ea="0123456789",_n="name",Na="valueHexView",jh="isHexOnly",Uh="idBlock",Ph="tagClass",Rh="tagNumber",Vh="isConstructed",Lh="fromBER",Hh="toBER",Dh="local",lt="",It=new ArrayBuffer(0),Un=new Uint8Array(0),Kr="EndOfContent",_u="OCTET STRING",qu="BIT STRING";function Dt(r){var t;return t=class extends r{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var n;super(...e);const i=e[0]||{};this.isHexOnly=(n=i.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=i.valueHex?S.toUint8Array(i.valueHex):Un}fromBER(e,n,i){const s=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!Gt(this,s,n,i))return-1;const o=n+i;return this.valueHexView=s.subarray(n,o),this.valueHexView.length?(this.blockLength=i,o):(this.warnings.push("Zero buffer length"),n)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",It)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:E.ToHex(this.valueHexView)}}},t.NAME="hexBlock",t}class xe{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}constructor({blockLength:t=0,error:e=lt,warnings:n=[],valueBeforeDecode:i=Un}={}){this.blockLength=t,this.error=e,this.warnings=n,this.valueBeforeDecodeView=S.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:E.ToHex(this.valueBeforeDecodeView)}}}xe.NAME="baseBlock";class at extends xe{fromBER(t,e,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}at.NAME="valueBlock";class Gu extends Dt(xe){constructor({idBlock:t={}}={}){var e,n,i,s;super(),t?(this.isHexOnly=(e=t.isHexOnly)!==null&&e!==void 0?e:!1,this.valueHexView=t.valueHex?S.toUint8Array(t.valueHex):Un,this.tagClass=(n=t.tagClass)!==null&&n!==void 0?n:-1,this.tagNumber=(i=t.tagNumber)!==null&&i!==void 0?i:-1,this.isConstructed=(s=t.isConstructed)!==null&&s!==void 0?s:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",It}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const i=new Uint8Array(1);if(!t){let s=this.tagNumber;s&=31,e|=s,i[0]=e}return i.buffer}if(!this.isHexOnly){const i=ve(this.tagNumber,7),s=new Uint8Array(i),o=i.byteLength,c=new Uint8Array(o+1);if(c[0]=e|31,!t){for(let l=0;l<o-1;l++)c[l+1]=s[l]|128;c[o]=s[o-1]}return c.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=e|31,!t){const i=this.valueHexView;for(let s=0;s<i.length-1;s++)n[s+1]=i[s]|128;n[this.valueHexView.byteLength]=i[i.length-1]}return n.buffer}fromBER(t,e,n){const i=S.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const s=i.subarray(e,e+n);if(s.length===0)return this.error="Zero buffer length",-1;switch(s[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(s[0]&32)===32,this.isHexOnly=!1;const o=s[0]&31;if(o!==31)this.tagNumber=o,this.blockLength=1;else{let c=1,l=this.valueHexView=new Uint8Array(255),h=255;for(;s[c]&128;){if(l[c-1]=s[c]&127,c++,c>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(c===h){h+=255;const y=new Uint8Array(h);for(let T=0;T<l.length;T++)y[T]=l[T];l=this.valueHexView=new Uint8Array(h)}}this.blockLength=c+1,l[c-1]=s[c]&127;const g=new Uint8Array(c);for(let y=0;y<c;y++)g[y]=l[y];l=this.valueHexView=new Uint8Array(c),l.set(g),this.blockLength<=9?this.tagNumber=qe(l,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Gu.NAME="identificationBlock";class Ju extends xe{constructor({lenBlock:t={}}={}){var e,n,i;super(),this.isIndefiniteForm=(e=t.isIndefiniteForm)!==null&&e!==void 0?e:!1,this.longFormUsed=(n=t.longFormUsed)!==null&&n!==void 0?n:!1,this.length=(i=t.length)!==null&&i!==void 0?i:0}fromBER(t,e,n){const i=S.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const s=i.subarray(e,e+n);if(s.length===0)return this.error="Zero buffer length",-1;if(s[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=s[0]===128,this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(s[0]&128),this.longFormUsed===!1)return this.length=s[0],this.blockLength=1,e+this.blockLength;const o=s[0]&127;if(o>8)return this.error="Too big integer",-1;if(o+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const c=e+1,l=i.subarray(c,c+o);return l[o-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=qe(l,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,e+this.blockLength}toBER(t=!1){let e,n;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=128),e;if(this.longFormUsed){const i=ve(this.length,8);if(i.byteLength>127)return this.error="Too big length",It;if(e=new ArrayBuffer(i.byteLength+1),t)return e;const s=new Uint8Array(i);n=new Uint8Array(e),n[0]=i.byteLength|128;for(let o=0;o<i.byteLength;o++)n[o+1]=s[o];return e}return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=this.length),e}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Ju.NAME="lengthBlock";const x={};class et extends xe{constructor({name:t=lt,optional:e=!1,primitiveSchema:n,...i}={},s){super(i),this.name=t,this.optional=e,n&&(this.primitiveSchema=n),this.idBlock=new Gu(i),this.lenBlock=new Ju(i),this.valueBlock=s?new s(i):new at(i)}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}toBER(t,e){const n=e||new jn;e||Yu(this);const i=this.idBlock.toBER(t);if(n.write(i),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,n),n.write(new ArrayBuffer(2));else{const s=this.valueBlock.toBER(t);this.lenBlock.length=s.byteLength;const o=this.lenBlock.toBER(t);n.write(o),n.write(s)}return e?It:n.final()}toJSON(){const t={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return t==="ascii"?this.onAsciiEncoding():E.ToHex(this.toBER())}onAsciiEncoding(){const t=this.constructor.NAME,e=E.ToHex(this.valueBlock.valueBeforeDecodeView);return`${t} : ${e}`}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;const e=this.toBER(),n=t.toBER();return Ih(e,n)}}et.NAME="BaseBlock";function Yu(r){var t;if(r instanceof x.Constructed)for(const e of r.valueBlock.value)Yu(e)&&(r.lenBlock.isIndefiniteForm=!0);return!!(!((t=r.lenBlock)===null||t===void 0)&&t.isIndefiniteForm)}class qo extends et{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor({value:t=lt,...e}={},n){super(e,n),t&&this.fromString(t)}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}qo.NAME="BaseStringBlock";class Zu extends Dt(at){constructor({isHexOnly:t=!0,...e}={}){super(e),this.isHexOnly=t}}Zu.NAME="PrimitiveValueBlock";var Ia;class zr extends et{constructor(t={}){super(t,Zu),this.idBlock.isConstructed=!1}}Ia=zr,x.Primitive=Ia,zr.NAME="PRIMITIVE";function Mh(r,t){if(r instanceof t)return r;const e=new t;return e.idBlock=r.idBlock,e.lenBlock=r.lenBlock,e.warnings=r.warnings,e.valueBeforeDecodeView=r.valueBeforeDecodeView,e}function er(r,t=0,e=r.length){const n=t;let i=new et({},at);const s=new xe;if(!Gt(s,r,t,e))return i.error=s.error,{offset:-1,result:i};if(!r.subarray(t,t+e).length)return i.error="Zero buffer length",{offset:-1,result:i};let o=i.idBlock.fromBER(r,t,e);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),o===-1)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=o,e-=i.idBlock.blockLength,o=i.lenBlock.fromBER(r,t,e),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),o===-1)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=o,e-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let c=et;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&i.idBlock.isHexOnly===!1)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=x.EndOfContent;break;case 1:c=x.Boolean;break;case 2:c=x.Integer;break;case 3:c=x.BitString;break;case 4:c=x.OctetString;break;case 5:c=x.Null;break;case 6:c=x.ObjectIdentifier;break;case 10:c=x.Enumerated;break;case 12:c=x.Utf8String;break;case 13:c=x.RelativeObjectIdentifier;break;case 14:c=x.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=x.Sequence;break;case 17:c=x.Set;break;case 18:c=x.NumericString;break;case 19:c=x.PrintableString;break;case 20:c=x.TeletexString;break;case 21:c=x.VideotexString;break;case 22:c=x.IA5String;break;case 23:c=x.UTCTime;break;case 24:c=x.GeneralizedTime;break;case 25:c=x.GraphicString;break;case 26:c=x.VisibleString;break;case 27:c=x.GeneralString;break;case 28:c=x.UniversalString;break;case 29:c=x.CharacterString;break;case 30:c=x.BmpString;break;case 31:c=x.DATE;break;case 32:c=x.TimeOfDay;break;case 33:c=x.DateTime;break;case 34:c=x.Duration;break;default:{const l=i.idBlock.isConstructed?new x.Constructed:new x.Primitive;l.idBlock=i.idBlock,l.lenBlock=i.lenBlock,l.warnings=i.warnings,i=l}}break;case 2:case 3:case 4:default:c=i.idBlock.isConstructed?x.Constructed:x.Primitive}return i=Mh(i,c),o=i.fromBER(r,t,i.lenBlock.isIndefiniteForm?e:i.lenBlock.length),i.valueBeforeDecodeView=r.subarray(n,n+i.blockLength),{offset:o,result:i}}function Fe(r){if(!r.byteLength){const t=new et({},at);return t.error="Input buffer has zero length",{offset:-1,result:t}}return er(S.toUint8Array(r).slice(),0,r.byteLength)}function $h(r,t){return r?1:t}class re extends at{constructor({value:t=[],isIndefiniteForm:e=!1,...n}={}){super(n),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,n){const i=S.toUint8Array(t);if(!Gt(this,i,e,n))return-1;if(this.valueBeforeDecodeView=i.subarray(e,e+n),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),e;let s=e;for(;$h(this.isIndefiniteForm,n)>0;){const o=er(i,s,n);if(o.offset===-1)return this.error=o.result.error,this.warnings.concat(o.result.warnings),-1;if(s=o.offset,this.blockLength+=o.result.blockLength,n-=o.result.blockLength,this.value.push(o.result),this.isIndefiniteForm&&o.result.constructor.NAME===Kr)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Kr?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(t,e){const n=e||new jn;for(let i=0;i<this.value.length;i++)this.value[i].toBER(t,n);return e?It:n.final()}toJSON(){const t={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const e of this.value)t.value.push(e.toJSON());return t}}re.NAME="ConstructedValueBlock";var Ta;class ot extends et{constructor(t={}){super(t,re),this.idBlock.isConstructed=!0}fromBER(t,e,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const t=[];for(const n of this.valueBlock.value)t.push(n.toString("ascii").split(`
`).map(i=>`  ${i}`).join(`
`));const e=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return t.length?`${e} :
${t.join(`
`)}`:`${e} :`}}Ta=ot,x.Constructed=Ta,ot.NAME="CONSTRUCTED";class Xu extends at{fromBER(t,e,n){return e}toBER(t){return It}}Xu.override="EndOfContentValueBlock";var ja;class bs extends et{constructor(t={}){super(t,Xu),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}ja=bs,x.EndOfContent=ja,bs.NAME=Kr;var Ua;class me extends et{constructor(t={}){super(t,at),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,e+n>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+n}toBER(t,e){const n=new ArrayBuffer(2);if(!t){const i=new Uint8Array(n);i[0]=5,i[1]=0}return e&&e.write(n),n}onAsciiEncoding(){return`${this.constructor.NAME}`}}Ua=me,x.Null=Ua,me.NAME="NULL";class Qu extends Dt(at){get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}constructor({value:t,...e}={}){super(e),e.valueHex?this.valueHexView=S.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}fromBER(t,e,n){const i=S.toUint8Array(t);return Gt(this,i,e,n)?(this.valueHexView=i.subarray(e,e+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Wu.call(this),this.blockLength=n,e+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Qu.NAME="BooleanValueBlock";var Pa;class Ui extends et{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor(t={}){super(t,Qu),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Pa=Ui,x.Boolean=Pa,Ui.NAME="BOOLEAN";class tl extends Dt(re){constructor({isConstructed:t=!1,...e}={}){super(e),this.isConstructed=t}fromBER(t,e,n){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,i=re.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(let s=0;s<this.value.length;s++){const o=this.value[s].constructor.NAME;if(o===Kr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==_u)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(t,e,n),this.blockLength=n;return i}toBER(t,e){return this.isConstructed?re.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}tl.NAME="OctetStringValueBlock";var As;let ye=class extends et{constructor({idBlock:r={},lenBlock:t={},...e}={}){var n,i;(n=e.isConstructed)!==null&&n!==void 0||(e.isConstructed=!!(!((i=e.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:e.isConstructed,...r},lenBlock:{...t,isIndefiniteForm:!!e.isIndefiniteForm},...e},tl),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,t,e){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,e===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(t,t+e);try{if(n.byteLength){const i=er(n,0,n.byteLength);i.offset!==-1&&i.offset===e&&(this.valueBlock.value=[i.result])}}catch{}}return super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ot.prototype.onAsciiEncoding.call(this);const r=this.constructor.NAME,t=E.ToHex(this.valueBlock.valueHexView);return`${r} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const t of this.valueBlock.value)t instanceof As&&r.push(t.valueBlock.valueHexView);return S.concat(r)}};As=ye,x.OctetString=As,ye.NAME=_u;class el extends Dt(re){constructor({unusedBits:t=0,isConstructed:e=!1,...n}={}){super(n),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,n){if(!n)return e;let i=-1;if(this.isConstructed){if(i=re.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(const c of this.value){const l=c.constructor.NAME;if(l===Kr){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==qu)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const h=c.valueBlock;if(this.unusedBits>0&&h.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=h.unusedBits}return i}const s=S.toUint8Array(t);if(!Gt(this,s,e,n))return-1;const o=s.subarray(e,e+n);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const c=o.subarray(1);try{if(c.byteLength){const l=er(c,0,c.byteLength);l.offset!==-1&&l.offset===n-1&&(this.value=[l.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,e+n}toBER(t,e){if(this.isConstructed)return re.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return It;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}el.NAME="BitStringValueBlock";var Ra;let de=class extends et{constructor({idBlock:r={},lenBlock:t={},...e}={}){var n,i;(n=e.isConstructed)!==null&&n!==void 0||(e.isConstructed=!!(!((i=e.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:e.isConstructed,...r},lenBlock:{...t,isIndefiniteForm:!!e.isIndefiniteForm},...e},el),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,t,e){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ot.prototype.onAsciiEncoding.call(this);{const r=[],t=this.valueBlock.valueHexView;for(const s of t)r.push(s.toString(2).padStart(8,"0"));const e=r.join(""),n=this.constructor.NAME,i=e.substring(0,e.length-this.valueBlock.unusedBits);return`${n} : ${i}`}}};Ra=de,x.BitString=Ra,de.NAME=qu;var Va;function Fh(r,t){const e=new Uint8Array([0]),n=new Uint8Array(r),i=new Uint8Array(t);let s=n.slice(0);const o=s.length-1,c=i.slice(0),l=c.length-1;let h=0;const g=l<o?o:l;let y=0;for(let T=g;T>=0;T--,y++){switch(!0){case y<c.length:h=s[o-y]+c[l-y]+e[0];break;default:h=s[o-y]+e[0]}switch(e[0]=h/10,!0){case y>=s.length:s=ws(new Uint8Array([h%10]),s);break;default:s[o-y]=h%10}}return e[0]>0&&(s=ws(e,s)),s}function La(r){if(r>=sr.length)for(let t=sr.length;t<=r;t++){const e=new Uint8Array([0]);let n=sr[t-1].slice(0);for(let i=n.length-1;i>=0;i--){const s=new Uint8Array([(n[i]<<1)+e[0]]);e[0]=s[0]/10,n[i]=s[0]%10}e[0]>0&&(n=ws(e,n)),sr.push(n)}return sr[r]}function Wh(r,t){let e=0;const n=new Uint8Array(r),i=new Uint8Array(t),s=n.slice(0),o=s.length-1,c=i.slice(0),l=c.length-1;let h,g=0;for(let y=l;y>=0;y--,g++)switch(h=s[o-g]-c[l-g]-e,!0){case h<0:e=1,s[o-g]=h+10;break;default:e=0,s[o-g]=h}if(e>0)for(let y=o-l+1;y>=0;y--,g++)if(h=s[o-g]-e,h<0)e=1,s[o-g]=h+10;else{e=0,s[o-g]=h;break}return s.slice()}class Ss extends Dt(at){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Wu.call(this)))}constructor({value:t,...e}={}){super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),t!==void 0&&(this.valueDec=t)}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(Nh(t))}get valueDec(){return this._valueDec}fromDER(t,e,n,i=0){const s=this.fromBER(t,e,n);if(s===-1)return s;const o=this.valueHexView;return o[0]===0&&(o[1]&128)!==0?this.valueHexView=o.subarray(1):i!==0&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),s}toDER(t=!1){const e=this.valueHexView;switch(!0){case(e[0]&128)!==0:{const n=new Uint8Array(this.valueHexView.length+1);n[0]=0,n.set(e,1),this.valueHexView=n}break;case(e[0]===0&&(e[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(t)}fromBER(t,e,n){const i=super.fromBER(t,e,n);return i===-1||this.setValueHex(),i}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const t=this.valueHexView.length*8-1;let e=new Uint8Array(this.valueHexView.length*8/3),n=0,i;const s=this.valueHexView;let o="",c=!1;for(let l=s.byteLength-1;l>=0;l--){i=s[l];for(let h=0;h<8;h++){if((i&1)===1)switch(n){case t:e=Wh(La(n),e),o="-";break;default:e=Fh(e,La(n))}n++,i>>=1}}for(let l=0;l<e.length;l++)e[l]&&(c=!0),c&&(o+=Ea.charAt(e[l]));return c===!1&&(o+=Ea.charAt(0)),o}}Va=Ss,Ss.NAME="IntegerValueBlock",Object.defineProperty(Va.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var Pr;class Ge extends et{constructor(t={}){super(t,Ss),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return ji(),BigInt(this.valueBlock.toString())}static fromBigInt(t){ji();const e=BigInt(t),n=new jn,i=e.toString(16).replace(/^-/,""),s=new Uint8Array(E.FromHex(i));if(e<0){const o=new Uint8Array(s.length+(s[0]&128?1:0));o[0]|=128;const c=BigInt(`0x${E.ToHex(o)}`)+e,l=S.toUint8Array(E.FromHex(c.toString(16)));l[0]|=128,n.write(l)}else s[0]&128&&n.write(new Uint8Array([0])),n.write(s);return new Pr({valueHex:n.final()})}convertToDER(){const t=new Pr({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new Pr({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Pr=Ge,x.Integer=Pr,Ge.NAME="INTEGER";var Ha;class Pi extends Ge{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Ha=Pi,x.Enumerated=Ha,Pi.NAME="ENUMERATED";class ks extends Dt(at){constructor({valueDec:t=-1,isFirstSid:e=!1,...n}={}){super(n),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,n){if(!n)return e;const i=S.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const s=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=s[c]&127,this.blockLength++,(s[c]&128)!==0);c++);const o=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)o[c]=this.valueHexView[c];return this.valueHexView=o,(s[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=qe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){ji();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const n=new Uint8Array(e.length/7);for(let i=0;i<n.length;i++)n[i]=parseInt(e.slice(i*7,i*7+7),2)+(i+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,s=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)s[o]=i[o]|128;return s[this.blockLength-1]=i[this.blockLength-1],s.buffer}const e=ve(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",It;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),s=e.byteLength-1;for(let o=0;o<s;o++)n[o]=i[o]|128;n[s]=i[s]}return n}toString(){let t="";if(this.isHexOnly)t=E.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}ks.NAME="sidBlock";class rl extends at{constructor({value:t=lt,...e}={}){super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const s=new ks;if(i=s.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=s.error,i;this.value.length===0&&(s.isFirstSid=!0),this.blockLength+=s.blockLength,n-=s.blockLength,this.value.push(s)}return i}toBER(t){const e=[];for(let n=0;n<this.value.length;n++){const i=this.value[n].toBER(t);if(i.byteLength===0)return this.error=this.value[n].error,It;e.push(i)}return _o(e)}fromString(t){this.value=[];let e=0,n=0,i="",s=!1;do if(n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1,s){const o=this.value[0];let c=0;switch(o.valueDec){case 0:break;case 1:c=40;break;case 2:c=80;break;default:this.value=[];return}const l=parseInt(i,10);if(isNaN(l))return;o.valueDec=l+c,s=!1}else{const o=new ks;if(i>Number.MAX_SAFE_INTEGER){ji();const c=BigInt(i);o.valueBigInt=c}else if(o.valueDec=parseInt(i,10),isNaN(o.valueDec))return;this.value.length||(o.isFirstSid=!0,s=!0),this.value.push(o)}while(n!==-1)}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t=`${t}.`),e?(i=`{${i}}`,this.value[n].isFirstSid?t=`2.{${i} - 80}`:t+=i):t+=i}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}rl.NAME="ObjectIdentifierValueBlock";var Da;class Ri extends et{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,rl),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Da=Ri,x.ObjectIdentifier=Da,Ri.NAME="OBJECT IDENTIFIER";class Bs extends Dt(xe){constructor({valueDec:t=0,...e}={}){super(e),this.valueDec=t}fromBER(t,e,n){if(n===0)return e;const i=S.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const s=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=s[c]&127,this.blockLength++,(s[c]&128)!==0);c++);const o=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)o[c]=this.valueHexView[c];return this.valueHexView=o,(s[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=qe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,s=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)s[o]=i[o]|128;return s[this.blockLength-1]=i[this.blockLength-1],s.buffer}const e=ve(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",It;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),s=e.byteLength-1;for(let o=0;o<s;o++)n[o]=i[o]|128;n[s]=i[s]}return n.buffer}toString(){let t="";return this.isHexOnly?t=E.ToHex(this.valueHexView):t=this.valueDec.toString(),t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Bs.NAME="relativeSidBlock";class il extends at{constructor({value:t=lt,...e}={}){super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const s=new Bs;if(i=s.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=s.error,i;this.blockLength+=s.blockLength,n-=s.blockLength,this.value.push(s)}return i}toBER(t,e){const n=[];for(let i=0;i<this.value.length;i++){const s=this.value[i].toBER(t);if(s.byteLength===0)return this.error=this.value[i].error,It;n.push(s)}return _o(n)}fromString(t){this.value=[];let e=0,n=0,i="";do{n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1;const s=new Bs;if(s.valueDec=parseInt(i,10),isNaN(s.valueDec))return!0;this.value.push(s)}while(n!==-1);return!0}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t=`${t}.`),e&&(i=`{${i}}`),t+=i}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}il.NAME="RelativeObjectIdentifierValueBlock";var Ma;class xs extends et{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,il),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Ma=xs,x.RelativeObjectIdentifier=Ma,xs.NAME="RelativeObjectIdentifier";var $a;class Et extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}$a=Et,x.Sequence=$a,Et.NAME="SEQUENCE";var Fa;let Vt=class extends ot{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};Fa=Vt,x.Set=Fa,Vt.NAME="SET";class nl extends Dt(at){constructor({...t}={}){super(t),this.isHexOnly=!0,this.value=lt}toJSON(){return{...super.toJSON(),value:this.value}}}nl.NAME="StringValueBlock";class sl extends nl{}sl.NAME="SimpleStringValueBlock";class gt extends qo{constructor({...t}={}){super(t,sl)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,S.toUint8Array(t))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);this.valueBlock.value=t}}gt.NAME="SIMPLE STRING";class ol extends gt{fromBuffer(t){this.valueBlock.valueHexView=S.toUint8Array(t);try{this.valueBlock.value=E.ToUtf8String(t)}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`),this.valueBlock.value=E.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(E.FromUtf8String(t)),this.valueBlock.value=t}}ol.NAME="Utf8StringValueBlock";var Wa;class Kt extends ol{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Wa=Kt,x.Utf8String=Wa,Kt.NAME="UTF8String";class al extends gt{fromBuffer(t){this.valueBlock.value=E.ToUtf16String(t),this.valueBlock.valueHexView=S.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(E.FromUtf16String(t))}}al.NAME="BmpStringValueBlock";var Ka;class Vi extends al{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Ka=Vi,x.BmpString=Ka,Vi.NAME="BMPString";class cl extends gt{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),n=new Uint8Array(e);for(let i=0;i<n.length;i+=4)n[i]=n[i+3],n[i+1]=n[i+2],n[i+2]=0,n[i+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e*4);for(let i=0;i<e;i++){const s=ve(t.charCodeAt(i),8),o=new Uint8Array(s);if(o.length>4)continue;const c=4-o.length;for(let l=o.length-1;l>=0;l--)n[i*4+l+c]=o[l]}this.valueBlock.value=t}}cl.NAME="UniversalStringValueBlock";var za;class Li extends cl{constructor({...t}={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}za=Li,x.UniversalString=za,Li.NAME="UniversalString";var _a;class Hi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}_a=Hi,x.NumericString=_a,Hi.NAME="NumericString";var qa;class Di extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}qa=Di,x.PrintableString=qa,Di.NAME="PrintableString";var Ga;class Mi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Ga=Mi,x.TeletexString=Ga,Mi.NAME="TeletexString";var Ja;class $i extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Ja=$i,x.VideotexString=Ja,$i.NAME="VideotexString";var Ya;class Fi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Ya=Fi,x.IA5String=Ya,Fi.NAME="IA5String";var Za;class Wi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Za=Wi,x.GraphicString=Za,Wi.NAME="GraphicString";var Xa;class _r extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Xa=_r,x.VisibleString=Xa,_r.NAME="VisibleString";var Qa;class Ki extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Qa=Ki,x.GeneralString=Qa,Ki.NAME="GeneralString";var tc;class zi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}tc=zi,x.CharacterString=tc,zi.NAME="CharacterString";var ec;class qr extends _r{constructor({value:t,valueDate:e,...n}={}){if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let i=0;i<t.length;i++)this.valueBlock.valueHexView[i]=t.charCodeAt(i)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,S.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(t);if(e===null){this.error="Wrong input string for conversion";return}const n=parseInt(e[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(t="iso"){if(t==="iso"){const e=new Array(7);return e[0]=yt(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=yt(this.month,2),e[2]=yt(this.day,2),e[3]=yt(this.hour,2),e[4]=yt(this.minute,2),e[5]=yt(this.second,2),e[6]="Z",e.join("")}return super.toString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}ec=qr,x.UTCTime=ec,qr.NAME="UTCTime";var rc;class _i extends qr{constructor(t={}){var e;super(t),(e=this.millisecond)!==null&&e!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){const t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(t)}fromString(t){let e=!1,n="",i="",s=0,o,c=0,l=0;if(t[t.length-1]==="Z")n=t.substring(0,t.length-1),e=!0;else{const y=new Number(t[t.length-1]);if(isNaN(y.valueOf()))throw new Error("Wrong input string for conversion");n=t}if(e){if(n.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(n.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let y=1,T=n.indexOf("+"),H="";if(T===-1&&(T=n.indexOf("-"),y=-1),T!==-1){if(H=n.substring(T+1),n=n.substring(0,T),H.length!==2&&H.length!==4)throw new Error("Wrong input string for conversion");let P=parseInt(H.substring(0,2),10);if(isNaN(P.valueOf()))throw new Error("Wrong input string for conversion");if(c=y*P,H.length===4){if(P=parseInt(H.substring(2,4),10),isNaN(P.valueOf()))throw new Error("Wrong input string for conversion");l=y*P}}}let h=n.indexOf(".");if(h===-1&&(h=n.indexOf(",")),h!==-1){const y=new Number(`0${n.substring(h)}`);if(isNaN(y.valueOf()))throw new Error("Wrong input string for conversion");s=y.valueOf(),i=n.substring(0,h)}else i=n;switch(!0){case i.length===8:if(o=/(\d{4})(\d{2})(\d{2})/ig,h!==-1)throw new Error("Wrong input string for conversion");break;case i.length===10:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,h!==-1){let y=60*s;this.minute=Math.floor(y),y=60*(y-this.minute),this.second=Math.floor(y),y=1e3*(y-this.second),this.millisecond=Math.floor(y)}break;case i.length===12:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,h!==-1){let y=60*s;this.second=Math.floor(y),y=1e3*(y-this.second),this.millisecond=Math.floor(y)}break;case i.length===14:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,h!==-1){const y=1e3*s;this.millisecond=Math.floor(y)}break;default:throw new Error("Wrong input string for conversion")}const g=o.exec(i);if(g===null)throw new Error("Wrong input string for conversion");for(let y=1;y<g.length;y++)switch(y){case 1:this.year=parseInt(g[y],10);break;case 2:this.month=parseInt(g[y],10);break;case 3:this.day=parseInt(g[y],10);break;case 4:this.hour=parseInt(g[y],10)+c;break;case 5:this.minute=parseInt(g[y],10)+l;break;case 6:this.second=parseInt(g[y],10);break;default:throw new Error("Wrong input string for conversion")}if(e===!1){const y=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=y.getUTCFullYear(),this.month=y.getUTCMonth(),this.day=y.getUTCDay(),this.hour=y.getUTCHours(),this.minute=y.getUTCMinutes(),this.second=y.getUTCSeconds(),this.millisecond=y.getUTCMilliseconds()}}toString(t="iso"){if(t==="iso"){const e=[];return e.push(yt(this.year,4)),e.push(yt(this.month,2)),e.push(yt(this.day,2)),e.push(yt(this.hour,2)),e.push(yt(this.minute,2)),e.push(yt(this.second,2)),this.millisecond!==0&&(e.push("."),e.push(yt(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(t)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}rc=_i,x.GeneralizedTime=rc,_i.NAME="GeneralizedTime";var ic;class Cs extends Kt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}ic=Cs,x.DATE=ic,Cs.NAME="DATE";var nc;class Os extends Kt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}nc=Os,x.TimeOfDay=nc,Os.NAME="TimeOfDay";var sc;class Es extends Kt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}sc=Es,x.DateTime=sc,Es.NAME="DateTime";var oc;class Ns extends Kt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}oc=Ns,x.Duration=oc,Ns.NAME="Duration";var ac;class Is extends Kt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}ac=Is,x.TIME=ac,Is.NAME="TIME";class we{constructor({name:t=lt,optional:e=!1}={}){this.name=t,this.optional=e}}class Go extends we{constructor({value:t=[],...e}={}){super(e),this.value=t}}class qi extends we{constructor({value:t=new we,local:e=!1,...n}={}){super(n),this.value=t,this.local=e}}class Kh{get data(){return this.dataView.slice().buffer}set data(t){this.dataView=S.toUint8Array(t)}constructor({data:t=Un}={}){this.dataView=S.toUint8Array(t)}fromBER(t,e,n){const i=e+n;return this.dataView=S.toUint8Array(t).subarray(e,i),i}toBER(t){return this.dataView.slice().buffer}}function Qt(r,t,e){if(e instanceof Go){for(const i of e.value)if(Qt(r,t,i).verified)return{verified:!0,result:r};{const i={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(_n)&&(i.name=e.name),i}}if(e instanceof we)return e.hasOwnProperty(_n)&&(r[e.name]=t),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Uh in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Lh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Hh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=e.idBlock.toBER(!1);if(n.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(e.idBlock.fromBER(n,0,n.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(e.idBlock.hasOwnProperty(Ph)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(Rh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(Vh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:r};if(!(jh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:r};if(e.idBlock.isHexOnly){if(!(Na in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=e.idBlock.valueHexView,s=t.idBlock.valueHexView;if(i.length!==s.length)return{verified:!1,result:r};for(let o=0;o<i.length;o++)if(i[o]!==s[1])return{verified:!1,result:r}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&(r[e.name]=t)),e instanceof x.Constructed){let i=0,s={verified:!1,result:{error:"Unknown error"}},o=e.valueBlock.value.length;if(o>0&&e.valueBlock.value[0]instanceof qi&&(o=t.valueBlock.value.length),o===0)return{verified:!0,result:r};if(t.valueBlock.value.length===0&&e.valueBlock.value.length!==0){let c=!0;for(let l=0;l<e.valueBlock.value.length;l++)c=c&&(e.valueBlock.value[l].optional||!1);return c?{verified:!0,result:r}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&delete r[e.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let c=0;c<o;c++)if(c-i>=t.valueBlock.value.length){if(e.valueBlock.value[c].optional===!1){const l={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&(delete r[e.name],l.name=e.name)),l}}else if(e.valueBlock.value[0]instanceof qi){if(s=Qt(r,t.valueBlock.value[c],e.valueBlock.value[0].value),s.verified===!1)if(e.valueBlock.value[0].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&delete r[e.name]),s;if(_n in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let l={};Dh in e.valueBlock.value[0]&&e.valueBlock.value[0].local?l=t:l=r,typeof l[e.valueBlock.value[0].name]>"u"&&(l[e.valueBlock.value[0].name]=[]),l[e.valueBlock.value[0].name].push(t.valueBlock.value[c])}}else if(s=Qt(r,t.valueBlock.value[c-i],e.valueBlock.value[c]),s.verified===!1)if(e.valueBlock.value[c].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&delete r[e.name]),s;if(s.verified===!1){const c={verified:!1,result:r};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&(delete r[e.name],c.name=e.name)),c}return{verified:!0,result:r}}if(e.primitiveSchema&&Na in t.valueBlock){const i=er(t.valueBlock.valueHexView);if(i.offset===-1){const s={verified:!1,result:i.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,lt),e.name&&(delete r[e.name],s.name=e.name)),s}return Qt(r,i.result,e.primitiveSchema)}return{verified:!0,result:r}}function zh(r,t){if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const e=er(S.toUint8Array(r));return e.offset===-1?{verified:!1,result:e.result}:Qt(e.result,e.result,t)}const ul=Object.freeze(Object.defineProperty({__proto__:null,Any:we,BaseBlock:et,BaseStringBlock:qo,BitString:de,BmpString:Vi,Boolean:Ui,CharacterString:zi,Choice:Go,Constructed:ot,DATE:Cs,DateTime:Es,Duration:Ns,EndOfContent:bs,Enumerated:Pi,GeneralString:Ki,GeneralizedTime:_i,GraphicString:Wi,HexBlock:Dt,IA5String:Fi,Integer:Ge,Null:me,NumericString:Hi,ObjectIdentifier:Ri,OctetString:ye,Primitive:zr,PrintableString:Di,RawData:Kh,RelativeObjectIdentifier:xs,Repeated:qi,Sequence:Et,Set:Vt,TIME:Is,TeletexString:Mi,TimeOfDay:Os,UTCTime:qr,UniversalString:Li,Utf8String:Kt,ValueBlock:at,VideotexString:$i,ViewWriter:jn,VisibleString:_r,compareSchema:Qt,fromBER:Fe,verifySchema:zh},Symbol.toStringTag,{value:"Module"}));var m;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(m||(m={}));var p;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(p||(p={}));class Pn{constructor(t,e=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),t)if(typeof t=="number")this.fromNumber(t);else if(S.isBufferSource(t))this.unusedBits=e,this.value=S.toArrayBuffer(t);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(t){if(!(t instanceof de))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=t.valueBlock.unusedBits,this.value=t.valueBlock.valueHex,this}toASN(){return new de({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new de({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const n of e)t+=n.toString(2).padStart(8,"0");return t=t.split("").reverse().join(""),this.unusedBits&&(t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(t,2)}fromNumber(t){let e=t.toString(2);const n=e.length+7>>3;this.unusedBits=(n<<3)-e.length;const i=new Uint8Array(n);e=e.padStart(n<<3,"0").split("").reverse().join("");let s=0;for(;s<n;)i[s]=parseInt(e.slice(s<<3,(s<<3)+8),2),s++;this.value=i.buffer}}class D{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(t){typeof t=="number"?this.buffer=new ArrayBuffer(t):S.isBufferSource(t)?this.buffer=S.toArrayBuffer(t):Array.isArray(t)?this.buffer=new Uint8Array(t):this.buffer=new ArrayBuffer(0)}fromASN(t){if(!(t instanceof ye))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=t.valueBlock.valueHex,this}toASN(){return new ye({valueHex:this.buffer})}toSchema(t){return new ye({name:t})}}const _h={fromASN:r=>r instanceof me?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new me;const t=Fe(r);if(t.result.error)throw new Error(t.result.error);return t.result}},qh={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new Ge({value:+r})},Gh={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new Pi({value:r})},W={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Ge({valueHex:r})},Jh={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new de({valueHex:r})},Yh={fromASN:r=>r.valueBlock.toString(),toASN:r=>new Ri({value:r})},Zh={fromASN:r=>r.valueBlock.value,toASN:r=>new Ui({value:r})},Gi={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new ye({valueHex:r})},Xh={fromASN:r=>new D(r.getValue()),toASN:r=>r.toASN()};function St(r){return{fromASN:t=>t.valueBlock.value,toASN:t=>new r({value:t})}}const ll=St(Kt),Qh=St(Vi),tp=St(Li),ep=St(Hi),rp=St(Di),ip=St(Mi),np=St($i),sp=St(Fi),op=St(Wi),ap=St(_r),cp=St(Ki),up=St(zi),lp={fromASN:r=>r.toDate(),toASN:r=>new qr({valueDate:r})},hp={fromASN:r=>r.toDate(),toASN:r=>new _i({valueDate:r})},pp={fromASN:()=>null,toASN:()=>new me};function Rr(r){switch(r){case p.Any:return _h;case p.BitString:return Jh;case p.BmpString:return Qh;case p.Boolean:return Zh;case p.CharacterString:return up;case p.Enumerated:return Gh;case p.GeneralString:return cp;case p.GeneralizedTime:return hp;case p.GraphicString:return op;case p.IA5String:return sp;case p.Integer:return qh;case p.Null:return pp;case p.NumericString:return ep;case p.ObjectIdentifier:return Yh;case p.OctetString:return Gi;case p.PrintableString:return rp;case p.TeletexString:return ip;case p.UTCTime:return lp;case p.UniversalString:return tp;case p.Utf8String:return ll;case p.VideotexString:return np;case p.VisibleString:return ap;default:return null}}function Wt(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:Wt(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function hl(r){var t;if(r){const e=Object.getPrototypeOf(r);return((t=e?.prototype)===null||t===void 0?void 0:t.constructor)===Array?!0:hl(e)}return!1}function fp(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}class yp{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,e=!1){const n=this.items.get(t);if(!n)throw new Error(`Cannot get schema for '${t.prototype.constructor.name}' target`);if(e&&!n.schema)throw new Error(`Schema '${t.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return n}cache(t){const e=this.get(t);e.schema||(e.schema=this.create(t,!0))}createDefault(t){const e={type:m.Sequence,items:{}},n=this.findParentSchema(t);return n&&(Object.assign(e,n),e.items=Object.assign({},e.items,n.items)),e}create(t,e){const n=this.items.get(t)||this.createDefault(t),i=[];for(const s in n.items){const o=n.items[s],c=e?s:"";let l;if(typeof o.type=="number"){const g=p[o.type],y=ul[g];if(!y)throw new Error(`Cannot get ASN1 class by name '${g}'`);l=new y({name:c})}else Wt(o.type)?l=new o.type().toSchema(c):o.optional?this.get(o.type).type===m.Choice?l=new we({name:c}):(l=this.create(o.type,!1),l.name=c):l=new we({name:c});const h=!!o.optional||o.defaultValue!==void 0;if(o.repeated){l.name="";const g=o.repeated==="set"?Vt:Et;l=new g({name:"",value:[new qi({name:c,value:l})]})}if(o.context!==null&&o.context!==void 0)if(o.implicit)if(typeof o.type=="number"||Wt(o.type)){const g=o.repeated?ot:zr;i.push(new g({name:c,optional:h,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);const g=!!o.repeated;let y=g?l:this.get(o.type,!0).schema;y="valueBlock"in y?y.valueBlock.value:y.value,i.push(new ot({name:g?"":c,optional:h,idBlock:{tagClass:3,tagNumber:o.context},value:y}))}else i.push(new ot({optional:h,idBlock:{tagClass:3,tagNumber:o.context},value:[l]}));else l.optional=h,i.push(l)}switch(n.type){case m.Sequence:return new Et({value:i,name:""});case m.Set:return new Vt({value:i,name:""});case m.Choice:return new Go({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(t,e){return this.items.set(t,e),this}findParentSchema(t){const e=Object.getPrototypeOf(t);return e?this.items.get(e)||this.findParentSchema(e):null}}const X=new yp,w=r=>t=>{let e;X.has(t)?e=X.get(t):(e=X.createDefault(t),X.set(t,e)),Object.assign(e,r)},u=r=>(t,e)=>{let n;X.has(t.constructor)?n=X.get(t.constructor):(n=X.createDefault(t.constructor),X.set(t.constructor,n));const i=Object.assign({},r);if(typeof i.type=="number"&&!i.converter){const s=Rr(r.type);if(!s)throw new Error(`Cannot get default converter for property '${e}' of ${t.constructor.name}`);i.converter=s}i.raw=r.raw,n.items[e]=i};class or extends Error{constructor(){super(...arguments),this.schemas=[]}}class dp{static parse(t,e){const n=Fe(t);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,e)}static fromASN(t,e){try{if(Wt(e))return new e().fromASN(t);const n=X.get(e);X.cache(e);let i=n.schema;const s=this.handleChoiceTypes(t,n,e,i);if(s?.result)return s.result;s?.targetSchema&&(i=s.targetSchema);const o=this.handleSequenceTypes(t,n,e,i),c=new e;return hl(e)?this.handleArrayTypes(t,n,e):(this.processSchemaItems(n,o,c),c)}catch(n){throw n instanceof or&&n.schemas.push(e.name),n}}static handleChoiceTypes(t,e,n,i){if(t.constructor===ot&&e.type===m.Choice&&t.idBlock.tagClass===3)for(const s in e.items){const o=e.items[s];if(o.context===t.idBlock.tagNumber&&o.implicit&&typeof o.type=="function"&&X.has(o.type)){const c=X.get(o.type);if(c&&c.type===m.Sequence){const l=new Et;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in l.valueBlock){l.valueBlock.value=t.valueBlock.value;const h=this.fromASN(l,o.type),g=new n;return g[s]=h,{result:g}}}}}else if(t.constructor===ot&&e.type!==m.Choice){const s=new ot({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:e.schema.valueBlock.value});for(const o in e.items)delete t[o];return{targetSchema:s}}return null}static handleSequenceTypes(t,e,n,i){if(e.type===m.Sequence){const s=Qt({},t,i);if(!s.verified)throw new or(`Data does not match to ${n.name} ASN1 schema.${s.result.error?` ${s.result.error}`:""}`);return s}else{const s=Qt({},t,i);if(!s.verified)throw new or(`Data does not match to ${n.name} ASN1 schema.${s.result.error?` ${s.result.error}`:""}`);return s}}static processRepeatedField(t,e,n){let i=t.slice(e);if(i.length===1&&i[0].constructor.name==="Sequence"){const s=i[0];s.valueBlock&&s.valueBlock.value&&Array.isArray(s.valueBlock.value)&&(i=s.valueBlock.value)}if(typeof n.type=="number"){const s=Rr(n.type);if(!s)throw new Error(`No converter for ASN.1 type ${n.type}`);return i.filter(o=>o&&o.valueBlock).map(o=>{try{return s.fromASN(o)}catch{return}}).filter(o=>o!==void 0)}else return i.filter(s=>s&&s.valueBlock).map(s=>{try{return this.fromASN(s,n.type)}catch{return}}).filter(s=>s!==void 0)}static processPrimitiveField(t,e){const n=Rr(e.type);if(!n)throw new Error(`No converter for ASN.1 type ${e.type}`);return n.fromASN(t)}static isOptionalChoiceField(t){return t.optional&&typeof t.type=="function"&&X.has(t.type)&&X.get(t.type).type===m.Choice}static processOptionalChoiceField(t,e){try{return{processed:!0,value:this.fromASN(t,e.type)}}catch(n){if(n instanceof or&&/Wrong values for Choice type/.test(n.message))return{processed:!1};throw n}}static handleArrayTypes(t,e,n){if(!("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const i=e.itemType;if(typeof i=="number"){const s=Rr(i);if(!s)throw new Error(`Cannot get default converter for array item of ${n.name} ASN1 schema`);return n.from(t.valueBlock.value,o=>s.fromASN(o))}else return n.from(t.valueBlock.value,s=>this.fromASN(s,i))}static processSchemaItems(t,e,n){for(const i in t.items){const s=e.result[i];if(!s)continue;const o=t.items[i],c=o.type;let l;typeof c=="number"||Wt(c)?l=this.processPrimitiveSchemaItem(s,o,c):l=this.processComplexSchemaItem(s,o,c),l&&typeof l=="object"&&"value"in l&&"raw"in l?(n[i]=l.value,n[`${i}Raw`]=l.raw):n[i]=l}}static processPrimitiveSchemaItem(t,e,n){var i;const s=(i=e.converter)!==null&&i!==void 0?i:Wt(n)?new n:null;if(!s)throw new Error("Converter is empty");return e.repeated?this.processRepeatedPrimitiveItem(t,e,s):this.processSinglePrimitiveItem(t,e,n,s)}static processRepeatedPrimitiveItem(t,e,n){if(e.implicit){const i=e.repeated==="sequence"?Et:Vt,s=new i;s.valueBlock=t.valueBlock;const o=Fe(s.toBER(!1));if(o.offset===-1)throw new Error(`Cannot parse the child item. ${o.result.error}`);if(!("value"in o.result.valueBlock&&Array.isArray(o.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const c=o.result.valueBlock.value;return Array.from(c,l=>n.fromASN(l))}else return Array.from(t,i=>n.fromASN(i))}static processSinglePrimitiveItem(t,e,n,i){let s=t;if(e.implicit){let o;if(Wt(n))o=new n().toSchema("");else{const c=p[n],l=ul[c];if(!l)throw new Error(`Cannot get '${c}' class from asn1js module`);o=new l}o.valueBlock=s.valueBlock,s=Fe(o.toBER(!1)).result}return i.fromASN(s)}static processComplexSchemaItem(t,e,n){if(e.repeated){if(!Array.isArray(t))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(t,i=>this.fromASN(i,n))}else{const i=this.handleImplicitTagging(t,e,n);if(this.isOptionalChoiceField(e))try{return this.fromASN(i,n)}catch(s){if(s instanceof or&&/Wrong values for Choice type/.test(s.message))return;throw s}else{const s=this.fromASN(i,n);return e.raw?{value:s,raw:t.valueBeforeDecodeView}:s}}}static handleImplicitTagging(t,e,n){if(e.implicit&&typeof e.context=="number"){const i=X.get(n);if(i.type===m.Sequence){const s=new Et;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in s.valueBlock)return s.valueBlock.value=t.valueBlock.value,s}else if(i.type===m.Set){const s=new Vt;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in s.valueBlock)return s.valueBlock.value=t.valueBlock.value,s}}return t}}class Jo{static serialize(t){return t instanceof et?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){if(t&&typeof t=="object"&&Wt(t))return t.toASN();if(!(t&&typeof t=="object"))throw new TypeError("Parameter 1 should be type of Object.");const e=t.constructor,n=X.get(e);X.cache(e);let i=[];if(n.itemType){if(!Array.isArray(t))throw new TypeError("Parameter 1 should be type of Array.");if(typeof n.itemType=="number"){const o=Rr(n.itemType);if(!o)throw new Error(`Cannot get default converter for array item of ${e.name} ASN1 schema`);i=t.map(c=>o.toASN(c))}else i=t.map(o=>this.toAsnItem({type:n.itemType},"[]",e,o))}else for(const o in n.items){const c=n.items[o],l=t[o];if(l===void 0||c.defaultValue===l||typeof c.defaultValue=="object"&&typeof l=="object"&&fp(this.serialize(c.defaultValue),this.serialize(l)))continue;const h=Jo.toAsnItem(c,o,e,l);if(typeof c.context=="number")if(c.implicit)if(!c.repeated&&(typeof c.type=="number"||Wt(c.type))){const g={};g.valueHex=h instanceof me?h.valueBeforeDecodeView:h.valueBlock.toBER(),i.push(new zr({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},...g}))}else i.push(new ot({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:h.valueBlock.value}));else i.push(new ot({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:[h]}));else c.repeated?i=i.concat(h):i.push(h)}let s;switch(n.type){case m.Sequence:s=new Et({value:i});break;case m.Set:s=new Vt({value:i});break;case m.Choice:if(!i[0])throw new Error(`Schema '${e.name}' has wrong data. Choice cannot be empty.`);s=i[0];break}return s}static toAsnItem(t,e,n,i){let s;if(typeof t.type=="number"){const o=t.converter;if(!o)throw new Error(`Property '${e}' doesn't have converter for type ${p[t.type]} in schema '${n.name}'`);if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const c=Array.from(i,h=>o.toASN(h)),l=t.repeated==="sequence"?Et:Vt;s=new l({value:c})}else s=o.toASN(i)}else if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const o=Array.from(i,l=>this.toASN(l)),c=t.repeated==="sequence"?Et:Vt;s=new c({value:o})}else s=this.toASN(i);return s}}class $ extends Array{constructor(t=[]){if(typeof t=="number")super(t);else{super();for(const e of t)this.push(e)}}}class b{static serialize(t){return Jo.serialize(t)}static parse(t,e){return dp.parse(t,e)}static toString(t){const e=S.isBufferSource(t)?S.toArrayBuffer(t):b.serialize(t),n=Fe(e);if(n.offset===-1)throw new Error(`Cannot decode ASN.1 data. ${n.result.error}`);return n.result.toString()}}function a(r,t,e,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,t,e,n);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(s=(i<3?o(s):i>3?o(t,e,s):o(t,e))||s);return i>3&&s&&Object.defineProperty(t,e,s),s}function R(r,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!n:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(r):n?n.value:t.get(r)}function K(r,t,e,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,e):i?i.value=e:t.set(r,e),e}class cc{static isIPv4(t){return/^(\d{1,3}\.){3}\d{1,3}$/.test(t)}static parseIPv4(t){const e=t.split(".");if(e.length!==4)throw new Error("Invalid IPv4 address");return e.map(n=>{const i=parseInt(n,10);if(isNaN(i)||i<0||i>255)throw new Error("Invalid IPv4 address part");return i})}static parseIPv6(t){const e=this.expandIPv6(t).split(":");if(e.length!==8)throw new Error("Invalid IPv6 address");return e.reduce((n,i)=>{const s=parseInt(i,16);if(isNaN(s)||s<0||s>65535)throw new Error("Invalid IPv6 address part");return n.push(s>>8&255),n.push(s&255),n},[])}static expandIPv6(t){if(!t.includes("::"))return t;const e=t.split("::");if(e.length>2)throw new Error("Invalid IPv6 address");const n=e[0]?e[0].split(":"):[],i=e[1]?e[1].split(":"):[],s=8-(n.length+i.length);if(s<0)throw new Error("Invalid IPv6 address");return[...n,...Array(s).fill("0"),...i].join(":")}static formatIPv6(t){const e=[];for(let n=0;n<16;n+=2)e.push((t[n]<<8|t[n+1]).toString(16));return this.compressIPv6(e.join(":"))}static compressIPv6(t){const e=t.split(":");let n=-1,i=0,s=-1,o=0;for(let c=0;c<e.length;c++)e[c]==="0"?(s===-1&&(s=c),o++):(o>i&&(n=s,i=o),s=-1,o=0);if(o>i&&(n=s,i=o),i>1){const c=e.slice(0,n).join(":"),l=e.slice(n+i).join(":");return`${c}::${l}`}return t}static parseCIDR(t){const[e,n]=t.split("/"),i=parseInt(n,10);if(this.isIPv4(e)){if(i<0||i>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(e),i]}else{if(i<0||i>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(e),i]}}static decodeIP(t){if(t.length===64&&parseInt(t,16)===0)return"::/0";if(t.length!==16)return t;const e=parseInt(t.slice(8),16).toString(2).split("").reduce((i,s)=>i+ +s,0);let n=t.slice(0,8).replace(/(.{2})/g,i=>`${parseInt(i,16)}.`);return n=n.slice(0,-1),`${n}/${e}`}static toString(t){const e=new Uint8Array(t);if(e.length===4)return Array.from(e).join(".");if(e.length===16)return this.formatIPv6(e);if(e.length===8||e.length===32){const n=e.length/2,i=e.slice(0,n),s=e.slice(n);if(e.every(c=>c===0))return e.length===8?"0.0.0.0/0":"::/0";const o=s.reduce((c,l)=>c+(l.toString(2).match(/1/g)||[]).length,0);return e.length===8?`${Array.from(i).join(".")}/${o}`:`${this.formatIPv6(i)}/${o}`}return this.decodeIP(E.ToHex(t))}static fromString(t){if(t.includes("/")){const[n,i]=this.parseCIDR(t),s=new Uint8Array(n.length);let o=i;for(let l=0;l<s.length;l++)o>=8?(s[l]=255,o-=8):o>0&&(s[l]=255<<8-o,o=0);const c=new Uint8Array(n.length*2);return c.set(n,0),c.set(s,n.length),c.buffer}const e=this.isIPv4(t)?this.parseIPv4(t):this.parseIPv6(t);return new Uint8Array(e).buffer}}var Ts,js,Us;let Q=class{constructor(r={}){Object.assign(this,r)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};a([u({type:p.TeletexString})],Q.prototype,"teletexString",void 0),a([u({type:p.PrintableString})],Q.prototype,"printableString",void 0),a([u({type:p.UniversalString})],Q.prototype,"universalString",void 0),a([u({type:p.Utf8String})],Q.prototype,"utf8String",void 0),a([u({type:p.BmpString})],Q.prototype,"bmpString",void 0),Q=a([w({type:m.Choice})],Q);let Ve=class extends Q{constructor(r={}){super(r),Object.assign(this,r)}toString(){return this.ia5String||(this.anyValue?E.ToHex(this.anyValue):super.toString())}};a([u({type:p.IA5String})],Ve.prototype,"ia5String",void 0),a([u({type:p.Any})],Ve.prototype,"anyValue",void 0),Ve=a([w({type:m.Choice})],Ve);class Ji{constructor(t={}){this.type="",this.value=new Ve,Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Ji.prototype,"type",void 0),a([u({type:Ve})],Ji.prototype,"value",void 0);let Je=Ts=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ts.prototype)}};Je=Ts=a([w({type:m.Set,itemType:Ji})],Je);let Ps=js=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,js.prototype)}};Ps=js=a([w({type:m.Sequence,itemType:Je})],Ps);let G=Us=class extends Ps{constructor(r){super(r),Object.setPrototypeOf(this,Us.prototype)}};G=Us=a([w({type:m.Sequence})],G);const gp={fromASN:r=>cc.toString(Gi.fromASN(r)),toASN:r=>Gi.toASN(cc.fromString(r))};class Gr{constructor(t={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Gr.prototype,"typeId",void 0),a([u({type:p.Any,context:0})],Gr.prototype,"value",void 0);class Rs{constructor(t={}){this.partyName=new Q,Object.assign(this,t)}}a([u({type:Q,optional:!0,context:0,implicit:!0})],Rs.prototype,"nameAssigner",void 0),a([u({type:Q,context:1,implicit:!0})],Rs.prototype,"partyName",void 0);let U=class{constructor(r={}){Object.assign(this,r)}};a([u({type:Gr,context:0,implicit:!0})],U.prototype,"otherName",void 0),a([u({type:p.IA5String,context:1,implicit:!0})],U.prototype,"rfc822Name",void 0),a([u({type:p.IA5String,context:2,implicit:!0})],U.prototype,"dNSName",void 0),a([u({type:p.Any,context:3,implicit:!0})],U.prototype,"x400Address",void 0),a([u({type:G,context:4,implicit:!1})],U.prototype,"directoryName",void 0),a([u({type:Rs,context:5})],U.prototype,"ediPartyName",void 0),a([u({type:p.IA5String,context:6,implicit:!0})],U.prototype,"uniformResourceIdentifier",void 0),a([u({type:p.OctetString,context:7,implicit:!0,converter:gp})],U.prototype,"iPAddress",void 0),a([u({type:p.ObjectIdentifier,context:8,implicit:!0})],U.prototype,"registeredID",void 0),U=a([w({type:m.Choice})],U);const Yo="1.3.6.1.5.5.7",vp=`${Yo}.1`,rr=`${Yo}.3`,Rn=`${Yo}.48`,uc=`${Rn}.1`,lc=`${Rn}.2`,hc=`${Rn}.3`,pc=`${Rn}.5`,Jt="2.5.29";var Vs;const Ls=`${vp}.1`;class Jr{constructor(t={}){this.accessMethod="",this.accessLocation=new U,Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Jr.prototype,"accessMethod",void 0),a([u({type:U})],Jr.prototype,"accessLocation",void 0);let Le=Vs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Vs.prototype)}};Le=Vs=a([w({type:m.Sequence,itemType:Jr})],Le);const Hs=`${Jt}.35`;class Zo extends D{}class le{constructor(t={}){t&&Object.assign(this,t)}}a([u({type:Zo,context:0,optional:!0,implicit:!0})],le.prototype,"keyIdentifier",void 0),a([u({type:U,context:1,optional:!0,implicit:!0,repeated:"sequence"})],le.prototype,"authorityCertIssuer",void 0),a([u({type:p.Integer,context:2,optional:!0,implicit:!0,converter:W})],le.prototype,"authorityCertSerialNumber",void 0);const pl=`${Jt}.19`;class Yi{constructor(t={}){this.cA=!1,Object.assign(this,t)}}a([u({type:p.Boolean,defaultValue:!1})],Yi.prototype,"cA",void 0),a([u({type:p.Integer,optional:!0})],Yi.prototype,"pathLenConstraint",void 0);var Ds;let st=Ds=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ds.prototype)}};st=Ds=a([w({type:m.Sequence,itemType:U})],st);var Ms;let fc=Ms=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Ms.prototype)}};fc=Ms=a([w({type:m.Sequence})],fc);var $s;const fl=`${Jt}.32`;let Ft=class{constructor(r={}){Object.assign(this,r)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};a([u({type:p.IA5String})],Ft.prototype,"ia5String",void 0),a([u({type:p.VisibleString})],Ft.prototype,"visibleString",void 0),a([u({type:p.BmpString})],Ft.prototype,"bmpString",void 0),a([u({type:p.Utf8String})],Ft.prototype,"utf8String",void 0),Ft=a([w({type:m.Choice})],Ft);class Fs{constructor(t={}){this.organization=new Ft,this.noticeNumbers=[],Object.assign(this,t)}}a([u({type:Ft})],Fs.prototype,"organization",void 0),a([u({type:p.Integer,repeated:"sequence"})],Fs.prototype,"noticeNumbers",void 0);class Ws{constructor(t={}){Object.assign(this,t)}}a([u({type:Fs,optional:!0})],Ws.prototype,"noticeRef",void 0),a([u({type:Ft,optional:!0})],Ws.prototype,"explicitText",void 0);let si=class{constructor(r={}){Object.assign(this,r)}};a([u({type:p.IA5String})],si.prototype,"cPSuri",void 0),a([u({type:Ws})],si.prototype,"userNotice",void 0),si=a([w({type:m.Choice})],si);class Ks{constructor(t={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Ks.prototype,"policyQualifierId",void 0),a([u({type:p.Any})],Ks.prototype,"qualifier",void 0);class Zi{constructor(t={}){this.policyIdentifier="",Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Zi.prototype,"policyIdentifier",void 0),a([u({type:Ks,repeated:"sequence",optional:!0})],Zi.prototype,"policyQualifiers",void 0);let Xi=$s=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,$s.prototype)}};Xi=$s=a([w({type:m.Sequence,itemType:Zi})],Xi);let yi=class{constructor(r=0){this.value=r}};a([u({type:p.Integer})],yi.prototype,"value",void 0),yi=a([w({type:m.Choice})],yi);let yc=class extends yi{};yc=a([w({type:m.Choice})],yc);var zs;const _s=`${Jt}.31`;var Bt;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(Bt||(Bt={}));class yl extends Pn{toJSON(){const t=[],e=this.toNumber();return e&Bt.aACompromise&&t.push("aACompromise"),e&Bt.affiliationChanged&&t.push("affiliationChanged"),e&Bt.cACompromise&&t.push("cACompromise"),e&Bt.certificateHold&&t.push("certificateHold"),e&Bt.cessationOfOperation&&t.push("cessationOfOperation"),e&Bt.keyCompromise&&t.push("keyCompromise"),e&Bt.privilegeWithdrawn&&t.push("privilegeWithdrawn"),e&Bt.superseded&&t.push("superseded"),e&Bt.unused&&t.push("unused"),t}toString(){return`[${this.toJSON().join(", ")}]`}}let he=class{constructor(r={}){Object.assign(this,r)}};a([u({type:U,context:0,repeated:"sequence",implicit:!0})],he.prototype,"fullName",void 0),a([u({type:Je,context:1,implicit:!0})],he.prototype,"nameRelativeToCRLIssuer",void 0),he=a([w({type:m.Choice})],he);class We{constructor(t={}){Object.assign(this,t)}}a([u({type:he,context:0,optional:!0})],We.prototype,"distributionPoint",void 0),a([u({type:yl,context:1,optional:!0,implicit:!0})],We.prototype,"reasons",void 0),a([u({type:U,context:2,optional:!0,repeated:"sequence",implicit:!0})],We.prototype,"cRLIssuer",void 0);let Ke=zs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,zs.prototype)}};Ke=zs=a([w({type:m.Sequence,itemType:We})],Ke);var qs;let dc=qs=class extends Ke{constructor(r){super(r),Object.setPrototypeOf(this,qs.prototype)}};dc=qs=a([w({type:m.Sequence,itemType:We})],dc);class it{constructor(t={}){this.onlyContainsUserCerts=it.ONLY,this.onlyContainsCACerts=it.ONLY,this.indirectCRL=it.ONLY,this.onlyContainsAttributeCerts=it.ONLY,Object.assign(this,t)}}it.ONLY=!1,a([u({type:he,context:0,optional:!0})],it.prototype,"distributionPoint",void 0),a([u({type:p.Boolean,context:1,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsUserCerts",void 0),a([u({type:p.Boolean,context:2,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsCACerts",void 0),a([u({type:yl,context:3,optional:!0,implicit:!0})],it.prototype,"onlySomeReasons",void 0),a([u({type:p.Boolean,context:4,defaultValue:it.ONLY,implicit:!0})],it.prototype,"indirectCRL",void 0),a([u({type:p.Boolean,context:5,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsAttributeCerts",void 0);var Vr;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Vr||(Vr={}));let qn=class{constructor(r=Vr.unspecified){this.reason=Vr.unspecified,this.reason=r}toJSON(){return Vr[this.reason]}toString(){return this.toJSON()}};a([u({type:p.Enumerated})],qn.prototype,"reason",void 0),qn=a([w({type:m.Choice})],qn);var Gs;const dl=`${Jt}.37`;let Qi=Gs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Gs.prototype)}};Qi=Gs=a([w({type:m.Sequence,itemType:p.ObjectIdentifier})],Qi);const mp=`${rr}.1`,wp=`${rr}.2`,bp=`${rr}.3`,Ap=`${rr}.4`,Sp=`${rr}.8`,kp=`${rr}.9`;let Gn=class{constructor(r=new ArrayBuffer(0)){this.value=r}};a([u({type:p.Integer,converter:W})],Gn.prototype,"value",void 0),Gn=a([w({type:m.Choice})],Gn);let Jn=class{constructor(r){this.value=new Date,r&&(this.value=r)}};a([u({type:p.GeneralizedTime})],Jn.prototype,"value",void 0),Jn=a([w({type:m.Choice})],Jn);var Js;const gl=`${Jt}.18`;let gc=Js=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Js.prototype)}};gc=Js=a([w({type:m.Sequence})],gc);const vl=`${Jt}.15`;var xt;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(xt||(xt={}));class Yn extends Pn{toJSON(){const t=this.toNumber(),e=[];return t&xt.cRLSign&&e.push("crlSign"),t&xt.dataEncipherment&&e.push("dataEncipherment"),t&xt.decipherOnly&&e.push("decipherOnly"),t&xt.digitalSignature&&e.push("digitalSignature"),t&xt.encipherOnly&&e.push("encipherOnly"),t&xt.keyAgreement&&e.push("keyAgreement"),t&xt.keyCertSign&&e.push("keyCertSign"),t&xt.keyEncipherment&&e.push("keyEncipherment"),t&xt.nonRepudiation&&e.push("nonRepudiation"),e}toString(){return`[${this.toJSON().join(", ")}]`}}var Ys;class di{constructor(t={}){this.base=new U,this.minimum=0,Object.assign(this,t)}}a([u({type:U})],di.prototype,"base",void 0),a([u({type:p.Integer,context:0,defaultValue:0,implicit:!0})],di.prototype,"minimum",void 0),a([u({type:p.Integer,context:1,optional:!0,implicit:!0})],di.prototype,"maximum",void 0);let tn=Ys=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ys.prototype)}};tn=Ys=a([w({type:m.Sequence,itemType:di})],tn);class vc{constructor(t={}){Object.assign(this,t)}}a([u({type:tn,context:0,optional:!0,implicit:!0})],vc.prototype,"permittedSubtrees",void 0),a([u({type:tn,context:1,optional:!0,implicit:!0})],vc.prototype,"excludedSubtrees",void 0);class mc{constructor(t={}){Object.assign(this,t)}}a([u({type:p.Integer,context:0,implicit:!0,optional:!0,converter:W})],mc.prototype,"requireExplicitPolicy",void 0),a([u({type:p.Integer,context:1,implicit:!0,optional:!0,converter:W})],mc.prototype,"inhibitPolicyMapping",void 0);var Zs;class Xs{constructor(t={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Xs.prototype,"issuerDomainPolicy",void 0),a([u({type:p.ObjectIdentifier})],Xs.prototype,"subjectDomainPolicy",void 0);let wc=Zs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Zs.prototype)}};wc=Zs=a([w({type:m.Sequence,itemType:Xs})],wc);var Qs;const ml=`${Jt}.17`;let to=Qs=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Qs.prototype)}};to=Qs=a([w({type:m.Sequence})],to);let Nt=class{constructor(r={}){this.type="",this.values=[],Object.assign(this,r)}};a([u({type:p.ObjectIdentifier})],Nt.prototype,"type",void 0),a([u({type:p.Any,repeated:"set"})],Nt.prototype,"values",void 0);var eo;let bc=eo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,eo.prototype)}};bc=eo=a([w({type:m.Sequence,itemType:Nt})],bc);const wl=`${Jt}.14`;class ie extends Zo{}class Ac{constructor(t={}){Object.assign(this,t)}}a([u({type:p.GeneralizedTime,context:0,implicit:!0,optional:!0})],Ac.prototype,"notBefore",void 0),a([u({type:p.GeneralizedTime,context:1,implicit:!0,optional:!0})],Ac.prototype,"notAfter",void 0);var Lr;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(Lr||(Lr={}));class bl extends Pn{toJSON(){const t=[],e=this.toNumber();return e&Lr.pKIXCertificate&&t.push("pKIXCertificate"),e&Lr.newExtensions&&t.push("newExtensions"),e&Lr.keyUpdateAllowed&&t.push("keyUpdateAllowed"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Sc{constructor(t={}){this.entrustVers="",this.entrustInfoFlags=new bl,Object.assign(this,t)}}a([u({type:p.GeneralString})],Sc.prototype,"entrustVers",void 0),a([u({type:bl})],Sc.prototype,"entrustInfoFlags",void 0);var ro;let kc=ro=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ro.prototype)}};kc=ro=a([w({type:m.Sequence,itemType:Jr})],kc);class B{constructor(t={}){this.algorithm="",Object.assign(this,t)}isEqual(t){return t instanceof B&&t.algorithm==this.algorithm&&(t.parameters&&this.parameters&&Fu(t.parameters,this.parameters)||t.parameters===this.parameters)}}a([u({type:p.ObjectIdentifier})],B.prototype,"algorithm",void 0),a([u({type:p.Any,optional:!0})],B.prototype,"parameters",void 0);class Ot{constructor(t={}){this.algorithm=new B,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:B})],Ot.prototype,"algorithm",void 0),a([u({type:p.BitString})],Ot.prototype,"subjectPublicKey",void 0);let tt=class{constructor(r){if(r)if(typeof r=="string"||typeof r=="number"||r instanceof Date){const t=new Date(r);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,r)}getTime(){const r=this.utcTime||this.generalTime;if(!r)throw new Error("Cannot get time from CHOICE object");return r}};a([u({type:p.UTCTime})],tt.prototype,"utcTime",void 0),a([u({type:p.GeneralizedTime})],tt.prototype,"generalTime",void 0),tt=a([w({type:m.Choice})],tt);class en{constructor(t){this.notBefore=new tt(new Date),this.notAfter=new tt(new Date),t&&(this.notBefore=new tt(t.notBefore),this.notAfter=new tt(t.notAfter))}}a([u({type:tt})],en.prototype,"notBefore",void 0),a([u({type:tt})],en.prototype,"notAfter",void 0);var io;let bt=class Al{constructor(t={}){this.extnID="",this.critical=Al.CRITICAL,this.extnValue=new D,Object.assign(this,t)}};bt.CRITICAL=!1,a([u({type:p.ObjectIdentifier})],bt.prototype,"extnID",void 0),a([u({type:p.Boolean,defaultValue:bt.CRITICAL})],bt.prototype,"critical",void 0),a([u({type:D})],bt.prototype,"extnValue",void 0);let ne=io=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,io.prototype)}};ne=io=a([w({type:m.Sequence,itemType:bt})],ne);var Ye;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(Ye||(Ye={}));class wt{constructor(t={}){this.version=Ye.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new B,this.issuer=new G,this.validity=new en,this.subject=new G,this.subjectPublicKeyInfo=new Ot,Object.assign(this,t)}}a([u({type:p.Integer,context:0,defaultValue:Ye.v1})],wt.prototype,"version",void 0),a([u({type:p.Integer,converter:W})],wt.prototype,"serialNumber",void 0),a([u({type:B})],wt.prototype,"signature",void 0),a([u({type:G})],wt.prototype,"issuer",void 0),a([u({type:en})],wt.prototype,"validity",void 0),a([u({type:G})],wt.prototype,"subject",void 0),a([u({type:Ot})],wt.prototype,"subjectPublicKeyInfo",void 0),a([u({type:p.BitString,context:1,implicit:!0,optional:!0})],wt.prototype,"issuerUniqueID",void 0),a([u({type:p.BitString,context:2,implicit:!0,optional:!0})],wt.prototype,"subjectUniqueID",void 0),a([u({type:ne,context:3,optional:!0})],wt.prototype,"extensions",void 0);class ze{constructor(t={}){this.tbsCertificate=new wt,this.signatureAlgorithm=new B,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:wt,raw:!0})],ze.prototype,"tbsCertificate",void 0),a([u({type:B})],ze.prototype,"signatureAlgorithm",void 0),a([u({type:p.BitString})],ze.prototype,"signatureValue",void 0);class gi{constructor(t={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new tt,Object.assign(this,t)}}a([u({type:p.Integer,converter:W})],gi.prototype,"userCertificate",void 0),a([u({type:tt})],gi.prototype,"revocationDate",void 0),a([u({type:bt,optional:!0,repeated:"sequence"})],gi.prototype,"crlEntryExtensions",void 0);class $t{constructor(t={}){this.signature=new B,this.issuer=new G,this.thisUpdate=new tt,Object.assign(this,t)}}a([u({type:p.Integer,optional:!0})],$t.prototype,"version",void 0),a([u({type:B})],$t.prototype,"signature",void 0),a([u({type:G})],$t.prototype,"issuer",void 0),a([u({type:tt})],$t.prototype,"thisUpdate",void 0),a([u({type:tt,optional:!0})],$t.prototype,"nextUpdate",void 0),a([u({type:gi,repeated:"sequence",optional:!0})],$t.prototype,"revokedCertificates",void 0),a([u({type:bt,optional:!0,context:0,repeated:"sequence"})],$t.prototype,"crlExtensions",void 0);class Zn{constructor(t={}){this.tbsCertList=new $t,this.signatureAlgorithm=new B,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:$t,raw:!0})],Zn.prototype,"tbsCertList",void 0),a([u({type:B})],Zn.prototype,"signatureAlgorithm",void 0),a([u({type:p.BitString})],Zn.prototype,"signature",void 0);class Ze{constructor(t={}){this.issuer=new G,this.serialNumber=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:G})],Ze.prototype,"issuer",void 0),a([u({type:p.Integer,converter:W})],Ze.prototype,"serialNumber",void 0);let He=class{constructor(r={}){Object.assign(this,r)}};a([u({type:ie,context:0,implicit:!0})],He.prototype,"subjectKeyIdentifier",void 0),a([u({type:Ze})],He.prototype,"issuerAndSerialNumber",void 0),He=a([w({type:m.Choice})],He);var zt;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(zt||(zt={}));let Yr=class extends B{};Yr=a([w({type:m.Sequence})],Yr);let rn=class extends B{};rn=a([w({type:m.Sequence})],rn);let Ht=class extends B{};Ht=a([w({type:m.Sequence})],Ht);let nn=class extends B{};nn=a([w({type:m.Sequence})],nn);let Bc=class extends B{};Bc=a([w({type:m.Sequence})],Bc);let no=class extends B{};no=a([w({type:m.Sequence})],no);let Xe=class{constructor(r={}){this.attrType="",this.attrValues=[],Object.assign(this,r)}};a([u({type:p.ObjectIdentifier})],Xe.prototype,"attrType",void 0),a([u({type:p.Any,repeated:"set"})],Xe.prototype,"attrValues",void 0);var so;class Rt{constructor(t={}){this.version=zt.v0,this.sid=new He,this.digestAlgorithm=new Yr,this.signatureAlgorithm=new rn,this.signature=new D,Object.assign(this,t)}}a([u({type:p.Integer})],Rt.prototype,"version",void 0),a([u({type:He})],Rt.prototype,"sid",void 0),a([u({type:Yr})],Rt.prototype,"digestAlgorithm",void 0),a([u({type:Xe,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],Rt.prototype,"signedAttrs",void 0),a([u({type:rn})],Rt.prototype,"signatureAlgorithm",void 0),a([u({type:D})],Rt.prototype,"signature",void 0),a([u({type:Xe,repeated:"set",context:1,implicit:!0,optional:!0})],Rt.prototype,"unsignedAttrs",void 0);let sn=so=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,so.prototype)}};sn=so=a([w({type:m.Set,itemType:Rt})],sn);let xc=class extends Rt{};xc=a([w({type:m.Sequence})],xc);let Cc=class extends tt{};Cc=a([w({type:m.Choice})],Cc);class Xn{constructor(t={}){this.acIssuer=new U,this.acSerial=0,this.attrs=[],Object.assign(this,t)}}a([u({type:U})],Xn.prototype,"acIssuer",void 0),a([u({type:p.Integer})],Xn.prototype,"acSerial",void 0),a([u({type:Nt,repeated:"sequence"})],Xn.prototype,"attrs",void 0);var oo;let on=oo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,oo.prototype)}};on=oo=a([w({type:m.Sequence,itemType:p.ObjectIdentifier})],on);class oi{constructor(t={}){this.permitUnSpecified=!0,Object.assign(this,t)}}a([u({type:p.Integer,optional:!0})],oi.prototype,"pathLenConstraint",void 0),a([u({type:on,implicit:!0,context:0,optional:!0})],oi.prototype,"permittedAttrs",void 0),a([u({type:on,implicit:!0,context:1,optional:!0})],oi.prototype,"excludedAttrs",void 0),a([u({type:p.Boolean,defaultValue:!0})],oi.prototype,"permitUnSpecified",void 0);class ge{constructor(t={}){this.issuer=new st,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:st})],ge.prototype,"issuer",void 0),a([u({type:p.Integer,converter:W})],ge.prototype,"serial",void 0),a([u({type:p.BitString,optional:!0})],ge.prototype,"issuerUID",void 0);var ao;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(ao||(ao={}));class pe{constructor(t={}){this.digestedObjectType=ao.publicKey,this.digestAlgorithm=new B,this.objectDigest=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.Enumerated})],pe.prototype,"digestedObjectType",void 0),a([u({type:p.ObjectIdentifier,optional:!0})],pe.prototype,"otherObjectTypeID",void 0),a([u({type:B})],pe.prototype,"digestAlgorithm",void 0),a([u({type:p.BitString})],pe.prototype,"objectDigest",void 0);class vi{constructor(t={}){Object.assign(this,t)}}a([u({type:st,optional:!0})],vi.prototype,"issuerName",void 0),a([u({type:ge,context:0,implicit:!0,optional:!0})],vi.prototype,"baseCertificateID",void 0),a([u({type:pe,context:1,implicit:!0,optional:!0})],vi.prototype,"objectDigestInfo",void 0);let De=class{constructor(r={}){Object.assign(this,r)}};a([u({type:U,repeated:"sequence"})],De.prototype,"v1Form",void 0),a([u({type:vi,context:0,implicit:!0})],De.prototype,"v2Form",void 0),De=a([w({type:m.Choice})],De);class an{constructor(t={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,t)}}a([u({type:p.GeneralizedTime})],an.prototype,"notBeforeTime",void 0),a([u({type:p.GeneralizedTime})],an.prototype,"notAfterTime",void 0);class Hr{constructor(t={}){Object.assign(this,t)}}a([u({type:ge,implicit:!0,context:0,optional:!0})],Hr.prototype,"baseCertificateID",void 0),a([u({type:st,implicit:!0,context:1,optional:!0})],Hr.prototype,"entityName",void 0),a([u({type:pe,implicit:!0,context:2,optional:!0})],Hr.prototype,"objectDigestInfo",void 0);var co;(function(r){r[r.v2=1]="v2"})(co||(co={}));class Ct{constructor(t={}){this.version=co.v2,this.holder=new Hr,this.issuer=new De,this.signature=new B,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new an,this.attributes=[],Object.assign(this,t)}}a([u({type:p.Integer})],Ct.prototype,"version",void 0),a([u({type:Hr})],Ct.prototype,"holder",void 0),a([u({type:De})],Ct.prototype,"issuer",void 0),a([u({type:B})],Ct.prototype,"signature",void 0),a([u({type:p.Integer,converter:W})],Ct.prototype,"serialNumber",void 0),a([u({type:an})],Ct.prototype,"attrCertValidityPeriod",void 0),a([u({type:Nt,repeated:"sequence"})],Ct.prototype,"attributes",void 0),a([u({type:p.BitString,optional:!0})],Ct.prototype,"issuerUniqueID",void 0),a([u({type:ne,optional:!0})],Ct.prototype,"extensions",void 0);class mi{constructor(t={}){this.acinfo=new Ct,this.signatureAlgorithm=new B,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:Ct})],mi.prototype,"acinfo",void 0),a([u({type:B})],mi.prototype,"signatureAlgorithm",void 0),a([u({type:p.BitString})],mi.prototype,"signatureValue",void 0);var cn;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})(cn||(cn={}));class uo extends Pn{}class lo{constructor(t={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier,implicit:!0,context:0})],lo.prototype,"type",void 0),a([u({type:p.Any,implicit:!0,context:1})],lo.prototype,"value",void 0);class Qn{constructor(t={}){this.policyId="",this.classList=new uo(cn.unclassified),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Qn.prototype,"policyId",void 0),a([u({type:uo,defaultValue:new uo(cn.unclassified)})],Qn.prototype,"classList",void 0),a([u({type:lo,repeated:"set"})],Qn.prototype,"securityCategories",void 0);class wi{constructor(t={}){Object.assign(this,t)}}a([u({type:D})],wi.prototype,"cotets",void 0),a([u({type:p.ObjectIdentifier})],wi.prototype,"oid",void 0),a([u({type:p.Utf8String})],wi.prototype,"string",void 0);class Oc{constructor(t={}){this.values=[],Object.assign(this,t)}}a([u({type:st,implicit:!0,context:0,optional:!0})],Oc.prototype,"policyAuthority",void 0),a([u({type:wi,repeated:"sequence"})],Oc.prototype,"values",void 0);var ho;class bi{constructor(t={}){this.targetCertificate=new ge,Object.assign(this,t)}}a([u({type:ge})],bi.prototype,"targetCertificate",void 0),a([u({type:U,optional:!0})],bi.prototype,"targetName",void 0),a([u({type:pe,optional:!0})],bi.prototype,"certDigestInfo",void 0);let Ne=class{constructor(r={}){Object.assign(this,r)}};a([u({type:U,context:0,implicit:!0})],Ne.prototype,"targetName",void 0),a([u({type:U,context:1,implicit:!0})],Ne.prototype,"targetGroup",void 0),a([u({type:bi,context:2,implicit:!0})],Ne.prototype,"targetCert",void 0),Ne=a([w({type:m.Choice})],Ne);let po=ho=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ho.prototype)}};po=ho=a([w({type:m.Sequence,itemType:Ne})],po);var fo;let Ec=fo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,fo.prototype)}};Ec=fo=a([w({type:m.Sequence,itemType:po})],Ec);class Nc{constructor(t={}){Object.assign(this,t)}}a([u({type:st,implicit:!0,context:0,optional:!0})],Nc.prototype,"roleAuthority",void 0),a([u({type:U,implicit:!0,context:1})],Nc.prototype,"roleName",void 0);class ts{constructor(t={}){this.service=new U,this.ident=new U,Object.assign(this,t)}}a([u({type:U})],ts.prototype,"service",void 0),a([u({type:U})],ts.prototype,"ident",void 0),a([u({type:D,optional:!0})],ts.prototype,"authInfo",void 0);var yo;class go{constructor(t={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],go.prototype,"otherCertFormat",void 0),a([u({type:p.Any})],go.prototype,"otherCert",void 0);let Ie=class{constructor(r={}){Object.assign(this,r)}};a([u({type:ze})],Ie.prototype,"certificate",void 0),a([u({type:mi,context:2,implicit:!0})],Ie.prototype,"v2AttrCert",void 0),a([u({type:go,context:3,implicit:!0})],Ie.prototype,"other",void 0),Ie=a([w({type:m.Choice})],Ie);let un=yo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,yo.prototype)}};un=yo=a([w({type:m.Set,itemType:Ie})],un);class Qe{constructor(t={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Qe.prototype,"contentType",void 0),a([u({type:p.Any,context:0})],Qe.prototype,"content",void 0);let cr=class{constructor(r={}){Object.assign(this,r)}};a([u({type:D})],cr.prototype,"single",void 0),a([u({type:p.Any})],cr.prototype,"any",void 0),cr=a([w({type:m.Choice})],cr);class ln{constructor(t={}){this.eContentType="",Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],ln.prototype,"eContentType",void 0),a([u({type:cr,context:0,optional:!0})],ln.prototype,"eContent",void 0);let ur=class{constructor(r={}){Object.assign(this,r)}};a([u({type:D,context:0,implicit:!0,optional:!0})],ur.prototype,"value",void 0),a([u({type:D,converter:Xh,context:0,implicit:!0,optional:!0,repeated:"sequence"})],ur.prototype,"constructedValue",void 0),ur=a([w({type:m.Choice})],ur);class Dr{constructor(t={}){this.contentType="",this.contentEncryptionAlgorithm=new nn,Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Dr.prototype,"contentType",void 0),a([u({type:nn})],Dr.prototype,"contentEncryptionAlgorithm",void 0),a([u({type:ur,optional:!0})],Dr.prototype,"encryptedContent",void 0);class hn{constructor(t={}){this.keyAttrId="",Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],hn.prototype,"keyAttrId",void 0),a([u({type:p.Any,optional:!0})],hn.prototype,"keyAttr",void 0);var vo;class Ai{constructor(t={}){this.subjectKeyIdentifier=new ie,Object.assign(this,t)}}a([u({type:ie})],Ai.prototype,"subjectKeyIdentifier",void 0),a([u({type:p.GeneralizedTime,optional:!0})],Ai.prototype,"date",void 0),a([u({type:hn,optional:!0})],Ai.prototype,"other",void 0);let Me=class{constructor(r={}){Object.assign(this,r)}};a([u({type:Ai,context:0,implicit:!0,optional:!0})],Me.prototype,"rKeyId",void 0),a([u({type:Ze,optional:!0})],Me.prototype,"issuerAndSerialNumber",void 0),Me=a([w({type:m.Choice})],Me);class mo{constructor(t={}){this.rid=new Me,this.encryptedKey=new D,Object.assign(this,t)}}a([u({type:Me})],mo.prototype,"rid",void 0),a([u({type:D})],mo.prototype,"encryptedKey",void 0);let pn=vo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,vo.prototype)}};pn=vo=a([w({type:m.Sequence,itemType:mo})],pn);class wo{constructor(t={}){this.algorithm=new B,this.publicKey=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:B})],wo.prototype,"algorithm",void 0),a([u({type:p.BitString})],wo.prototype,"publicKey",void 0);let ae=class{constructor(r={}){Object.assign(this,r)}};a([u({type:ie,context:0,implicit:!0,optional:!0})],ae.prototype,"subjectKeyIdentifier",void 0),a([u({type:wo,context:1,implicit:!0,optional:!0})],ae.prototype,"originatorKey",void 0),a([u({type:Ze,optional:!0})],ae.prototype,"issuerAndSerialNumber",void 0),ae=a([w({type:m.Choice})],ae);class Te{constructor(t={}){this.version=zt.v3,this.originator=new ae,this.keyEncryptionAlgorithm=new Ht,this.recipientEncryptedKeys=new pn,Object.assign(this,t)}}a([u({type:p.Integer})],Te.prototype,"version",void 0),a([u({type:ae,context:0})],Te.prototype,"originator",void 0),a([u({type:D,context:1,optional:!0})],Te.prototype,"ukm",void 0),a([u({type:Ht})],Te.prototype,"keyEncryptionAlgorithm",void 0),a([u({type:pn})],Te.prototype,"recipientEncryptedKeys",void 0);let $e=class{constructor(r={}){Object.assign(this,r)}};a([u({type:ie,context:0,implicit:!0})],$e.prototype,"subjectKeyIdentifier",void 0),a([u({type:Ze})],$e.prototype,"issuerAndSerialNumber",void 0),$e=a([w({type:m.Choice})],$e);class lr{constructor(t={}){this.version=zt.v0,this.rid=new $e,this.keyEncryptionAlgorithm=new Ht,this.encryptedKey=new D,Object.assign(this,t)}}a([u({type:p.Integer})],lr.prototype,"version",void 0),a([u({type:$e})],lr.prototype,"rid",void 0),a([u({type:Ht})],lr.prototype,"keyEncryptionAlgorithm",void 0),a([u({type:D})],lr.prototype,"encryptedKey",void 0);class Mr{constructor(t={}){this.keyIdentifier=new D,Object.assign(this,t)}}a([u({type:D})],Mr.prototype,"keyIdentifier",void 0),a([u({type:p.GeneralizedTime,optional:!0})],Mr.prototype,"date",void 0),a([u({type:hn,optional:!0})],Mr.prototype,"other",void 0);class hr{constructor(t={}){this.version=zt.v4,this.kekid=new Mr,this.keyEncryptionAlgorithm=new Ht,this.encryptedKey=new D,Object.assign(this,t)}}a([u({type:p.Integer})],hr.prototype,"version",void 0),a([u({type:Mr})],hr.prototype,"kekid",void 0),a([u({type:Ht})],hr.prototype,"keyEncryptionAlgorithm",void 0),a([u({type:D})],hr.prototype,"encryptedKey",void 0);class pr{constructor(t={}){this.version=zt.v0,this.keyEncryptionAlgorithm=new Ht,this.encryptedKey=new D,Object.assign(this,t)}}a([u({type:p.Integer})],pr.prototype,"version",void 0),a([u({type:no,context:0,optional:!0})],pr.prototype,"keyDerivationAlgorithm",void 0),a([u({type:Ht})],pr.prototype,"keyEncryptionAlgorithm",void 0),a([u({type:D})],pr.prototype,"encryptedKey",void 0);class bo{constructor(t={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],bo.prototype,"oriType",void 0),a([u({type:p.Any})],bo.prototype,"oriValue",void 0);let Zt=class{constructor(r={}){Object.assign(this,r)}};a([u({type:lr,optional:!0})],Zt.prototype,"ktri",void 0),a([u({type:Te,context:1,implicit:!0,optional:!0})],Zt.prototype,"kari",void 0),a([u({type:hr,context:2,implicit:!0,optional:!0})],Zt.prototype,"kekri",void 0),a([u({type:pr,context:3,implicit:!0,optional:!0})],Zt.prototype,"pwri",void 0),a([u({type:bo,context:4,implicit:!0,optional:!0})],Zt.prototype,"ori",void 0),Zt=a([w({type:m.Choice})],Zt);var Ao;let fn=Ao=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ao.prototype)}};fn=Ao=a([w({type:m.Set,itemType:Zt})],fn);var So;class yn{constructor(t={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],yn.prototype,"otherRevInfoFormat",void 0),a([u({type:p.Any})],yn.prototype,"otherRevInfo",void 0);let Si=class{constructor(r={}){this.other=new yn,Object.assign(this,r)}};a([u({type:yn,context:1,implicit:!0})],Si.prototype,"other",void 0),Si=a([w({type:m.Choice})],Si);let dn=So=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,So.prototype)}};dn=So=a([w({type:m.Set,itemType:Si})],dn);class ko{constructor(t={}){Object.assign(this,t)}}a([u({type:un,context:0,implicit:!0,optional:!0})],ko.prototype,"certs",void 0),a([u({type:dn,context:1,implicit:!0,optional:!0})],ko.prototype,"crls",void 0);var Bo;let xo=Bo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Bo.prototype)}};xo=Bo=a([w({type:m.Set,itemType:Xe})],xo);class ar{constructor(t={}){this.version=zt.v0,this.recipientInfos=new fn,this.encryptedContentInfo=new Dr,Object.assign(this,t)}}a([u({type:p.Integer})],ar.prototype,"version",void 0),a([u({type:ko,context:0,implicit:!0,optional:!0})],ar.prototype,"originatorInfo",void 0),a([u({type:fn})],ar.prototype,"recipientInfos",void 0),a([u({type:Dr})],ar.prototype,"encryptedContentInfo",void 0),a([u({type:xo,context:1,implicit:!0,optional:!0})],ar.prototype,"unprotectedAttrs",void 0);const Bp="1.2.840.113549.1.7.2";var Co;let gn=Co=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Co.prototype)}};gn=Co=a([w({type:m.Set,itemType:Yr})],gn);class Oe{constructor(t={}){this.version=zt.v0,this.digestAlgorithms=new gn,this.encapContentInfo=new ln,this.signerInfos=new sn,Object.assign(this,t)}}a([u({type:p.Integer})],Oe.prototype,"version",void 0),a([u({type:gn})],Oe.prototype,"digestAlgorithms",void 0),a([u({type:ln})],Oe.prototype,"encapContentInfo",void 0),a([u({type:un,context:0,implicit:!0,optional:!0})],Oe.prototype,"certificates",void 0),a([u({type:dn,context:1,implicit:!0,optional:!0})],Oe.prototype,"crls",void 0),a([u({type:sn})],Oe.prototype,"signerInfos",void 0);const Zr="1.2.840.10045.2.1",Xo="1.2.840.10045.4.1",Sl="1.2.840.10045.4.3.1",Qo="1.2.840.10045.4.3.2",ta="1.2.840.10045.4.3.3",ea="1.2.840.10045.4.3.4",Ic="1.2.840.10045.3.1.7",Tc="1.3.132.0.34",jc="1.3.132.0.35";function ei(r){return new B({algorithm:r})}const xp=ei(Xo);ei(Sl);const Cp=ei(Qo),Op=ei(ta),Ep=ei(ea);let fr=class{constructor(r={}){Object.assign(this,r)}};a([u({type:p.ObjectIdentifier})],fr.prototype,"fieldType",void 0),a([u({type:p.Any})],fr.prototype,"parameters",void 0),fr=a([w({type:m.Sequence})],fr);class Np extends D{}let je=class{constructor(r={}){Object.assign(this,r)}};a([u({type:p.OctetString})],je.prototype,"a",void 0),a([u({type:p.OctetString})],je.prototype,"b",void 0),a([u({type:p.BitString,optional:!0})],je.prototype,"seed",void 0),je=a([w({type:m.Sequence})],je);var Oo;(function(r){r[r.ecpVer1=1]="ecpVer1"})(Oo||(Oo={}));let Mt=class{constructor(r={}){this.version=Oo.ecpVer1,Object.assign(this,r)}};a([u({type:p.Integer})],Mt.prototype,"version",void 0),a([u({type:fr})],Mt.prototype,"fieldID",void 0),a([u({type:je})],Mt.prototype,"curve",void 0),a([u({type:Np})],Mt.prototype,"base",void 0),a([u({type:p.Integer,converter:W})],Mt.prototype,"order",void 0),a([u({type:p.Integer,optional:!0})],Mt.prototype,"cofactor",void 0),Mt=a([w({type:m.Sequence})],Mt);let Xt=class{constructor(r={}){Object.assign(this,r)}};a([u({type:p.ObjectIdentifier})],Xt.prototype,"namedCurve",void 0),a([u({type:p.Null})],Xt.prototype,"implicitCurve",void 0),a([u({type:Mt})],Xt.prototype,"specifiedCurve",void 0),Xt=a([w({type:m.Choice})],Xt);class ai{constructor(t={}){this.version=1,this.privateKey=new D,Object.assign(this,t)}}a([u({type:p.Integer})],ai.prototype,"version",void 0),a([u({type:D})],ai.prototype,"privateKey",void 0),a([u({type:Xt,context:0,optional:!0})],ai.prototype,"parameters",void 0),a([u({type:p.BitString,context:1,optional:!0})],ai.prototype,"publicKey",void 0);class vn{constructor(t={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.Integer,converter:W})],vn.prototype,"r",void 0),a([u({type:p.Integer,converter:W})],vn.prototype,"s",void 0);const ht="1.2.840.113549.1.1",be=`${ht}.1`,Ip=`${ht}.7`,Tp=`${ht}.9`,$r=`${ht}.10`,jp=`${ht}.2`,Up=`${ht}.4`,mn=`${ht}.5`,Pp=`${ht}.14`,Eo=`${ht}.11`,wn=`${ht}.12`,bn=`${ht}.13`,Uc=`${ht}.15`,Pc=`${ht}.16`,An="1.3.14.3.2.26",kl="2.16.840.1.101.3.4.2.4",Sn="2.16.840.1.101.3.4.2.1",kn="2.16.840.1.101.3.4.2.2",Bn="2.16.840.1.101.3.4.2.3",Rp="2.16.840.1.101.3.4.2.5",Vp="2.16.840.1.101.3.4.2.6",Lp="1.2.840.113549.2.2",Hp="1.2.840.113549.2.5",Vn=`${ht}.8`;function Z(r){return new B({algorithm:r,parameters:null})}Z(Lp),Z(Hp);const Ae=Z(An);Z(kl),Z(Sn),Z(kn),Z(Bn),Z(Rp),Z(Vp);const Bl=new B({algorithm:Vn,parameters:b.serialize(Ae)}),xl=new B({algorithm:Tp,parameters:b.serialize(Gi.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});Z(be),Z(jp),Z(Up),Z(mn),Z(Uc),Z(Pc),Z(wn),Z(bn),Z(Uc),Z(Pc);class ci{constructor(t={}){this.hashAlgorithm=new B(Ae),this.maskGenAlgorithm=new B({algorithm:Vn,parameters:b.serialize(Ae)}),this.pSourceAlgorithm=new B(xl),Object.assign(this,t)}}a([u({type:B,context:0,defaultValue:Ae})],ci.prototype,"hashAlgorithm",void 0),a([u({type:B,context:1,defaultValue:Bl})],ci.prototype,"maskGenAlgorithm",void 0),a([u({type:B,context:2,defaultValue:xl})],ci.prototype,"pSourceAlgorithm",void 0),new B({algorithm:Ip,parameters:b.serialize(new ci)});class ce{constructor(t={}){this.hashAlgorithm=new B(Ae),this.maskGenAlgorithm=new B({algorithm:Vn,parameters:b.serialize(Ae)}),this.saltLength=20,this.trailerField=1,Object.assign(this,t)}}a([u({type:B,context:0,defaultValue:Ae})],ce.prototype,"hashAlgorithm",void 0),a([u({type:B,context:1,defaultValue:Bl})],ce.prototype,"maskGenAlgorithm",void 0),a([u({type:p.Integer,context:2,defaultValue:20})],ce.prototype,"saltLength",void 0),a([u({type:p.Integer,context:3,defaultValue:1})],ce.prototype,"trailerField",void 0),new B({algorithm:$r,parameters:b.serialize(new ce)});class xn{constructor(t={}){this.digestAlgorithm=new B,this.digest=new D,Object.assign(this,t)}}a([u({type:B})],xn.prototype,"digestAlgorithm",void 0),a([u({type:D})],xn.prototype,"digest",void 0);var No;class ki{constructor(t={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.Integer,converter:W})],ki.prototype,"prime",void 0),a([u({type:p.Integer,converter:W})],ki.prototype,"exponent",void 0),a([u({type:p.Integer,converter:W})],ki.prototype,"coefficient",void 0);let Io=No=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,No.prototype)}};Io=No=a([w({type:m.Sequence,itemType:ki})],Io);class Pt{constructor(t={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.Integer})],Pt.prototype,"version",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"modulus",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"publicExponent",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"privateExponent",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"prime1",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"prime2",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"exponent1",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"exponent2",void 0),a([u({type:p.Integer,converter:W})],Pt.prototype,"coefficient",void 0),a([u({type:Io,optional:!0})],Pt.prototype,"otherPrimeInfos",void 0);class To{constructor(t={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.Integer,converter:W})],To.prototype,"modulus",void 0),a([u({type:p.Integer,converter:W})],To.prototype,"publicExponent",void 0);var jo;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(jo||(jo={}));const ct=jo;var Uo=function(r,t){return Uo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},Uo(r,t)};function ra(r,t){Uo(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Dp(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function c(g){try{h(n.next(g))}catch(y){o(y)}}function l(g){try{h(n.throw(g))}catch(y){o(y)}}function h(g){g.done?s(g.value):i(g.value).then(c,l)}h((n=n.apply(r,[])).next())})}function Mp(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(g){return l([h,g])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,i=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){e.label=h[1];break}if(h[0]===6&&e.label<s[1]){e.label=s[1],s=h;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(h);break}s[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(r,e)}catch(g){h=[6,g],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function ui(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cn(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return s}function ue(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Cn(arguments[t]));return r}var $p="injectionTokens";function Fp(r){var t=Reflect.getMetadata("design:paramtypes",r)||[],e=Reflect.getOwnMetadata($p,r)||{};return Object.keys(e).forEach(function(n){t[+n]=e[n]}),t}function Cl(r){return!!r.useClass}function Po(r){return!!r.useFactory}var Ol=function(){function r(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(t){var e=this,n={},i=!1,s,o=function(){return i||(s=t(e.wrap()),i=!0),s};return new Proxy(n,this.createHandler(o))},r.prototype.createHandler=function(t){var e={},n=function(i){e[i]=function(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];s[0]=t();var c=Reflect[i];return c.apply(void 0,ue(s))}};return this.reflectMethods.forEach(n),e},r}();function Ee(r){return typeof r=="string"||typeof r=="symbol"}function Wp(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function Rc(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Kp(r){return typeof r=="function"||r instanceof Ol}function Bi(r){return!!r.useToken}function xi(r){return r.useValue!=null}function zp(r){return Cl(r)||xi(r)||Bi(r)||Po(r)}var ia=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},r.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},r.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},r.prototype.setAll=function(t,e){this._registryMap.set(t,e)},r.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},r}(),_p=function(r){ra(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(ia),li=function(){function r(){this.scopedResolutions=new Map}return r}();function qp(r,t){if(r===null)return"at position #"+t;var e=r.split(",")[t].trim();return'"'+e+'" at position #'+t}function Gp(r,t,e){return e===void 0&&(e="    "),ue([r],t.message.split(`
`).map(function(n){return e+n})).join(`
`)}function Jp(r,t,e){var n=Cn(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),i=n[1],s=i===void 0?null:i,o=qp(s,t);return Gp("Cannot inject the dependency "+o+' of "'+r.name+'" constructor. Reason:',e)}function Yp(r){if(typeof r.dispose!="function")return!1;var t=r.dispose;return!(t.length>0)}var Zp=function(r){ra(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(ia),Xp=function(r){ra(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(ia),Qp=function(){function r(){this.preResolution=new Zp,this.postResolution=new Xp}return r}(),El=new Map,tf=function(){function r(t){this.parent=t,this._registry=new _p,this.interceptors=new Qp,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(t,e,n){n===void 0&&(n={lifecycle:ct.Transient}),this.ensureNotDisposed();var i;if(zp(e)?i=e:i={useClass:e},Bi(i))for(var s=[t],o=i;o!=null;){var c=o.useToken;if(s.includes(c))throw new Error("Token registration cycle detected! "+ue(s,[c]).join(" -> "));s.push(c);var l=this._registry.get(c);l&&Bi(l.provider)?o=l.provider:o=null}if((n.lifecycle===ct.Singleton||n.lifecycle==ct.ContainerScoped||n.lifecycle==ct.ResolutionScoped)&&(xi(i)||Po(i)))throw new Error('Cannot use lifecycle "'+ct[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},r.prototype.registerType=function(t,e){return this.ensureNotDisposed(),Ee(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},r.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},r.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),Ee(t)){if(Ee(e))return this.register(t,{useToken:e},{lifecycle:ct.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:ct.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!Ee(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:ct.Singleton})},r.prototype.resolve=function(t,e,n){e===void 0&&(e=new li),n===void 0&&(n=!1),this.ensureNotDisposed();var i=this.getRegistration(t);if(!i&&Ee(t)){if(n)return;throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"Single"),i){var s=this.resolveRegistration(i,e);return this.executePostResolutionInterceptor(t,s,"Single"),s}if(Kp(t)){var s=this.construct(t,e);return this.executePostResolutionInterceptor(t,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var s=[];try{for(var o=ui(this.interceptors.preResolution.getAll(t)),c=o.next();!c.done;c=o.next()){var l=c.value;l.options.frequency!="Once"&&s.push(l),l.callback(t,e)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,s)}},r.prototype.executePostResolutionInterceptor=function(t,e,n){var i,s;if(this.interceptors.postResolution.has(t)){var o=[];try{for(var c=ui(this.interceptors.postResolution.getAll(t)),l=c.next();!l.done;l=c.next()){var h=l.value;h.options.frequency!="Once"&&o.push(h),h.callback(t,e,n)}}catch(g){i={error:g}}finally{try{l&&!l.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,o)}},r.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===ct.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n=t.options.lifecycle===ct.Singleton,i=t.options.lifecycle===ct.ContainerScoped,s=n||i,o;return xi(t.provider)?o=t.provider.useValue:Bi(t.provider)?o=s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):Cl(t.provider)?o=s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):Po(t.provider)?o=t.provider.useFactory(this):o=this.construct(t.provider,e),t.options.lifecycle===ct.ResolutionScoped&&e.scopedResolutions.set(t,o),o},r.prototype.resolveAll=function(t,e,n){var i=this;e===void 0&&(e=new li),n===void 0&&(n=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(t);if(!s&&Ee(t)){if(n)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"All"),s){var o=s.map(function(l){return i.resolveRegistration(l,e)});return this.executePostResolutionInterceptor(t,o,"All"),o}var c=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,c,"All"),c},r.prototype.isRegistered=function(t,e){return e===void 0&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=ui(this._registry.entries()),i=n.next();!i.done;i=n.next()){var s=Cn(i.value,2),o=s[0],c=s[1];this._registry.setAll(o,c.filter(function(l){return!xi(l.provider)}).map(function(l){return l.instance=void 0,l}))}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},r.prototype.createChildContainer=function(){var t,e;this.ensureNotDisposed();var n=new r(this);try{for(var i=ui(this._registry.entries()),s=i.next();!s.done;s=i.next()){var o=Cn(s.value,2),c=o[0],l=o[1];l.some(function(h){var g=h.options;return g.lifecycle===ct.ContainerScoped})&&n._registry.setAll(c,l.map(function(h){return h.options.lifecycle===ct.ContainerScoped?{provider:h.provider,options:h.options}:h}))}}catch(h){t={error:h}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},r.prototype.beforeResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},r.prototype.afterResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},r.prototype.dispose=function(){return Dp(this,void 0,void 0,function(){var t;return Mp(this,function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach(function(n){var i=n.dispose();i&&t.push(i)}),[4,Promise.all(t)];case 1:return e.sent(),[2]}})})},r.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},r.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},r.prototype.construct=function(t,e){var n=this;if(t instanceof Ol)return t.createProxy(function(s){return n.resolve(s,e)});var i=function(){var s=El.get(t);if(!s||s.length===0){if(t.length===0)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var o=s.map(n.resolveParams(e,t));return new(t.bind.apply(t,ue([void 0],o)))}();return Yp(i)&&this.disposables.add(i),i},r.prototype.resolveParams=function(t,e){var n=this;return function(i,s){var o,c,l;try{return Wp(i)?Rc(i)?i.multiple?(o=n.resolve(i.transform)).transform.apply(o,ue([n.resolveAll(i.token,new li,i.isOptional)],i.transformArgs)):(c=n.resolve(i.transform)).transform.apply(c,ue([n.resolve(i.token,t,i.isOptional)],i.transformArgs)):i.multiple?n.resolveAll(i.token,new li,i.isOptional):n.resolve(i.token,t,i.isOptional):Rc(i)?(l=n.resolve(i.transform,t)).transform.apply(l,ue([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(h){throw new Error(Jp(e,s,h))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),rt=new tf;function Ln(r){return function(t){El.set(t,Fp(t))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);var Ro;class On{constructor(t={}){this.attrId="",this.attrValues=[],Object.assign(t)}}a([u({type:p.ObjectIdentifier})],On.prototype,"attrId",void 0),a([u({type:p.Any,repeated:"set"})],On.prototype,"attrValues",void 0);let Vc=Ro=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ro.prototype)}};Vc=Ro=a([w({type:m.Sequence,itemType:On})],Vc);var Vo;let Lc=Vo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Vo.prototype)}};Lc=Vo=a([w({type:m.Sequence,itemType:Qe})],Lc);class Hc{constructor(t={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Hc.prototype,"certId",void 0),a([u({type:p.Any,context:0})],Hc.prototype,"certValue",void 0);class Dc{constructor(t={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Dc.prototype,"crlId",void 0),a([u({type:p.Any,context:0})],Dc.prototype,"crltValue",void 0);class Nl extends D{}let En=class{constructor(r={}){this.encryptionAlgorithm=new B,this.encryptedData=new Nl,Object.assign(this,r)}};a([u({type:B})],En.prototype,"encryptionAlgorithm",void 0),a([u({type:Nl})],En.prototype,"encryptedData",void 0);var Lo,Ho;(function(r){r[r.v1=0]="v1"})(Ho||(Ho={}));class Il extends D{}let Do=Lo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Lo.prototype)}};Do=Lo=a([w({type:m.Sequence,itemType:Nt})],Do);class yr{constructor(t={}){this.version=Ho.v1,this.privateKeyAlgorithm=new B,this.privateKey=new Il,Object.assign(this,t)}}a([u({type:p.Integer})],yr.prototype,"version",void 0),a([u({type:B})],yr.prototype,"privateKeyAlgorithm",void 0),a([u({type:Il})],yr.prototype,"privateKey",void 0),a([u({type:Do,implicit:!0,context:0,optional:!0})],yr.prototype,"attributes",void 0);let Mc=class extends yr{};Mc=a([w({type:m.Sequence})],Mc);let $c=class extends En{};$c=a([w({type:m.Sequence})],$c);class Fc{constructor(t={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Fc.prototype,"secretTypeId",void 0),a([u({type:p.Any,context:0})],Fc.prototype,"secretValue",void 0);class Fr{constructor(t={}){this.mac=new xn,this.macSalt=new D,this.iterations=1,Object.assign(this,t)}}a([u({type:xn})],Fr.prototype,"mac",void 0),a([u({type:D})],Fr.prototype,"macSalt",void 0),a([u({type:p.Integer,defaultValue:1})],Fr.prototype,"iterations",void 0);class Ci{constructor(t={}){this.version=3,this.authSafe=new Qe,this.macData=new Fr,Object.assign(this,t)}}a([u({type:p.Integer})],Ci.prototype,"version",void 0),a([u({type:Qe})],Ci.prototype,"authSafe",void 0),a([u({type:Fr,optional:!0})],Ci.prototype,"macData",void 0);var Mo;class Oi{constructor(t={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:p.ObjectIdentifier})],Oi.prototype,"bagId",void 0),a([u({type:p.Any,context:0})],Oi.prototype,"bagValue",void 0),a([u({type:On,repeated:"set",optional:!0})],Oi.prototype,"bagAttributes",void 0);let Wc=Mo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Mo.prototype)}};Wc=Mo=a([w({type:m.Sequence,itemType:Oi})],Wc);var $o,Fo,Wo;const Tl="1.2.840.113549.1.9",jl=`${Tl}.7`,Hn=`${Tl}.14`;let Ei=class extends Q{constructor(r={}){super(r)}toString(){return this.ia5String||super.toString()}};a([u({type:p.IA5String})],Ei.prototype,"ia5String",void 0),Ei=a([w({type:m.Choice})],Ei);let Kc=class extends Qe{};Kc=a([w({type:m.Sequence})],Kc);let zc=class extends Ci{};zc=a([w({type:m.Sequence})],zc);let _c=class extends En{};_c=a([w({type:m.Sequence})],_c);let es=class{constructor(r=""){this.value=r}toString(){return this.value}};a([u({type:p.IA5String})],es.prototype,"value",void 0),es=a([w({type:m.Choice})],es);let qc=class extends Ei{};qc=a([w({type:m.Choice})],qc);let Gc=class extends Q{};Gc=a([w({type:m.Choice})],Gc);let rs=class{constructor(r=new Date){this.value=r}};a([u({type:p.GeneralizedTime})],rs.prototype,"value",void 0),rs=a([w({type:m.Choice})],rs);let Jc=class extends Q{};Jc=a([w({type:m.Choice})],Jc);let is=class{constructor(r="M"){this.value=r}toString(){return this.value}};a([u({type:p.PrintableString})],is.prototype,"value",void 0),is=a([w({type:m.Choice})],is);let Ni=class{constructor(r=""){this.value=r}toString(){return this.value}};a([u({type:p.PrintableString})],Ni.prototype,"value",void 0),Ni=a([w({type:m.Choice})],Ni);let Yc=class extends Ni{};Yc=a([w({type:m.Choice})],Yc);let Zc=class extends Q{};Zc=a([w({type:m.Choice})],Zc);let ns=class{constructor(r=""){this.value=r}toString(){return this.value}};a([u({type:p.ObjectIdentifier})],ns.prototype,"value",void 0),ns=a([w({type:m.Choice})],ns);let Xc=class extends tt{};Xc=a([w({type:m.Choice})],Xc);let ss=class{constructor(r=0){this.value=r}toString(){return this.value.toString()}};a([u({type:p.Integer})],ss.prototype,"value",void 0),ss=a([w({type:m.Choice})],ss);let Qc=class extends Rt{};Qc=a([w({type:m.Sequence})],Qc);let Nn=class extends Q{};Nn=a([w({type:m.Choice})],Nn);let tu=$o=class extends ne{constructor(r){super(r),Object.setPrototypeOf(this,$o.prototype)}};tu=$o=a([w({type:m.Sequence})],tu);let eu=Fo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Fo.prototype)}};eu=Fo=a([w({type:m.Set,itemType:Xe})],eu);let os=class{constructor(r=""){this.value=r}toString(){return this.value}};a([u({type:p.BmpString})],os.prototype,"value",void 0),os=a([w({type:m.Choice})],os);let Ko=class extends B{};Ko=a([w({type:m.Sequence})],Ko);let ru=Wo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Wo.prototype)}};ru=Wo=a([w({type:m.Sequence,itemType:Ko})],ru);var zo;let In=zo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,zo.prototype)}};In=zo=a([w({type:m.Sequence,itemType:Nt})],In);class fe{constructor(t={}){this.version=0,this.subject=new G,this.subjectPKInfo=new Ot,this.attributes=new In,Object.assign(this,t)}}a([u({type:p.Integer})],fe.prototype,"version",void 0),a([u({type:G})],fe.prototype,"subject",void 0),a([u({type:Ot})],fe.prototype,"subjectPKInfo",void 0),a([u({type:In,implicit:!0,context:0,optional:!0})],fe.prototype,"attributes",void 0);class _e{constructor(t={}){this.certificationRequestInfo=new fe,this.signatureAlgorithm=new B,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}a([u({type:fe,raw:!0})],_e.prototype,"certificationRequestInfo",void 0),a([u({type:B})],_e.prototype,"signatureAlgorithm",void 0),a([u({type:p.BitString})],_e.prototype,"signature",void 0);const ri="crypto.algorithm";class ef{getAlgorithms(){return rt.resolveAll(ri)}toAsnAlgorithm(t){({...t});for(const e of this.getAlgorithms()){const n=e.toAsnAlgorithm(t);if(n)return n}if(/^[0-9.]+$/.test(t.name)){const e=new B({algorithm:t.name});if("parameters"in t){const n=t;e.parameters=n.parameters}return e}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(t){for(const e of this.getAlgorithms()){const n=e.toWebAlgorithm(t);if(n)return n}return{name:t.algorithm,parameters:t.parameters}}}const Se="crypto.algorithmProvider";rt.registerSingleton(Se,ef);var Ii;const pt="1.3.36.3.3.2.8.1.1",iu=`${pt}.1`,nu=`${pt}.2`,su=`${pt}.3`,ou=`${pt}.4`,au=`${pt}.5`,cu=`${pt}.6`,uu=`${pt}.7`,lu=`${pt}.8`,hu=`${pt}.9`,pu=`${pt}.10`,fu=`${pt}.11`,yu=`${pt}.12`,du=`${pt}.13`,gu=`${pt}.14`,vu="brainpoolP160r1",mu="brainpoolP160t1",wu="brainpoolP192r1",bu="brainpoolP192t1",Au="brainpoolP224r1",Su="brainpoolP224t1",ku="brainpoolP256r1",Bu="brainpoolP256t1",xu="brainpoolP320r1",Cu="brainpoolP320t1",Ou="brainpoolP384r1",Eu="brainpoolP384t1",Nu="brainpoolP512r1",Iu="brainpoolP512t1",z="ECDSA";let dr=Ii=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case z.toLowerCase():if("hash"in r)switch((typeof r.hash=="string"?r.hash:r.hash.name).toLowerCase()){case"sha-1":return xp;case"sha-256":return Cp;case"sha-384":return Op;case"sha-512":return Ep}else if("namedCurve"in r){let t="";switch(r.namedCurve){case"P-256":t=Ic;break;case"K-256":t=Ii.SECP256K1;break;case"P-384":t=Tc;break;case"P-521":t=jc;break;case vu:t=iu;break;case mu:t=nu;break;case wu:t=su;break;case bu:t=ou;break;case Au:t=au;break;case Su:t=cu;break;case ku:t=uu;break;case Bu:t=lu;break;case xu:t=hu;break;case Cu:t=pu;break;case Ou:t=fu;break;case Eu:t=yu;break;case Nu:t=du;break;case Iu:t=gu;break}if(t)return new B({algorithm:Zr,parameters:b.serialize(new Xt({namedCurve:t}))})}}return null}toWebAlgorithm(r){switch(r.algorithm){case Xo:return{name:z,hash:{name:"SHA-1"}};case Qo:return{name:z,hash:{name:"SHA-256"}};case ta:return{name:z,hash:{name:"SHA-384"}};case ea:return{name:z,hash:{name:"SHA-512"}};case Zr:{if(!r.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(b.parse(r.parameters,Xt).namedCurve){case Ic:return{name:z,namedCurve:"P-256"};case Ii.SECP256K1:return{name:z,namedCurve:"K-256"};case Tc:return{name:z,namedCurve:"P-384"};case jc:return{name:z,namedCurve:"P-521"};case iu:return{name:z,namedCurve:vu};case nu:return{name:z,namedCurve:mu};case su:return{name:z,namedCurve:wu};case ou:return{name:z,namedCurve:bu};case au:return{name:z,namedCurve:Au};case cu:return{name:z,namedCurve:Su};case uu:return{name:z,namedCurve:ku};case lu:return{name:z,namedCurve:Bu};case hu:return{name:z,namedCurve:xu};case pu:return{name:z,namedCurve:Cu};case fu:return{name:z,namedCurve:Ou};case yu:return{name:z,namedCurve:Eu};case du:return{name:z,namedCurve:Nu};case gu:return{name:z,namedCurve:Iu}}}}return null}};dr.SECP256K1="1.3.132.0.10",dr=Ii=a([Ln()],dr),rt.registerSingleton(ri,dr);const Ul=Symbol("name"),Pl=Symbol("value");class M{constructor(t,e={},n=""){this[Ul]=t,this[Pl]=n;for(const i in e)this[i]=e[i]}}M.NAME=Ul,M.VALUE=Pl;class rf{static toTextObject(t){const e=new M("Algorithm Identifier",{},se.toString(t.algorithm));if(t.parameters)switch(t.algorithm){case Zr:{const n=new dr().toWebAlgorithm(t);n&&"namedCurve"in n?e["Named Curve"]=n.namedCurve:e.Parameters=t.parameters;break}default:e.Parameters=t.parameters}return e}}class se{static toString(t){return this.items[t]||t}}se.items={[An]:"sha1",[kl]:"sha224",[Sn]:"sha256",[kn]:"sha384",[Bn]:"sha512",[be]:"rsaEncryption",[mn]:"sha1WithRSAEncryption",[Pp]:"sha224WithRSAEncryption",[Eo]:"sha256WithRSAEncryption",[wn]:"sha384WithRSAEncryption",[bn]:"sha512WithRSAEncryption",[Zr]:"ecPublicKey",[Xo]:"ecdsaWithSHA1",[Sl]:"ecdsaWithSHA224",[Qo]:"ecdsaWithSHA256",[ta]:"ecdsaWithSHA384",[ea]:"ecdsaWithSHA512",[mp]:"TLS WWW server authentication",[wp]:"TLS WWW client authentication",[bp]:"Code Signing",[Ap]:"E-mail Protection",[Sp]:"Time Stamping",[kp]:"OCSP Signing",[Bp]:"Signed Data"};class ke{static serialize(t){return this.serializeObj(t).join(`
`)}static pad(t=0){return"".padStart(2*t," ")}static serializeObj(t,e=0){const n=[];let i=this.pad(e++),s="";const o=t[M.VALUE];o&&(s=` ${o}`),n.push(`${i}${t[M.NAME]}:${s}`),i=this.pad(e);for(const c in t){if(typeof c=="symbol")continue;const l=t[c],h=c?`${c}: `:"";if(typeof l=="string"||typeof l=="number"||typeof l=="boolean")n.push(`${i}${h}${l}`);else if(l instanceof Date)n.push(`${i}${h}${l.toUTCString()}`);else if(Array.isArray(l))for(const g of l)g[M.NAME]=c,n.push(...this.serializeObj(g,e));else if(l instanceof M)l[M.NAME]=c,n.push(...this.serializeObj(l,e));else if(S.isBufferSource(l))c?(n.push(`${i}${h}`),n.push(...this.serializeBufferSource(l,e+1))):n.push(...this.serializeBufferSource(l,e));else if("toTextObject"in l){const g=l.toTextObject();g[M.NAME]=c,n.push(...this.serializeObj(g,e))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return n}static serializeBufferSource(t,e=0){const n=this.pad(e),i=S.toUint8Array(t),s=[];for(let o=0;o<i.length;){const c=[];for(let l=0;l<16&&o<i.length;l++){l===8&&c.push("");const h=i[o++].toString(16).padStart(2,"0");c.push(h)}s.push(`${n}${c.join(" ")}`)}return s}static serializeAlgorithm(t){return this.algorithmSerializer.toTextObject(t)}}ke.oidSerializer=se,ke.algorithmSerializer=rf;var Ue;class oe{get rawData(){return R(this,Ue,"f")||K(this,Ue,b.serialize(this.asn),"f"),R(this,Ue,"f")}constructor(...t){Ue.set(this,void 0),S.isBufferSource(t[0])?(this.asn=b.parse(t[0],t[1]),K(this,Ue,S.toArrayBuffer(t[0]),"f"),this.onInit(this.asn)):(this.asn=t[0],this.onInit(this.asn))}equal(t){return t instanceof oe?Fu(t.rawData,this.rawData):!1}toString(t="text"){switch(t){case"asn":return b.toString(this.rawData);case"text":return ke.serialize(this.toTextObject());case"hex":return E.ToHex(this.rawData);case"base64":return E.ToBase64(this.rawData);case"base64url":return E.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const t=this.toTextObjectEmpty();return t[""]=this.rawData,t}toTextObjectEmpty(t){return new M(this.getTextName(),{},t)}}Ue=new WeakMap,oe.NAME="ASN";class vt extends oe{constructor(...t){let e;S.isBufferSource(t[0])?e=S.toArrayBuffer(t[0]):e=b.serialize(new bt({extnID:t[0],critical:t[1],extnValue:new D(S.toArrayBuffer(t[2]))})),super(e,bt)}onInit(t){this.type=t.extnID,this.critical=t.critical,this.value=t.extnValue.buffer}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.value,t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty(this.critical?"critical":void 0);return t[M.NAME]===vt.NAME&&(t[M.NAME]=se.toString(this.type)),t}}var Rl;class te{static isCryptoKeyPair(t){return t&&t.privateKey&&t.publicKey}static isCryptoKey(t){return t&&t.usages&&t.type&&t.algorithm&&t.extractable!==void 0}constructor(){this.items=new Map,this[Rl]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(te.DEFAULT,crypto):typeof ni<"u"&&ni.crypto&&ni.crypto.subtle&&this.set(te.DEFAULT,ni.crypto)}clear(){this.items.clear()}delete(t){return this.items.delete(t)}forEach(t,e){return this.items.forEach(t,e)}has(t){return this.items.has(t)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(t=te.DEFAULT){const e=this.items.get(t.toLowerCase());if(!e)throw new Error(`Cannot get Crypto by name '${t}'`);return e}set(t,e){if(typeof t=="string"){if(!e)throw new TypeError("Argument 'value' is required");this.items.set(t.toLowerCase(),e)}else this.items.set(te.DEFAULT,t);return this}}Rl=Symbol.toStringTag,te.DEFAULT="default";const nt=new te,nf=/^[0-2](?:\.[1-9][0-9]*)+$/;function sf(r){return new RegExp(nf).test(r)}class Vl{constructor(t={}){this.items={};for(const e in t)this.register(e,t[e])}get(t){return this.items[t]||null}findId(t){return sf(t)?t:this.get(t)}register(t,e){this.items[t]=e,this.items[e]=t}}const ut=new Vl;ut.register("CN","2.5.4.3"),ut.register("L","2.5.4.7"),ut.register("ST","2.5.4.8"),ut.register("O","2.5.4.10"),ut.register("OU","2.5.4.11"),ut.register("C","2.5.4.6"),ut.register("DC","0.9.2342.19200300.100.1.25"),ut.register("E","1.2.840.113549.1.9.1"),ut.register("G","2.5.4.42"),ut.register("I","2.5.4.43"),ut.register("SN","2.5.4.4"),ut.register("T","2.5.4.12");function of(r,t){return`\\${E.ToHex(E.FromUtf8String(t)).toUpperCase()}`}function af(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,of)}class _t{static isASCII(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!1;return!0}static isPrintableString(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(t)}constructor(t,e={}){this.extraNames=new Vl,this.asn=new G;for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];this.extraNames.register(n,i)}typeof t=="string"?this.asn=this.fromString(t):t instanceof G?this.asn=t:S.isBufferSource(t)?this.asn=b.parse(t,G):this.asn=this.fromJSON(t)}getField(t){const e=this.extraNames.findId(t)||ut.findId(t),n=[];for(const i of this.asn)for(const s of i)s.type===e&&n.push(s.value.toString());return n}getName(t){return this.extraNames.get(t)||ut.get(t)}toString(){return this.asn.map(t=>t.map(e=>{const n=this.getName(e.type)||e.type,i=e.value.anyValue?`#${E.ToHex(e.value.anyValue)}`:af(e.value.toString());return`${n}=${i}`}).join("+")).join(", ")}toJSON(){var t;const e=[];for(const n of this.asn){const i={};for(const s of n){const o=this.getName(s.type)||s.type;(t=i[o])!==null&&t!==void 0||(i[o]=[]),i[o].push(s.value.anyValue?`#${E.ToHex(s.value.anyValue)}`:s.value.toString())}e.push(i)}return e}fromString(t){const e=new G,n=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let i=null,s=",";for(;i=n.exec(`${t},`);){let[,o,c]=i;const l=c[c.length-1];(l===","||l==="+")&&(c=c.slice(0,c.length-1),i[3]=l);const h=i[3];o=this.getTypeOid(o);const g=this.createAttribute(o,c);s==="+"?e[e.length-1].push(g):e.push(new Je([g])),s=h}return e}fromJSON(t){const e=new G;for(const n of t){const i=new Je;for(const s in n){const o=this.getTypeOid(s),c=n[s];for(const l of c){const h=this.createAttribute(o,l);i.push(h)}}e.push(i)}return e}getTypeOid(t){if(/[\d.]+/.test(t)||(t=this.getName(t)||""),!t)throw new Error(`Cannot get OID for name type '${t}'`);return t}createAttribute(t,e){const n=new Ji({type:t});if(typeof e=="object")for(const i in e)switch(i){case"ia5String":n.value.ia5String=e[i];break;case"utf8String":n.value.utf8String=e[i];break;case"universalString":n.value.universalString=e[i];break;case"bmpString":n.value.bmpString=e[i];break;case"printableString":n.value.printableString=e[i];break}else if(e[0]==="#")n.value.anyValue=E.FromHex(e.slice(1));else{const i=this.processStringValue(e);t===this.getName("E")||t===this.getName("DC")?n.value.ia5String=i:_t.isPrintableString(i)?n.value.printableString=i:n.value.utf8String=i}return n}processStringValue(t){const e=/"(.*?[^\\])?"/.exec(t);return e&&(t=e[1]),t.replace(/\\0a/ig,`
`).replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return b.serialize(this.asn)}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||nt.get()):n=t[0]||nt.get(),await n.subtle.digest(i,this.toArrayBuffer())}}const Ll="Cannot initialize GeneralName from ASN.1 data.",Tu=`${Ll} Unsupported string format in use.`,cf=`${Ll} Value doesn't match to GUID regular expression.`,ju=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,Uu="1.3.6.1.4.1.311.25.1",Pu="1.3.6.1.4.1.311.20.2.3",as="dns",cs="dn",us="email",ls="ip",hs="url",ps="guid",fs="upn",hi="id";class ee extends oe{constructor(...t){let e;if(t.length===2)switch(t[0]){case cs:{const n=new _t(t[1]).toArrayBuffer(),i=b.parse(n,G);e=new U({directoryName:i});break}case as:e=new U({dNSName:t[1]});break;case us:e=new U({rfc822Name:t[1]});break;case ps:{const n=new RegExp(ju,"i").exec(t[1]);if(!n)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=n.slice(1).map((s,o)=>o<3?E.ToHex(new Uint8Array(E.FromHex(s)).reverse()):s).join("");e=new U({otherName:new Gr({typeId:Uu,value:b.serialize(new D(E.FromHex(i)))})});break}case ls:e=new U({iPAddress:t[1]});break;case hi:e=new U({registeredID:t[1]});break;case fs:{e=new U({otherName:new Gr({typeId:Pu,value:b.serialize(ll.toASN(t[1]))})});break}case hs:e=new U({uniformResourceIdentifier:t[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else S.isBufferSource(t[0])?e=b.parse(t[0],U):e=t[0];super(e)}onInit(t){if(t.dNSName!=null)this.type=as,this.value=t.dNSName;else if(t.rfc822Name!=null)this.type=us,this.value=t.rfc822Name;else if(t.iPAddress!=null)this.type=ls,this.value=t.iPAddress;else if(t.uniformResourceIdentifier!=null)this.type=hs,this.value=t.uniformResourceIdentifier;else if(t.registeredID!=null)this.type=hi,this.value=t.registeredID;else if(t.directoryName!=null)this.type=cs,this.value=new _t(t.directoryName).toString();else if(t.otherName!=null)if(t.otherName.typeId===Uu){this.type=ps;const e=b.parse(t.otherName.value,D),n=new RegExp(ju,"i").exec(E.ToHex(e));if(!n)throw new Error(cf);this.value=n.slice(1).map((i,s)=>s<3?E.ToHex(new Uint8Array(E.FromHex(i)).reverse()):i).join("-")}else if(t.otherName.typeId===Pu)this.type=fs,this.value=b.parse(t.otherName.value,Q).toString();else throw new Error(Tu);else throw new Error(Tu)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let t;switch(this.type){case cs:case as:case ps:case ls:case hi:case fs:case hs:t=this.type.toUpperCase();break;case us:t="Email";break;default:throw new Error("Unsupported GeneralName type")}let e=this.value;return this.type===hi&&(e=se.toString(e)),new M(t,void 0,e)}}class Be extends oe{constructor(t){let e;if(t instanceof st)e=t;else if(Array.isArray(t)){const n=[];for(const i of t)if(i instanceof U)n.push(i);else{const s=b.parse(new ee(i.type,i.value).rawData,U);n.push(s)}e=new st(n)}else if(S.isBufferSource(t))e=b.parse(t,st);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(e)}onInit(t){const e=[];for(const n of t){let i=null;try{i=new ee(n)}catch{continue}e.push(i)}this.items=e}toJSON(){return this.items.map(t=>t.toJSON())}toTextObject(){const t=super.toTextObjectEmpty();for(const e of this.items){const n=e.toTextObject();let i=t[n[M.NAME]];Array.isArray(i)||(i=[],t[n[M.NAME]]=i),i.push(n)}return t}}Be.NAME="GeneralNames";const Wr="-{5}",Xr="\\n",uf=`[^${Xr}]+`,lf=`${Wr}BEGIN (${uf}(?=${Wr}))${Wr}`,hf=`${Wr}END \\1${Wr}`,tr="\\n",pf=`[^:${Xr}]+`,ff=`(?:[^${Xr}]+${tr}(?: +[^${Xr}]+${tr})*)`,yf="[a-zA-Z0-9=+/]+",df=`(?:${yf}${tr})+`,Ru=`${lf}${tr}(?:((?:${pf}: ${ff})+))?${tr}?(${df})${hf}`;class dt{static isPem(t){return typeof t=="string"&&new RegExp(Ru,"g").test(t.replace(/\r/g,""))}static decodeWithHeaders(t){t=t.replace(/\r/g,"");const e=new RegExp(Ru,"g"),n=[];let i=null;for(;i=e.exec(t);){const s=i[3].replace(new RegExp(`[${Xr}]+`,"g"),""),o={type:i[1],headers:[],rawData:E.FromBase64(s)},c=i[2];if(c){const l=c.split(new RegExp(tr,"g"));let h=null;for(const g of l){const[y,T]=g.split(/:(.*)/);if(T===void 0){if(!h)throw new Error("Cannot parse PEM string. Incorrect header value");h.value+=y.trim()}else h&&o.headers.push(h),h={key:y,value:T.trim()}}h&&o.headers.push(h)}n.push(o)}return n}static decode(t){return this.decodeWithHeaders(t).map(e=>e.rawData)}static decodeFirst(t){const e=this.decode(t);if(!e.length)throw new RangeError("PEM string doesn't contain any objects");return e[0]}static encode(t,e){if(Array.isArray(t)){const n=new Array;return e?t.forEach(i=>{if(!S.isBufferSource(i))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");n.push(this.encodeStruct({type:e,rawData:S.toArrayBuffer(i)}))}):t.forEach(i=>{if(!("type"in i))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");n.push(this.encodeStruct(i))}),n.join(`
`)}else{if(!e)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:e,rawData:S.toArrayBuffer(t)})}}static encodeStruct(t){var e;const n=t.type.toLocaleUpperCase(),i=[];if(i.push(`-----BEGIN ${n}-----`),!((e=t.headers)===null||e===void 0)&&e.length){for(const h of t.headers)i.push(`${h.key}: ${h.value}`);i.push("")}const s=E.ToBase64(t.rawData);let o,c=0;const l=Array();for(;c<s.length&&(s.length-c<64?o=s.substring(c):(o=s.substring(c,c+64),c+=64),o.length!==0)&&(l.push(o),!(o.length<64)););return i.push(...l),i.push(`-----END ${n}-----`),i.join(`
`)}}dt.CertificateTag="CERTIFICATE",dt.CrlTag="CRL",dt.CertificateRequestTag="CERTIFICATE REQUEST",dt.PublicKeyTag="PUBLIC KEY",dt.PrivateKeyTag="PRIVATE KEY";class qt extends oe{static isAsnEncoded(t){return S.isBufferSource(t)||typeof t=="string"}static toArrayBuffer(t){if(typeof t=="string"){if(dt.isPem(t))return dt.decode(t)[0];if(E.isHex(t))return E.FromHex(t);if(E.isBase64(t))return E.FromBase64(t);if(E.isBase64Url(t))return E.FromBase64Url(t);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const e=S.toUint8Array(t);if(e.length>0&&e[0]===48)return S.toArrayBuffer(t);const n=E.ToBinary(t);if(dt.isPem(n))return dt.decode(n)[0];if(E.isHex(n))return E.FromHex(n);if(E.isBase64(n))return E.FromBase64(n);if(E.isBase64Url(n))return E.FromBase64Url(n);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...t){qt.isAsnEncoded(t[0])?super(qt.toArrayBuffer(t[0]),t[1]):super(t[0])}toString(t="pem"){switch(t){case"pem":return dt.encode(this.rawData,this.tag);default:return super.toString(t)}}}class Lt extends qt{static async create(t,e=nt.get()){if(t instanceof Lt)return t;if(te.isCryptoKey(t)){if(t.type!=="public")throw new TypeError("Public key is required");const n=await e.subtle.exportKey("spki",t);return new Lt(n)}else{if(t.publicKey)return t.publicKey;if(S.isBufferSource(t))return new Lt(t);throw new TypeError("Unsupported PublicKeyType")}}constructor(t){qt.isAsnEncoded(t)?super(t,Ot):super(t),this.tag=dt.PublicKeyTag}async export(...t){let e,n=["verify"],i={hash:"SHA-256",...this.algorithm};t.length>1?(i=t[0]||i,n=t[1]||n,e=t[2]||nt.get()):e=t[0]||nt.get();let s=this.rawData;const o=b.parse(this.rawData,Ot);return o.algorithm.algorithm===$r&&(s=gf(o,s)),e.subtle.importKey("spki",s,i,!0,n)}onInit(t){const e=rt.resolve(Se),n=this.algorithm=e.toWebAlgorithm(t.algorithm);switch(t.algorithm.algorithm){case be:{const i=b.parse(t.subjectPublicKey,To),s=S.toUint8Array(i.modulus);n.publicExponent=S.toUint8Array(i.publicExponent),n.modulusLength=(s[0]?s:s.slice(1)).byteLength<<3;break}}}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||nt.get()):n=t[0]||nt.get(),await n.subtle.digest(i,this.rawData)}async getKeyIdentifier(...t){let e,n="SHA-1";t.length===1?typeof t[0]=="string"?(n=t[0],e=nt.get()):e=t[0]:t.length===2?(n=t[0],e=t[1]):e=nt.get();const i=b.parse(this.rawData,Ot);return await e.subtle.digest(n,i.subjectPublicKey)}toTextObject(){const t=this.toTextObjectEmpty(),e=b.parse(this.rawData,Ot);switch(t.Algorithm=ke.serializeAlgorithm(e.algorithm),e.algorithm.algorithm){case Zr:t["EC Point"]=e.subjectPublicKey;break;case be:default:t["Raw Data"]=e.subjectPublicKey}return t}}function gf(r,t){return r.algorithm=new B({algorithm:be,parameters:null}),t=b.serialize(r),t}class Qr extends vt{static async create(t,e=!1,n=nt.get()){if("name"in t&&"serialNumber"in t)return new Qr(t,e);const i=await(await Lt.create(t,n)).getKeyIdentifier(n);return new Qr(E.ToHex(i),e)}constructor(...t){if(S.isBufferSource(t[0]))super(t[0]);else if(typeof t[0]=="string"){const e=new le({keyIdentifier:new Zo(E.FromHex(t[0]))});super(Hs,t[1],b.serialize(e))}else{const e=t[0],n=e.name instanceof Be?b.parse(e.name.rawData,st):e.name,i=new le({authorityCertIssuer:n,authorityCertSerialNumber:E.FromHex(e.serialNumber)});super(Hs,t[1],b.serialize(i))}}onInit(t){super.onInit(t);const e=b.parse(t.extnValue,le);e.keyIdentifier&&(this.keyId=E.ToHex(e.keyIdentifier)),(e.authorityCertIssuer||e.authorityCertSerialNumber)&&(this.certId={name:e.authorityCertIssuer||[],serialNumber:e.authorityCertSerialNumber?E.ToHex(e.authorityCertSerialNumber):""})}toTextObject(){const t=this.toTextObjectWithoutValue(),e=b.parse(this.value,le);return e.authorityCertIssuer&&(t["Authority Issuer"]=new Be(e.authorityCertIssuer).toTextObject()),e.authorityCertSerialNumber&&(t["Authority Serial Number"]=e.authorityCertSerialNumber),e.keyIdentifier&&(t[""]=e.keyIdentifier),t}}Qr.NAME="Authority Key Identifier";class Hl extends vt{constructor(...t){if(S.isBufferSource(t[0])){super(t[0]);const e=b.parse(this.value,Yi);this.ca=e.cA,this.pathLength=e.pathLenConstraint}else{const e=new Yi({cA:t[0],pathLenConstraint:t[1]});super(pl,t[2],b.serialize(e)),this.ca=t[0],this.pathLength=t[1]}}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ca&&(t.CA=this.ca),this.pathLength!==void 0&&(t["Path Length"]=this.pathLength),t}}Hl.NAME="Basic Constraints";var Vu;(function(r){r.serverAuth="1.3.6.1.5.5.7.3.1",r.clientAuth="1.3.6.1.5.5.7.3.2",r.codeSigning="1.3.6.1.5.5.7.3.3",r.emailProtection="1.3.6.1.5.5.7.3.4",r.timeStamping="1.3.6.1.5.5.7.3.8",r.ocspSigning="1.3.6.1.5.5.7.3.9"})(Vu||(Vu={}));class Dl extends vt{constructor(...t){if(S.isBufferSource(t[0])){super(t[0]);const e=b.parse(this.value,Qi);this.usages=e.map(n=>n)}else{const e=new Qi(t[0]);super(dl,t[1],b.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.usages.map(e=>se.toString(e)).join(", "),t}}Dl.NAME="Extended Key Usages";var Lu;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Lu||(Lu={}));class Ml extends vt{constructor(...t){if(S.isBufferSource(t[0])){super(t[0]);const e=b.parse(this.value,Yn);this.usages=e.toNumber()}else{const e=new Yn(t[0]);super(vl,t[1],b.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=b.parse(this.value,Yn);return t[""]=e.toJSON().join(", "),t}}Ml.NAME="Key Usages";class Dn extends vt{static async create(t,e=!1,n=nt.get()){const i=await(await Lt.create(t,n)).getKeyIdentifier(n);return new Dn(E.ToHex(i),e)}constructor(...t){if(S.isBufferSource(t[0])){super(t[0]);const e=b.parse(this.value,ie);this.keyId=E.ToHex(e)}else{const e=typeof t[0]=="string"?E.FromHex(t[0]):t[0],n=new ie(e);super(wl,t[1],b.serialize(n)),this.keyId=E.ToHex(e)}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=b.parse(this.value,ie);return t[""]=e,t}}Dn.NAME="Subject Key Identifier";class $l extends vt{constructor(...t){S.isBufferSource(t[0])?super(t[0]):super(ml,t[1],new Be(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=b.parse(t.extnValue,to);this.names=new Be(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const n in e)t[n]=e[n];return t}}$l.NAME="Subject Alternative Name";class ft{static register(t,e){this.items.set(t,e)}static create(t){const e=new vt(t),n=this.items.get(e.type);return n?new n(t):e}}ft.items=new Map;class Hu extends vt{constructor(...t){var e;if(S.isBufferSource(t[0])){super(t[0]);const n=b.parse(this.value,Xi);this.policies=n.map(i=>i.policyIdentifier)}else{const n=t[0],i=(e=t[1])!==null&&e!==void 0?e:!1,s=new Xi(n.map(o=>new Zi({policyIdentifier:o})));super(fl,i,b.serialize(s)),this.policies=n}}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Policy=this.policies.map(e=>new M("",{},se.toString(e))),t}}Hu.NAME="Certificate Policies",ft.register(fl,Hu);class Fl extends vt{constructor(...t){var e;if(S.isBufferSource(t[0]))super(t[0]);else if(Array.isArray(t[0])&&typeof t[0][0]=="string"){const n=t[0].map(s=>new We({distributionPoint:new he({fullName:[new U({uniformResourceIdentifier:s})]})})),i=new Ke(n);super(_s,t[1],b.serialize(i))}else{const n=new Ke(t[0]);super(_s,t[1],b.serialize(n))}(e=this.distributionPoints)!==null&&e!==void 0||(this.distributionPoints=[])}onInit(t){super.onInit(t);const e=b.parse(t.extnValue,Ke);this.distributionPoints=e}toTextObject(){const t=this.toTextObjectWithoutValue();return t["Distribution Point"]=this.distributionPoints.map(e=>{var n;const i={};return e.distributionPoint&&(i[""]=(n=e.distributionPoint.fullName)===null||n===void 0?void 0:n.map(s=>new ee(s).toString()).join(", ")),e.reasons&&(i.Reasons=e.reasons.toString()),e.cRLIssuer&&(i["CRL Issuer"]=e.cRLIssuer.map(s=>s.toString()).join(", ")),i}),t}}Fl.NAME="CRL Distribution Points";class Wl extends vt{constructor(...t){var e,n,i,s;if(S.isBufferSource(t[0]))super(t[0]);else if(t[0]instanceof Le){const o=new Le(t[0]);super(Ls,t[1],b.serialize(o))}else{const o=t[0],c=new Le;fi(c,o,uc,"ocsp"),fi(c,o,lc,"caIssuers"),fi(c,o,hc,"timeStamping"),fi(c,o,pc,"caRepository"),super(Ls,t[1],b.serialize(c))}(e=this.ocsp)!==null&&e!==void 0||(this.ocsp=[]),(n=this.caIssuers)!==null&&n!==void 0||(this.caIssuers=[]),(i=this.timeStamping)!==null&&i!==void 0||(this.timeStamping=[]),(s=this.caRepository)!==null&&s!==void 0||(this.caRepository=[])}onInit(t){super.onInit(t),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],b.parse(t.extnValue,Le).forEach(e=>{switch(e.accessMethod){case uc:this.ocsp.push(new ee(e.accessLocation));break;case lc:this.caIssuers.push(new ee(e.accessLocation));break;case hc:this.timeStamping.push(new ee(e.accessLocation));break;case pc:this.caRepository.push(new ee(e.accessLocation));break}})}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ocsp.length&&pi(t,"OCSP",this.ocsp),this.caIssuers.length&&pi(t,"CA Issuers",this.caIssuers),this.timeStamping.length&&pi(t,"Time Stamping",this.timeStamping),this.caRepository.length&&pi(t,"CA Repository",this.caRepository),t}}Wl.NAME="Authority Info Access";function pi(r,t,e){if(e.length===1)r[t]=e[0].toTextObject();else{const n=new M("");e.forEach((i,s)=>{const o=i.toTextObject(),c=`${o[M.NAME]} ${s+1}`;let l=n[c];Array.isArray(l)||(l=[],n[c]=l),l.push(o)}),r[t]=n}}function fi(r,t,e,n){const i=t[n];i&&(Array.isArray(i)?i:[i]).forEach(s=>{typeof s=="string"&&(s=new ee("url",s)),r.push(new Jr({accessMethod:e,accessLocation:b.parse(s.rawData,U)}))})}class Kl extends vt{constructor(...t){S.isBufferSource(t[0])?super(t[0]):super(gl,t[1],new Be(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=b.parse(t.extnValue,st);this.names=new Be(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const n in e)t[n]=e[n];return t}}Kl.NAME="Issuer Alternative Name";class ir extends oe{constructor(...t){let e;if(S.isBufferSource(t[0]))e=S.toArrayBuffer(t[0]);else{const n=t[0],i=Array.isArray(t[1])?t[1].map(s=>S.toArrayBuffer(s)):[];e=b.serialize(new Nt({type:n,values:i}))}super(e,Nt)}onInit(t){this.type=t.type,this.values=t.values}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Value=this.values.map(e=>new M("",{"":e})),t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty();return t[M.NAME]===ir.NAME&&(t[M.NAME]=se.toString(this.type)),t}}ir.NAME="Attribute";class zl extends ir{constructor(...t){var e;if(S.isBufferSource(t[0]))super(t[0]);else{const n=new Nn({printableString:t[0]});super(jl,[b.serialize(n)])}(e=this.password)!==null&&e!==void 0||(this.password="")}onInit(t){if(super.onInit(t),this.values[0]){const e=b.parse(this.values[0],Nn);this.password=e.toString()}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[M.VALUE]=this.password,t}}zl.NAME="Challenge Password";class na extends ir{constructor(...t){var e;if(S.isBufferSource(t[0]))super(t[0]);else{const n=t[0],i=new ne;for(const s of n)i.push(b.parse(s.rawData,bt));super(Hn,[b.serialize(i)])}(e=this.items)!==null&&e!==void 0||(this.items=[])}onInit(t){if(super.onInit(t),this.values[0]){const e=b.parse(this.values[0],ne);this.items=e.map(n=>ft.create(b.serialize(n)))}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.items.map(n=>n.toTextObject());for(const n of e)t[n[M.NAME]]=n;return t}}na.NAME="Extensions";class Tn{static register(t,e){this.items.set(t,e)}static create(t){const e=new ir(t),n=this.items.get(e.type);return n?new n(t):e}}Tn.items=new Map;const ti="crypto.signatureFormatter";class vf{toAsnSignature(t,e){return S.toArrayBuffer(e)}toWebSignature(t,e){return S.toArrayBuffer(e)}}var Ti;let ys=Ti=class{static createPssParams(r,t){const e=Ti.getHashAlgorithm(r);return e?new ce({hashAlgorithm:e,maskGenAlgorithm:new B({algorithm:Vn,parameters:b.serialize(e)}),saltLength:t}):null}static getHashAlgorithm(r){const t=rt.resolve(Se);return typeof r=="string"?t.toAsnAlgorithm({name:r}):typeof r=="object"&&r&&"name"in r?t.toAsnAlgorithm(r):null}toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in r){let t;if(typeof r.hash=="string")t=r.hash;else if(r.hash&&typeof r.hash=="object"&&"name"in r.hash&&typeof r.hash.name=="string")t=r.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new B({algorithm:mn,parameters:null});case"sha-256":return new B({algorithm:Eo,parameters:null});case"sha-384":return new B({algorithm:wn,parameters:null});case"sha-512":return new B({algorithm:bn,parameters:null})}}else return new B({algorithm:be,parameters:null});break;case"rsa-pss":if("hash"in r){if(!("saltLength"in r&&typeof r.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=Ti.createPssParams(r.hash,r.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new B({algorithm:$r,parameters:b.serialize(t)})}else return new B({algorithm:$r,parameters:null})}return null}toWebAlgorithm(r){switch(r.algorithm){case be:return{name:"RSASSA-PKCS1-v1_5"};case mn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case Eo:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case wn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case bn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case $r:if(r.parameters){const t=b.parse(r.parameters,ce);return{name:"RSA-PSS",hash:rt.resolve(Se).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}else return{name:"RSA-PSS"}}return null}};ys=Ti=a([Ln()],ys),rt.registerSingleton(ri,ys);let ds=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"sha-1":return new B({algorithm:An});case"sha-256":return new B({algorithm:Sn});case"sha-384":return new B({algorithm:kn});case"sha-512":return new B({algorithm:Bn})}return null}toWebAlgorithm(r){switch(r.algorithm){case An:return{name:"SHA-1"};case Sn:return{name:"SHA-256"};case kn:return{name:"SHA-384"};case Bn:return{name:"SHA-512"}}return null}};ds=a([Ln()],ds),rt.registerSingleton(ri,ds);class At{addPadding(t,e){const n=S.toUint8Array(e),i=new Uint8Array(t);return i.set(n,t-n.length),i.buffer}removePadding(t,e=!1){let n=S.toUint8Array(t);for(let i=0;i<n.length;i++)if(n[i]){n=n.slice(i);break}if(e&&n[0]>127){const i=new Uint8Array(n.length+1);return i.set(n,1),i.buffer}return n.buffer}toAsnSignature(t,e){if(t.name==="ECDSA"){const n=t.namedCurve,i=At.namedCurveSize.get(n)||At.defaultNamedCurveSize,s=new vn,o=S.toUint8Array(e);return s.r=this.removePadding(o.slice(0,i),!0),s.s=this.removePadding(o.slice(i,i+i),!0),b.serialize(s)}return null}toWebSignature(t,e){if(t.name==="ECDSA"){const n=b.parse(e,vn),i=t.namedCurve,s=At.namedCurveSize.get(i)||At.defaultNamedCurveSize,o=this.addPadding(s,this.removePadding(n.r)),c=this.addPadding(s,this.removePadding(n.s));return Eh(o,c)}return null}}At.namedCurveSize=new Map,At.defaultNamedCurveSize=32;const gs="1.3.101.110",Du="1.3.101.111",vs="1.3.101.112",Mu="1.3.101.113";let ms=class{toAsnAlgorithm(r){let t=null;switch(r.name.toLowerCase()){case"ed25519":t=vs;break;case"x25519":t=gs;break;case"eddsa":switch(r.namedCurve.toLowerCase()){case"ed25519":t=vs;break;case"ed448":t=Mu;break}break;case"ecdh-es":switch(r.namedCurve.toLowerCase()){case"x25519":t=gs;break;case"x448":t=Du;break}}return t?new B({algorithm:t}):null}toWebAlgorithm(r){switch(r.algorithm){case vs:return{name:"Ed25519"};case Mu:return{name:"EdDSA",namedCurve:"Ed448"};case gs:return{name:"X25519"};case Du:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};ms=a([Ln()],ms),rt.registerSingleton(ri,ms);var gr,vr,mr,wr,br,Ar,Sr,Pe;class _l extends qt{get subjectName(){return R(this,vr,"f")||K(this,vr,new _t(this.asn.certificationRequestInfo.subject),"f"),R(this,vr,"f")}get subject(){return R(this,mr,"f")||K(this,mr,this.subjectName.toString(),"f"),R(this,mr,"f")}get signatureAlgorithm(){if(!R(this,wr,"f")){const t=rt.resolve(Se);K(this,wr,t.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return R(this,wr,"f")}get signature(){return R(this,br,"f")||K(this,br,this.asn.signature,"f"),R(this,br,"f")}get publicKey(){return R(this,Ar,"f")||K(this,Ar,new Lt(this.asn.certificationRequestInfo.subjectPKInfo),"f"),R(this,Ar,"f")}get attributes(){return R(this,Sr,"f")||K(this,Sr,this.asn.certificationRequestInfo.attributes.map(t=>Tn.create(b.serialize(t))),"f"),R(this,Sr,"f")}get extensions(){if(!R(this,Pe,"f")){K(this,Pe,[],"f");const t=this.getAttribute(Hn);t instanceof na&&K(this,Pe,t.items,"f")}return R(this,Pe,"f")}get tbs(){return R(this,gr,"f")||K(this,gr,this.asn.certificationRequestInfoRaw||b.serialize(this.asn.certificationRequestInfo),"f"),R(this,gr,"f")}constructor(t){const e=qt.isAsnEncoded(t)?[t,_e]:[t];super(e[0],e[1]),gr.set(this,void 0),vr.set(this,void 0),mr.set(this,void 0),wr.set(this,void 0),br.set(this,void 0),Ar.set(this,void 0),Sr.set(this,void 0),Pe.set(this,void 0),this.tag=dt.CertificateRequestTag}onInit(t){}getAttribute(t){for(const e of this.attributes)if(e.type===t)return e;return null}getAttributes(t){return this.attributes.filter(e=>e.type===t)}getExtension(t){for(const e of this.extensions)if(e.type===t)return e;return null}getExtensions(t){return this.extensions.filter(e=>e.type===t)}async verify(t=nt.get()){const e={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(e,["verify"],t),i=rt.resolveAll(ti).reverse();let s=null;for(const o of i)if(s=o.toWebSignature(e,this.signature),s)break;if(!s)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await t.subtle.verify(this.signatureAlgorithm,n,s,this.tbs)}toTextObject(){const t=this.toTextObjectEmpty(),e=b.parse(this.rawData,_e),n=e.certificationRequestInfo,i=new M("",{Version:`${Ye[n.version]} (${n.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const s=new M("");for(const o of this.attributes){const c=o.toTextObject();s[c[M.NAME]]=c}i.Attributes=s}return t.Data=i,t.Signature=new M("",{Algorithm:ke.serializeAlgorithm(e.signatureAlgorithm),"":e.signature}),t}}gr=new WeakMap,vr=new WeakMap,mr=new WeakMap,wr=new WeakMap,br=new WeakMap,Ar=new WeakMap,Sr=new WeakMap,Pe=new WeakMap,_l.NAME="PKCS#10 Certificate Request";class If{static async create(t,e=nt.get()){if(!t.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!t.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'publicKey' is empty");const n=await e.subtle.exportKey("spki",t.keys.publicKey),i=new _e({certificationRequestInfo:new fe({subjectPKInfo:b.parse(n,Ot)})});if(t.name){const y=t.name instanceof _t?t.name:new _t(t.name);i.certificationRequestInfo.subject=b.parse(y.toArrayBuffer(),G)}if(t.attributes)for(const y of t.attributes)i.certificationRequestInfo.attributes.push(b.parse(y.rawData,Nt));if(t.extensions&&t.extensions.length){const y=new Nt({type:Hn}),T=new ne;for(const H of t.extensions)T.push(b.parse(H.rawData,bt));y.values.push(b.serialize(T)),i.certificationRequestInfo.attributes.push(y)}const s={...t.signingAlgorithm,...t.keys.privateKey.algorithm},o=rt.resolve(Se);i.signatureAlgorithm=o.toAsnAlgorithm(s);const c=b.serialize(i.certificationRequestInfo),l=await e.subtle.sign(s,t.keys.privateKey,c),h=rt.resolveAll(ti).reverse();let g=null;for(const y of h)if(g=y.toAsnSignature(s,l),g)break;if(!g)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return i.signature=g,new _l(b.serialize(i))}}var kr,Br,xr,Cr,Or,Er,Nr,Ir,Tr,jr,Re,Ur;class mf extends qt{get publicKey(){return R(this,Ur,"f")||K(this,Ur,new Lt(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),R(this,Ur,"f")}get serialNumber(){if(!R(this,Br,"f")){const t=this.asn.tbsCertificate;let e=new Uint8Array(t.serialNumber);e.length>1&&e[0]===0&&e[1]>127&&(e=e.slice(1)),K(this,Br,E.ToHex(e),"f")}return R(this,Br,"f")}get subjectName(){return R(this,xr,"f")||K(this,xr,new _t(this.asn.tbsCertificate.subject),"f"),R(this,xr,"f")}get subject(){return R(this,Cr,"f")||K(this,Cr,this.subjectName.toString(),"f"),R(this,Cr,"f")}get issuerName(){return R(this,Or,"f")||K(this,Or,new _t(this.asn.tbsCertificate.issuer),"f"),R(this,Or,"f")}get issuer(){return R(this,Er,"f")||K(this,Er,this.issuerName.toString(),"f"),R(this,Er,"f")}get notBefore(){if(!R(this,Nr,"f")){const t=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!t)throw new Error("Cannot get 'notBefore' value");K(this,Nr,t,"f")}return R(this,Nr,"f")}get notAfter(){if(!R(this,Ir,"f")){const t=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!t)throw new Error("Cannot get 'notAfter' value");K(this,Ir,t,"f")}return R(this,Ir,"f")}get signatureAlgorithm(){if(!R(this,Tr,"f")){const t=rt.resolve(Se);K(this,Tr,t.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return R(this,Tr,"f")}get signature(){return R(this,jr,"f")||K(this,jr,this.asn.signatureValue,"f"),R(this,jr,"f")}get extensions(){return R(this,Re,"f")||(K(this,Re,[],"f"),this.asn.tbsCertificate.extensions&&K(this,Re,this.asn.tbsCertificate.extensions.map(t=>ft.create(b.serialize(t))),"f")),R(this,Re,"f")}get tbs(){return R(this,kr,"f")||K(this,kr,this.asn.tbsCertificateRaw||b.serialize(this.asn.tbsCertificate),"f"),R(this,kr,"f")}constructor(t){const e=qt.isAsnEncoded(t)?[t,ze]:[t];super(e[0],e[1]),kr.set(this,void 0),Br.set(this,void 0),xr.set(this,void 0),Cr.set(this,void 0),Or.set(this,void 0),Er.set(this,void 0),Nr.set(this,void 0),Ir.set(this,void 0),Tr.set(this,void 0),jr.set(this,void 0),Re.set(this,void 0),Ur.set(this,void 0),this.tag=dt.CertificateTag}onInit(t){}getExtension(t){for(const e of this.extensions)if(typeof t=="string"){if(e.type===t)return e}else if(e instanceof t)return e;return null}getExtensions(t){return this.extensions.filter(e=>typeof t=="string"?e.type===t:e instanceof t)}async verify(t={},e=nt.get()){let n,i;const s=t.publicKey;try{if(!s)n={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(n,["verify"],e);else if("publicKey"in s)n={...s.publicKey.algorithm,...this.signatureAlgorithm},i=await s.publicKey.export(n,["verify"],e);else if(s instanceof Lt)n={...s.algorithm,...this.signatureAlgorithm},i=await s.export(n,["verify"],e);else if(S.isBufferSource(s)){const h=new Lt(s);n={...h.algorithm,...this.signatureAlgorithm},i=await h.export(n,["verify"],e)}else n={...s.algorithm,...this.signatureAlgorithm},i=s}catch{return!1}const o=rt.resolveAll(ti).reverse();let c=null;for(const h of o)if(c=h.toWebSignature(n,this.signature),c)break;if(!c)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const l=await e.subtle.verify(this.signatureAlgorithm,i,c,this.tbs);if(t.signatureOnly)return l;{const h=(t.date||new Date).getTime();return l&&this.notBefore.getTime()<h&&h<this.notAfter.getTime()}}async getThumbprint(...t){let e,n="SHA-1";return t[0]&&(t[0].subtle?e=t[0]:(n=t[0]||n,e=t[1])),e??(e=nt.get()),await e.subtle.digest(n,this.rawData)}async isSelfSigned(t=nt.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},t)}toTextObject(){const t=this.toTextObjectEmpty(),e=b.parse(this.rawData,ze),n=e.tbsCertificate,i=new M("",{Version:`${Ye[n.version]} (${n.version})`,"Serial Number":n.serialNumber,"Signature Algorithm":ke.serializeAlgorithm(n.signature),Issuer:this.issuer,Validity:new M("",{"Not Before":n.validity.notBefore.getTime(),"Not After":n.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(n.issuerUniqueID&&(i["Issuer Unique ID"]=n.issuerUniqueID),n.subjectUniqueID&&(i["Subject Unique ID"]=n.subjectUniqueID),this.extensions.length){const s=new M("");for(const o of this.extensions){const c=o.toTextObject();s[c[M.NAME]]=c}i.Extensions=s}return t.Data=i,t.Signature=new M("",{Algorithm:ke.serializeAlgorithm(e.signatureAlgorithm),"":e.signatureValue}),t}}kr=new WeakMap,Br=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Or=new WeakMap,Er=new WeakMap,Nr=new WeakMap,Ir=new WeakMap,Tr=new WeakMap,jr=new WeakMap,Re=new WeakMap,Ur=new WeakMap,mf.NAME="Certificate";var $u;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})($u||($u={})),ft.register(pl,Hl),ft.register(dl,Dl),ft.register(vl,Ml),ft.register(wl,Dn),ft.register(Hs,Qr),ft.register(ml,$l),ft.register(_s,Fl),ft.register(Ls,Wl),ft.register(gl,Kl),Tn.register(jl,zl),Tn.register(Hn,na),rt.registerSingleton(ti,vf),rt.registerSingleton(ti,At),At.namedCurveSize.set("P-256",32),At.namedCurveSize.set("K-256",32),At.namedCurveSize.set("P-384",48),At.namedCurveSize.set("P-521",66);export{we as A,S as B,ot as C,Wi as D,_r as E,Ki as F,_i as G,zi as H,Ge as I,Pi as J,qe as K,ve as L,Sf as M,me as N,ye as O,dt as P,If as Q,qi as R,Et as S,Mi as T,qr as U,$i as V,Ml as W,mf as X,Lu as Y,bf as Z,Cf as a,Qt as b,Nf as c,Ri as d,de as e,Fe as f,Af as g,Go as h,zr as i,E as j,Vt as k,xf as l,Ih as m,Ef as n,Kh as o,Sh as p,Ui as q,Di as r,Of as s,Bf as t,kf as u,Li as v,Kt as w,Vi as x,Fi as y,Hi as z};
//# sourceMappingURL=x509.es-Bu4aLWpw.chunk.mjs.map
