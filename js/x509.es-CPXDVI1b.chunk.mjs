var th=Object.defineProperty,eh=Object.defineProperties;var rh=Object.getOwnPropertyDescriptors;var Dr=Object.getOwnPropertySymbols;var na=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable;var ia=(r,t,e)=>t in r?th(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,V=(r,t)=>{for(var e in t||(t={}))na.call(t,e)&&ia(r,e,t[e]);if(Dr)for(var e of Dr(t))oa.call(t,e)&&ia(r,e,t[e]);return r},W=(r,t)=>eh(r,rh(t));var q=(r,t)=>{var e={};for(var n in r)na.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&Dr)for(var n of Dr(r))t.indexOf(n)<0&&oa.call(r,n)&&(e[n]=r[n]);return e};import{p as ih,e as nh,aq as sa,B as aa,g as Lr}from"./_plugin-vue2_normalizer-DKrpQda6.chunk.mjs";var kn,ca;function oh(){if(ca)return kn;ca=1;function r(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function t(i,o){for(var s="",c=0,u=-1,h=0,g,d=0;d<=i.length;++d){if(d<i.length)g=i.charCodeAt(d);else{if(g===47)break;g=47}if(g===47){if(!(u===d-1||h===1))if(u!==d-1&&h===2){if(s.length<2||c!==2||s.charCodeAt(s.length-1)!==46||s.charCodeAt(s.length-2)!==46){if(s.length>2){var j=s.lastIndexOf("/");if(j!==s.length-1){j===-1?(s="",c=0):(s=s.slice(0,j),c=s.length-1-s.lastIndexOf("/")),u=d,h=0;continue}}else if(s.length===2||s.length===1){s="",c=0,u=d,h=0;continue}}o&&(s.length>0?s+="/..":s="..",c=2)}else s.length>0?s+="/"+i.slice(u+1,d):s=i.slice(u+1,d),c=d-u-1;u=d,h=0}else g===46&&h!==-1?++h:h=-1}return s}function e(i,o){var s=o.dir||o.root,c=o.base||(o.name||"")+(o.ext||"");return s?s===o.root?s+c:s+i+c:c}var n={resolve:function(){for(var i="",o=!1,s,c=arguments.length-1;c>=-1&&!o;c--){var u;c>=0?u=arguments[c]:(s===void 0&&(s=ih.cwd()),u=s),r(u),u.length!==0&&(i=u+"/"+i,o=u.charCodeAt(0)===47)}return i=t(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(r(i),i.length===0)return".";var o=i.charCodeAt(0)===47,s=i.charCodeAt(i.length-1)===47;return i=t(i,!o),i.length===0&&!o&&(i="."),i.length>0&&s&&(i+="/"),o?"/"+i:i},isAbsolute:function(i){return r(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,o=0;o<arguments.length;++o){var s=arguments[o];r(s),s.length>0&&(i===void 0?i=s:i+="/"+s)}return i===void 0?".":n.normalize(i)},relative:function(i,o){if(r(i),r(o),i===o||(i=n.resolve(i),o=n.resolve(o),i===o))return"";for(var s=1;s<i.length&&i.charCodeAt(s)===47;++s);for(var c=i.length,u=c-s,h=1;h<o.length&&o.charCodeAt(h)===47;++h);for(var g=o.length,d=g-h,j=u<d?u:d,H=-1,U=0;U<=j;++U){if(U===j){if(d>j){if(o.charCodeAt(h+U)===47)return o.slice(h+U+1);if(U===0)return o.slice(h+U)}else u>j&&(i.charCodeAt(s+U)===47?H=U:U===0&&(H=0));break}var vt=i.charCodeAt(s+U),Jt=o.charCodeAt(h+U);if(vt!==Jt)break;vt===47&&(H=U)}var It="";for(U=s+H+1;U<=c;++U)(U===c||i.charCodeAt(U)===47)&&(It.length===0?It+="..":It+="/..");return It.length>0?It+o.slice(h+H):(h+=H,o.charCodeAt(h)===47&&++h,o.slice(h))},_makeLong:function(i){return i},dirname:function(i){if(r(i),i.length===0)return".";for(var o=i.charCodeAt(0),s=o===47,c=-1,u=!0,h=i.length-1;h>=1;--h)if(o=i.charCodeAt(h),o===47){if(!u){c=h;break}}else u=!1;return c===-1?s?"/":".":s&&c===1?"//":i.slice(0,c)},basename:function(i,o){if(o!==void 0&&typeof o!="string")throw new TypeError('"ext" argument must be a string');r(i);var s=0,c=-1,u=!0,h;if(o!==void 0&&o.length>0&&o.length<=i.length){if(o.length===i.length&&o===i)return"";var g=o.length-1,d=-1;for(h=i.length-1;h>=0;--h){var j=i.charCodeAt(h);if(j===47){if(!u){s=h+1;break}}else d===-1&&(u=!1,d=h+1),g>=0&&(j===o.charCodeAt(g)?--g===-1&&(c=h):(g=-1,c=d))}return s===c?c=d:c===-1&&(c=i.length),i.slice(s,c)}else{for(h=i.length-1;h>=0;--h)if(i.charCodeAt(h)===47){if(!u){s=h+1;break}}else c===-1&&(u=!1,c=h+1);return c===-1?"":i.slice(s,c)}},extname:function(i){r(i);for(var o=-1,s=0,c=-1,u=!0,h=0,g=i.length-1;g>=0;--g){var d=i.charCodeAt(g);if(d===47){if(!u){s=g+1;break}continue}c===-1&&(u=!1,c=g+1),d===46?o===-1?o=g:h!==1&&(h=1):o!==-1&&(h=-1)}return o===-1||c===-1||h===0||h===1&&o===c-1&&o===s+1?"":i.slice(o,c)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return e("/",i)},parse:function(i){r(i);var o={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return o;var s=i.charCodeAt(0),c=s===47,u;c?(o.root="/",u=1):u=0;for(var h=-1,g=0,d=-1,j=!0,H=i.length-1,U=0;H>=u;--H){if(s=i.charCodeAt(H),s===47){if(!j){g=H+1;break}continue}d===-1&&(j=!1,d=H+1),s===46?h===-1?h=H:U!==1&&(U=1):h!==-1&&(U=-1)}return h===-1||d===-1||U===0||U===1&&h===d-1&&h===g+1?d!==-1&&(g===0&&c?o.base=o.name=i.slice(1,d):o.base=o.name=i.slice(g,d)):(g===0&&c?(o.name=i.slice(1,h),o.base=i.slice(1,d)):(o.name=i.slice(g,h),o.base=i.slice(g,d)),o.ext=i.slice(h,d)),g>0?o.dir=i.slice(0,g-1):c&&(o.dir="/"),o},sep:"/",delimiter:":",win32:null,posix:null};return n.posix=n,kn=n,kn}var sh=oh();const sf=nh(sh);var la={},ua;function ah(){if(ua)return la;ua=1;var r;return function(t){(function(e){var n=typeof globalThis=="object"?globalThis:typeof sa=="object"?sa:typeof self=="object"?self:typeof this=="object"?this:u(),i=o(t);typeof n.Reflect<"u"&&(i=o(n.Reflect,i)),e(i,n),typeof n.Reflect>"u"&&(n.Reflect=t);function o(h,g){return function(d,j){Object.defineProperty(h,d,{configurable:!0,writable:!0,value:j}),g&&g(d,j)}}function s(){try{return Function("return this;")()}catch(h){}}function c(){try{return(0,eval)("(function() { return this; })()")}catch(h){}}function u(){return s()||c()}})(function(e,n){var i=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",s=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",c=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",u=typeof Object.create=="function",h={__proto__:[]}instanceof Array,g=!u&&!h,d={create:u?function(){return Bn(Object.create(null))}:h?function(){return Bn({__proto__:null})}:function(){return Bn({})},has:g?function(f,y){return i.call(f,y)}:function(f,y){return y in f},get:g?function(f,y){return i.call(f,y)?f[y]:void 0}:function(f,y){return f[y]}},j=Object.getPrototypeOf(Function),H=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ju(),U=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Zu(),vt=typeof WeakMap=="function"?WeakMap:Yu(),Jt=o?Symbol.for("@reflect-metadata:registry"):void 0,It=Ku(),Ms=Wu(It);function Eu(f,y,v,w){if(T(v)){if(!Js(f))throw new TypeError;if(!Zs(y))throw new TypeError;return Lu(f,y)}else{if(!Js(f))throw new TypeError;if(!J(y))throw new TypeError;if(!J(w)&&!T(w)&&!ke(w))throw new TypeError;return ke(w)&&(w=void 0),v=Tt(v),Hu(f,y,v,w)}}e("decorate",Eu);function Nu(f,y){function v(w,I){if(!J(w))throw new TypeError;if(!T(I)&&!zu(I))throw new TypeError;zs(f,y,w,I)}return v}e("metadata",Nu);function Iu(f,y,v,w){if(!J(v))throw new TypeError;return T(w)||(w=Tt(w)),zs(f,y,v,w)}e("defineMetadata",Iu);function Tu(f,y,v){if(!J(y))throw new TypeError;return T(v)||(v=Tt(v)),$s(f,y,v)}e("hasMetadata",Tu);function ju(f,y,v){if(!J(y))throw new TypeError;return T(v)||(v=Tt(v)),wn(f,y,v)}e("hasOwnMetadata",ju);function Pu(f,y,v){if(!J(y))throw new TypeError;return T(v)||(v=Tt(v)),Fs(f,y,v)}e("getMetadata",Pu);function Uu(f,y,v){if(!J(y))throw new TypeError;return T(v)||(v=Tt(v)),_s(f,y,v)}e("getOwnMetadata",Uu);function Vu(f,y){if(!J(f))throw new TypeError;return T(y)||(y=Tt(y)),qs(f,y)}e("getMetadataKeys",Vu);function Ru(f,y){if(!J(f))throw new TypeError;return T(y)||(y=Tt(y)),Ks(f,y)}e("getOwnMetadataKeys",Ru);function Du(f,y,v){if(!J(y))throw new TypeError;if(T(v)||(v=Tt(v)),!J(y))throw new TypeError;T(v)||(v=Tt(v));var w=tr(y,v,!1);return T(w)?!1:w.OrdinaryDeleteMetadata(f,y,v)}e("deleteMetadata",Du);function Lu(f,y){for(var v=f.length-1;v>=0;--v){var w=f[v],I=w(y);if(!T(I)&&!ke(I)){if(!Zs(I))throw new TypeError;y=I}}return y}function Hu(f,y,v,w){for(var I=f.length-1;I>=0;--I){var K=f[I],Z=K(y,v,w);if(!T(Z)&&!ke(Z)){if(!J(Z))throw new TypeError;w=Z}}return w}function $s(f,y,v){var w=wn(f,y,v);if(w)return!0;var I=Sn(y);return ke(I)?!1:$s(f,I,v)}function wn(f,y,v){var w=tr(y,v,!1);return T(w)?!1:Gs(w.OrdinaryHasOwnMetadata(f,y,v))}function Fs(f,y,v){var w=wn(f,y,v);if(w)return _s(f,y,v);var I=Sn(y);if(!ke(I))return Fs(f,I,v)}function _s(f,y,v){var w=tr(y,v,!1);if(!T(w))return w.OrdinaryGetOwnMetadata(f,y,v)}function zs(f,y,v,w){var I=tr(v,w,!0);I.OrdinaryDefineOwnMetadata(f,y,v,w)}function qs(f,y){var v=Ks(f,y),w=Sn(f);if(w===null)return v;var I=qs(w,y);if(I.length<=0)return v;if(v.length<=0)return I;for(var K=new U,Z=[],R=0,B=v;R<B.length;R++){var O=B[R],C=K.has(O);C||(K.add(O),Z.push(O))}for(var N=0,D=I;N<D.length;N++){var O=D[N],C=K.has(O);C||(K.add(O),Z.push(O))}return Z}function Ks(f,y){var v=tr(f,y,!1);return v?v.OrdinaryOwnMetadataKeys(f,y):[]}function Ws(f){if(f===null)return 1;switch(typeof f){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return f===null?1:6;default:return 6}}function T(f){return f===void 0}function ke(f){return f===null}function Mu(f){return typeof f=="symbol"}function J(f){return typeof f=="object"?f!==null:typeof f=="function"}function $u(f,y){switch(Ws(f)){case 0:return f;case 1:return f;case 2:return f;case 3:return f;case 4:return f;case 5:return f}var v="string",w=Ys(f,s);if(w!==void 0){var I=w.call(f,v);if(J(I))throw new TypeError;return I}return Fu(f)}function Fu(f,y){var v,w,I;{var K=f.toString;if(Rr(K)){var w=K.call(f);if(!J(w))return w}var v=f.valueOf;if(Rr(v)){var w=v.call(f);if(!J(w))return w}}throw new TypeError}function Gs(f){return!!f}function _u(f){return""+f}function Tt(f){var y=$u(f);return Mu(y)?y:_u(y)}function Js(f){return Array.isArray?Array.isArray(f):f instanceof Object?f instanceof Array:Object.prototype.toString.call(f)==="[object Array]"}function Rr(f){return typeof f=="function"}function Zs(f){return typeof f=="function"}function zu(f){switch(Ws(f)){case 3:return!0;case 4:return!0;default:return!1}}function An(f,y){return f===y||f!==f&&y!==y}function Ys(f,y){var v=f[y];if(v!=null){if(!Rr(v))throw new TypeError;return v}}function Xs(f){var y=Ys(f,c);if(!Rr(y))throw new TypeError;var v=y.call(f);if(!J(v))throw new TypeError;return v}function Qs(f){return f.value}function ta(f){var y=f.next();return y.done?!1:y}function ea(f){var y=f.return;y&&y.call(f)}function Sn(f){var y=Object.getPrototypeOf(f);if(typeof f!="function"||f===j||y!==j)return y;var v=f.prototype,w=v&&Object.getPrototypeOf(v);if(w==null||w===Object.prototype)return y;var I=w.constructor;return typeof I!="function"||I===f?y:I}function qu(){var f;!T(Jt)&&typeof n.Reflect<"u"&&!(Jt in n.Reflect)&&typeof n.Reflect.defineMetadata=="function"&&(f=Gu(n.Reflect));var y,v,w,I=new vt,K={registerProvider:Z,getProvider:B,setProvider:C};return K;function Z(N){if(!Object.isExtensible(K))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case f===N:break;case T(y):y=N;break;case y===N:break;case T(v):v=N;break;case v===N:break;default:w===void 0&&(w=new U),w.add(N);break}}function R(N,D){if(!T(y)){if(y.isProviderFor(N,D))return y;if(!T(v)){if(v.isProviderFor(N,D))return y;if(!T(w))for(var F=Xs(w);;){var G=ta(F);if(!G)return;var Bt=Qs(G);if(Bt.isProviderFor(N,D))return ea(F),Bt}}}if(!T(f)&&f.isProviderFor(N,D))return f}function B(N,D){var F=I.get(N),G;return T(F)||(G=F.get(D)),T(G)&&(G=R(N,D),T(G)||(T(F)&&(F=new H,I.set(N,F)),F.set(D,G))),G}function O(N){if(T(N))throw new TypeError;return y===N||v===N||!T(w)&&w.has(N)}function C(N,D,F){if(!O(F))throw new Error("Metadata provider not registered.");var G=B(N,D);if(G!==F){if(!T(G))return!1;var Bt=I.get(N);T(Bt)&&(Bt=new H,I.set(N,Bt)),Bt.set(D,F)}return!0}}function Ku(){var f;return!T(Jt)&&J(n.Reflect)&&Object.isExtensible(n.Reflect)&&(f=n.Reflect[Jt]),T(f)&&(f=qu()),!T(Jt)&&J(n.Reflect)&&Object.isExtensible(n.Reflect)&&Object.defineProperty(n.Reflect,Jt,{enumerable:!1,configurable:!1,writable:!1,value:f}),f}function Wu(f){var y=new vt,v={isProviderFor:function(O,C){var N=y.get(O);return T(N)?!1:N.has(C)},OrdinaryDefineOwnMetadata:Z,OrdinaryHasOwnMetadata:I,OrdinaryGetOwnMetadata:K,OrdinaryOwnMetadataKeys:R,OrdinaryDeleteMetadata:B};return It.registerProvider(v),v;function w(O,C,N){var D=y.get(O),F=!1;if(T(D)){if(!N)return;D=new H,y.set(O,D),F=!0}var G=D.get(C);if(T(G)){if(!N)return;if(G=new H,D.set(C,G),!f.setProvider(O,C,v))throw D.delete(C),F&&y.delete(O),new Error("Wrong provider for target.")}return G}function I(O,C,N){var D=w(C,N,!1);return T(D)?!1:Gs(D.has(O))}function K(O,C,N){var D=w(C,N,!1);if(!T(D))return D.get(O)}function Z(O,C,N,D){var F=w(N,D,!0);F.set(O,C)}function R(O,C){var N=[],D=w(O,C,!1);if(T(D))return N;for(var F=D.keys(),G=Xs(F),Bt=0;;){var ra=ta(G);if(!ra)return N.length=Bt,N;var Xu=Qs(ra);try{N[Bt]=Xu}catch(Qu){try{ea(G)}finally{throw Qu}}Bt++}}function B(O,C,N){var D=w(C,N,!1);if(T(D)||!D.delete(O))return!1;if(D.size===0){var F=y.get(C);T(F)||(F.delete(N),F.size===0&&y.delete(F))}return!0}}function Gu(f){var y=f.defineMetadata,v=f.hasOwnMetadata,w=f.getOwnMetadata,I=f.getOwnMetadataKeys,K=f.deleteMetadata,Z=new vt,R={isProviderFor:function(B,O){var C=Z.get(B);return!T(C)&&C.has(O)?!0:I(B,O).length?(T(C)&&(C=new U,Z.set(B,C)),C.add(O),!0):!1},OrdinaryDefineOwnMetadata:y,OrdinaryHasOwnMetadata:v,OrdinaryGetOwnMetadata:w,OrdinaryOwnMetadataKeys:I,OrdinaryDeleteMetadata:K};return R}function tr(f,y,v){var w=It.getProvider(f,y);if(!T(w))return w;if(v){if(It.setProvider(f,y,Ms))return Ms;throw new Error("Illegal state.")}}function Ju(){var f={},y=[],v=function(){function R(B,O,C){this._index=0,this._keys=B,this._values=O,this._selector=C}return R.prototype["@@iterator"]=function(){return this},R.prototype[c]=function(){return this},R.prototype.next=function(){var B=this._index;if(B>=0&&B<this._keys.length){var O=this._selector(this._keys[B],this._values[B]);return B+1>=this._keys.length?(this._index=-1,this._keys=y,this._values=y):this._index++,{value:O,done:!1}}return{value:void 0,done:!0}},R.prototype.throw=function(B){throw this._index>=0&&(this._index=-1,this._keys=y,this._values=y),B},R.prototype.return=function(B){return this._index>=0&&(this._index=-1,this._keys=y,this._values=y),{value:B,done:!0}},R}(),w=function(){function R(){this._keys=[],this._values=[],this._cacheKey=f,this._cacheIndex=-2}return Object.defineProperty(R.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),R.prototype.has=function(B){return this._find(B,!1)>=0},R.prototype.get=function(B){var O=this._find(B,!1);return O>=0?this._values[O]:void 0},R.prototype.set=function(B,O){var C=this._find(B,!0);return this._values[C]=O,this},R.prototype.delete=function(B){var O=this._find(B,!1);if(O>=0){for(var C=this._keys.length,N=O+1;N<C;N++)this._keys[N-1]=this._keys[N],this._values[N-1]=this._values[N];return this._keys.length--,this._values.length--,An(B,this._cacheKey)&&(this._cacheKey=f,this._cacheIndex=-2),!0}return!1},R.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=f,this._cacheIndex=-2},R.prototype.keys=function(){return new v(this._keys,this._values,I)},R.prototype.values=function(){return new v(this._keys,this._values,K)},R.prototype.entries=function(){return new v(this._keys,this._values,Z)},R.prototype["@@iterator"]=function(){return this.entries()},R.prototype[c]=function(){return this.entries()},R.prototype._find=function(B,O){if(!An(this._cacheKey,B)){this._cacheIndex=-1;for(var C=0;C<this._keys.length;C++)if(An(this._keys[C],B)){this._cacheIndex=C;break}}return this._cacheIndex<0&&O&&(this._cacheIndex=this._keys.length,this._keys.push(B),this._values.push(void 0)),this._cacheIndex},R}();return w;function I(R,B){return R}function K(R,B){return B}function Z(R,B){return[R,B]}}function Zu(){var f=function(){function y(){this._map=new H}return Object.defineProperty(y.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),y.prototype.has=function(v){return this._map.has(v)},y.prototype.add=function(v){return this._map.set(v,v),this},y.prototype.delete=function(v){return this._map.delete(v)},y.prototype.clear=function(){this._map.clear()},y.prototype.keys=function(){return this._map.keys()},y.prototype.values=function(){return this._map.keys()},y.prototype.entries=function(){return this._map.entries()},y.prototype["@@iterator"]=function(){return this.keys()},y.prototype[c]=function(){return this.keys()},y}();return f}function Yu(){var f=16,y=d.create(),v=w();return function(){function B(){this._key=w()}return B.prototype.has=function(O){var C=I(O,!1);return C!==void 0?d.has(C,this._key):!1},B.prototype.get=function(O){var C=I(O,!1);return C!==void 0?d.get(C,this._key):void 0},B.prototype.set=function(O,C){var N=I(O,!0);return N[this._key]=C,this},B.prototype.delete=function(O){var C=I(O,!1);return C!==void 0?delete C[this._key]:!1},B.prototype.clear=function(){this._key=w()},B}();function w(){var B;do B="@@WeakMap@@"+R();while(d.has(y,B));return y[B]=!0,B}function I(B,O){if(!i.call(B,v)){if(!O)return;Object.defineProperty(B,v,{value:d.create()})}return B[v]}function K(B,O){for(var C=0;C<O;++C)B[C]=Math.random()*255|0;return B}function Z(B){if(typeof Uint8Array=="function"){var O=new Uint8Array(B);return typeof crypto<"u"?crypto.getRandomValues(O):typeof msCrypto<"u"?msCrypto.getRandomValues(O):K(O,B),O}return K(new Array(B),B)}function R(){var B=Z(f);B[6]=B[6]&79|64,B[8]=B[8]&191|128;for(var O="",C=0;C<f;++C){var N=B[C];(C===4||C===6||C===8)&&(O+="-"),N<16&&(O+="0"),O+=N.toString(16).toLowerCase()}return O}}function Bn(f){return f.__=void 0,delete f.__,f}})}(r||(r={})),la}ah();const ch="[object ArrayBuffer]";class A{static isArrayBuffer(t){return Object.prototype.toString.call(t)===ch}static toArrayBuffer(t){return this.isArrayBuffer(t)?t:t.byteLength===t.buffer.byteLength||t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e)return t;if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const n=A.toUint8Array(t),i=A.toUint8Array(e);if(n.length!==i.byteLength)return!1;for(let o=0;o<n.length;o++)if(n[o]!==i[o])return!1;return!0}static concat(...t){let e;Array.isArray(t[0])&&!(t[1]instanceof Function)||Array.isArray(t[0])&&t[1]instanceof Function?e=t[0]:t[t.length-1]instanceof Function?e=t.slice(0,t.length-1):e=t;let n=0;for(const s of e)n+=s.byteLength;const i=new Uint8Array(n);let o=0;for(const s of e){const c=this.toUint8Array(s);i.set(c,o),o+=c.length}return t[t.length-1]instanceof Function?this.toView(i,t[t.length-1]):i.buffer}}const xn="string",lh=/^[0-9a-f\s]+$/i,uh=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,hh=/^[a-zA-Z0-9-_]+$/;class ha{static fromString(t){const e=unescape(encodeURIComponent(t)),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n.buffer}static toString(t){const e=A.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return decodeURIComponent(escape(n))}}class jt{static toString(t,e=!1){const n=A.toArrayBuffer(t),i=new DataView(n);let o="";for(let s=0;s<n.byteLength;s+=2){const c=i.getUint16(s,e);o+=String.fromCharCode(c)}return o}static fromString(t,e=!1){const n=new ArrayBuffer(t.length*2),i=new DataView(n);for(let o=0;o<t.length;o++)i.setUint16(o*2,t.charCodeAt(o),e);return n}}class E{static isHex(t){return typeof t===xn&&lh.test(t)}static isBase64(t){return typeof t===xn&&uh.test(t)}static isBase64Url(t){return typeof t===xn&&hh.test(t)}static ToString(t,e="utf8"){const n=A.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return jt.toString(n,!0);case"utf16":case"utf16be":return jt.toString(n);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return jt.fromString(t,!0);case"utf16":case"utf16be":return jt.fromString(t);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToBase64(t){const e=A.toUint8Array(t);if(typeof btoa<"u"){const n=this.ToString(e,"binary");return btoa(n)}else return aa.from(e).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(e)):new Uint8Array(aa.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return ha.fromString(t);case"utf16":case"utf16be":return jt.fromString(t);case"utf16le":case"usc2":return jt.fromString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static ToUtf8String(t,e=E.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return ha.toString(t);case"utf16":case"utf16be":return jt.toString(t);case"utf16le":case"usc2":return jt.toString(t,!0);default:throw new Error("Unknown type of encoding '".concat(e,"'"))}}static FromBinary(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n.buffer}static ToBinary(t){const e=A.toUint8Array(t);let n="";for(let i=0;i<e.length;i++)n+=String.fromCharCode(e[i]);return n}static ToHex(t){const e=A.toUint8Array(t);let n="";const i=e.length;for(let o=0;o<i;o++){const s=e[o];s<16&&(n+="0"),n+=s.toString(16)}return n}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!E.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e="0".concat(e));const n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i=i+2){const o=e.slice(i,i+2);n[i/2]=parseInt(o,16)}return n.buffer}static ToUtf16String(t,e=!1){return jt.toString(t,e)}static FromUtf16String(t,e=!1){return jt.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let n=0;n<e;n++)t+="=";return t}static formatString(t){return(t==null?void 0:t.replace(/[\n\r\t ]/g,""))||""}}E.DEFAULT_UTF8_ENCODING="utf8";function ph(...r){const t=r.map(i=>i.byteLength).reduce((i,o)=>i+o),e=new Uint8Array(t);let n=0;return r.map(i=>new Uint8Array(i)).forEach(i=>{for(const o of i)e[n++]=o}),e.buffer}function Ol(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}function af(r,t,e){var n;return r instanceof Object&&(n=r[t])!==null&&n!==void 0?n:e}function cf(r,t=0,e=r.byteLength-t,n=!1){let i="";for(const o of new Uint8Array(r,t,e)){const s=o.toString(16).toUpperCase();s.length===1&&(i+="0"),i+=s,n&&(i+=" ")}return i.trim()}function Fe(r,t){let e=0;if(r.length===1)return r[0];for(let n=r.length-1;n>=0;n--)e+=r[r.length-1-n]*Math.pow(2,t*n);return e}function ge(r,t,e=-1){const n=e;let i=r,o=0,s=Math.pow(2,t);for(let c=1;c<8;c++){if(r<s){let u;if(n<0)u=new ArrayBuffer(c),o=c;else{if(n<c)return new ArrayBuffer(0);u=new ArrayBuffer(n),o=n}const h=new Uint8Array(u);for(let g=c-1;g>=0;g--){const d=Math.pow(2,g*t);h[o-g-1]=Math.floor(i/d),i-=h[o-g-1]*d}return u}s*=Math.pow(2,t)}return new ArrayBuffer(0)}function lf(...r){let t=0,e=0;for(const o of r)t+=o.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const o of r)i.set(new Uint8Array(o),e),e+=o.byteLength;return n}function Qn(...r){let t=0,e=0;for(const o of r)t+=o.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const o of r)i.set(o,e),e+=o.length;return i}function Cl(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const s=r[0]===255&&r[1]&128,c=r[0]===0&&(r[1]&128)===0;(s||c)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),e=new Uint8Array(t);for(let s=0;s<this.valueHex.byteLength;s++)e[s]=0;e[0]=r[0]&128;const n=Fe(e,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let s=0;s<this.valueHex.byteLength;s++)o[s]=r[s];return o[0]&=127,Fe(o,8)-n}function fh(r){const t=r<0?r*-1:r;let e=128;for(let n=1;n<8;n++){if(t<=e){if(r<0){const s=e-t,c=ge(s,8,n),u=new Uint8Array(c);return u[0]|=128,c}let i=ge(t,8,n),o=new Uint8Array(i);if(o[0]&128){const s=i.slice(0),c=new Uint8Array(s);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let u=0;u<s.byteLength;u++)o[u+1]=c[u];o[0]=0}return i}e*=Math.pow(2,8)}return new ArrayBuffer(0)}function yh(r,t){if(r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}function yt(r,t){const e=r.toString(10);if(t<e.length)return"";const n=t-e.length,i=new Array(n);for(let o=0;o<n;o++)i[o]="0";return i.join("").concat(e)}const El="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Nl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function uf(r,t=!1,e=!1,n=!1){let i=0,o=0,s=0,c="";const u=t?Nl:El;if(n){let h=0;for(let g=0;g<r.length;g++)if(r.charCodeAt(g)!==0){h=g;break}r=r.slice(h)}for(;i<r.length;){const h=r.charCodeAt(i++);i>=r.length&&(o=1);const g=r.charCodeAt(i++);i>=r.length&&(s=1);const d=r.charCodeAt(i++),j=h>>2,H=(h&3)<<4|g>>4;let U=(g&15)<<2|d>>6,vt=d&63;o===1?U=vt=64:s===1&&(vt=64),e?U===64?c+="".concat(u.charAt(j)).concat(u.charAt(H)):vt===64?c+="".concat(u.charAt(j)).concat(u.charAt(H)).concat(u.charAt(U)):c+="".concat(u.charAt(j)).concat(u.charAt(H)).concat(u.charAt(U)).concat(u.charAt(vt)):c+="".concat(u.charAt(j)).concat(u.charAt(H)).concat(u.charAt(U)).concat(u.charAt(vt))}return c}function hf(r,t=!1,e=!1){const n=t?Nl:El;function i(u){for(let h=0;h<64;h++)if(n.charAt(h)===u)return h;return 64}function o(u){return u===64?0:u}let s=0,c="";for(;s<r.length;){const u=i(r.charAt(s++)),h=s>=r.length?0:i(r.charAt(s++)),g=s>=r.length?0:i(r.charAt(s++)),d=s>=r.length?0:i(r.charAt(s++)),j=o(u)<<2|o(h)>>4,H=(o(h)&15)<<4|o(g)>>2,U=(o(g)&3)<<6|o(d);c+=String.fromCharCode(j),g!==64&&(c+=String.fromCharCode(H)),d!==64&&(c+=String.fromCharCode(U))}if(e){const u=c.length;let h=-1;for(let g=u-1;g>=0;g--)if(c.charCodeAt(g)!==0){h=g;break}h!==-1?c=c.slice(0,h+1):c=""}return c}function pf(r){let t="";const e=new Uint8Array(r);for(const n of e)t+=String.fromCharCode(n);return t}function ff(r){const t=r.length,e=new ArrayBuffer(t),n=new Uint8Array(e);for(let i=0;i<t;i++)n[i]=r.charCodeAt(i);return e}const dh=Math.log(2);function yf(r){const t=Math.log(r)/dh,e=Math.floor(t),n=Math.round(t);return e===n?e:n}function df(r,t){for(const e of t)delete r[e]}function pi(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Os(r){let t=0,e=0;for(let i=0;i<r.length;i++){const o=r[i];t+=o.byteLength}const n=new Uint8Array(t);for(let i=0;i<r.length;i++){const o=r[i];n.set(new Uint8Array(o),e),e+=o.byteLength}return n.buffer}function Gt(r,t,e,n){return t instanceof Uint8Array?t.byteLength?e<0?(r.error="Wrong parameter: inputOffset less than zero",!1):n<0?(r.error="Wrong parameter: inputLength less than zero",!1):t.byteLength-e-n<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class fn{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return Os(this.items)}}const er=[new Uint8Array([1])],pa="0123456789",On="name",fa="valueHexView",gh="isHexOnly",vh="idBlock",mh="tagClass",bh="tagNumber",wh="isConstructed",Ah="fromBER",Sh="toBER",Bh="local",ht="",Nt=new ArrayBuffer(0),yn=new Uint8Array(0),Br="EndOfContent",Il="OCTET STRING",Tl="BIT STRING";function Ht(r){var t;return t=class extends r{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var n;super(...e);const i=e[0]||{};this.isHexOnly=(n=i.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=i.valueHex?A.toUint8Array(i.valueHex):yn}fromBER(e,n,i){const o=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!Gt(this,o,n,i))return-1;const s=n+i;return this.valueHexView=o.subarray(n,s),this.valueHexView.length?(this.blockLength=i,s):(this.warnings.push("Zero buffer length"),n)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Nt)}toJSON(){return W(V({},super.toJSON()),{isHexOnly:this.isHexOnly,valueHex:E.ToHex(this.valueHexView)})}},t.NAME="hexBlock",t}class Be{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}constructor({blockLength:t=0,error:e=ht,warnings:n=[],valueBeforeDecode:i=yn}={}){this.blockLength=t,this.error=e,this.warnings=n,this.valueBeforeDecodeView=A.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:E.ToHex(this.valueBeforeDecodeView)}}}Be.NAME="baseBlock";class ct extends Be{fromBER(t,e,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}ct.NAME="valueBlock";class jl extends Ht(Be){constructor({idBlock:t={}}={}){var e,n,i,o;super(),t?(this.isHexOnly=(e=t.isHexOnly)!==null&&e!==void 0?e:!1,this.valueHexView=t.valueHex?A.toUint8Array(t.valueHex):yn,this.tagClass=(n=t.tagClass)!==null&&n!==void 0?n:-1,this.tagNumber=(i=t.tagNumber)!==null&&i!==void 0?i:-1,this.isConstructed=(o=t.isConstructed)!==null&&o!==void 0?o:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(t=!1){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",Nt}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const i=new Uint8Array(1);if(!t){let o=this.tagNumber;o&=31,e|=o,i[0]=e}return i.buffer}if(!this.isHexOnly){const i=ge(this.tagNumber,7),o=new Uint8Array(i),s=i.byteLength,c=new Uint8Array(s+1);if(c[0]=e|31,!t){for(let u=0;u<s-1;u++)c[u+1]=o[u]|128;c[s]=o[s-1]}return c.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=e|31,!t){const i=this.valueHexView;for(let o=0;o<i.length-1;o++)n[o+1]=i[o]|128;n[this.valueHexView.byteLength]=i[i.length-1]}return n.buffer}fromBER(t,e,n){const i=A.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const o=i.subarray(e,e+n);if(o.length===0)return this.error="Zero buffer length",-1;switch(o[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(o[0]&32)===32,this.isHexOnly=!1;const s=o[0]&31;if(s!==31)this.tagNumber=s,this.blockLength=1;else{let c=1,u=this.valueHexView=new Uint8Array(255),h=255;for(;o[c]&128;){if(u[c-1]=o[c]&127,c++,c>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(c===h){h+=255;const d=new Uint8Array(h);for(let j=0;j<u.length;j++)d[j]=u[j];u=this.valueHexView=new Uint8Array(h)}}this.blockLength=c+1,u[c-1]=o[c]&127;const g=new Uint8Array(c);for(let d=0;d<c;d++)g[d]=u[d];u=this.valueHexView=new Uint8Array(c),u.set(g),this.blockLength<=9?this.tagNumber=Fe(u,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return W(V({},super.toJSON()),{tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed})}}jl.NAME="identificationBlock";class Pl extends Be{constructor({lenBlock:t={}}={}){var e,n,i;super(),this.isIndefiniteForm=(e=t.isIndefiniteForm)!==null&&e!==void 0?e:!1,this.longFormUsed=(n=t.longFormUsed)!==null&&n!==void 0?n:!1,this.length=(i=t.length)!==null&&i!==void 0?i:0}fromBER(t,e,n){const i=A.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const o=i.subarray(e,e+n);if(o.length===0)return this.error="Zero buffer length",-1;if(o[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=o[0]===128,this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(o[0]&128),this.longFormUsed===!1)return this.length=o[0],this.blockLength=1,e+this.blockLength;const s=o[0]&127;if(s>8)return this.error="Too big integer",-1;if(s+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const c=e+1,u=i.subarray(c,c+s);return u[s-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=Fe(u,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,e+this.blockLength}toBER(t=!1){let e,n;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=128),e;if(this.longFormUsed){const i=ge(this.length,8);if(i.byteLength>127)return this.error="Too big length",Nt;if(e=new ArrayBuffer(i.byteLength+1),t)return e;const o=new Uint8Array(i);n=new Uint8Array(e),n[0]=i.byteLength|128;for(let s=0;s<i.byteLength;s++)n[s+1]=o[s];return e}return e=new ArrayBuffer(1),t===!1&&(n=new Uint8Array(e),n[0]=this.length),e}toJSON(){return W(V({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length})}}Pl.NAME="lengthBlock";const x={};class rt extends Be{constructor(s={},o){var c=s,{name:t=ht,optional:e=!1,primitiveSchema:n}=c,i=q(c,["name","optional","primitiveSchema"]);super(i),this.name=t,this.optional=e,n&&(this.primitiveSchema=n),this.idBlock=new jl(i),this.lenBlock=new Pl(i),this.valueBlock=o?new o(i):new ct(i)}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}toBER(t,e){const n=e||new fn;e||Ul(this);const i=this.idBlock.toBER(t);if(n.write(i),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,n),n.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(t);this.lenBlock.length=o.byteLength;const s=this.lenBlock.toBER(t);n.write(s),n.write(o)}return e?Nt:n.final()}toJSON(){const t=W(V({},super.toJSON()),{idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional});return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(t="ascii"){return t==="ascii"?this.onAsciiEncoding():E.ToHex(this.toBER())}onAsciiEncoding(){const t=this.constructor.NAME,e=E.ToHex(this.valueBlock.valueBeforeDecodeView);return"".concat(t," : ").concat(e)}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;const e=this.toBER(),n=t.toBER();return yh(e,n)}}rt.NAME="BaseBlock";function Ul(r){var t;if(r instanceof x.Constructed)for(const e of r.valueBlock.value)Ul(e)&&(r.lenBlock.isIndefiniteForm=!0);return!!(!((t=r.lenBlock)===null||t===void 0)&&t.isIndefiniteForm)}class Cs extends rt{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor(i={},n){var o=i,{value:t=ht}=o,e=q(o,["value"]);super(e,n),t&&this.fromString(t)}fromBER(t,e,n){const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : '").concat(this.valueBlock.value,"'")}}Cs.NAME="BaseStringBlock";class Vl extends Ht(ct){constructor(n={}){var i=n,{isHexOnly:t=!0}=i,e=q(i,["isHexOnly"]);super(e),this.isHexOnly=t}}Vl.NAME="PrimitiveValueBlock";var ya;class kr extends rt{constructor(t={}){super(t,Vl),this.idBlock.isConstructed=!1}}ya=kr,x.Primitive=ya,kr.NAME="PRIMITIVE";function kh(r,t){if(r instanceof t)return r;const e=new t;return e.idBlock=r.idBlock,e.lenBlock=r.lenBlock,e.warnings=r.warnings,e.valueBeforeDecodeView=r.valueBeforeDecodeView,e}function Ye(r,t=0,e=r.length){const n=t;let i=new rt({},ct);const o=new Be;if(!Gt(o,r,t,e))return i.error=o.error,{offset:-1,result:i};if(!r.subarray(t,t+e).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(r,t,e);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),s===-1)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=s,e-=i.idBlock.blockLength,s=i.lenBlock.fromBER(r,t,e),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),s===-1)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=s,e-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let c=rt;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&i.idBlock.isHexOnly===!1)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=x.EndOfContent;break;case 1:c=x.Boolean;break;case 2:c=x.Integer;break;case 3:c=x.BitString;break;case 4:c=x.OctetString;break;case 5:c=x.Null;break;case 6:c=x.ObjectIdentifier;break;case 10:c=x.Enumerated;break;case 12:c=x.Utf8String;break;case 13:c=x.RelativeObjectIdentifier;break;case 14:c=x.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=x.Sequence;break;case 17:c=x.Set;break;case 18:c=x.NumericString;break;case 19:c=x.PrintableString;break;case 20:c=x.TeletexString;break;case 21:c=x.VideotexString;break;case 22:c=x.IA5String;break;case 23:c=x.UTCTime;break;case 24:c=x.GeneralizedTime;break;case 25:c=x.GraphicString;break;case 26:c=x.VisibleString;break;case 27:c=x.GeneralString;break;case 28:c=x.UniversalString;break;case 29:c=x.CharacterString;break;case 30:c=x.BmpString;break;case 31:c=x.DATE;break;case 32:c=x.TimeOfDay;break;case 33:c=x.DateTime;break;case 34:c=x.Duration;break;default:{const u=i.idBlock.isConstructed?new x.Constructed:new x.Primitive;u.idBlock=i.idBlock,u.lenBlock=i.lenBlock,u.warnings=i.warnings,i=u}}break;case 2:case 3:case 4:default:c=i.idBlock.isConstructed?x.Constructed:x.Primitive}return i=kh(i,c),s=i.fromBER(r,t,i.lenBlock.isIndefiniteForm?e:i.lenBlock.length),i.valueBeforeDecodeView=r.subarray(n,n+i.blockLength),{offset:s,result:i}}function Le(r){if(!r.byteLength){const t=new rt({},ct);return t.error="Input buffer has zero length",{offset:-1,result:t}}return Ye(A.toUint8Array(r).slice(),0,r.byteLength)}function xh(r,t){return r?1:t}class ee extends ct{constructor(i={}){var o=i,{value:t=[],isIndefiniteForm:e=!1}=o,n=q(o,["value","isIndefiniteForm"]);super(n),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,n){const i=A.toUint8Array(t);if(!Gt(this,i,e,n))return-1;if(this.valueBeforeDecodeView=i.subarray(e,e+n),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),e;let o=e;for(;xh(this.isIndefiniteForm,n)>0;){const s=Ye(i,o,n);if(s.offset===-1)return this.error=s.result.error,this.warnings.concat(s.result.warnings),-1;if(o=s.offset,this.blockLength+=s.result.blockLength,n-=s.result.blockLength,this.value.push(s.result),this.isIndefiniteForm&&s.result.constructor.NAME===Br)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===Br?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(t,e){const n=e||new fn;for(let i=0;i<this.value.length;i++)this.value[i].toBER(t,n);return e?Nt:n.final()}toJSON(){const t=W(V({},super.toJSON()),{isIndefiniteForm:this.isIndefiniteForm,value:[]});for(const e of this.value)t.value.push(e.toJSON());return t}}ee.NAME="ConstructedValueBlock";var da;class ot extends rt{constructor(t={}){super(t,ee),this.idBlock.isConstructed=!0}fromBER(t,e,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return i===-1?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const t=[];for(const n of this.valueBlock.value)t.push(n.toString("ascii").split("\n").map(i=>"  ".concat(i)).join("\n"));const e=this.idBlock.tagClass===3?"[".concat(this.idBlock.tagNumber,"]"):this.constructor.NAME;return t.length?"".concat(e," :\n").concat(t.join("\n")):"".concat(e," :")}}da=ot,x.Constructed=da,ot.NAME="CONSTRUCTED";class Rl extends ct{fromBER(t,e,n){return e}toBER(t){return Nt}}Rl.override="EndOfContentValueBlock";var ga;class to extends rt{constructor(t={}){super(t,Rl),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}ga=to,x.EndOfContent=ga,to.NAME=Br;var va;class ve extends rt{constructor(t={}){super(t,ct),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,e+n>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+n}toBER(t,e){const n=new ArrayBuffer(2);if(!t){const i=new Uint8Array(n);i[0]=5,i[1]=0}return e&&e.write(n),n}onAsciiEncoding(){return"".concat(this.constructor.NAME)}}va=ve,x.Null=va,ve.NAME="NULL";class Dl extends Ht(ct){get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}constructor(n={}){var i=n,{value:t}=i,e=q(i,["value"]);super(e),e.valueHex?this.valueHexView=A.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}fromBER(t,e,n){const i=A.toUint8Array(t);return Gt(this,i,e,n)?(this.valueHexView=i.subarray(e,e+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Cl.call(this),this.blockLength=n,e+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return W(V({},super.toJSON()),{value:this.value})}}Dl.NAME="BooleanValueBlock";var ma;class fi extends rt{getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}constructor(t={}){super(t,Dl),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.getValue)}}ma=fi,x.Boolean=ma,fi.NAME="BOOLEAN";class Ll extends Ht(ee){constructor(n={}){var i=n,{isConstructed:t=!1}=i,e=q(i,["isConstructed"]);super(e),this.isConstructed=t}fromBER(t,e,n){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,i=ee.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(let o=0;o<this.value.length;o++){const s=this.value[o].constructor.NAME;if(s===Br){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(s!==Il)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(t,e,n),this.blockLength=n;return i}toBER(t,e){return this.isConstructed?ee.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return W(V({},super.toJSON()),{isConstructed:this.isConstructed})}}Ll.NAME="OctetStringValueBlock";var eo;let fe=class extends rt{constructor(n={}){var i=n,{idBlock:r={},lenBlock:t={}}=i,e=q(i,["idBlock","lenBlock"]);var o,s;(o=e.isConstructed)!==null&&o!==void 0||(e.isConstructed=!!(!((s=e.value)===null||s===void 0)&&s.length)),super(V({idBlock:V({isConstructed:e.isConstructed},r),lenBlock:W(V({},t),{isIndefiniteForm:!!e.isIndefiniteForm})},e),Ll),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,t,e){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,e===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(t,t+e);try{if(n.byteLength){const i=Ye(n,0,n.byteLength);i.offset!==-1&&i.offset===e&&(this.valueBlock.value=[i.result])}}catch(i){}}return super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ot.prototype.onAsciiEncoding.call(this);const r=this.constructor.NAME,t=E.ToHex(this.valueBlock.valueHexView);return"".concat(r," : ").concat(t)}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const t of this.valueBlock.value)t instanceof eo&&r.push(t.valueBlock.valueHexView);return A.concat(r)}};eo=fe,x.OctetString=eo,fe.NAME=Il;class Hl extends Ht(ee){constructor(i={}){var o=i,{unusedBits:t=0,isConstructed:e=!1}=o,n=q(o,["unusedBits","isConstructed"]);super(n),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,n){if(!n)return e;let i=-1;if(this.isConstructed){if(i=ee.prototype.fromBER.call(this,t,e,n),i===-1)return i;for(const c of this.value){const u=c.constructor.NAME;if(u===Br){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(u!==Tl)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const h=c.valueBlock;if(this.unusedBits>0&&h.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=h.unusedBits}return i}const o=A.toUint8Array(t);if(!Gt(this,o,e,n))return-1;const s=o.subarray(e,e+n);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const c=s.subarray(1);try{if(c.byteLength){const u=Ye(c,0,c.byteLength);u.offset!==-1&&u.offset===n-1&&(this.value=[u.result])}}catch(u){}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,e+n}toBER(t,e){if(this.isConstructed)return ee.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Nt;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return W(V({},super.toJSON()),{unusedBits:this.unusedBits,isConstructed:this.isConstructed})}}Hl.NAME="BitStringValueBlock";var ba;let ye=class extends rt{constructor(n={}){var i=n,{idBlock:r={},lenBlock:t={}}=i,e=q(i,["idBlock","lenBlock"]);var o,s;(o=e.isConstructed)!==null&&o!==void 0||(e.isConstructed=!!(!((s=e.value)===null||s===void 0)&&s.length)),super(V({idBlock:V({isConstructed:e.isConstructed},r),lenBlock:W(V({},t),{isIndefiniteForm:!!e.isIndefiniteForm})},e),Hl),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,t,e){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,t,e)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ot.prototype.onAsciiEncoding.call(this);{const r=[],t=this.valueBlock.valueHexView;for(const o of t)r.push(o.toString(2).padStart(8,"0"));const e=r.join(""),n=this.constructor.NAME,i=e.substring(0,e.length-this.valueBlock.unusedBits);return"".concat(n," : ").concat(i)}}};ba=ye,x.BitString=ba,ye.NAME=Tl;var wa;function Oh(r,t){const e=new Uint8Array([0]),n=new Uint8Array(r),i=new Uint8Array(t);let o=n.slice(0);const s=o.length-1,c=i.slice(0),u=c.length-1;let h=0;const g=u<s?s:u;let d=0;for(let j=g;j>=0;j--,d++){switch(!0){case d<c.length:h=o[s-d]+c[u-d]+e[0];break;default:h=o[s-d]+e[0]}switch(e[0]=h/10,!0){case d>=o.length:o=Qn(new Uint8Array([h%10]),o);break;default:o[s-d]=h%10}}return e[0]>0&&(o=Qn(e,o)),o}function Aa(r){if(r>=er.length)for(let t=er.length;t<=r;t++){const e=new Uint8Array([0]);let n=er[t-1].slice(0);for(let i=n.length-1;i>=0;i--){const o=new Uint8Array([(n[i]<<1)+e[0]]);e[0]=o[0]/10,n[i]=o[0]%10}e[0]>0&&(n=Qn(e,n)),er.push(n)}return er[r]}function Ch(r,t){let e=0;const n=new Uint8Array(r),i=new Uint8Array(t),o=n.slice(0),s=o.length-1,c=i.slice(0),u=c.length-1;let h,g=0;for(let d=u;d>=0;d--,g++)switch(h=o[s-g]-c[u-g]-e,!0){case h<0:e=1,o[s-g]=h+10;break;default:e=0,o[s-g]=h}if(e>0)for(let d=s-u+1;d>=0;d--,g++)if(h=o[s-g]-e,h<0)e=1,o[s-g]=h+10;else{e=0,o[s-g]=h;break}return o.slice()}class ro extends Ht(ct){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Cl.call(this)))}constructor(n={}){var i=n,{value:t}=i,e=q(i,["value"]);super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),t!==void 0&&(this.valueDec=t)}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(fh(t))}get valueDec(){return this._valueDec}fromDER(t,e,n,i=0){const o=this.fromBER(t,e,n);if(o===-1)return o;const s=this.valueHexView;return s[0]===0&&(s[1]&128)!==0?this.valueHexView=s.subarray(1):i!==0&&s.length<i&&(i-s.length>1&&(i=s.length+1),this.valueHexView=s.subarray(i-s.length)),o}toDER(t=!1){const e=this.valueHexView;switch(!0){case(e[0]&128)!==0:{const n=new Uint8Array(this.valueHexView.length+1);n[0]=0,n.set(e,1),this.valueHexView=n}break;case(e[0]===0&&(e[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(t)}fromBER(t,e,n){const i=super.fromBER(t,e,n);return i===-1||this.setValueHex(),i}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return W(V({},super.toJSON()),{valueDec:this.valueDec})}toString(){const t=this.valueHexView.length*8-1;let e=new Uint8Array(this.valueHexView.length*8/3),n=0,i;const o=this.valueHexView;let s="",c=!1;for(let u=o.byteLength-1;u>=0;u--){i=o[u];for(let h=0;h<8;h++){if((i&1)===1)switch(n){case t:e=Ch(Aa(n),e),s="-";break;default:e=Oh(e,Aa(n))}n++,i>>=1}}for(let u=0;u<e.length;u++)e[u]&&(c=!0),c&&(s+=pa.charAt(e[u]));return c===!1&&(s+=pa.charAt(0)),s}}wa=ro,ro.NAME="IntegerValueBlock",Object.defineProperty(wa.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var pr;class _e extends rt{constructor(t={}){super(t,ro),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return pi(),BigInt(this.valueBlock.toString())}static fromBigInt(t){pi();const e=BigInt(t),n=new fn,i=e.toString(16).replace(/^-/,""),o=new Uint8Array(E.FromHex(i));if(e<0){const s=new Uint8Array(o.length+(o[0]&128?1:0));s[0]|=128;const c=BigInt("0x".concat(E.ToHex(s)))+e,u=A.toUint8Array(E.FromHex(c.toString(16)));u[0]|=128,n.write(u)}else o[0]&128&&n.write(new Uint8Array([0])),n.write(o);return new pr({valueHex:n.final()})}convertToDER(){const t=new pr({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new pr({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString())}}pr=_e,x.Integer=pr,_e.NAME="INTEGER";var Sa;class yi extends _e{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Sa=yi,x.Enumerated=Sa,yi.NAME="ENUMERATED";class io extends Ht(ct){constructor(i={}){var o=i,{valueDec:t=-1,isFirstSid:e=!1}=o,n=q(o,["valueDec","isFirstSid"]);super(n),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,n){if(!n)return e;const i=A.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const o=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=o[c]&127,this.blockLength++,(o[c]&128)!==0);c++);const s=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)s[c]=this.valueHexView[c];return this.valueHexView=s,(o[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Fe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){pi();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const n=new Uint8Array(e.length/7);for(let i=0;i<n.length;i++)n[i]=parseInt(e.slice(i*7,i*7+7),2)+(i+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,o=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength-1;s++)o[s]=i[s]|128;return o[this.blockLength-1]=i[this.blockLength-1],o.buffer}const e=ge(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",Nt;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),o=e.byteLength-1;for(let s=0;s<o;s++)n[s]=i[s]|128;n[o]=i[o]}return n}toString(){let t="";if(this.isHexOnly)t=E.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return W(V({},super.toJSON()),{valueDec:this.valueDec,isFirstSid:this.isFirstSid})}}io.NAME="sidBlock";class Ml extends ct{constructor(n={}){var i=n,{value:t=ht}=i,e=q(i,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const o=new io;if(i=o.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=o.error,i;this.value.length===0&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,n-=o.blockLength,this.value.push(o)}return i}toBER(t){const e=[];for(let n=0;n<this.value.length;n++){const i=this.value[n].toBER(t);if(i.byteLength===0)return this.error=this.value[n].error,Nt;e.push(i)}return Os(e)}fromString(t){this.value=[];let e=0,n=0,i="",o=!1;do if(n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1,o){const s=this.value[0];let c=0;switch(s.valueDec){case 0:break;case 1:c=40;break;case 2:c=80;break;default:this.value=[];return}const u=parseInt(i,10);if(isNaN(u))return;s.valueDec=u+c,o=!1}else{const s=new io;if(i>Number.MAX_SAFE_INTEGER){pi();const c=BigInt(i);s.valueBigInt=c}else if(s.valueDec=parseInt(i,10),isNaN(s.valueDec))return;this.value.length||(s.isFirstSid=!0,o=!0),this.value.push(s)}while(n!==-1)}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t="".concat(t,".")),e?(i="{".concat(i,"}"),this.value[n].isFirstSid?t="2.{".concat(i," - 80}"):t+=i):t+=i}return t}toJSON(){const t=W(V({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Ml.NAME="ObjectIdentifierValueBlock";var Ba;class di extends rt{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,Ml),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return W(V({},super.toJSON()),{value:this.getValue()})}}Ba=di,x.ObjectIdentifier=Ba,di.NAME="OBJECT IDENTIFIER";class no extends Ht(Be){constructor(n={}){var i=n,{valueDec:t=0}=i,e=q(i,["valueDec"]);super(e),this.valueDec=t}fromBER(t,e,n){if(n===0)return e;const i=A.toUint8Array(t);if(!Gt(this,i,e,n))return-1;const o=i.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let c=0;c<n&&(this.valueHexView[c]=o[c]&127,this.blockLength++,(o[c]&128)!==0);c++);const s=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength;c++)s[c]=this.valueHexView[c];return this.valueHexView=s,(o[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Fe(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const i=this.valueHexView,o=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength-1;s++)o[s]=i[s]|128;return o[this.blockLength-1]=i[this.blockLength-1],o.buffer}const e=ge(this.valueDec,7);if(e.byteLength===0)return this.error="Error during encoding SID value",Nt;const n=new Uint8Array(e.byteLength);if(!t){const i=new Uint8Array(e),o=e.byteLength-1;for(let s=0;s<o;s++)n[s]=i[s]|128;n[o]=i[o]}return n.buffer}toString(){let t="";return this.isHexOnly?t=E.ToHex(this.valueHexView):t=this.valueDec.toString(),t}toJSON(){return W(V({},super.toJSON()),{valueDec:this.valueDec})}}no.NAME="relativeSidBlock";class $l extends ct{constructor(n={}){var i=n,{value:t=ht}=i,e=q(i,["value"]);super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let i=e;for(;n>0;){const o=new no;if(i=o.fromBER(t,i,n),i===-1)return this.blockLength=0,this.error=o.error,i;this.blockLength+=o.blockLength,n-=o.blockLength,this.value.push(o)}return i}toBER(t,e){const n=[];for(let i=0;i<this.value.length;i++){const o=this.value[i].toBER(t);if(o.byteLength===0)return this.error=this.value[i].error,Nt;n.push(o)}return Os(n)}fromString(t){this.value=[];let e=0,n=0,i="";do{n=t.indexOf(".",e),n===-1?i=t.substring(e):i=t.substring(e,n),e=n+1;const o=new no;if(o.valueDec=parseInt(i,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(n!==-1);return!0}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let i=this.value[n].toString();n!==0&&(t="".concat(t,".")),e&&(i="{".concat(i,"}")),t+=i}return t}toJSON(){const t=W(V({},super.toJSON()),{value:this.toString(),sidArray:[]});for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}$l.NAME="RelativeObjectIdentifierValueBlock";var ka;class oo extends rt{getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}constructor(t={}){super(t,$l),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return W(V({},super.toJSON()),{value:this.getValue()})}}ka=oo,x.RelativeObjectIdentifier=ka,oo.NAME="RelativeObjectIdentifier";var xa;class Et extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}xa=Et,x.Sequence=xa,Et.NAME="SEQUENCE";var Oa;let Rt=class extends ot{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};Oa=Rt,x.Set=Oa,Rt.NAME="SET";class Fl extends Ht(ct){constructor(e={}){var t=q(e,[]);super(t),this.isHexOnly=!0,this.value=ht}toJSON(){return W(V({},super.toJSON()),{value:this.value})}}Fl.NAME="StringValueBlock";class _l extends Fl{}_l.NAME="SimpleStringValueBlock";class gt extends Cs{constructor(e={}){var t=q(e,[]);super(t,_l)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,A.toUint8Array(t))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);this.valueBlock.value=t}}gt.NAME="SIMPLE STRING";class zl extends gt{fromBuffer(t){this.valueBlock.valueHexView=A.toUint8Array(t);try{this.valueBlock.value=E.ToUtf8String(t)}catch(e){this.warnings.push('Error during "decodeURIComponent": '.concat(e,", using raw string")),this.valueBlock.value=E.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(E.FromUtf8String(t)),this.valueBlock.value=t}}zl.NAME="Utf8StringValueBlock";var Ca;class zt extends zl{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Ca=zt,x.Utf8String=Ca,zt.NAME="UTF8String";class ql extends gt{fromBuffer(t){this.valueBlock.value=E.ToUtf16String(t),this.valueBlock.valueHexView=A.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(E.FromUtf16String(t))}}ql.NAME="BmpStringValueBlock";var Ea;class gi extends ql{constructor(e={}){var t=q(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Ea=gi,x.BmpString=Ea,gi.NAME="BMPString";class Kl extends gt{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),n=new Uint8Array(e);for(let i=0;i<n.length;i+=4)n[i]=n[i+3],n[i+1]=n[i+2],n[i+2]=0,n[i+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e*4);for(let i=0;i<e;i++){const o=ge(t.charCodeAt(i),8),s=new Uint8Array(o);if(s.length>4)continue;const c=4-s.length;for(let u=s.length-1;u>=0;u--)n[i*4+u+c]=s[u]}this.valueBlock.value=t}}Kl.NAME="UniversalStringValueBlock";var Na;class vi extends Kl{constructor(e={}){var t=q(e,[]);super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Na=vi,x.UniversalString=Na,vi.NAME="UniversalString";var Ia;class mi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Ia=mi,x.NumericString=Ia,mi.NAME="NumericString";var Ta;class bi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Ta=bi,x.PrintableString=Ta,bi.NAME="PrintableString";var ja;class wi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}ja=wi,x.TeletexString=ja,wi.NAME="TeletexString";var Pa;class Ai extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Pa=Ai,x.VideotexString=Pa,Ai.NAME="VideotexString";var Ua;class Si extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Ua=Si,x.IA5String=Ua,Si.NAME="IA5String";var Va;class Bi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Va=Bi,x.GraphicString=Va,Bi.NAME="GraphicString";var Ra;class xr extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Ra=xr,x.VisibleString=Ra,xr.NAME="VisibleString";var Da;class ki extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Da=ki,x.GeneralString=Da,ki.NAME="GeneralString";var La;class xi extends gt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}La=xi,x.CharacterString=La,xi.NAME="CharacterString";var Ha;class Or extends xr{constructor(i={}){var o=i,{value:t,valueDate:e}=o,n=q(o,["value","valueDate"]);if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let s=0;s<t.length;s++)this.valueBlock.valueHexView[s]=t.charCodeAt(s)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,A.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(t);if(e===null){this.error="Wrong input string for conversion";return}const n=parseInt(e[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(t="iso"){if(t==="iso"){const e=new Array(7);return e[0]=yt(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=yt(this.month,2),e[2]=yt(this.day,2),e[3]=yt(this.hour,2),e[4]=yt(this.minute,2),e[5]=yt(this.second,2),e[6]="Z",e.join("")}return super.toString(t)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.toDate().toISOString())}toJSON(){return W(V({},super.toJSON()),{year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second})}}Ha=Or,x.UTCTime=Ha,Or.NAME="UTCTime";var Ma;class Oi extends Or{constructor(t={}){var e;super(t),(e=this.millisecond)!==null&&e!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){const t=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond);return new Date(t)}fromString(t){let e=!1,n="",i="",o=0,s,c=0,u=0;if(t[t.length-1]==="Z")n=t.substring(0,t.length-1),e=!0;else{const d=new Number(t[t.length-1]);if(isNaN(d.valueOf()))throw new Error("Wrong input string for conversion");n=t}if(e){if(n.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(n.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let d=1,j=n.indexOf("+"),H="";if(j===-1&&(j=n.indexOf("-"),d=-1),j!==-1){if(H=n.substring(j+1),n=n.substring(0,j),H.length!==2&&H.length!==4)throw new Error("Wrong input string for conversion");let U=parseInt(H.substring(0,2),10);if(isNaN(U.valueOf()))throw new Error("Wrong input string for conversion");if(c=d*U,H.length===4){if(U=parseInt(H.substring(2,4),10),isNaN(U.valueOf()))throw new Error("Wrong input string for conversion");u=d*U}}}let h=n.indexOf(".");if(h===-1&&(h=n.indexOf(",")),h!==-1){const d=new Number("0".concat(n.substring(h)));if(isNaN(d.valueOf()))throw new Error("Wrong input string for conversion");o=d.valueOf(),i=n.substring(0,h)}else i=n;switch(!0){case i.length===8:if(s=/(\d{4})(\d{2})(\d{2})/ig,h!==-1)throw new Error("Wrong input string for conversion");break;case i.length===10:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,h!==-1){let d=60*o;this.minute=Math.floor(d),d=60*(d-this.minute),this.second=Math.floor(d),d=1e3*(d-this.second),this.millisecond=Math.floor(d)}break;case i.length===12:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,h!==-1){let d=60*o;this.second=Math.floor(d),d=1e3*(d-this.second),this.millisecond=Math.floor(d)}break;case i.length===14:if(s=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,h!==-1){const d=1e3*o;this.millisecond=Math.floor(d)}break;default:throw new Error("Wrong input string for conversion")}const g=s.exec(i);if(g===null)throw new Error("Wrong input string for conversion");for(let d=1;d<g.length;d++)switch(d){case 1:this.year=parseInt(g[d],10);break;case 2:this.month=parseInt(g[d],10);break;case 3:this.day=parseInt(g[d],10);break;case 4:this.hour=parseInt(g[d],10)+c;break;case 5:this.minute=parseInt(g[d],10)+u;break;case 6:this.second=parseInt(g[d],10);break;default:throw new Error("Wrong input string for conversion")}if(e===!1){const d=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=d.getUTCFullYear(),this.month=d.getUTCMonth(),this.day=d.getUTCDay(),this.hour=d.getUTCHours(),this.minute=d.getUTCMinutes(),this.second=d.getUTCSeconds(),this.millisecond=d.getUTCMilliseconds()}}toString(t="iso"){if(t==="iso"){const e=[];return e.push(yt(this.year,4)),e.push(yt(this.month,2)),e.push(yt(this.day,2)),e.push(yt(this.hour,2)),e.push(yt(this.minute,2)),e.push(yt(this.second,2)),this.millisecond!==0&&(e.push("."),e.push(yt(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(t)}toJSON(){return W(V({},super.toJSON()),{millisecond:this.millisecond})}}Ma=Oi,x.GeneralizedTime=Ma,Oi.NAME="GeneralizedTime";var $a;class so extends zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}$a=so,x.DATE=$a,so.NAME="DATE";var Fa;class ao extends zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Fa=ao,x.TimeOfDay=Fa,ao.NAME="TimeOfDay";var _a;class co extends zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}_a=co,x.DateTime=_a,co.NAME="DateTime";var za;class lo extends zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}za=lo,x.Duration=za,lo.NAME="Duration";var qa;class uo extends zt{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}qa=uo,x.TIME=qa,uo.NAME="TIME";class me{constructor({name:t=ht,optional:e=!1}={}){this.name=t,this.optional=e}}class Es extends me{constructor(n={}){var i=n,{value:t=[]}=i,e=q(i,["value"]);super(e),this.value=t}}class Ci extends me{constructor(i={}){var o=i,{value:t=new me,local:e=!1}=o,n=q(o,["value","local"]);super(n),this.value=t,this.local=e}}class Eh{get data(){return this.dataView.slice().buffer}set data(t){this.dataView=A.toUint8Array(t)}constructor({data:t=yn}={}){this.dataView=A.toUint8Array(t)}fromBER(t,e,n){const i=e+n;return this.dataView=A.toUint8Array(t).subarray(e,i),i}toBER(t){return this.dataView.slice().buffer}}function Xt(r,t,e){if(e instanceof Es){for(const i of e.value)if(Xt(r,t,i).verified)return{verified:!0,result:r};{const i={verified:!1,result:{error:"Wrong values for Choice type"}};return e.hasOwnProperty(On)&&(i.name=e.name),i}}if(e instanceof me)return e.hasOwnProperty(On)&&(r[e.name]=t),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(vh in e))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Ah in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Sh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=e.idBlock.toBER(!1);if(n.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(e.idBlock.fromBER(n,0,n.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(e.idBlock.hasOwnProperty(mh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(bh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:r};if(e.idBlock.hasOwnProperty(wh)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:r};if(!(gh in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(e.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:r};if(e.idBlock.isHexOnly){if(!(fa in e.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=e.idBlock.valueHexView,o=t.idBlock.valueHexView;if(i.length!==o.length)return{verified:!1,result:r};for(let s=0;s<i.length;s++)if(i[s]!==o[1])return{verified:!1,result:r}}if(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&(r[e.name]=t)),e instanceof x.Constructed){let i=0,o={verified:!1,result:{error:"Unknown error"}},s=e.valueBlock.value.length;if(s>0&&e.valueBlock.value[0]instanceof Ci&&(s=t.valueBlock.value.length),s===0)return{verified:!0,result:r};if(t.valueBlock.value.length===0&&e.valueBlock.value.length!==0){let c=!0;for(let u=0;u<e.valueBlock.value.length;u++)c=c&&(e.valueBlock.value[u].optional||!1);return c?{verified:!0,result:r}:(e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&delete r[e.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let c=0;c<s;c++)if(c-i>=t.valueBlock.value.length){if(e.valueBlock.value[c].optional===!1){const u={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&(delete r[e.name],u.name=e.name)),u}}else if(e.valueBlock.value[0]instanceof Ci){if(o=Xt(r,t.valueBlock.value[c],e.valueBlock.value[0].value),o.verified===!1)if(e.valueBlock.value[0].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&delete r[e.name]),o;if(On in e.valueBlock.value[0]&&e.valueBlock.value[0].name.length>0){let u={};Bh in e.valueBlock.value[0]&&e.valueBlock.value[0].local?u=t:u=r,typeof u[e.valueBlock.value[0].name]>"u"&&(u[e.valueBlock.value[0].name]=[]),u[e.valueBlock.value[0].name].push(t.valueBlock.value[c])}}else if(o=Xt(r,t.valueBlock.value[c-i],e.valueBlock.value[c]),o.verified===!1)if(e.valueBlock.value[c].optional)i++;else return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&delete r[e.name]),o;if(o.verified===!1){const c={verified:!1,result:r};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&(delete r[e.name],c.name=e.name)),c}return{verified:!0,result:r}}if(e.primitiveSchema&&fa in t.valueBlock){const i=Ye(t.valueBlock.valueHexView);if(i.offset===-1){const o={verified:!1,result:i.result};return e.name&&(e.name=e.name.replace(/^\s+|\s+$/g,ht),e.name&&(delete r[e.name],o.name=e.name)),o}return Xt(r,i.result,e.primitiveSchema)}return{verified:!0,result:r}}function Nh(r,t){if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const e=Ye(A.toUint8Array(r));return e.offset===-1?{verified:!1,result:e.result}:Xt(e.result,e.result,t)}const Wl=Object.freeze(Object.defineProperty({__proto__:null,Any:me,BaseBlock:rt,BaseStringBlock:Cs,BitString:ye,BmpString:gi,Boolean:fi,CharacterString:xi,Choice:Es,Constructed:ot,DATE:so,DateTime:co,Duration:lo,EndOfContent:to,Enumerated:yi,GeneralString:ki,GeneralizedTime:Oi,GraphicString:Bi,HexBlock:Ht,IA5String:Si,Integer:_e,Null:ve,NumericString:mi,ObjectIdentifier:di,OctetString:fe,Primitive:kr,PrintableString:bi,RawData:Eh,RelativeObjectIdentifier:oo,Repeated:Ci,Sequence:Et,Set:Rt,TIME:uo,TeletexString:wi,TimeOfDay:ao,UTCTime:Or,UniversalString:vi,Utf8String:zt,ValueBlock:ct,VideotexString:Ai,ViewWriter:fn,VisibleString:xr,compareSchema:Xt,fromBER:Le,verifySchema:Nh},Symbol.toStringTag,{value:"Module"}));var m;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(m||(m={}));var p;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(p||(p={}));class dn{constructor(t,e=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),t)if(typeof t=="number")this.fromNumber(t);else if(A.isBufferSource(t))this.unusedBits=e,this.value=A.toArrayBuffer(t);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(t){if(!(t instanceof ye))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=t.valueBlock.unusedBits,this.value=t.valueBlock.valueHex,this}toASN(){return new ye({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new ye({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const n of e)t+=n.toString(2).padStart(8,"0");return t=t.split("").reverse().join(""),this.unusedBits&&(t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(t,2)}fromNumber(t){let e=t.toString(2);const n=e.length+7>>3;this.unusedBits=(n<<3)-e.length;const i=new Uint8Array(n);e=e.padStart(n<<3,"0").split("").reverse().join("");let o=0;for(;o<n;)i[o]=parseInt(e.slice(o<<3,(o<<3)+8),2),o++;this.value=i.buffer}}class L{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(t){typeof t=="number"?this.buffer=new ArrayBuffer(t):A.isBufferSource(t)?this.buffer=A.toArrayBuffer(t):Array.isArray(t)?this.buffer=new Uint8Array(t):this.buffer=new ArrayBuffer(0)}fromASN(t){if(!(t instanceof fe))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=t.valueBlock.valueHex,this}toASN(){return new fe({valueHex:this.buffer})}toSchema(t){return new fe({name:t})}}const Ih={fromASN:r=>r instanceof ve?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new ve;const t=Le(r);if(t.result.error)throw new Error(t.result.error);return t.result}},Th={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new _e({value:+r})},jh={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new yi({value:r})},_={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new _e({valueHex:r})},Ph={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new ye({valueHex:r})},Uh={fromASN:r=>r.valueBlock.toString(),toASN:r=>new di({value:r})},Vh={fromASN:r=>r.valueBlock.value,toASN:r=>new fi({value:r})},Ei={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new fe({valueHex:r})},Rh={fromASN:r=>new L(r.getValue()),toASN:r=>r.toASN()};function At(r){return{fromASN:t=>t.valueBlock.value,toASN:t=>new r({value:t})}}const Gl=At(zt),Dh=At(gi),Lh=At(vi),Hh=At(mi),Mh=At(bi),$h=At(wi),Fh=At(Ai),_h=At(Si),zh=At(Bi),qh=At(xr),Kh=At(ki),Wh=At(xi),Gh={fromASN:r=>r.toDate(),toASN:r=>new Or({valueDate:r})},Jh={fromASN:r=>r.toDate(),toASN:r=>new Oi({valueDate:r})},Zh={fromASN:()=>null,toASN:()=>new ve};function fr(r){switch(r){case p.Any:return Ih;case p.BitString:return Ph;case p.BmpString:return Dh;case p.Boolean:return Vh;case p.CharacterString:return Wh;case p.Enumerated:return jh;case p.GeneralString:return Kh;case p.GeneralizedTime:return Jh;case p.GraphicString:return zh;case p.IA5String:return _h;case p.Integer:return Th;case p.Null:return Zh;case p.NumericString:return Hh;case p.ObjectIdentifier:return Uh;case p.OctetString:return Ei;case p.PrintableString:return Mh;case p.TeletexString:return $h;case p.UTCTime:return Gh;case p.UniversalString:return Lh;case p.Utf8String:return Gl;case p.VideotexString:return Fh;case p.VisibleString:return qh;default:return null}}function _t(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:_t(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function Jl(r){var t;if(r){const e=Object.getPrototypeOf(r);return((t=e==null?void 0:e.prototype)===null||t===void 0?void 0:t.constructor)===Array?!0:Jl(e)}return!1}function Yh(r,t){if(!(r&&t)||r.byteLength!==t.byteLength)return!1;const e=new Uint8Array(r),n=new Uint8Array(t);for(let i=0;i<r.byteLength;i++)if(e[i]!==n[i])return!1;return!0}class Xh{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,e=!1){const n=this.items.get(t);if(!n)throw new Error("Cannot get schema for '".concat(t.prototype.constructor.name,"' target"));if(e&&!n.schema)throw new Error("Schema '".concat(t.prototype.constructor.name,"' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'."));return n}cache(t){const e=this.get(t);e.schema||(e.schema=this.create(t,!0))}createDefault(t){const e={type:m.Sequence,items:{}},n=this.findParentSchema(t);return n&&(Object.assign(e,n),e.items=Object.assign({},e.items,n.items)),e}create(t,e){const n=this.items.get(t)||this.createDefault(t),i=[];for(const o in n.items){const s=n.items[o],c=e?o:"";let u;if(typeof s.type=="number"){const g=p[s.type],d=Wl[g];if(!d)throw new Error("Cannot get ASN1 class by name '".concat(g,"'"));u=new d({name:c})}else _t(s.type)?u=new s.type().toSchema(c):s.optional?this.get(s.type).type===m.Choice?u=new me({name:c}):(u=this.create(s.type,!1),u.name=c):u=new me({name:c});const h=!!s.optional||s.defaultValue!==void 0;if(s.repeated){u.name="";const g=s.repeated==="set"?Rt:Et;u=new g({name:"",value:[new Ci({name:c,value:u})]})}if(s.context!==null&&s.context!==void 0)if(s.implicit)if(typeof s.type=="number"||_t(s.type)){const g=s.repeated?ot:kr;i.push(new g({name:c,optional:h,idBlock:{tagClass:3,tagNumber:s.context}}))}else{this.cache(s.type);const g=!!s.repeated;let d=g?u:this.get(s.type,!0).schema;d="valueBlock"in d?d.valueBlock.value:d.value,i.push(new ot({name:g?"":c,optional:h,idBlock:{tagClass:3,tagNumber:s.context},value:d}))}else i.push(new ot({optional:h,idBlock:{tagClass:3,tagNumber:s.context},value:[u]}));else u.optional=h,i.push(u)}switch(n.type){case m.Sequence:return new Et({value:i,name:""});case m.Set:return new Rt({value:i,name:""});case m.Choice:return new Es({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(t,e){return this.items.set(t,e),this}findParentSchema(t){const e=Object.getPrototypeOf(t);return e?this.items.get(e)||this.findParentSchema(e):null}}const X=new Xh,b=r=>t=>{let e;X.has(t)?e=X.get(t):(e=X.createDefault(t),X.set(t,e)),Object.assign(e,r)},l=r=>(t,e)=>{let n;X.has(t.constructor)?n=X.get(t.constructor):(n=X.createDefault(t.constructor),X.set(t.constructor,n));const i=Object.assign({},r);if(typeof i.type=="number"&&!i.converter){const o=fr(r.type);if(!o)throw new Error("Cannot get default converter for property '".concat(e,"' of ").concat(t.constructor.name));i.converter=o}i.raw=r.raw,n.items[e]=i};class rr extends Error{constructor(){super(...arguments),this.schemas=[]}}class Qh{static parse(t,e){const n=Le(t);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,e)}static fromASN(t,e){try{if(_t(e))return new e().fromASN(t);const n=X.get(e);X.cache(e);let i=n.schema;const o=this.handleChoiceTypes(t,n,e,i);if(o!=null&&o.result)return o.result;o!=null&&o.targetSchema&&(i=o.targetSchema);const s=this.handleSequenceTypes(t,n,e,i);if(s&&"isManualMapping"in s)return s.result;const c=s,u=new e;return Jl(e)?this.handleArrayTypes(t,n,e):(this.processSchemaItems(n,c,u),u)}catch(n){throw n instanceof rr&&n.schemas.push(e.name),n}}static handleChoiceTypes(t,e,n,i){if(t.constructor===ot&&e.type===m.Choice&&t.idBlock.tagClass===3)for(const o in e.items){const s=e.items[o];if(s.context===t.idBlock.tagNumber&&s.implicit&&typeof s.type=="function"&&X.has(s.type)){const c=X.get(s.type);if(c&&c.type===m.Sequence){const u=new Et;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in u.valueBlock){u.valueBlock.value=t.valueBlock.value;const h=this.fromASN(u,s.type),g=new n;return g[o]=h,{result:g}}}}}else if(t.constructor===ot&&e.type!==m.Choice){const o=new ot({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:e.schema.valueBlock.value});for(const s in e.items)delete t[s];return{targetSchema:o}}return null}static handleSequenceTypes(t,e,n,i){if(e.type===m.Sequence){if(Object.keys(e.items).filter(s=>{const c=e.items[s];return c.optional&&typeof c.type=="function"&&X.has(c.type)&&X.get(c.type).type===m.Choice}).length>0&&"value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&n.name==="CertReqMsg")return this.handleManualMapping(t,e,n);const o=Xt({},t,i);if(!o.verified)throw new rr("Data does not match to ".concat(n.name," ASN1 schema.").concat(o.result.error?" ".concat(o.result.error):""));return o}else{const o=Xt({},t,i);if(!o.verified)throw new rr("Data does not match to ".concat(n.name," ASN1 schema.").concat(o.result.error?" ".concat(o.result.error):""));return o}}static handleManualMapping(t,e,n){const i=new n,o=t.valueBlock.value,s=Object.keys(e.items);let c=0;for(let u=0;u<s.length;u++){const h=s[u],g=e.items[h];if(c>=o.length)break;if(g.repeated){i[h]=this.processRepeatedField(o,c,g);break}else if(typeof g.type=="number")i[h]=this.processPrimitiveField(o[c],g),c++;else if(this.isOptionalChoiceField(g)){const d=this.processOptionalChoiceField(o[c],g);d.processed&&(i[h]=d.value,c++)}else i[h]=this.fromASN(o[c],g.type),c++}return{result:i,verified:!0,isManualMapping:!0}}static processRepeatedField(t,e,n){let i=t.slice(e);if(i.length===1&&i[0].constructor.name==="Sequence"){const o=i[0];o.valueBlock&&o.valueBlock.value&&Array.isArray(o.valueBlock.value)&&(i=o.valueBlock.value)}if(typeof n.type=="number"){const o=fr(n.type);if(!o)throw new Error("No converter for ASN.1 type ".concat(n.type));return i.filter(s=>s&&s.valueBlock).map(s=>{try{return o.fromASN(s)}catch(c){return}}).filter(s=>s!==void 0)}else return i.filter(o=>o&&o.valueBlock).map(o=>{try{return this.fromASN(o,n.type)}catch(s){return}}).filter(o=>o!==void 0)}static processPrimitiveField(t,e){const n=fr(e.type);if(!n)throw new Error("No converter for ASN.1 type ".concat(e.type));return n.fromASN(t)}static isOptionalChoiceField(t){return t.optional&&typeof t.type=="function"&&X.has(t.type)&&X.get(t.type).type===m.Choice}static processOptionalChoiceField(t,e){try{return{processed:!0,value:this.fromASN(t,e.type)}}catch(n){if(n instanceof rr&&/Wrong values for Choice type/.test(n.message))return{processed:!1};throw n}}static handleArrayTypes(t,e,n){if(!("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const i=e.itemType;if(typeof i=="number"){const o=fr(i);if(!o)throw new Error("Cannot get default converter for array item of ".concat(n.name," ASN1 schema"));return n.from(t.valueBlock.value,s=>o.fromASN(s))}else return n.from(t.valueBlock.value,o=>this.fromASN(o,i))}static processSchemaItems(t,e,n){for(const i in t.items){const o=e.result[i];if(!o)continue;const s=t.items[i],c=s.type;let u;typeof c=="number"||_t(c)?u=this.processPrimitiveSchemaItem(o,s,c):u=this.processComplexSchemaItem(o,s,c),u&&typeof u=="object"&&"value"in u&&"raw"in u?(n[i]=u.value,n["".concat(i,"Raw")]=u.raw):n[i]=u}}static processPrimitiveSchemaItem(t,e,n){var i;const o=(i=e.converter)!==null&&i!==void 0?i:_t(n)?new n:null;if(!o)throw new Error("Converter is empty");return e.repeated?this.processRepeatedPrimitiveItem(t,e,o):this.processSinglePrimitiveItem(t,e,n,o)}static processRepeatedPrimitiveItem(t,e,n){if(e.implicit){const i=e.repeated==="sequence"?Et:Rt,o=new i;o.valueBlock=t.valueBlock;const s=Le(o.toBER(!1));if(s.offset===-1)throw new Error("Cannot parse the child item. ".concat(s.result.error));if(!("value"in s.result.valueBlock&&Array.isArray(s.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const c=s.result.valueBlock.value;return Array.from(c,u=>n.fromASN(u))}else return Array.from(t,i=>n.fromASN(i))}static processSinglePrimitiveItem(t,e,n,i){let o=t;if(e.implicit){let s;if(_t(n))s=new n().toSchema("");else{const c=p[n],u=Wl[c];if(!u)throw new Error("Cannot get '".concat(c,"' class from asn1js module"));s=new u}s.valueBlock=o.valueBlock,o=Le(s.toBER(!1)).result}return i.fromASN(o)}static processComplexSchemaItem(t,e,n){if(e.repeated){if(!Array.isArray(t))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(t,i=>this.fromASN(i,n))}else{const i=this.handleImplicitTagging(t,e,n);if(this.isOptionalChoiceField(e))try{return this.fromASN(i,n)}catch(o){if(o instanceof rr&&/Wrong values for Choice type/.test(o.message))return;throw o}else{const o=this.fromASN(i,n);return e.raw?{value:o,raw:t.valueBeforeDecodeView}:o}}}static handleImplicitTagging(t,e,n){if(e.implicit&&typeof e.context=="number"){const i=X.get(n);if(i.type===m.Sequence){const o=new Et;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in o.valueBlock)return o.valueBlock.value=t.valueBlock.value,o}else if(i.type===m.Set){const o=new Rt;if("value"in t.valueBlock&&Array.isArray(t.valueBlock.value)&&"value"in o.valueBlock)return o.valueBlock.value=t.valueBlock.value,o}}return t}}class Ns{static serialize(t){return t instanceof rt?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){if(t&&typeof t=="object"&&_t(t))return t.toASN();if(!(t&&typeof t=="object"))throw new TypeError("Parameter 1 should be type of Object.");const e=t.constructor,n=X.get(e);X.cache(e);let i=[];if(n.itemType){if(!Array.isArray(t))throw new TypeError("Parameter 1 should be type of Array.");if(typeof n.itemType=="number"){const s=fr(n.itemType);if(!s)throw new Error("Cannot get default converter for array item of ".concat(e.name," ASN1 schema"));i=t.map(c=>s.toASN(c))}else i=t.map(s=>this.toAsnItem({type:n.itemType},"[]",e,s))}else for(const s in n.items){const c=n.items[s],u=t[s];if(u===void 0||c.defaultValue===u||typeof c.defaultValue=="object"&&typeof u=="object"&&Yh(this.serialize(c.defaultValue),this.serialize(u)))continue;const h=Ns.toAsnItem(c,s,e,u);if(typeof c.context=="number")if(c.implicit)if(!c.repeated&&(typeof c.type=="number"||_t(c.type))){const g={};g.valueHex=h instanceof ve?h.valueBeforeDecodeView:h.valueBlock.toBER(),i.push(new kr(V({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context}},g)))}else i.push(new ot({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:h.valueBlock.value}));else i.push(new ot({optional:c.optional,idBlock:{tagClass:3,tagNumber:c.context},value:[h]}));else c.repeated?i=i.concat(h):i.push(h)}let o;switch(n.type){case m.Sequence:o=new Et({value:i});break;case m.Set:o=new Rt({value:i});break;case m.Choice:if(!i[0])throw new Error("Schema '".concat(e.name,"' has wrong data. Choice cannot be empty."));o=i[0];break}return o}static toAsnItem(t,e,n,i){let o;if(typeof t.type=="number"){const s=t.converter;if(!s)throw new Error("Property '".concat(e,"' doesn't have converter for type ").concat(p[t.type]," in schema '").concat(n.name,"'"));if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const c=Array.from(i,h=>s.toASN(h)),u=t.repeated==="sequence"?Et:Rt;o=new u({value:c})}else o=s.toASN(i)}else if(t.repeated){if(!Array.isArray(i))throw new TypeError("Parameter 'objProp' should be type of Array.");const s=Array.from(i,u=>this.toASN(u)),c=t.repeated==="sequence"?Et:Rt;o=new c({value:s})}else o=this.toASN(i);return o}}class $ extends Array{constructor(t=[]){if(typeof t=="number")super(t);else{super();for(const e of t)this.push(e)}}}class S{static serialize(t){return Ns.serialize(t)}static parse(t,e){return Qh.parse(t,e)}static toString(t){const e=A.isBufferSource(t)?A.toArrayBuffer(t):S.serialize(t),n=Le(e);if(n.offset===-1)throw new Error("Cannot decode ASN.1 data. ".concat(n.result.error));return n.result.toString()}}function a(r,t,e,n){var i=arguments.length,o=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,t,e,n);else for(var c=r.length-1;c>=0;c--)(s=r[c])&&(o=(i<3?s(o):i>3?s(t,e,o):s(t,e))||o);return i>3&&o&&Object.defineProperty(t,e,o),o}class Ka{static isIPv4(t){return/^(\d{1,3}\.){3}\d{1,3}$/.test(t)}static parseIPv4(t){const e=t.split(".");if(e.length!==4)throw new Error("Invalid IPv4 address");return e.map(n=>{const i=parseInt(n,10);if(isNaN(i)||i<0||i>255)throw new Error("Invalid IPv4 address part");return i})}static parseIPv6(t){const e=this.expandIPv6(t).split(":");if(e.length!==8)throw new Error("Invalid IPv6 address");return e.reduce((n,i)=>{const o=parseInt(i,16);if(isNaN(o)||o<0||o>65535)throw new Error("Invalid IPv6 address part");return n.push(o>>8&255),n.push(o&255),n},[])}static expandIPv6(t){if(!t.includes("::"))return t;const e=t.split("::");if(e.length>2)throw new Error("Invalid IPv6 address");const n=e[0]?e[0].split(":"):[],i=e[1]?e[1].split(":"):[],o=8-(n.length+i.length);if(o<0)throw new Error("Invalid IPv6 address");return[...n,...Array(o).fill("0"),...i].join(":")}static formatIPv6(t){const e=[];for(let n=0;n<16;n+=2)e.push((t[n]<<8|t[n+1]).toString(16));return this.compressIPv6(e.join(":"))}static compressIPv6(t){const e=t.split(":");let n=-1,i=0,o=-1,s=0;for(let c=0;c<e.length;c++)e[c]==="0"?(o===-1&&(o=c),s++):(s>i&&(n=o,i=s),o=-1,s=0);if(s>i&&(n=o,i=s),i>1){const c=e.slice(0,n).join(":"),u=e.slice(n+i).join(":");return"".concat(c,"::").concat(u)}return t}static parseCIDR(t){const[e,n]=t.split("/"),i=parseInt(n,10);if(this.isIPv4(e)){if(i<0||i>32)throw new Error("Invalid IPv4 prefix length");return[this.parseIPv4(e),i]}else{if(i<0||i>128)throw new Error("Invalid IPv6 prefix length");return[this.parseIPv6(e),i]}}static decodeIP(t){if(t.length===64&&parseInt(t,16)===0)return"::/0";if(t.length!==16)return t;const e=parseInt(t.slice(8),16).toString(2).split("").reduce((i,o)=>i+ +o,0);let n=t.slice(0,8).replace(/(.{2})/g,i=>"".concat(parseInt(i,16),"."));return n=n.slice(0,-1),"".concat(n,"/").concat(e)}static toString(t){const e=new Uint8Array(t);if(e.length===4)return Array.from(e).join(".");if(e.length===16)return this.formatIPv6(e);if(e.length===8||e.length===32){const n=e.length/2,i=e.slice(0,n),o=e.slice(n);if(e.every(c=>c===0))return e.length===8?"0.0.0.0/0":"::/0";const s=o.reduce((c,u)=>c+(u.toString(2).match(/1/g)||[]).length,0);return e.length===8?"".concat(Array.from(i).join("."),"/").concat(s):"".concat(this.formatIPv6(i),"/").concat(s)}return this.decodeIP(E.ToHex(t))}static fromString(t){if(t.includes("/")){const[n,i]=this.parseCIDR(t),o=new Uint8Array(n.length);let s=i;for(let u=0;u<o.length;u++)s>=8?(o[u]=255,s-=8):s>0&&(o[u]=255<<8-s,s=0);const c=new Uint8Array(n.length*2);return c.set(n,0),c.set(o,n.length),c.buffer}const e=this.isIPv4(t)?this.parseIPv4(t):this.parseIPv6(t);return new Uint8Array(e).buffer}}var ho,po,fo;let tt=class{constructor(r={}){Object.assign(this,r)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};a([l({type:p.TeletexString})],tt.prototype,"teletexString",void 0),a([l({type:p.PrintableString})],tt.prototype,"printableString",void 0),a([l({type:p.UniversalString})],tt.prototype,"universalString",void 0),a([l({type:p.Utf8String})],tt.prototype,"utf8String",void 0),a([l({type:p.BmpString})],tt.prototype,"bmpString",void 0),tt=a([b({type:m.Choice})],tt);let Te=class extends tt{constructor(r={}){super(r),Object.assign(this,r)}toString(){return this.ia5String||(this.anyValue?E.ToHex(this.anyValue):super.toString())}};a([l({type:p.IA5String})],Te.prototype,"ia5String",void 0),a([l({type:p.Any})],Te.prototype,"anyValue",void 0),Te=a([b({type:m.Choice})],Te);class Ni{constructor(t={}){this.type="",this.value=new Te,Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Ni.prototype,"type",void 0),a([l({type:Te})],Ni.prototype,"value",void 0);let ze=ho=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ho.prototype)}};ze=ho=a([b({type:m.Set,itemType:Ni})],ze);let yo=po=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,po.prototype)}};yo=po=a([b({type:m.Sequence,itemType:ze})],yo);let Q=fo=class extends yo{constructor(r){super(r),Object.setPrototypeOf(this,fo.prototype)}};Q=fo=a([b({type:m.Sequence})],Q);const tp={fromASN:r=>Ka.toString(Ei.fromASN(r)),toASN:r=>Ei.toASN(Ka.fromString(r))};class Cr{constructor(t={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Cr.prototype,"typeId",void 0),a([l({type:p.Any,context:0})],Cr.prototype,"value",void 0);class go{constructor(t={}){this.partyName=new tt,Object.assign(this,t)}}a([l({type:tt,optional:!0,context:0,implicit:!0})],go.prototype,"nameAssigner",void 0),a([l({type:tt,context:1,implicit:!0})],go.prototype,"partyName",void 0);let P=class{constructor(r={}){Object.assign(this,r)}};a([l({type:Cr,context:0,implicit:!0})],P.prototype,"otherName",void 0),a([l({type:p.IA5String,context:1,implicit:!0})],P.prototype,"rfc822Name",void 0),a([l({type:p.IA5String,context:2,implicit:!0})],P.prototype,"dNSName",void 0),a([l({type:p.Any,context:3,implicit:!0})],P.prototype,"x400Address",void 0),a([l({type:Q,context:4,implicit:!1})],P.prototype,"directoryName",void 0),a([l({type:go,context:5})],P.prototype,"ediPartyName",void 0),a([l({type:p.IA5String,context:6,implicit:!0})],P.prototype,"uniformResourceIdentifier",void 0),a([l({type:p.OctetString,context:7,implicit:!0,converter:tp})],P.prototype,"iPAddress",void 0),a([l({type:p.ObjectIdentifier,context:8,implicit:!0})],P.prototype,"registeredID",void 0),P=a([b({type:m.Choice})],P);const Is="1.3.6.1.5.5.7",ep="".concat(Is,".1"),Xe="".concat(Is,".3"),gn="".concat(Is,".48"),Wa="".concat(gn,".1"),Ga="".concat(gn,".2"),Ja="".concat(gn,".3"),Za="".concat(gn,".5"),ne="2.5.29";var vo;const mo="".concat(ep,".1");class Er{constructor(t={}){this.accessMethod="",this.accessLocation=new P,Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Er.prototype,"accessMethod",void 0),a([l({type:P})],Er.prototype,"accessLocation",void 0);let je=vo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,vo.prototype)}};je=vo=a([b({type:m.Sequence,itemType:Er})],je);const bo="".concat(ne,".35");class Ts extends L{}class ue{constructor(t={}){t&&Object.assign(this,t)}}a([l({type:Ts,context:0,optional:!0,implicit:!0})],ue.prototype,"keyIdentifier",void 0),a([l({type:P,context:1,optional:!0,implicit:!0,repeated:"sequence"})],ue.prototype,"authorityCertIssuer",void 0),a([l({type:p.Integer,context:2,optional:!0,implicit:!0,converter:_})],ue.prototype,"authorityCertSerialNumber",void 0);const Zl="".concat(ne,".19");class Ii{constructor(t={}){this.cA=!1,Object.assign(this,t)}}a([l({type:p.Boolean,defaultValue:!1})],Ii.prototype,"cA",void 0),a([l({type:p.Integer,optional:!0})],Ii.prototype,"pathLenConstraint",void 0);var wo;let st=wo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,wo.prototype)}};st=wo=a([b({type:m.Sequence,itemType:P})],st);var Ao;let Ya=Ao=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Ao.prototype)}};Ya=Ao=a([b({type:m.Sequence})],Ya);var So;const Yl="".concat(ne,".32");let Ft=class{constructor(r={}){Object.assign(this,r)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};a([l({type:p.IA5String})],Ft.prototype,"ia5String",void 0),a([l({type:p.VisibleString})],Ft.prototype,"visibleString",void 0),a([l({type:p.BmpString})],Ft.prototype,"bmpString",void 0),a([l({type:p.Utf8String})],Ft.prototype,"utf8String",void 0),Ft=a([b({type:m.Choice})],Ft);class Bo{constructor(t={}){this.organization=new Ft,this.noticeNumbers=[],Object.assign(this,t)}}a([l({type:Ft})],Bo.prototype,"organization",void 0),a([l({type:p.Integer,repeated:"sequence"})],Bo.prototype,"noticeNumbers",void 0);class ko{constructor(t={}){Object.assign(this,t)}}a([l({type:Bo,optional:!0})],ko.prototype,"noticeRef",void 0),a([l({type:Ft,optional:!0})],ko.prototype,"explicitText",void 0);let Hr=class{constructor(r={}){Object.assign(this,r)}};a([l({type:p.IA5String})],Hr.prototype,"cPSuri",void 0),a([l({type:ko})],Hr.prototype,"userNotice",void 0),Hr=a([b({type:m.Choice})],Hr);class xo{constructor(t={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],xo.prototype,"policyQualifierId",void 0),a([l({type:p.Any})],xo.prototype,"qualifier",void 0);class Ti{constructor(t={}){this.policyIdentifier="",Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Ti.prototype,"policyIdentifier",void 0),a([l({type:xo,repeated:"sequence",optional:!0})],Ti.prototype,"policyQualifiers",void 0);let ji=So=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,So.prototype)}};ji=So=a([b({type:m.Sequence,itemType:Ti})],ji);let Gr=class{constructor(r=0){this.value=r}};a([l({type:p.Integer})],Gr.prototype,"value",void 0),Gr=a([b({type:m.Choice})],Gr);let Xa=class extends Gr{};Xa=a([b({type:m.Choice})],Xa);var Oo;const Co="".concat(ne,".31");var kt;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(kt||(kt={}));class Xl extends dn{toJSON(){const t=[],e=this.toNumber();return e&kt.aACompromise&&t.push("aACompromise"),e&kt.affiliationChanged&&t.push("affiliationChanged"),e&kt.cACompromise&&t.push("cACompromise"),e&kt.certificateHold&&t.push("certificateHold"),e&kt.cessationOfOperation&&t.push("cessationOfOperation"),e&kt.keyCompromise&&t.push("keyCompromise"),e&kt.privilegeWithdrawn&&t.push("privilegeWithdrawn"),e&kt.superseded&&t.push("superseded"),e&kt.unused&&t.push("unused"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}let he=class{constructor(r={}){Object.assign(this,r)}};a([l({type:P,context:0,repeated:"sequence",implicit:!0})],he.prototype,"fullName",void 0),a([l({type:ze,context:1,implicit:!0})],he.prototype,"nameRelativeToCRLIssuer",void 0),he=a([b({type:m.Choice})],he);class He{constructor(t={}){Object.assign(this,t)}}a([l({type:he,context:0,optional:!0})],He.prototype,"distributionPoint",void 0),a([l({type:Xl,context:1,optional:!0,implicit:!0})],He.prototype,"reasons",void 0),a([l({type:P,context:2,optional:!0,repeated:"sequence",implicit:!0})],He.prototype,"cRLIssuer",void 0);let Me=Oo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Oo.prototype)}};Me=Oo=a([b({type:m.Sequence,itemType:He})],Me);var Eo;let Qa=Eo=class extends Me{constructor(r){super(r),Object.setPrototypeOf(this,Eo.prototype)}};Qa=Eo=a([b({type:m.Sequence,itemType:He})],Qa);class it{constructor(t={}){this.onlyContainsUserCerts=it.ONLY,this.onlyContainsCACerts=it.ONLY,this.indirectCRL=it.ONLY,this.onlyContainsAttributeCerts=it.ONLY,Object.assign(this,t)}}it.ONLY=!1,a([l({type:he,context:0,optional:!0})],it.prototype,"distributionPoint",void 0),a([l({type:p.Boolean,context:1,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsUserCerts",void 0),a([l({type:p.Boolean,context:2,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsCACerts",void 0),a([l({type:Xl,context:3,optional:!0,implicit:!0})],it.prototype,"onlySomeReasons",void 0),a([l({type:p.Boolean,context:4,defaultValue:it.ONLY,implicit:!0})],it.prototype,"indirectCRL",void 0),a([l({type:p.Boolean,context:5,defaultValue:it.ONLY,implicit:!0})],it.prototype,"onlyContainsAttributeCerts",void 0);var yr;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(yr||(yr={}));let Cn=class{constructor(r=yr.unspecified){this.reason=yr.unspecified,this.reason=r}toJSON(){return yr[this.reason]}toString(){return this.toJSON()}};a([l({type:p.Enumerated})],Cn.prototype,"reason",void 0),Cn=a([b({type:m.Choice})],Cn);var No;const Ql="".concat(ne,".37");let Pi=No=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,No.prototype)}};Pi=No=a([b({type:m.Sequence,itemType:p.ObjectIdentifier})],Pi);const rp="".concat(Xe,".1"),ip="".concat(Xe,".2"),np="".concat(Xe,".3"),op="".concat(Xe,".4"),sp="".concat(Xe,".8"),ap="".concat(Xe,".9");let En=class{constructor(r=new ArrayBuffer(0)){this.value=r}};a([l({type:p.Integer,converter:_})],En.prototype,"value",void 0),En=a([b({type:m.Choice})],En);let Nn=class{constructor(r){this.value=new Date,r&&(this.value=r)}};a([l({type:p.GeneralizedTime})],Nn.prototype,"value",void 0),Nn=a([b({type:m.Choice})],Nn);var Io;let tc=Io=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Io.prototype)}};tc=Io=a([b({type:m.Sequence})],tc);const tu="".concat(ne,".15");var xt;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(xt||(xt={}));class In extends dn{toJSON(){const t=this.toNumber(),e=[];return t&xt.cRLSign&&e.push("crlSign"),t&xt.dataEncipherment&&e.push("dataEncipherment"),t&xt.decipherOnly&&e.push("decipherOnly"),t&xt.digitalSignature&&e.push("digitalSignature"),t&xt.encipherOnly&&e.push("encipherOnly"),t&xt.keyAgreement&&e.push("keyAgreement"),t&xt.keyCertSign&&e.push("keyCertSign"),t&xt.keyEncipherment&&e.push("keyEncipherment"),t&xt.nonRepudiation&&e.push("nonRepudiation"),e}toString(){return"[".concat(this.toJSON().join(", "),"]")}}var To;class Jr{constructor(t={}){this.base=new P,this.minimum=0,Object.assign(this,t)}}a([l({type:P})],Jr.prototype,"base",void 0),a([l({type:p.Integer,context:0,defaultValue:0,implicit:!0})],Jr.prototype,"minimum",void 0),a([l({type:p.Integer,context:1,optional:!0,implicit:!0})],Jr.prototype,"maximum",void 0);let Ui=To=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,To.prototype)}};Ui=To=a([b({type:m.Sequence,itemType:Jr})],Ui);class ec{constructor(t={}){Object.assign(this,t)}}a([l({type:Ui,context:0,optional:!0,implicit:!0})],ec.prototype,"permittedSubtrees",void 0),a([l({type:Ui,context:1,optional:!0,implicit:!0})],ec.prototype,"excludedSubtrees",void 0);class rc{constructor(t={}){Object.assign(this,t)}}a([l({type:p.Integer,context:0,implicit:!0,optional:!0,converter:_})],rc.prototype,"requireExplicitPolicy",void 0),a([l({type:p.Integer,context:1,implicit:!0,optional:!0,converter:_})],rc.prototype,"inhibitPolicyMapping",void 0);var jo;class Po{constructor(t={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Po.prototype,"issuerDomainPolicy",void 0),a([l({type:p.ObjectIdentifier})],Po.prototype,"subjectDomainPolicy",void 0);let ic=jo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,jo.prototype)}};ic=jo=a([b({type:m.Sequence,itemType:Po})],ic);var Uo;const eu="".concat(ne,".17");let Vo=Uo=class extends st{constructor(r){super(r),Object.setPrototypeOf(this,Uo.prototype)}};Vo=Uo=a([b({type:m.Sequence})],Vo);let qt=class{constructor(r={}){this.type="",this.values=[],Object.assign(this,r)}};a([l({type:p.ObjectIdentifier})],qt.prototype,"type",void 0),a([l({type:p.Any,repeated:"set"})],qt.prototype,"values",void 0);var Ro;let nc=Ro=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ro.prototype)}};nc=Ro=a([b({type:m.Sequence,itemType:qt})],nc);const ru="".concat(ne,".14");class re extends Ts{}class oc{constructor(t={}){Object.assign(this,t)}}a([l({type:p.GeneralizedTime,context:0,implicit:!0,optional:!0})],oc.prototype,"notBefore",void 0),a([l({type:p.GeneralizedTime,context:1,implicit:!0,optional:!0})],oc.prototype,"notAfter",void 0);var dr;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(dr||(dr={}));class iu extends dn{toJSON(){const t=[],e=this.toNumber();return e&dr.pKIXCertificate&&t.push("pKIXCertificate"),e&dr.newExtensions&&t.push("newExtensions"),e&dr.keyUpdateAllowed&&t.push("keyUpdateAllowed"),t}toString(){return"[".concat(this.toJSON().join(", "),"]")}}class sc{constructor(t={}){this.entrustVers="",this.entrustInfoFlags=new iu,Object.assign(this,t)}}a([l({type:p.GeneralString})],sc.prototype,"entrustVers",void 0),a([l({type:iu})],sc.prototype,"entrustInfoFlags",void 0);var Do;let ac=Do=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Do.prototype)}};ac=Do=a([b({type:m.Sequence,itemType:Er})],ac);class k{constructor(t={}){this.algorithm="",Object.assign(this,t)}isEqual(t){return t instanceof k&&t.algorithm==this.algorithm&&(t.parameters&&this.parameters&&Ol(t.parameters,this.parameters)||t.parameters===this.parameters)}}a([l({type:p.ObjectIdentifier})],k.prototype,"algorithm",void 0),a([l({type:p.Any,optional:!0})],k.prototype,"parameters",void 0);class Vt{constructor(t={}){this.algorithm=new k,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:k})],Vt.prototype,"algorithm",void 0),a([l({type:p.BitString})],Vt.prototype,"subjectPublicKey",void 0);let et=class{constructor(r){if(r)if(typeof r=="string"||typeof r=="number"||r instanceof Date){const t=new Date(r);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,r)}getTime(){const r=this.utcTime||this.generalTime;if(!r)throw new Error("Cannot get time from CHOICE object");return r}};a([l({type:p.UTCTime})],et.prototype,"utcTime",void 0),a([l({type:p.GeneralizedTime})],et.prototype,"generalTime",void 0),et=a([b({type:m.Choice})],et);class Vi{constructor(t){this.notBefore=new et(new Date),this.notAfter=new et(new Date),t&&(this.notBefore=new et(t.notBefore),this.notAfter=new et(t.notAfter))}}a([l({type:et})],Vi.prototype,"notBefore",void 0),a([l({type:et})],Vi.prototype,"notAfter",void 0);var Lo;let Ct=class nu{constructor(t={}){this.extnID="",this.critical=nu.CRITICAL,this.extnValue=new L,Object.assign(this,t)}};Ct.CRITICAL=!1,a([l({type:p.ObjectIdentifier})],Ct.prototype,"extnID",void 0),a([l({type:p.Boolean,defaultValue:Ct.CRITICAL})],Ct.prototype,"critical",void 0),a([l({type:L})],Ct.prototype,"extnValue",void 0);let be=Lo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Lo.prototype)}};be=Lo=a([b({type:m.Sequence,itemType:Ct})],be);var qe;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(qe||(qe={}));class mt{constructor(t={}){this.version=qe.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new k,this.issuer=new Q,this.validity=new Vi,this.subject=new Q,this.subjectPublicKeyInfo=new Vt,Object.assign(this,t)}}a([l({type:p.Integer,context:0,defaultValue:qe.v1})],mt.prototype,"version",void 0),a([l({type:p.Integer,converter:_})],mt.prototype,"serialNumber",void 0),a([l({type:k})],mt.prototype,"signature",void 0),a([l({type:Q})],mt.prototype,"issuer",void 0),a([l({type:Vi})],mt.prototype,"validity",void 0),a([l({type:Q})],mt.prototype,"subject",void 0),a([l({type:Vt})],mt.prototype,"subjectPublicKeyInfo",void 0),a([l({type:p.BitString,context:1,implicit:!0,optional:!0})],mt.prototype,"issuerUniqueID",void 0),a([l({type:p.BitString,context:2,implicit:!0,optional:!0})],mt.prototype,"subjectUniqueID",void 0),a([l({type:be,context:3,optional:!0})],mt.prototype,"extensions",void 0);class $e{constructor(t={}){this.tbsCertificate=new mt,this.signatureAlgorithm=new k,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:mt,raw:!0})],$e.prototype,"tbsCertificate",void 0),a([l({type:k})],$e.prototype,"signatureAlgorithm",void 0),a([l({type:p.BitString})],$e.prototype,"signatureValue",void 0);class Zr{constructor(t={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new et,Object.assign(this,t)}}a([l({type:p.Integer,converter:_})],Zr.prototype,"userCertificate",void 0),a([l({type:et})],Zr.prototype,"revocationDate",void 0),a([l({type:Ct,optional:!0,repeated:"sequence"})],Zr.prototype,"crlEntryExtensions",void 0);class $t{constructor(t={}){this.signature=new k,this.issuer=new Q,this.thisUpdate=new et,Object.assign(this,t)}}a([l({type:p.Integer,optional:!0})],$t.prototype,"version",void 0),a([l({type:k})],$t.prototype,"signature",void 0),a([l({type:Q})],$t.prototype,"issuer",void 0),a([l({type:et})],$t.prototype,"thisUpdate",void 0),a([l({type:et,optional:!0})],$t.prototype,"nextUpdate",void 0),a([l({type:Zr,repeated:"sequence",optional:!0})],$t.prototype,"revokedCertificates",void 0),a([l({type:Ct,optional:!0,context:0,repeated:"sequence"})],$t.prototype,"crlExtensions",void 0);class Tn{constructor(t={}){this.tbsCertList=new $t,this.signatureAlgorithm=new k,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:$t,raw:!0})],Tn.prototype,"tbsCertList",void 0),a([l({type:k})],Tn.prototype,"signatureAlgorithm",void 0),a([l({type:p.BitString})],Tn.prototype,"signature",void 0);class Ke{constructor(t={}){this.issuer=new Q,this.serialNumber=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:Q})],Ke.prototype,"issuer",void 0),a([l({type:p.Integer,converter:_})],Ke.prototype,"serialNumber",void 0);let Pe=class{constructor(r={}){Object.assign(this,r)}};a([l({type:re,context:0,implicit:!0})],Pe.prototype,"subjectKeyIdentifier",void 0),a([l({type:Ke})],Pe.prototype,"issuerAndSerialNumber",void 0),Pe=a([b({type:m.Choice})],Pe);var Kt;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(Kt||(Kt={}));let Nr=class extends k{};Nr=a([b({type:m.Sequence})],Nr);let Ri=class extends k{};Ri=a([b({type:m.Sequence})],Ri);let Lt=class extends k{};Lt=a([b({type:m.Sequence})],Lt);let Di=class extends k{};Di=a([b({type:m.Sequence})],Di);let cc=class extends k{};cc=a([b({type:m.Sequence})],cc);let Ho=class extends k{};Ho=a([b({type:m.Sequence})],Ho);let We=class{constructor(r={}){this.attrType="",this.attrValues=[],Object.assign(this,r)}};a([l({type:p.ObjectIdentifier})],We.prototype,"attrType",void 0),a([l({type:p.Any,repeated:"set"})],We.prototype,"attrValues",void 0);var Mo;class Ut{constructor(t={}){this.version=Kt.v0,this.sid=new Pe,this.digestAlgorithm=new Nr,this.signatureAlgorithm=new Ri,this.signature=new L,Object.assign(this,t)}}a([l({type:p.Integer})],Ut.prototype,"version",void 0),a([l({type:Pe})],Ut.prototype,"sid",void 0),a([l({type:Nr})],Ut.prototype,"digestAlgorithm",void 0),a([l({type:We,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],Ut.prototype,"signedAttrs",void 0),a([l({type:Ri})],Ut.prototype,"signatureAlgorithm",void 0),a([l({type:L})],Ut.prototype,"signature",void 0),a([l({type:We,repeated:"set",context:1,implicit:!0,optional:!0})],Ut.prototype,"unsignedAttrs",void 0);let Li=Mo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Mo.prototype)}};Li=Mo=a([b({type:m.Set,itemType:Ut})],Li);let lc=class extends et{};lc=a([b({type:m.Choice})],lc);let uc=class extends Ut{};uc=a([b({type:m.Sequence})],uc);class jn{constructor(t={}){this.acIssuer=new P,this.acSerial=0,this.attrs=[],Object.assign(this,t)}}a([l({type:P})],jn.prototype,"acIssuer",void 0),a([l({type:p.Integer})],jn.prototype,"acSerial",void 0),a([l({type:qt,repeated:"sequence"})],jn.prototype,"attrs",void 0);var $o;let Hi=$o=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,$o.prototype)}};Hi=$o=a([b({type:m.Sequence,itemType:p.ObjectIdentifier})],Hi);class Mr{constructor(t={}){this.permitUnSpecified=!0,Object.assign(this,t)}}a([l({type:p.Integer,optional:!0})],Mr.prototype,"pathLenConstraint",void 0),a([l({type:Hi,implicit:!0,context:0,optional:!0})],Mr.prototype,"permittedAttrs",void 0),a([l({type:Hi,implicit:!0,context:1,optional:!0})],Mr.prototype,"excludedAttrs",void 0),a([l({type:p.Boolean,defaultValue:!0})],Mr.prototype,"permitUnSpecified",void 0);class de{constructor(t={}){this.issuer=new st,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:st})],de.prototype,"issuer",void 0),a([l({type:p.Integer,converter:_})],de.prototype,"serial",void 0),a([l({type:p.BitString,optional:!0})],de.prototype,"issuerUID",void 0);var Fo;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(Fo||(Fo={}));class pe{constructor(t={}){this.digestedObjectType=Fo.publicKey,this.digestAlgorithm=new k,this.objectDigest=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.Enumerated})],pe.prototype,"digestedObjectType",void 0),a([l({type:p.ObjectIdentifier,optional:!0})],pe.prototype,"otherObjectTypeID",void 0),a([l({type:k})],pe.prototype,"digestAlgorithm",void 0),a([l({type:p.BitString})],pe.prototype,"objectDigest",void 0);class Yr{constructor(t={}){Object.assign(this,t)}}a([l({type:st,optional:!0})],Yr.prototype,"issuerName",void 0),a([l({type:de,context:0,implicit:!0,optional:!0})],Yr.prototype,"baseCertificateID",void 0),a([l({type:pe,context:1,implicit:!0,optional:!0})],Yr.prototype,"objectDigestInfo",void 0);let Ue=class{constructor(r={}){Object.assign(this,r)}};a([l({type:P,repeated:"sequence"})],Ue.prototype,"v1Form",void 0),a([l({type:Yr,context:0,implicit:!0})],Ue.prototype,"v2Form",void 0),Ue=a([b({type:m.Choice})],Ue);class Mi{constructor(t={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,t)}}a([l({type:p.GeneralizedTime})],Mi.prototype,"notBeforeTime",void 0),a([l({type:p.GeneralizedTime})],Mi.prototype,"notAfterTime",void 0);class gr{constructor(t={}){Object.assign(this,t)}}a([l({type:de,implicit:!0,context:0,optional:!0})],gr.prototype,"baseCertificateID",void 0),a([l({type:st,implicit:!0,context:1,optional:!0})],gr.prototype,"entityName",void 0),a([l({type:pe,implicit:!0,context:2,optional:!0})],gr.prototype,"objectDigestInfo",void 0);var _o;(function(r){r[r.v2=1]="v2"})(_o||(_o={}));class Ot{constructor(t={}){this.version=_o.v2,this.holder=new gr,this.issuer=new Ue,this.signature=new k,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new Mi,this.attributes=[],Object.assign(this,t)}}a([l({type:p.Integer})],Ot.prototype,"version",void 0),a([l({type:gr})],Ot.prototype,"holder",void 0),a([l({type:Ue})],Ot.prototype,"issuer",void 0),a([l({type:k})],Ot.prototype,"signature",void 0),a([l({type:p.Integer,converter:_})],Ot.prototype,"serialNumber",void 0),a([l({type:Mi})],Ot.prototype,"attrCertValidityPeriod",void 0),a([l({type:qt,repeated:"sequence"})],Ot.prototype,"attributes",void 0),a([l({type:p.BitString,optional:!0})],Ot.prototype,"issuerUniqueID",void 0),a([l({type:be,optional:!0})],Ot.prototype,"extensions",void 0);class Xr{constructor(t={}){this.acinfo=new Ot,this.signatureAlgorithm=new k,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:Ot})],Xr.prototype,"acinfo",void 0),a([l({type:k})],Xr.prototype,"signatureAlgorithm",void 0),a([l({type:p.BitString})],Xr.prototype,"signatureValue",void 0);var $i;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})($i||($i={}));class zo extends dn{}class qo{constructor(t={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier,implicit:!0,context:0})],qo.prototype,"type",void 0),a([l({type:p.Any,implicit:!0,context:1})],qo.prototype,"value",void 0);class Pn{constructor(t={}){this.policyId="",this.classList=new zo($i.unclassified),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Pn.prototype,"policyId",void 0),a([l({type:zo,defaultValue:new zo($i.unclassified)})],Pn.prototype,"classList",void 0),a([l({type:qo,repeated:"set"})],Pn.prototype,"securityCategories",void 0);class Qr{constructor(t={}){Object.assign(this,t)}}a([l({type:L})],Qr.prototype,"cotets",void 0),a([l({type:p.ObjectIdentifier})],Qr.prototype,"oid",void 0),a([l({type:p.Utf8String})],Qr.prototype,"string",void 0);class hc{constructor(t={}){this.values=[],Object.assign(this,t)}}a([l({type:st,implicit:!0,context:0,optional:!0})],hc.prototype,"policyAuthority",void 0),a([l({type:Qr,repeated:"sequence"})],hc.prototype,"values",void 0);var Ko;class ti{constructor(t={}){this.targetCertificate=new de,Object.assign(this,t)}}a([l({type:de})],ti.prototype,"targetCertificate",void 0),a([l({type:P,optional:!0})],ti.prototype,"targetName",void 0),a([l({type:pe,optional:!0})],ti.prototype,"certDigestInfo",void 0);let Ce=class{constructor(r={}){Object.assign(this,r)}};a([l({type:P,context:0,implicit:!0})],Ce.prototype,"targetName",void 0),a([l({type:P,context:1,implicit:!0})],Ce.prototype,"targetGroup",void 0),a([l({type:ti,context:2,implicit:!0})],Ce.prototype,"targetCert",void 0),Ce=a([b({type:m.Choice})],Ce);let Wo=Ko=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ko.prototype)}};Wo=Ko=a([b({type:m.Sequence,itemType:Ce})],Wo);var Go;let pc=Go=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Go.prototype)}};pc=Go=a([b({type:m.Sequence,itemType:Wo})],pc);class fc{constructor(t={}){Object.assign(this,t)}}a([l({type:st,implicit:!0,context:0,optional:!0})],fc.prototype,"roleAuthority",void 0),a([l({type:P,implicit:!0,context:1})],fc.prototype,"roleName",void 0);class Un{constructor(t={}){this.service=new P,this.ident=new P,Object.assign(this,t)}}a([l({type:P})],Un.prototype,"service",void 0),a([l({type:P})],Un.prototype,"ident",void 0),a([l({type:L,optional:!0})],Un.prototype,"authInfo",void 0);var Jo;class Zo{constructor(t={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Zo.prototype,"otherCertFormat",void 0),a([l({type:p.Any})],Zo.prototype,"otherCert",void 0);let Ee=class{constructor(r={}){Object.assign(this,r)}};a([l({type:$e})],Ee.prototype,"certificate",void 0),a([l({type:Xr,context:2,implicit:!0})],Ee.prototype,"v2AttrCert",void 0),a([l({type:Zo,context:3,implicit:!0})],Ee.prototype,"other",void 0),Ee=a([b({type:m.Choice})],Ee);let Fi=Jo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Jo.prototype)}};Fi=Jo=a([b({type:m.Set,itemType:Ee})],Fi);class Ge{constructor(t={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Ge.prototype,"contentType",void 0),a([l({type:p.Any,context:0})],Ge.prototype,"content",void 0);let nr=class{constructor(r={}){Object.assign(this,r)}};a([l({type:L})],nr.prototype,"single",void 0),a([l({type:p.Any})],nr.prototype,"any",void 0),nr=a([b({type:m.Choice})],nr);class _i{constructor(t={}){this.eContentType="",Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],_i.prototype,"eContentType",void 0),a([l({type:nr,context:0,optional:!0})],_i.prototype,"eContent",void 0);let or=class{constructor(r={}){Object.assign(this,r)}};a([l({type:L,context:0,implicit:!0,optional:!0})],or.prototype,"value",void 0),a([l({type:L,converter:Rh,context:0,implicit:!0,optional:!0,repeated:"sequence"})],or.prototype,"constructedValue",void 0),or=a([b({type:m.Choice})],or);class vr{constructor(t={}){this.contentType="",this.contentEncryptionAlgorithm=new Di,Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],vr.prototype,"contentType",void 0),a([l({type:Di})],vr.prototype,"contentEncryptionAlgorithm",void 0),a([l({type:or,optional:!0})],vr.prototype,"encryptedContent",void 0);class zi{constructor(t={}){this.keyAttrId="",Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],zi.prototype,"keyAttrId",void 0),a([l({type:p.Any,optional:!0})],zi.prototype,"keyAttr",void 0);var Yo;class ei{constructor(t={}){this.subjectKeyIdentifier=new re,Object.assign(this,t)}}a([l({type:re})],ei.prototype,"subjectKeyIdentifier",void 0),a([l({type:p.GeneralizedTime,optional:!0})],ei.prototype,"date",void 0),a([l({type:zi,optional:!0})],ei.prototype,"other",void 0);let Ve=class{constructor(r={}){Object.assign(this,r)}};a([l({type:ei,context:0,implicit:!0,optional:!0})],Ve.prototype,"rKeyId",void 0),a([l({type:Ke,optional:!0})],Ve.prototype,"issuerAndSerialNumber",void 0),Ve=a([b({type:m.Choice})],Ve);class Xo{constructor(t={}){this.rid=new Ve,this.encryptedKey=new L,Object.assign(this,t)}}a([l({type:Ve})],Xo.prototype,"rid",void 0),a([l({type:L})],Xo.prototype,"encryptedKey",void 0);let qi=Yo=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Yo.prototype)}};qi=Yo=a([b({type:m.Sequence,itemType:Xo})],qi);class Qo{constructor(t={}){this.algorithm=new k,this.publicKey=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:k})],Qo.prototype,"algorithm",void 0),a([l({type:p.BitString})],Qo.prototype,"publicKey",void 0);let ae=class{constructor(r={}){Object.assign(this,r)}};a([l({type:re,context:0,implicit:!0,optional:!0})],ae.prototype,"subjectKeyIdentifier",void 0),a([l({type:Qo,context:1,implicit:!0,optional:!0})],ae.prototype,"originatorKey",void 0),a([l({type:Ke,optional:!0})],ae.prototype,"issuerAndSerialNumber",void 0),ae=a([b({type:m.Choice})],ae);class Ne{constructor(t={}){this.version=Kt.v3,this.originator=new ae,this.keyEncryptionAlgorithm=new Lt,this.recipientEncryptedKeys=new qi,Object.assign(this,t)}}a([l({type:p.Integer})],Ne.prototype,"version",void 0),a([l({type:ae,context:0})],Ne.prototype,"originator",void 0),a([l({type:L,context:1,optional:!0})],Ne.prototype,"ukm",void 0),a([l({type:Lt})],Ne.prototype,"keyEncryptionAlgorithm",void 0),a([l({type:qi})],Ne.prototype,"recipientEncryptedKeys",void 0);let Re=class{constructor(r={}){Object.assign(this,r)}};a([l({type:re,context:0,implicit:!0})],Re.prototype,"subjectKeyIdentifier",void 0),a([l({type:Ke})],Re.prototype,"issuerAndSerialNumber",void 0),Re=a([b({type:m.Choice})],Re);class sr{constructor(t={}){this.version=Kt.v0,this.rid=new Re,this.keyEncryptionAlgorithm=new Lt,this.encryptedKey=new L,Object.assign(this,t)}}a([l({type:p.Integer})],sr.prototype,"version",void 0),a([l({type:Re})],sr.prototype,"rid",void 0),a([l({type:Lt})],sr.prototype,"keyEncryptionAlgorithm",void 0),a([l({type:L})],sr.prototype,"encryptedKey",void 0);class mr{constructor(t={}){this.keyIdentifier=new L,Object.assign(this,t)}}a([l({type:L})],mr.prototype,"keyIdentifier",void 0),a([l({type:p.GeneralizedTime,optional:!0})],mr.prototype,"date",void 0),a([l({type:zi,optional:!0})],mr.prototype,"other",void 0);class ar{constructor(t={}){this.version=Kt.v4,this.kekid=new mr,this.keyEncryptionAlgorithm=new Lt,this.encryptedKey=new L,Object.assign(this,t)}}a([l({type:p.Integer})],ar.prototype,"version",void 0),a([l({type:mr})],ar.prototype,"kekid",void 0),a([l({type:Lt})],ar.prototype,"keyEncryptionAlgorithm",void 0),a([l({type:L})],ar.prototype,"encryptedKey",void 0);class cr{constructor(t={}){this.version=Kt.v0,this.keyEncryptionAlgorithm=new Lt,this.encryptedKey=new L,Object.assign(this,t)}}a([l({type:p.Integer})],cr.prototype,"version",void 0),a([l({type:Ho,context:0,optional:!0})],cr.prototype,"keyDerivationAlgorithm",void 0),a([l({type:Lt})],cr.prototype,"keyEncryptionAlgorithm",void 0),a([l({type:L})],cr.prototype,"encryptedKey",void 0);class ts{constructor(t={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],ts.prototype,"oriType",void 0),a([l({type:p.Any})],ts.prototype,"oriValue",void 0);let Zt=class{constructor(r={}){Object.assign(this,r)}};a([l({type:sr,optional:!0})],Zt.prototype,"ktri",void 0),a([l({type:Ne,context:1,implicit:!0,optional:!0})],Zt.prototype,"kari",void 0),a([l({type:ar,context:2,implicit:!0,optional:!0})],Zt.prototype,"kekri",void 0),a([l({type:cr,context:3,implicit:!0,optional:!0})],Zt.prototype,"pwri",void 0),a([l({type:ts,context:4,implicit:!0,optional:!0})],Zt.prototype,"ori",void 0),Zt=a([b({type:m.Choice})],Zt);var es;let Ki=es=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,es.prototype)}};Ki=es=a([b({type:m.Set,itemType:Zt})],Ki);var rs;class Wi{constructor(t={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Wi.prototype,"otherRevInfoFormat",void 0),a([l({type:p.Any})],Wi.prototype,"otherRevInfo",void 0);let ri=class{constructor(r={}){this.other=new Wi,Object.assign(this,r)}};a([l({type:Wi,context:1,implicit:!0})],ri.prototype,"other",void 0),ri=a([b({type:m.Choice})],ri);let Gi=rs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,rs.prototype)}};Gi=rs=a([b({type:m.Set,itemType:ri})],Gi);class is{constructor(t={}){Object.assign(this,t)}}a([l({type:Fi,context:0,implicit:!0,optional:!0})],is.prototype,"certs",void 0),a([l({type:Gi,context:1,implicit:!0,optional:!0})],is.prototype,"crls",void 0);var ns;let os=ns=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ns.prototype)}};os=ns=a([b({type:m.Set,itemType:We})],os);class ir{constructor(t={}){this.version=Kt.v0,this.recipientInfos=new Ki,this.encryptedContentInfo=new vr,Object.assign(this,t)}}a([l({type:p.Integer})],ir.prototype,"version",void 0),a([l({type:is,context:0,implicit:!0,optional:!0})],ir.prototype,"originatorInfo",void 0),a([l({type:Ki})],ir.prototype,"recipientInfos",void 0),a([l({type:vr})],ir.prototype,"encryptedContentInfo",void 0),a([l({type:os,context:1,implicit:!0,optional:!0})],ir.prototype,"unprotectedAttrs",void 0);const cp="1.2.840.113549.1.7.2";var ss;let Ji=ss=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ss.prototype)}};Ji=ss=a([b({type:m.Set,itemType:Nr})],Ji);class xe{constructor(t={}){this.version=Kt.v0,this.digestAlgorithms=new Ji,this.encapContentInfo=new _i,this.signerInfos=new Li,Object.assign(this,t)}}a([l({type:p.Integer})],xe.prototype,"version",void 0),a([l({type:Ji})],xe.prototype,"digestAlgorithms",void 0),a([l({type:_i})],xe.prototype,"encapContentInfo",void 0),a([l({type:Fi,context:0,implicit:!0,optional:!0})],xe.prototype,"certificates",void 0),a([l({type:Gi,context:1,implicit:!0,optional:!0})],xe.prototype,"crls",void 0),a([l({type:Li})],xe.prototype,"signerInfos",void 0);const Ir="1.2.840.10045.2.1",js="1.2.840.10045.4.1",ou="1.2.840.10045.4.3.1",Ps="1.2.840.10045.4.3.2",Us="1.2.840.10045.4.3.3",Vs="1.2.840.10045.4.3.4",yc="1.2.840.10045.3.1.7",dc="1.3.132.0.34",gc="1.3.132.0.35";function Ur(r){return new k({algorithm:r})}const lp=Ur(js);Ur(ou);const up=Ur(Ps),hp=Ur(Us),pp=Ur(Vs);let lr=class{constructor(r={}){Object.assign(this,r)}};a([l({type:p.ObjectIdentifier})],lr.prototype,"fieldType",void 0),a([l({type:p.Any})],lr.prototype,"parameters",void 0),lr=a([b({type:m.Sequence})],lr);class fp extends L{}let Ie=class{constructor(r={}){Object.assign(this,r)}};a([l({type:p.OctetString})],Ie.prototype,"a",void 0),a([l({type:p.OctetString})],Ie.prototype,"b",void 0),a([l({type:p.BitString,optional:!0})],Ie.prototype,"seed",void 0),Ie=a([b({type:m.Sequence})],Ie);var as;(function(r){r[r.ecpVer1=1]="ecpVer1"})(as||(as={}));let Mt=class{constructor(r={}){this.version=as.ecpVer1,Object.assign(this,r)}};a([l({type:p.Integer})],Mt.prototype,"version",void 0),a([l({type:lr})],Mt.prototype,"fieldID",void 0),a([l({type:Ie})],Mt.prototype,"curve",void 0),a([l({type:fp})],Mt.prototype,"base",void 0),a([l({type:p.Integer,converter:_})],Mt.prototype,"order",void 0),a([l({type:p.Integer,optional:!0})],Mt.prototype,"cofactor",void 0),Mt=a([b({type:m.Sequence})],Mt);let Yt=class{constructor(r={}){Object.assign(this,r)}};a([l({type:p.ObjectIdentifier})],Yt.prototype,"namedCurve",void 0),a([l({type:p.Null})],Yt.prototype,"implicitCurve",void 0),a([l({type:Mt})],Yt.prototype,"specifiedCurve",void 0),Yt=a([b({type:m.Choice})],Yt);class $r{constructor(t={}){this.version=1,this.privateKey=new L,Object.assign(this,t)}}a([l({type:p.Integer})],$r.prototype,"version",void 0),a([l({type:L})],$r.prototype,"privateKey",void 0),a([l({type:Yt,context:0,optional:!0})],$r.prototype,"parameters",void 0),a([l({type:p.BitString,context:1,optional:!0})],$r.prototype,"publicKey",void 0);class Zi{constructor(t={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.Integer,converter:_})],Zi.prototype,"r",void 0),a([l({type:p.Integer,converter:_})],Zi.prototype,"s",void 0);const pt="1.2.840.113549.1.1",we="".concat(pt,".1"),yp="".concat(pt,".7"),dp="".concat(pt,".9"),br="".concat(pt,".10"),gp="".concat(pt,".2"),vp="".concat(pt,".4"),Yi="".concat(pt,".5"),mp="".concat(pt,".14"),cs="".concat(pt,".11"),Xi="".concat(pt,".12"),Qi="".concat(pt,".13"),vc="".concat(pt,".15"),mc="".concat(pt,".16"),tn="1.3.14.3.2.26",su="2.16.840.1.101.3.4.2.4",en="2.16.840.1.101.3.4.2.1",rn="2.16.840.1.101.3.4.2.2",nn="2.16.840.1.101.3.4.2.3",bp="2.16.840.1.101.3.4.2.5",wp="2.16.840.1.101.3.4.2.6",Ap="1.2.840.113549.2.2",Sp="1.2.840.113549.2.5",vn="".concat(pt,".8");function Y(r){return new k({algorithm:r,parameters:null})}Y(Ap),Y(Sp);const Ae=Y(tn);Y(su),Y(en),Y(rn),Y(nn),Y(bp),Y(wp);const au=new k({algorithm:vn,parameters:S.serialize(Ae)}),cu=new k({algorithm:dp,parameters:S.serialize(Ei.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});Y(we),Y(gp),Y(vp),Y(Yi),Y(vc),Y(mc),Y(Xi),Y(Qi),Y(vc),Y(mc);class Fr{constructor(t={}){this.hashAlgorithm=new k(Ae),this.maskGenAlgorithm=new k({algorithm:vn,parameters:S.serialize(Ae)}),this.pSourceAlgorithm=new k(cu),Object.assign(this,t)}}a([l({type:k,context:0,defaultValue:Ae})],Fr.prototype,"hashAlgorithm",void 0),a([l({type:k,context:1,defaultValue:au})],Fr.prototype,"maskGenAlgorithm",void 0),a([l({type:k,context:2,defaultValue:cu})],Fr.prototype,"pSourceAlgorithm",void 0),new k({algorithm:yp,parameters:S.serialize(new Fr)});class ce{constructor(t={}){this.hashAlgorithm=new k(Ae),this.maskGenAlgorithm=new k({algorithm:vn,parameters:S.serialize(Ae)}),this.saltLength=20,this.trailerField=1,Object.assign(this,t)}}a([l({type:k,context:0,defaultValue:Ae})],ce.prototype,"hashAlgorithm",void 0),a([l({type:k,context:1,defaultValue:au})],ce.prototype,"maskGenAlgorithm",void 0),a([l({type:p.Integer,context:2,defaultValue:20})],ce.prototype,"saltLength",void 0),a([l({type:p.Integer,context:3,defaultValue:1})],ce.prototype,"trailerField",void 0),new k({algorithm:br,parameters:S.serialize(new ce)});class on{constructor(t={}){this.digestAlgorithm=new k,this.digest=new L,Object.assign(this,t)}}a([l({type:k})],on.prototype,"digestAlgorithm",void 0),a([l({type:L})],on.prototype,"digest",void 0);var ls;class ii{constructor(t={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.Integer,converter:_})],ii.prototype,"prime",void 0),a([l({type:p.Integer,converter:_})],ii.prototype,"exponent",void 0),a([l({type:p.Integer,converter:_})],ii.prototype,"coefficient",void 0);let us=ls=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ls.prototype)}};us=ls=a([b({type:m.Sequence,itemType:ii})],us);class Pt{constructor(t={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.Integer})],Pt.prototype,"version",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"modulus",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"publicExponent",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"privateExponent",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"prime1",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"prime2",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"exponent1",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"exponent2",void 0),a([l({type:p.Integer,converter:_})],Pt.prototype,"coefficient",void 0),a([l({type:us,optional:!0})],Pt.prototype,"otherPrimeInfos",void 0);class hs{constructor(t={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.Integer,converter:_})],hs.prototype,"modulus",void 0),a([l({type:p.Integer,converter:_})],hs.prototype,"publicExponent",void 0);var ps;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(ps||(ps={}));const lt=ps;var fs=function(r,t){return fs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])},fs(r,t)};function Rs(r,t){fs(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Bp(r,t,e,n){function i(o){return o instanceof e?o:new e(function(s){s(o)})}return new(e||(e=Promise))(function(o,s){function c(g){try{h(n.next(g))}catch(d){s(d)}}function u(g){try{h(n.throw(g))}catch(d){s(d)}}function h(g){g.done?o(g.value):i(g.value).then(c,u)}h((n=n.apply(r,[])).next())})}function kp(r,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(h){return function(g){return u([h,g])}}function u(h){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(o=h[0]&2?i.return:h[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,h[1])).done)return o;switch(i=0,o&&(h=[h[0]&2,o.value]),h[0]){case 0:case 1:o=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,i=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!o||h[1]>o[0]&&h[1]<o[3])){e.label=h[1];break}if(h[0]===6&&e.label<o[1]){e.label=o[1],o=h;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(h);break}o[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(r,e)}catch(g){h=[6,g],i=0}finally{n=o=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function _r(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function sn(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,o=[],s;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(c){s={error:c}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return o}function le(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(sn(arguments[t]));return r}var xp="injectionTokens";function Op(r){var t=Reflect.getMetadata("design:paramtypes",r)||[],e=Reflect.getOwnMetadata(xp,r)||{};return Object.keys(e).forEach(function(n){t[+n]=e[n]}),t}function lu(r){return!!r.useClass}function ys(r){return!!r.useFactory}var uu=function(){function r(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(t){var e=this,n={},i=!1,o,s=function(){return i||(o=t(e.wrap()),i=!0),o};return new Proxy(n,this.createHandler(s))},r.prototype.createHandler=function(t){var e={},n=function(i){e[i]=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];o[0]=t();var c=Reflect[i];return c.apply(void 0,le(o))}};return this.reflectMethods.forEach(n),e},r}();function Oe(r){return typeof r=="string"||typeof r=="symbol"}function Cp(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function bc(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Ep(r){return typeof r=="function"||r instanceof uu}function ni(r){return!!r.useToken}function oi(r){return r.useValue!=null}function Np(r){return lu(r)||oi(r)||ni(r)||ys(r)}var Ds=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},r.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},r.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},r.prototype.setAll=function(t,e){this._registryMap.set(t,e)},r.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},r}(),Ip=function(r){Rs(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ds),zr=function(){function r(){this.scopedResolutions=new Map}return r}();function Tp(r,t){if(r===null)return"at position #"+t;var e=r.split(",")[t].trim();return'"'+e+'" at position #'+t}function jp(r,t,e){return e===void 0&&(e="    "),le([r],t.message.split("\n").map(function(n){return e+n})).join("\n")}function Pp(r,t,e){var n=sn(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),i=n[1],o=i===void 0?null:i,s=Tp(o,t);return jp("Cannot inject the dependency "+s+' of "'+r.name+'" constructor. Reason:',e)}function Up(r){if(typeof r.dispose!="function")return!1;var t=r.dispose;return!(t.length>0)}var Vp=function(r){Rs(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ds),Rp=function(r){Rs(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Ds),Dp=function(){function r(){this.preResolution=new Vp,this.postResolution=new Rp}return r}(),hu=new Map,Lp=function(){function r(t){this.parent=t,this._registry=new Ip,this.interceptors=new Dp,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(t,e,n){n===void 0&&(n={lifecycle:lt.Transient}),this.ensureNotDisposed();var i;if(Np(e)?i=e:i={useClass:e},ni(i))for(var o=[t],s=i;s!=null;){var c=s.useToken;if(o.includes(c))throw new Error("Token registration cycle detected! "+le(o,[c]).join(" -> "));o.push(c);var u=this._registry.get(c);u&&ni(u.provider)?s=u.provider:s=null}if((n.lifecycle===lt.Singleton||n.lifecycle==lt.ContainerScoped||n.lifecycle==lt.ResolutionScoped)&&(oi(i)||ys(i)))throw new Error('Cannot use lifecycle "'+lt[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},r.prototype.registerType=function(t,e){return this.ensureNotDisposed(),Oe(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},r.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},r.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),Oe(t)){if(Oe(e))return this.register(t,{useToken:e},{lifecycle:lt.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:lt.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!Oe(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:lt.Singleton})},r.prototype.resolve=function(t,e,n){e===void 0&&(e=new zr),n===void 0&&(n=!1),this.ensureNotDisposed();var i=this.getRegistration(t);if(!i&&Oe(t)){if(n)return;throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"Single"),i){var o=this.resolveRegistration(i,e);return this.executePostResolutionInterceptor(t,o,"Single"),o}if(Ep(t)){var o=this.construct(t,e);return this.executePostResolutionInterceptor(t,o,"Single"),o}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var s=_r(this.interceptors.preResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var u=c.value;u.options.frequency!="Once"&&o.push(u),u.callback(t,e)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,o)}},r.prototype.executePostResolutionInterceptor=function(t,e,n){var i,o;if(this.interceptors.postResolution.has(t)){var s=[];try{for(var c=_r(this.interceptors.postResolution.getAll(t)),u=c.next();!u.done;u=c.next()){var h=u.value;h.options.frequency!="Once"&&s.push(h),h.callback(t,e,n)}}catch(g){i={error:g}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,s)}},r.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===lt.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n=t.options.lifecycle===lt.Singleton,i=t.options.lifecycle===lt.ContainerScoped,o=n||i,s;return oi(t.provider)?s=t.provider.useValue:ni(t.provider)?s=o?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):lu(t.provider)?s=o?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):ys(t.provider)?s=t.provider.useFactory(this):s=this.construct(t.provider,e),t.options.lifecycle===lt.ResolutionScoped&&e.scopedResolutions.set(t,s),s},r.prototype.resolveAll=function(t,e,n){var i=this;e===void 0&&(e=new zr),n===void 0&&(n=!1),this.ensureNotDisposed();var o=this.getAllRegistrations(t);if(!o&&Oe(t)){if(n)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"')}if(this.executePreResolutionInterceptor(t,"All"),o){var s=o.map(function(u){return i.resolveRegistration(u,e)});return this.executePostResolutionInterceptor(t,s,"All"),s}var c=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,c,"All"),c},r.prototype.isRegistered=function(t,e){return e===void 0&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=_r(this._registry.entries()),i=n.next();!i.done;i=n.next()){var o=sn(i.value,2),s=o[0],c=o[1];this._registry.setAll(s,c.filter(function(u){return!oi(u.provider)}).map(function(u){return u.instance=void 0,u}))}}catch(u){t={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},r.prototype.createChildContainer=function(){var t,e;this.ensureNotDisposed();var n=new r(this);try{for(var i=_r(this._registry.entries()),o=i.next();!o.done;o=i.next()){var s=sn(o.value,2),c=s[0],u=s[1];u.some(function(h){var g=h.options;return g.lifecycle===lt.ContainerScoped})&&n._registry.setAll(c,u.map(function(h){return h.options.lifecycle===lt.ContainerScoped?{provider:h.provider,options:h.options}:h}))}}catch(h){t={error:h}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},r.prototype.beforeResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},r.prototype.afterResolution=function(t,e,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},r.prototype.dispose=function(){return Bp(this,void 0,void 0,function(){var t;return kp(this,function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach(function(n){var i=n.dispose();i&&t.push(i)}),[4,Promise.all(t)];case 1:return e.sent(),[2]}})})},r.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},r.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},r.prototype.construct=function(t,e){var n=this;if(t instanceof uu)return t.createProxy(function(o){return n.resolve(o,e)});var i=function(){var o=hu.get(t);if(!o||o.length===0){if(t.length===0)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var s=o.map(n.resolveParams(e,t));return new(t.bind.apply(t,le([void 0],s)))}();return Up(i)&&this.disposables.add(i),i},r.prototype.resolveParams=function(t,e){var n=this;return function(i,o){var s,c,u;try{return Cp(i)?bc(i)?i.multiple?(s=n.resolve(i.transform)).transform.apply(s,le([n.resolveAll(i.token,new zr,i.isOptional)],i.transformArgs)):(c=n.resolve(i.transform)).transform.apply(c,le([n.resolve(i.token,t,i.isOptional)],i.transformArgs)):i.multiple?n.resolveAll(i.token,new zr,i.isOptional):n.resolve(i.token,t,i.isOptional):bc(i)?(u=n.resolve(i.transform,t)).transform.apply(u,le([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(h){throw new Error(Pp(e,o,h))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),at=new Lp;function mn(r){return function(t){hu.set(t,Op(t))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var ds;class an{constructor(t={}){this.attrId="",this.attrValues=[],Object.assign(t)}}a([l({type:p.ObjectIdentifier})],an.prototype,"attrId",void 0),a([l({type:p.Any,repeated:"set"})],an.prototype,"attrValues",void 0);let wc=ds=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ds.prototype)}};wc=ds=a([b({type:m.Sequence,itemType:an})],wc);var gs;let Ac=gs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,gs.prototype)}};Ac=gs=a([b({type:m.Sequence,itemType:Ge})],Ac);class Sc{constructor(t={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Sc.prototype,"certId",void 0),a([l({type:p.Any,context:0})],Sc.prototype,"certValue",void 0);class Bc{constructor(t={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Bc.prototype,"crlId",void 0),a([l({type:p.Any,context:0})],Bc.prototype,"crltValue",void 0);class pu extends L{}let cn=class{constructor(r={}){this.encryptionAlgorithm=new k,this.encryptedData=new pu,Object.assign(this,r)}};a([l({type:k})],cn.prototype,"encryptionAlgorithm",void 0),a([l({type:pu})],cn.prototype,"encryptedData",void 0);var vs,ms;(function(r){r[r.v1=0]="v1"})(ms||(ms={}));class fu extends L{}let bs=vs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,vs.prototype)}};bs=vs=a([b({type:m.Sequence,itemType:qt})],bs);class ur{constructor(t={}){this.version=ms.v1,this.privateKeyAlgorithm=new k,this.privateKey=new fu,Object.assign(this,t)}}a([l({type:p.Integer})],ur.prototype,"version",void 0),a([l({type:k})],ur.prototype,"privateKeyAlgorithm",void 0),a([l({type:fu})],ur.prototype,"privateKey",void 0),a([l({type:bs,implicit:!0,context:0,optional:!0})],ur.prototype,"attributes",void 0);let kc=class extends ur{};kc=a([b({type:m.Sequence})],kc);let xc=class extends cn{};xc=a([b({type:m.Sequence})],xc);class Oc{constructor(t={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],Oc.prototype,"secretTypeId",void 0),a([l({type:p.Any,context:0})],Oc.prototype,"secretValue",void 0);class wr{constructor(t={}){this.mac=new on,this.macSalt=new L,this.iterations=1,Object.assign(this,t)}}a([l({type:on})],wr.prototype,"mac",void 0),a([l({type:L})],wr.prototype,"macSalt",void 0),a([l({type:p.Integer,defaultValue:1})],wr.prototype,"iterations",void 0);class si{constructor(t={}){this.version=3,this.authSafe=new Ge,this.macData=new wr,Object.assign(this,t)}}a([l({type:p.Integer})],si.prototype,"version",void 0),a([l({type:Ge})],si.prototype,"authSafe",void 0),a([l({type:wr,optional:!0})],si.prototype,"macData",void 0);var ws;class ai{constructor(t={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:p.ObjectIdentifier})],ai.prototype,"bagId",void 0),a([l({type:p.Any,context:0})],ai.prototype,"bagValue",void 0),a([l({type:an,repeated:"set",optional:!0})],ai.prototype,"bagAttributes",void 0);let Cc=ws=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,ws.prototype)}};Cc=ws=a([b({type:m.Sequence,itemType:ai})],Cc);var As,Ss,Bs;const yu="1.2.840.113549.1.9",du="".concat(yu,".7"),Ls="".concat(yu,".14");let ci=class extends tt{constructor(r={}){super(r)}toString(){return this.ia5String||super.toString()}};a([l({type:p.IA5String})],ci.prototype,"ia5String",void 0),ci=a([b({type:m.Choice})],ci);let Ec=class extends Ge{};Ec=a([b({type:m.Sequence})],Ec);let Nc=class extends si{};Nc=a([b({type:m.Sequence})],Nc);let Ic=class extends cn{};Ic=a([b({type:m.Sequence})],Ic);let Vn=class{constructor(r=""){this.value=r}toString(){return this.value}};a([l({type:p.IA5String})],Vn.prototype,"value",void 0),Vn=a([b({type:m.Choice})],Vn);let Tc=class extends ci{};Tc=a([b({type:m.Choice})],Tc);let jc=class extends tt{};jc=a([b({type:m.Choice})],jc);let Rn=class{constructor(r=new Date){this.value=r}};a([l({type:p.GeneralizedTime})],Rn.prototype,"value",void 0),Rn=a([b({type:m.Choice})],Rn);let Pc=class extends tt{};Pc=a([b({type:m.Choice})],Pc);let Dn=class{constructor(r="M"){this.value=r}toString(){return this.value}};a([l({type:p.PrintableString})],Dn.prototype,"value",void 0),Dn=a([b({type:m.Choice})],Dn);let li=class{constructor(r=""){this.value=r}toString(){return this.value}};a([l({type:p.PrintableString})],li.prototype,"value",void 0),li=a([b({type:m.Choice})],li);let Uc=class extends li{};Uc=a([b({type:m.Choice})],Uc);let Vc=class extends tt{};Vc=a([b({type:m.Choice})],Vc);let Ln=class{constructor(r=""){this.value=r}toString(){return this.value}};a([l({type:p.ObjectIdentifier})],Ln.prototype,"value",void 0),Ln=a([b({type:m.Choice})],Ln);let Rc=class extends et{};Rc=a([b({type:m.Choice})],Rc);let Hn=class{constructor(r=0){this.value=r}toString(){return this.value.toString()}};a([l({type:p.Integer})],Hn.prototype,"value",void 0),Hn=a([b({type:m.Choice})],Hn);let Dc=class extends Ut{};Dc=a([b({type:m.Sequence})],Dc);let ln=class extends tt{};ln=a([b({type:m.Choice})],ln);let Lc=As=class extends be{constructor(r){super(r),Object.setPrototypeOf(this,As.prototype)}};Lc=As=a([b({type:m.Sequence})],Lc);let Hc=Ss=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Ss.prototype)}};Hc=Ss=a([b({type:m.Set,itemType:We})],Hc);let Mn=class{constructor(r=""){this.value=r}toString(){return this.value}};a([l({type:p.BmpString})],Mn.prototype,"value",void 0),Mn=a([b({type:m.Choice})],Mn);let ks=class extends k{};ks=a([b({type:m.Sequence})],ks);let Mc=Bs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,Bs.prototype)}};Mc=Bs=a([b({type:m.Sequence,itemType:ks})],Mc);var xs;let un=xs=class extends ${constructor(r){super(r),Object.setPrototypeOf(this,xs.prototype)}};un=xs=a([b({type:m.Sequence,itemType:qt})],un);class De{constructor(t={}){this.version=0,this.subject=new Q,this.subjectPKInfo=new Vt,this.attributes=new un,Object.assign(this,t)}}a([l({type:p.Integer})],De.prototype,"version",void 0),a([l({type:Q})],De.prototype,"subject",void 0),a([l({type:Vt})],De.prototype,"subjectPKInfo",void 0),a([l({type:un,implicit:!0,context:0})],De.prototype,"attributes",void 0);class Ar{constructor(t={}){this.certificationRequestInfo=new De,this.signatureAlgorithm=new k,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}a([l({type:De,raw:!0})],Ar.prototype,"certificationRequestInfo",void 0),a([l({type:k})],Ar.prototype,"signatureAlgorithm",void 0),a([l({type:p.BitString})],Ar.prototype,"signature",void 0);const Vr="crypto.algorithm";class Hp{getAlgorithms(){return at.resolveAll(Vr)}toAsnAlgorithm(t){V({},t);for(const e of this.getAlgorithms()){const n=e.toAsnAlgorithm(t);if(n)return n}if(/^[0-9.]+$/.test(t.name)){const e=new k({algorithm:t.name});if("parameters"in t){const n=t;e.parameters=n.parameters}return e}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(t){for(const e of this.getAlgorithms()){const n=e.toWebAlgorithm(t);if(n)return n}return{name:t.algorithm,parameters:t.parameters}}}const Je="crypto.algorithmProvider";at.registerSingleton(Je,Hp);var ui;const ft="1.3.36.3.3.2.8.1.1",$c="".concat(ft,".1"),Fc="".concat(ft,".2"),_c="".concat(ft,".3"),zc="".concat(ft,".4"),qc="".concat(ft,".5"),Kc="".concat(ft,".6"),Wc="".concat(ft,".7"),Gc="".concat(ft,".8"),Jc="".concat(ft,".9"),Zc="".concat(ft,".10"),Yc="".concat(ft,".11"),Xc="".concat(ft,".12"),Qc="".concat(ft,".13"),tl="".concat(ft,".14"),el="brainpoolP160r1",rl="brainpoolP160t1",il="brainpoolP192r1",nl="brainpoolP192t1",ol="brainpoolP224r1",sl="brainpoolP224t1",al="brainpoolP256r1",cl="brainpoolP256t1",ll="brainpoolP320r1",ul="brainpoolP320t1",hl="brainpoolP384r1",pl="brainpoolP384t1",fl="brainpoolP512r1",yl="brainpoolP512t1",z="ECDSA";let hr=ui=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case z.toLowerCase():if("hash"in r)switch((typeof r.hash=="string"?r.hash:r.hash.name).toLowerCase()){case"sha-1":return lp;case"sha-256":return up;case"sha-384":return hp;case"sha-512":return pp}else if("namedCurve"in r){let t="";switch(r.namedCurve){case"P-256":t=yc;break;case"K-256":t=ui.SECP256K1;break;case"P-384":t=dc;break;case"P-521":t=gc;break;case el:t=$c;break;case rl:t=Fc;break;case il:t=_c;break;case nl:t=zc;break;case ol:t=qc;break;case sl:t=Kc;break;case al:t=Wc;break;case cl:t=Gc;break;case ll:t=Jc;break;case ul:t=Zc;break;case hl:t=Yc;break;case pl:t=Xc;break;case fl:t=Qc;break;case yl:t=tl;break}if(t)return new k({algorithm:Ir,parameters:S.serialize(new Yt({namedCurve:t}))})}}return null}toWebAlgorithm(r){switch(r.algorithm){case js:return{name:z,hash:{name:"SHA-1"}};case Ps:return{name:z,hash:{name:"SHA-256"}};case Us:return{name:z,hash:{name:"SHA-384"}};case Vs:return{name:z,hash:{name:"SHA-512"}};case Ir:{if(!r.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(S.parse(r.parameters,Yt).namedCurve){case yc:return{name:z,namedCurve:"P-256"};case ui.SECP256K1:return{name:z,namedCurve:"K-256"};case dc:return{name:z,namedCurve:"P-384"};case gc:return{name:z,namedCurve:"P-521"};case $c:return{name:z,namedCurve:el};case Fc:return{name:z,namedCurve:rl};case _c:return{name:z,namedCurve:il};case zc:return{name:z,namedCurve:nl};case qc:return{name:z,namedCurve:ol};case Kc:return{name:z,namedCurve:sl};case Wc:return{name:z,namedCurve:al};case Gc:return{name:z,namedCurve:cl};case Jc:return{name:z,namedCurve:ll};case Zc:return{name:z,namedCurve:ul};case Yc:return{name:z,namedCurve:hl};case Xc:return{name:z,namedCurve:pl};case Qc:return{name:z,namedCurve:fl};case tl:return{name:z,namedCurve:yl}}}}return null}};hr.SECP256K1="1.3.132.0.10",hr=ui=a([mn()],hr),at.registerSingleton(Vr,hr);const gu=Symbol("name"),vu=Symbol("value");class M{constructor(t,e={},n=""){this[gu]=t,this[vu]=n;for(const i in e)this[i]=e[i]}}M.NAME=gu,M.VALUE=vu;class Mp{static toTextObject(t){const e=new M("Algorithm Identifier",{},oe.toString(t.algorithm));if(t.parameters)switch(t.algorithm){case Ir:{const n=new hr().toWebAlgorithm(t);n&&"namedCurve"in n?e["Named Curve"]=n.namedCurve:e.Parameters=t.parameters;break}default:e.Parameters=t.parameters}return e}}class oe{static toString(t){return this.items[t]||t}}oe.items={[tn]:"sha1",[su]:"sha224",[en]:"sha256",[rn]:"sha384",[nn]:"sha512",[we]:"rsaEncryption",[Yi]:"sha1WithRSAEncryption",[mp]:"sha224WithRSAEncryption",[cs]:"sha256WithRSAEncryption",[Xi]:"sha384WithRSAEncryption",[Qi]:"sha512WithRSAEncryption",[Ir]:"ecPublicKey",[js]:"ecdsaWithSHA1",[ou]:"ecdsaWithSHA224",[Ps]:"ecdsaWithSHA256",[Us]:"ecdsaWithSHA384",[Vs]:"ecdsaWithSHA512",[rp]:"TLS WWW server authentication",[ip]:"TLS WWW client authentication",[np]:"Code Signing",[op]:"E-mail Protection",[sp]:"Time Stamping",[ap]:"OCSP Signing",[cp]:"Signed Data"};class Se{static serialize(t){return this.serializeObj(t).join("\n")}static pad(t=0){return"".padStart(2*t," ")}static serializeObj(t,e=0){const n=[];let i=this.pad(e++),o="";const s=t[M.VALUE];s&&(o=" ".concat(s)),n.push("".concat(i).concat(t[M.NAME],":").concat(o)),i=this.pad(e);for(const c in t){if(typeof c=="symbol")continue;const u=t[c],h=c?"".concat(c,": "):"";if(typeof u=="string"||typeof u=="number"||typeof u=="boolean")n.push("".concat(i).concat(h).concat(u));else if(u instanceof Date)n.push("".concat(i).concat(h).concat(u.toUTCString()));else if(Array.isArray(u))for(const g of u)g[M.NAME]=c,n.push(...this.serializeObj(g,e));else if(u instanceof M)u[M.NAME]=c,n.push(...this.serializeObj(u,e));else if(A.isBufferSource(u))c?(n.push("".concat(i).concat(h)),n.push(...this.serializeBufferSource(u,e+1))):n.push(...this.serializeBufferSource(u,e));else if("toTextObject"in u){const g=u.toTextObject();g[M.NAME]=c,n.push(...this.serializeObj(g,e))}else throw new TypeError("Cannot serialize data in text format. Unsupported type.")}return n}static serializeBufferSource(t,e=0){const n=this.pad(e),i=A.toUint8Array(t),o=[];for(let s=0;s<i.length;){const c=[];for(let u=0;u<16&&s<i.length;u++){u===8&&c.push("");const h=i[s++].toString(16).padStart(2,"0");c.push(h)}o.push("".concat(n).concat(c.join(" ")))}return o}static serializeAlgorithm(t){return this.algorithmSerializer.toTextObject(t)}}Se.oidSerializer=oe,Se.algorithmSerializer=Mp;class se{constructor(...t){if(t.length===1){const e=t[0];this.rawData=S.serialize(e),this.onInit(e)}else{const e=S.parse(t[0],t[1]);this.rawData=A.toArrayBuffer(t[0]),this.onInit(e)}}equal(t){return t instanceof se?Ol(t.rawData,this.rawData):!1}toString(t="text"){switch(t){case"asn":return S.toString(this.rawData);case"text":return Se.serialize(this.toTextObject());case"hex":return E.ToHex(this.rawData);case"base64":return E.ToBase64(this.rawData);case"base64url":return E.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const t=this.toTextObjectEmpty();return t[""]=this.rawData,t}toTextObjectEmpty(t){return new M(this.getTextName(),{},t)}}se.NAME="ASN";class St extends se{constructor(...t){let e;A.isBufferSource(t[0])?e=A.toArrayBuffer(t[0]):e=S.serialize(new Ct({extnID:t[0],critical:t[1],extnValue:new L(A.toArrayBuffer(t[2]))})),super(e,Ct)}onInit(t){this.type=t.extnID,this.critical=t.critical,this.value=t.extnValue.buffer}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.value,t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty(this.critical?"critical":void 0);return t[M.NAME]===St.NAME&&(t[M.NAME]=oe.toString(this.type)),t}}var mu;class Qt{static isCryptoKeyPair(t){return t&&t.privateKey&&t.publicKey}static isCryptoKey(t){return t&&t.usages&&t.type&&t.algorithm&&t.extractable!==void 0}constructor(){this.items=new Map,this[mu]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"?this.set(Qt.DEFAULT,crypto):typeof Lr<"u"&&Lr.crypto&&Lr.crypto.subtle&&this.set(Qt.DEFAULT,Lr.crypto)}clear(){this.items.clear()}delete(t){return this.items.delete(t)}forEach(t,e){return this.items.forEach(t,e)}has(t){return this.items.has(t)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(t=Qt.DEFAULT){const e=this.items.get(t.toLowerCase());if(!e)throw new Error("Cannot get Crypto by name '".concat(t,"'"));return e}set(t,e){if(typeof t=="string"){if(!e)throw new TypeError("Argument 'value' is required");this.items.set(t.toLowerCase(),e)}else this.items.set(Qt.DEFAULT,t);return this}}mu=Symbol.toStringTag,Qt.DEFAULT="default";const nt=new Qt,$p=/^[0-2](?:\.[1-9][0-9]*)+$/;function Fp(r){return new RegExp($p).test(r)}class bu{constructor(t={}){this.items={};for(const e in t)this.register(e,t[e])}get(t){return this.items[t]||null}findId(t){return Fp(t)?t:this.get(t)}register(t,e){this.items[t]=e,this.items[e]=t}}const ut=new bu;ut.register("CN","2.5.4.3"),ut.register("L","2.5.4.7"),ut.register("ST","2.5.4.8"),ut.register("O","2.5.4.10"),ut.register("OU","2.5.4.11"),ut.register("C","2.5.4.6"),ut.register("DC","0.9.2342.19200300.100.1.25"),ut.register("E","1.2.840.113549.1.9.1"),ut.register("G","2.5.4.42"),ut.register("I","2.5.4.43"),ut.register("SN","2.5.4.4"),ut.register("T","2.5.4.12");function _p(r,t){return"\\".concat(E.ToHex(E.FromUtf8String(t)).toUpperCase())}function zp(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,_p)}class ie{static isASCII(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!1;return!0}static isPrintableString(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(t)}constructor(t,e={}){this.extraNames=new bu,this.asn=new Q;for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n];this.extraNames.register(n,i)}typeof t=="string"?this.asn=this.fromString(t):t instanceof Q?this.asn=t:A.isBufferSource(t)?this.asn=S.parse(t,Q):this.asn=this.fromJSON(t)}getField(t){const e=this.extraNames.findId(t)||ut.findId(t),n=[];for(const i of this.asn)for(const o of i)o.type===e&&n.push(o.value.toString());return n}getName(t){return this.extraNames.get(t)||ut.get(t)}toString(){return this.asn.map(t=>t.map(e=>{const n=this.getName(e.type)||e.type,i=e.value.anyValue?"#".concat(E.ToHex(e.value.anyValue)):zp(e.value.toString());return"".concat(n,"=").concat(i)}).join("+")).join(", ")}toJSON(){var t;const e=[];for(const n of this.asn){const i={};for(const o of n){const s=this.getName(o.type)||o.type;(t=i[s])!==null&&t!==void 0||(i[s]=[]),i[s].push(o.value.anyValue?"#".concat(E.ToHex(o.value.anyValue)):o.value.toString())}e.push(i)}return e}fromString(t){const e=new Q,n=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let i=null,o=",";for(;i=n.exec("".concat(t,","));){let[,s,c]=i;const u=c[c.length-1];(u===","||u==="+")&&(c=c.slice(0,c.length-1),i[3]=u);const h=i[3];s=this.getTypeOid(s);const g=this.createAttribute(s,c);o==="+"?e[e.length-1].push(g):e.push(new ze([g])),o=h}return e}fromJSON(t){const e=new Q;for(const n of t){const i=new ze;for(const o in n){const s=this.getTypeOid(o),c=n[o];for(const u of c){const h=this.createAttribute(s,u);i.push(h)}}e.push(i)}return e}getTypeOid(t){if(/[\d.]+/.test(t)||(t=this.getName(t)||""),!t)throw new Error("Cannot get OID for name type '".concat(t,"'"));return t}createAttribute(t,e){const n=new Ni({type:t});if(typeof e=="object")for(const i in e)switch(i){case"ia5String":n.value.ia5String=e[i];break;case"utf8String":n.value.utf8String=e[i];break;case"universalString":n.value.universalString=e[i];break;case"bmpString":n.value.bmpString=e[i];break;case"printableString":n.value.printableString=e[i];break}else if(e[0]==="#")n.value.anyValue=E.FromHex(e.slice(1));else{const i=this.processStringValue(e);t===this.getName("E")||t===this.getName("DC")?n.value.ia5String=i:ie.isPrintableString(i)?n.value.printableString=i:n.value.utf8String=i}return n}processStringValue(t){const e=/"(.*?[^\\])?"/.exec(t);return e&&(t=e[1]),t.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return S.serialize(this.asn)}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||nt.get()):n=t[0]||nt.get(),await n.subtle.digest(i,this.toArrayBuffer())}}const wu="Cannot initialize GeneralName from ASN.1 data.",dl="".concat(wu," Unsupported string format in use."),qp="".concat(wu," Value doesn't match to GUID regular expression."),gl=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,vl="1.3.6.1.4.1.311.25.1",ml="1.3.6.1.4.1.311.20.2.3",$n="dns",Fn="dn",_n="email",zn="ip",qn="url",Kn="guid",Wn="upn",qr="id";class te extends se{constructor(...t){let e;if(t.length===2)switch(t[0]){case Fn:{const n=new ie(t[1]).toArrayBuffer(),i=S.parse(n,Q);e=new P({directoryName:i});break}case $n:e=new P({dNSName:t[1]});break;case _n:e=new P({rfc822Name:t[1]});break;case Kn:{const n=new RegExp(gl,"i").exec(t[1]);if(!n)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=n.slice(1).map((o,s)=>s<3?E.ToHex(new Uint8Array(E.FromHex(o)).reverse()):o).join("");e=new P({otherName:new Cr({typeId:vl,value:S.serialize(new L(E.FromHex(i)))})});break}case zn:e=new P({iPAddress:t[1]});break;case qr:e=new P({registeredID:t[1]});break;case Wn:{e=new P({otherName:new Cr({typeId:ml,value:S.serialize(Gl.toASN(t[1]))})});break}case qn:e=new P({uniformResourceIdentifier:t[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else A.isBufferSource(t[0])?e=S.parse(t[0],P):e=t[0];super(e)}onInit(t){if(t.dNSName!=null)this.type=$n,this.value=t.dNSName;else if(t.rfc822Name!=null)this.type=_n,this.value=t.rfc822Name;else if(t.iPAddress!=null)this.type=zn,this.value=t.iPAddress;else if(t.uniformResourceIdentifier!=null)this.type=qn,this.value=t.uniformResourceIdentifier;else if(t.registeredID!=null)this.type=qr,this.value=t.registeredID;else if(t.directoryName!=null)this.type=Fn,this.value=new ie(t.directoryName).toString();else if(t.otherName!=null)if(t.otherName.typeId===vl){this.type=Kn;const e=S.parse(t.otherName.value,L),n=new RegExp(gl,"i").exec(E.ToHex(e));if(!n)throw new Error(qp);this.value=n.slice(1).map((i,o)=>o<3?E.ToHex(new Uint8Array(E.FromHex(i)).reverse()):i).join("-")}else if(t.otherName.typeId===ml)this.type=Wn,this.value=S.parse(t.otherName.value,tt).toString();else throw new Error(dl);else throw new Error(dl)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let t;switch(this.type){case Fn:case $n:case Kn:case zn:case qr:case Wn:case qn:t=this.type.toUpperCase();break;case _n:t="Email";break;default:throw new Error("Unsupported GeneralName type")}let e=this.value;return this.type===qr&&(e=oe.toString(e)),new M(t,void 0,e)}}class Tr extends se{constructor(t){let e;if(t instanceof st)e=t;else if(Array.isArray(t)){const n=[];for(const i of t)if(i instanceof P)n.push(i);else{const o=S.parse(new te(i.type,i.value).rawData,P);n.push(o)}e=new st(n)}else if(A.isBufferSource(t))e=S.parse(t,st);else throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(e)}onInit(t){const e=[];for(const n of t){let i=null;try{i=new te(n)}catch(o){continue}e.push(i)}this.items=e}toJSON(){return this.items.map(t=>t.toJSON())}toTextObject(){const t=super.toTextObjectEmpty();for(const e of this.items){const n=e.toTextObject();let i=t[n[M.NAME]];Array.isArray(i)||(i=[],t[n[M.NAME]]=i),i.push(n)}return t}}Tr.NAME="GeneralNames";const Sr="-{5}",jr="\\n",Kp="[^".concat(jr,"]+"),Wp="".concat(Sr,"BEGIN (").concat(Kp,"(?=").concat(Sr,"))").concat(Sr),Gp="".concat(Sr,"END \\1").concat(Sr),Ze="\\n",Jp="[^:".concat(jr,"]+"),Zp="(?:[^".concat(jr,"]+").concat(Ze,"(?: +[^").concat(jr,"]+").concat(Ze,")*)"),Yp="[a-zA-Z0-9=+/]+",Xp="(?:".concat(Yp).concat(Ze,")+"),bl="".concat(Wp).concat(Ze,"(?:((?:").concat(Jp,": ").concat(Zp,")+))?").concat(Ze,"?(").concat(Xp,")").concat(Gp);class dt{static isPem(t){return typeof t=="string"&&new RegExp(bl,"g").test(t.replace(/\r/g,""))}static decodeWithHeaders(t){t=t.replace(/\r/g,"");const e=new RegExp(bl,"g"),n=[];let i=null;for(;i=e.exec(t);){const o=i[3].replace(new RegExp("[".concat(jr,"]+"),"g"),""),s={type:i[1],headers:[],rawData:E.FromBase64(o)},c=i[2];if(c){const u=c.split(new RegExp(Ze,"g"));let h=null;for(const g of u){const[d,j]=g.split(/:(.*)/);if(j===void 0){if(!h)throw new Error("Cannot parse PEM string. Incorrect header value");h.value+=d.trim()}else h&&s.headers.push(h),h={key:d,value:j.trim()}}h&&s.headers.push(h)}n.push(s)}return n}static decode(t){return this.decodeWithHeaders(t).map(e=>e.rawData)}static decodeFirst(t){const e=this.decode(t);if(!e.length)throw new RangeError("PEM string doesn't contain any objects");return e[0]}static encode(t,e){if(Array.isArray(t)){const n=new Array;return e?t.forEach(i=>{if(!A.isBufferSource(i))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");n.push(this.encodeStruct({type:e,rawData:A.toArrayBuffer(i)}))}):t.forEach(i=>{if(!("type"in i))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");n.push(this.encodeStruct(i))}),n.join("\n")}else{if(!e)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:e,rawData:A.toArrayBuffer(t)})}}static encodeStruct(t){var e;const n=t.type.toLocaleUpperCase(),i=[];if(i.push("-----BEGIN ".concat(n,"-----")),!((e=t.headers)===null||e===void 0)&&e.length){for(const h of t.headers)i.push("".concat(h.key,": ").concat(h.value));i.push("")}const o=E.ToBase64(t.rawData);let s,c=0;const u=Array();for(;c<o.length&&(o.length-c<64?s=o.substring(c):(s=o.substring(c,c+64),c+=64),s.length!==0)&&(u.push(s),!(s.length<64)););return i.push(...u),i.push("-----END ".concat(n,"-----")),i.join("\n")}}dt.CertificateTag="CERTIFICATE",dt.CrlTag="CRL",dt.CertificateRequestTag="CERTIFICATE REQUEST",dt.PublicKeyTag="PUBLIC KEY",dt.PrivateKeyTag="PRIVATE KEY";class Wt extends se{static isAsnEncoded(t){return A.isBufferSource(t)||typeof t=="string"}static toArrayBuffer(t){if(typeof t=="string"){if(dt.isPem(t))return dt.decode(t)[0];if(E.isHex(t))return E.FromHex(t);if(E.isBase64(t))return E.FromBase64(t);if(E.isBase64Url(t))return E.FromBase64Url(t);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const e=E.ToBinary(t);return dt.isPem(e)?dt.decode(e)[0]:E.isHex(e)?E.FromHex(e):E.isBase64(e)?E.FromBase64(e):E.isBase64Url(e)?E.FromBase64Url(e):A.toArrayBuffer(t)}}constructor(...t){Wt.isAsnEncoded(t[0])?super(Wt.toArrayBuffer(t[0]),t[1]):super(t[0])}toString(t="pem"){switch(t){case"pem":return dt.encode(this.rawData,this.tag);default:return super.toString(t)}}}class Dt extends Wt{static async create(t,e=nt.get()){if(t instanceof Dt)return t;if(Qt.isCryptoKey(t)){if(t.type!=="public")throw new TypeError("Public key is required");const n=await e.subtle.exportKey("spki",t);return new Dt(n)}else{if(t.publicKey)return t.publicKey;if(A.isBufferSource(t))return new Dt(t);throw new TypeError("Unsupported PublicKeyType")}}constructor(t){Wt.isAsnEncoded(t)?super(t,Vt):super(t),this.tag=dt.PublicKeyTag}async export(...t){let e,n=["verify"],i=V({hash:"SHA-256"},this.algorithm);t.length>1?(i=t[0]||i,n=t[1]||n,e=t[2]||nt.get()):e=t[0]||nt.get();let o=this.rawData;const s=S.parse(this.rawData,Vt);return s.algorithm.algorithm===br&&(o=Qp(s,o)),e.subtle.importKey("spki",o,i,!0,n)}onInit(t){const e=at.resolve(Je),n=this.algorithm=e.toWebAlgorithm(t.algorithm);switch(t.algorithm.algorithm){case we:{const i=S.parse(t.subjectPublicKey,hs),o=A.toUint8Array(i.modulus);n.publicExponent=A.toUint8Array(i.publicExponent),n.modulusLength=(o[0]?o:o.slice(1)).byteLength<<3;break}}}async getThumbprint(...t){var e;let n,i="SHA-1";return t.length>=1&&!(!((e=t[0])===null||e===void 0)&&e.subtle)?(i=t[0]||i,n=t[1]||nt.get()):n=t[0]||nt.get(),await n.subtle.digest(i,this.rawData)}async getKeyIdentifier(...t){let e,n="SHA-1";t.length===1?typeof t[0]=="string"?(n=t[0],e=nt.get()):e=t[0]:t.length===2?(n=t[0],e=t[1]):e=nt.get();const i=S.parse(this.rawData,Vt);return await e.subtle.digest(n,i.subjectPublicKey)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,Vt);switch(t.Algorithm=Se.serializeAlgorithm(e.algorithm),e.algorithm.algorithm){case Ir:t["EC Point"]=e.subjectPublicKey;break;case we:default:t["Raw Data"]=e.subjectPublicKey}return t}}function Qp(r,t){return r.algorithm=new k({algorithm:we,parameters:null}),t=S.serialize(r),t}class Pr extends St{static async create(t,e=!1,n=nt.get()){if("name"in t&&"serialNumber"in t)return new Pr(t,e);const i=await(await Dt.create(t,n)).getKeyIdentifier(n);return new Pr(E.ToHex(i),e)}constructor(...t){if(A.isBufferSource(t[0]))super(t[0]);else if(typeof t[0]=="string"){const e=new ue({keyIdentifier:new Ts(E.FromHex(t[0]))});super(bo,t[1],S.serialize(e))}else{const e=t[0],n=e.name instanceof Tr?S.parse(e.name.rawData,st):e.name,i=new ue({authorityCertIssuer:n,authorityCertSerialNumber:E.FromHex(e.serialNumber)});super(bo,t[1],S.serialize(i))}}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,ue);e.keyIdentifier&&(this.keyId=E.ToHex(e.keyIdentifier)),(e.authorityCertIssuer||e.authorityCertSerialNumber)&&(this.certId={name:e.authorityCertIssuer||[],serialNumber:e.authorityCertSerialNumber?E.ToHex(e.authorityCertSerialNumber):""})}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,ue);return e.authorityCertIssuer&&(t["Authority Issuer"]=new Tr(e.authorityCertIssuer).toTextObject()),e.authorityCertSerialNumber&&(t["Authority Serial Number"]=e.authorityCertSerialNumber),e.keyIdentifier&&(t[""]=e.keyIdentifier),t}}Pr.NAME="Authority Key Identifier";class Au extends St{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,Ii);this.ca=e.cA,this.pathLength=e.pathLenConstraint}else{const e=new Ii({cA:t[0],pathLenConstraint:t[1]});super(Zl,t[2],S.serialize(e)),this.ca=t[0],this.pathLength=t[1]}}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ca&&(t.CA=this.ca),this.pathLength!==void 0&&(t["Path Length"]=this.pathLength),t}}Au.NAME="Basic Constraints";var wl;(function(r){r.serverAuth="1.3.6.1.5.5.7.3.1",r.clientAuth="1.3.6.1.5.5.7.3.2",r.codeSigning="1.3.6.1.5.5.7.3.3",r.emailProtection="1.3.6.1.5.5.7.3.4",r.timeStamping="1.3.6.1.5.5.7.3.8",r.ocspSigning="1.3.6.1.5.5.7.3.9"})(wl||(wl={}));class Su extends St{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,Pi);this.usages=e.map(n=>n)}else{const e=new Pi(t[0]);super(Ql,t[1],S.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[""]=this.usages.map(e=>oe.toString(e)).join(", "),t}}Su.NAME="Extended Key Usages";var Al;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Al||(Al={}));class Bu extends St{constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,In);this.usages=e.toNumber()}else{const e=new In(t[0]);super(tu,t[1],S.serialize(e)),this.usages=t[0]}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,In);return t[""]=e.toJSON().join(", "),t}}Bu.NAME="Key Usages";class bn extends St{static async create(t,e=!1,n=nt.get()){const i=await(await Dt.create(t,n)).getKeyIdentifier(n);return new bn(E.ToHex(i),e)}constructor(...t){if(A.isBufferSource(t[0])){super(t[0]);const e=S.parse(this.value,re);this.keyId=E.ToHex(e)}else{const e=typeof t[0]=="string"?E.FromHex(t[0]):t[0],n=new re(e);super(ru,t[1],S.serialize(n)),this.keyId=E.ToHex(e)}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=S.parse(this.value,re);return t[""]=e,t}}bn.NAME="Subject Key Identifier";class ku extends St{constructor(...t){A.isBufferSource(t[0])?super(t[0]):super(eu,t[1],new Tr(t[0]||[]).rawData)}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,Vo);this.names=new Tr(e)}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.names.toTextObject();for(const n in e)t[n]=e[n];return t}}ku.NAME="Subject Alternative Name";class bt{static register(t,e){this.items.set(t,e)}static create(t){const e=new St(t),n=this.items.get(e.type);return n?new n(t):e}}bt.items=new Map;class Sl extends St{constructor(...t){var e;if(A.isBufferSource(t[0])){super(t[0]);const n=S.parse(this.value,ji);this.policies=n.map(i=>i.policyIdentifier)}else{const n=t[0],i=(e=t[1])!==null&&e!==void 0?e:!1,o=new ji(n.map(s=>new Ti({policyIdentifier:s})));super(Yl,i,S.serialize(o)),this.policies=n}}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Policy=this.policies.map(e=>new M("",{},oe.toString(e))),t}}Sl.NAME="Certificate Policies",bt.register(Yl,Sl);class xu extends St{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else if(Array.isArray(t[0])&&typeof t[0][0]=="string"){const n=t[0].map(o=>new He({distributionPoint:new he({fullName:[new P({uniformResourceIdentifier:o})]})})),i=new Me(n);super(Co,t[1],S.serialize(i))}else{const n=new Me(t[0]);super(Co,t[1],S.serialize(n))}(e=this.distributionPoints)!==null&&e!==void 0||(this.distributionPoints=[])}onInit(t){super.onInit(t);const e=S.parse(t.extnValue,Me);this.distributionPoints=e}toTextObject(){const t=this.toTextObjectWithoutValue();return t["Distribution Point"]=this.distributionPoints.map(e=>{var n;const i={};return e.distributionPoint&&(i[""]=(n=e.distributionPoint.fullName)===null||n===void 0?void 0:n.map(o=>new te(o).toString()).join(", ")),e.reasons&&(i.Reasons=e.reasons.toString()),e.cRLIssuer&&(i["CRL Issuer"]=e.cRLIssuer.map(o=>o.toString()).join(", ")),i}),t}}xu.NAME="CRL Distribution Points";class Ou extends St{constructor(...t){var e,n,i,o;if(A.isBufferSource(t[0]))super(t[0]);else if(t[0]instanceof je){const s=new je(t[0]);super(mo,t[1],S.serialize(s))}else{const s=t[0],c=new je;Wr(c,s,Wa,"ocsp"),Wr(c,s,Ga,"caIssuers"),Wr(c,s,Ja,"timeStamping"),Wr(c,s,Za,"caRepository"),super(mo,t[1],S.serialize(c))}(e=this.ocsp)!==null&&e!==void 0||(this.ocsp=[]),(n=this.caIssuers)!==null&&n!==void 0||(this.caIssuers=[]),(i=this.timeStamping)!==null&&i!==void 0||(this.timeStamping=[]),(o=this.caRepository)!==null&&o!==void 0||(this.caRepository=[])}onInit(t){super.onInit(t),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],S.parse(t.extnValue,je).forEach(e=>{switch(e.accessMethod){case Wa:this.ocsp.push(new te(e.accessLocation));break;case Ga:this.caIssuers.push(new te(e.accessLocation));break;case Ja:this.timeStamping.push(new te(e.accessLocation));break;case Za:this.caRepository.push(new te(e.accessLocation));break}})}toTextObject(){const t=this.toTextObjectWithoutValue();return this.ocsp.length&&Kr(t,"OCSP",this.ocsp),this.caIssuers.length&&Kr(t,"CA Issuers",this.caIssuers),this.timeStamping.length&&Kr(t,"Time Stamping",this.timeStamping),this.caRepository.length&&Kr(t,"CA Repository",this.caRepository),t}}Ou.NAME="Authority Info Access";function Kr(r,t,e){if(e.length===1)r[t]=e[0].toTextObject();else{const n=new M("");e.forEach((i,o)=>{const s=i.toTextObject(),c="".concat(s[M.NAME]," ").concat(o+1);let u=n[c];Array.isArray(u)||(u=[],n[c]=u),u.push(s)}),r[t]=n}}function Wr(r,t,e,n){const i=t[n];i&&(Array.isArray(i)?i:[i]).forEach(o=>{typeof o=="string"&&(o=new te("url",o)),r.push(new Er({accessMethod:e,accessLocation:S.parse(o.rawData,P)}))})}class Qe extends se{constructor(...t){let e;if(A.isBufferSource(t[0]))e=A.toArrayBuffer(t[0]);else{const n=t[0],i=Array.isArray(t[1])?t[1].map(o=>A.toArrayBuffer(o)):[];e=S.serialize(new qt({type:n,values:i}))}super(e,qt)}onInit(t){this.type=t.type,this.values=t.values}toTextObject(){const t=this.toTextObjectWithoutValue();return t.Value=this.values.map(e=>new M("",{"":e})),t}toTextObjectWithoutValue(){const t=this.toTextObjectEmpty();return t[M.NAME]===Qe.NAME&&(t[M.NAME]=oe.toString(this.type)),t}}Qe.NAME="Attribute";class Cu extends Qe{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else{const n=new ln({printableString:t[0]});super(du,[S.serialize(n)])}(e=this.password)!==null&&e!==void 0||(this.password="")}onInit(t){if(super.onInit(t),this.values[0]){const e=S.parse(this.values[0],ln);this.password=e.toString()}}toTextObject(){const t=this.toTextObjectWithoutValue();return t[M.VALUE]=this.password,t}}Cu.NAME="Challenge Password";class Hs extends Qe{constructor(...t){var e;if(A.isBufferSource(t[0]))super(t[0]);else{const n=t[0],i=new be;for(const o of n)i.push(S.parse(o.rawData,Ct));super(Ls,[S.serialize(i)])}(e=this.items)!==null&&e!==void 0||(this.items=[])}onInit(t){if(super.onInit(t),this.values[0]){const e=S.parse(this.values[0],be);this.items=e.map(n=>bt.create(S.serialize(n)))}}toTextObject(){const t=this.toTextObjectWithoutValue(),e=this.items.map(n=>n.toTextObject());for(const n of e)t[n[M.NAME]]=n;return t}}Hs.NAME="Extensions";class hn{static register(t,e){this.items.set(t,e)}static create(t){const e=new Qe(t),n=this.items.get(e.type);return n?new n(t):e}}hn.items=new Map;const pn="crypto.signatureFormatter";class tf{toAsnSignature(t,e){return A.toArrayBuffer(e)}toWebSignature(t,e){return A.toArrayBuffer(e)}}var hi;let Gn=hi=class{static createPssParams(r,t){const e=hi.getHashAlgorithm(r);return e?new ce({hashAlgorithm:e,maskGenAlgorithm:new k({algorithm:vn,parameters:S.serialize(e)}),saltLength:t}):null}static getHashAlgorithm(r){const t=at.resolve(Je);return typeof r=="string"?t.toAsnAlgorithm({name:r}):typeof r=="object"&&r&&"name"in r?t.toAsnAlgorithm(r):null}toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if("hash"in r){let t;if(typeof r.hash=="string")t=r.hash;else if(r.hash&&typeof r.hash=="object"&&"name"in r.hash&&typeof r.hash.name=="string")t=r.hash.name.toUpperCase();else throw new Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new k({algorithm:Yi,parameters:null});case"sha-256":return new k({algorithm:cs,parameters:null});case"sha-384":return new k({algorithm:Xi,parameters:null});case"sha-512":return new k({algorithm:Qi,parameters:null})}}else return new k({algorithm:we,parameters:null});break;case"rsa-pss":if("hash"in r){if(!("saltLength"in r&&typeof r.saltLength=="number"))throw new Error("Cannot get 'saltLength' from 'alg' argument");const t=hi.createPssParams(r.hash,r.saltLength);if(!t)throw new Error("Cannot create PSS parameters");return new k({algorithm:br,parameters:S.serialize(t)})}else return new k({algorithm:br,parameters:null})}return null}toWebAlgorithm(r){switch(r.algorithm){case we:return{name:"RSASSA-PKCS1-v1_5"};case Yi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case cs:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case Xi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case Qi:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case br:if(r.parameters){const t=S.parse(r.parameters,ce);return{name:"RSA-PSS",hash:at.resolve(Je).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}else return{name:"RSA-PSS"}}return null}};Gn=hi=a([mn()],Gn),at.registerSingleton(Vr,Gn);let Jn=class{toAsnAlgorithm(r){switch(r.name.toLowerCase()){case"sha-1":return new k({algorithm:tn});case"sha-256":return new k({algorithm:en});case"sha-384":return new k({algorithm:rn});case"sha-512":return new k({algorithm:nn})}return null}toWebAlgorithm(r){switch(r.algorithm){case tn:return{name:"SHA-1"};case en:return{name:"SHA-256"};case rn:return{name:"SHA-384"};case nn:return{name:"SHA-512"}}return null}};Jn=a([mn()],Jn),at.registerSingleton(Vr,Jn);class wt{addPadding(t,e){const n=A.toUint8Array(e),i=new Uint8Array(t);return i.set(n,t-n.length),i}removePadding(t,e=!1){let n=A.toUint8Array(t);for(let i=0;i<n.length;i++)if(n[i]){n=n.slice(i);break}if(e&&n[0]>127){const i=new Uint8Array(n.length+1);return i.set(n,1),i.buffer}return n.buffer}toAsnSignature(t,e){if(t.name==="ECDSA"){const n=t.namedCurve,i=wt.namedCurveSize.get(n)||wt.defaultNamedCurveSize,o=new Zi,s=A.toUint8Array(e);return o.r=this.removePadding(s.slice(0,i),!0),o.s=this.removePadding(s.slice(i,i+i),!0),S.serialize(o)}return null}toWebSignature(t,e){if(t.name==="ECDSA"){const n=S.parse(e,Zi),i=t.namedCurve,o=wt.namedCurveSize.get(i)||wt.defaultNamedCurveSize,s=this.addPadding(o,this.removePadding(n.r)),c=this.addPadding(o,this.removePadding(n.s));return ph(s,c)}return null}}wt.namedCurveSize=new Map,wt.defaultNamedCurveSize=32;const Zn="1.3.101.110",Bl="1.3.101.111",Yn="1.3.101.112",kl="1.3.101.113";let Xn=class{toAsnAlgorithm(r){let t=null;switch(r.name.toLowerCase()){case"ed25519":t=Yn;break;case"x25519":t=Zn;break;case"eddsa":switch(r.namedCurve.toLowerCase()){case"ed25519":t=Yn;break;case"ed448":t=kl;break}break;case"ecdh-es":switch(r.namedCurve.toLowerCase()){case"x25519":t=Zn;break;case"x448":t=Bl;break}}return t?new k({algorithm:t}):null}toWebAlgorithm(r){switch(r.algorithm){case Yn:return{name:"Ed25519"};case kl:return{name:"EdDSA",namedCurve:"Ed448"};case Zn:return{name:"X25519"};case Bl:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};Xn=a([mn()],Xn),at.registerSingleton(Vr,Xn);class ef extends Wt{constructor(t){Wt.isAsnEncoded(t)?super(t,Ar):super(t),this.tag=dt.CertificateRequestTag}onInit(t){this.tbs=S.serialize(t.certificationRequestInfo),this.publicKey=new Dt(t.certificationRequestInfo.subjectPKInfo);const e=at.resolve(Je);this.signatureAlgorithm=e.toWebAlgorithm(t.signatureAlgorithm),this.signature=t.signature,this.attributes=t.certificationRequestInfo.attributes.map(i=>hn.create(S.serialize(i)));const n=this.getAttribute(Ls);this.extensions=[],n instanceof Hs&&(this.extensions=n.items),this.subjectName=new ie(t.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(t){for(const e of this.attributes)if(e.type===t)return e;return null}getAttributes(t){return this.attributes.filter(e=>e.type===t)}getExtension(t){for(const e of this.extensions)if(e.type===t)return e;return null}getExtensions(t){return this.extensions.filter(e=>e.type===t)}async verify(t=nt.get()){const e=V(V({},this.publicKey.algorithm),this.signatureAlgorithm),n=await this.publicKey.export(e,["verify"],t),i=at.resolveAll(pn).reverse();let o=null;for(const s of i)if(o=s.toWebSignature(e,this.signature),o)break;if(!o)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await t.subtle.verify(this.signatureAlgorithm,n,o,this.tbs)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,Ar),n=e.certificationRequestInfo,i=new M("",{Version:"".concat(qe[n.version]," (").concat(n.version,")"),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const o=new M("");for(const s of this.attributes){const c=s.toTextObject();o[c[M.NAME]]=c}i.Attributes=o}return t.Data=i,t.Signature=new M("",{Algorithm:Se.serializeAlgorithm(e.signatureAlgorithm),"":e.signature}),t}}ef.NAME="PKCS#10 Certificate Request";class rf extends Wt{constructor(t){Wt.isAsnEncoded(t)?super(t,$e):super(t),this.tag=dt.CertificateTag}onInit(t){const e=t.tbsCertificate;this.tbs=S.serialize(e);let n=new Uint8Array(e.serialNumber);n.length>1&&n[0]===0&&n[1]>127&&(n=n.slice(1)),this.serialNumber=E.ToHex(n),this.subjectName=new ie(e.subject),this.subject=new ie(e.subject).toString(),this.issuerName=new ie(e.issuer),this.issuer=this.issuerName.toString();const i=at.resolve(Je);this.signatureAlgorithm=i.toWebAlgorithm(t.signatureAlgorithm),this.signature=t.signatureValue;const o=e.validity.notBefore.utcTime||e.validity.notBefore.generalTime;if(!o)throw new Error("Cannot get 'notBefore' value");this.notBefore=o;const s=e.validity.notAfter.utcTime||e.validity.notAfter.generalTime;if(!s)throw new Error("Cannot get 'notAfter' value");this.notAfter=s,this.extensions=[],e.extensions&&(this.extensions=e.extensions.map(c=>bt.create(S.serialize(c)))),this.publicKey=new Dt(e.subjectPublicKeyInfo)}getExtension(t){for(const e of this.extensions)if(typeof t=="string"){if(e.type===t)return e}else if(e instanceof t)return e;return null}getExtensions(t){return this.extensions.filter(e=>typeof t=="string"?e.type===t:e instanceof t)}async verify(t={},e=nt.get()){let n,i;const o=t.publicKey;try{if(!o)n=V(V({},this.publicKey.algorithm),this.signatureAlgorithm),i=await this.publicKey.export(n,["verify"],e);else if("publicKey"in o)n=V(V({},o.publicKey.algorithm),this.signatureAlgorithm),i=await o.publicKey.export(n,["verify"],e);else if(o instanceof Dt)n=V(V({},o.algorithm),this.signatureAlgorithm),i=await o.export(n,["verify"],e);else if(A.isBufferSource(o)){const h=new Dt(o);n=V(V({},h.algorithm),this.signatureAlgorithm),i=await h.export(n,["verify"],e)}else n=V(V({},o.algorithm),this.signatureAlgorithm),i=o}catch(h){return!1}const s=at.resolveAll(pn).reverse();let c=null;for(const h of s)if(c=h.toWebSignature(n,this.signature),c)break;if(!c)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const u=await e.subtle.verify(this.signatureAlgorithm,i,c,this.tbs);if(t.signatureOnly)return u;{const h=(t.date||new Date).getTime();return u&&this.notBefore.getTime()<h&&h<this.notAfter.getTime()}}async getThumbprint(...t){let e,n="SHA-1";return t[0]&&(t[0].subtle?e=t[0]:(n=t[0]||n,e=t[1])),e!=null||(e=nt.get()),await e.subtle.digest(n,this.rawData)}async isSelfSigned(t=nt.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},t)}toTextObject(){const t=this.toTextObjectEmpty(),e=S.parse(this.rawData,$e),n=e.tbsCertificate,i=new M("",{Version:"".concat(qe[n.version]," (").concat(n.version,")"),"Serial Number":n.serialNumber,"Signature Algorithm":Se.serializeAlgorithm(n.signature),Issuer:this.issuer,Validity:new M("",{"Not Before":n.validity.notBefore.getTime(),"Not After":n.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(n.issuerUniqueID&&(i["Issuer Unique ID"]=n.issuerUniqueID),n.subjectUniqueID&&(i["Subject Unique ID"]=n.subjectUniqueID),this.extensions.length){const o=new M("");for(const s of this.extensions){const c=s.toTextObject();o[c[M.NAME]]=c}i.Extensions=o}return t.Data=i,t.Signature=new M("",{Algorithm:Se.serializeAlgorithm(e.signatureAlgorithm),"":e.signatureValue}),t}}rf.NAME="Certificate";var xl;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(xl||(xl={})),bt.register(Zl,Au),bt.register(Ql,Su),bt.register(tu,Bu),bt.register(ru,bn),bt.register(bo,Pr),bt.register(eu,ku),bt.register(Co,xu),bt.register(mo,Ou),hn.register(du,Cu),hn.register(Ls,Hs),at.registerSingleton(pn,tf),at.registerSingleton(pn,wt),wt.namedCurveSize.set("P-256",32),wt.namedCurveSize.set("K-256",32),wt.namedCurveSize.set("P-384",48),wt.namedCurveSize.set("P-521",66);export{me as A,A as B,ot as C,ki as D,xi as E,yi as F,Oi as G,Fe as H,_e as I,ge as J,cf as K,sh as L,sf as M,ve as N,fe as O,kr as P,Ci as R,Et as S,wi as T,Or as U,Ai as V,rf as X,pf as a,Xt as b,df as c,di as d,ye as e,Le as f,af as g,Es as h,E as i,Rt as j,hf as k,yh as l,Eh as m,yf as n,fi as o,bi as p,vi as q,zt as r,ff as s,uf as t,lf as u,gi as v,Si as w,mi as x,Bi as y,xr as z};
//# sourceMappingURL=x509.es-CPXDVI1b.chunk.mjs.map
